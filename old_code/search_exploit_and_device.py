# Author: Dr. X
# Searches through exploits of a specific type
# combined with another word for a generic device (ex. 'webcam type:dos') and prints them

import shodan

SHODAN_API_KEY = "myKey"

api = shodan.Shodan(SHODAN_API_KEY)

print('device search')
print('=================================================================================')
# Wrap the request in a try/ except block to catch errors
list_devices = ['webcam', 'router', 'Amazon Echo', 'printer', 'light']
list_exploits_type = ['dos', 'local', 'remote', 'shellcode', ' webapps']

for device in list_devices:
    for type in list_exploits_type:
        # Search Shodan
        print('Searching for '+ device)
        print('=================================================================================')
        print('exploit search')
        print('=================================================================================')
        # Wrap the request in a try/ except block to catch errors
        try:
            # Search Shodan
            print(type)
            print('=================================================================================')
            exploits = api.exploits.search(device + ' type:'+type)

            # Show the results
            print('Exploits found: {}'.format(exploits['total']))
            for exploit in exploits['matches']:
                print('CVE: {}'.format(exploit['cve']))
                print('Description: {}'.format(exploit['description']))
                print(exploit)
                print('')
        except Exception as e:
            print(e)
